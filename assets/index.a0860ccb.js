var Be=Object.defineProperty,Fe=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var Se=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var oe=(o,e,n)=>e in o?Be(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,V=(o,e)=>{for(var n in e||(e={}))We.call(e,n)&&oe(o,n,e[n]);if(Se)for(var n of Se(e))Ge.call(e,n)&&oe(o,n,e[n]);return o},z=(o,e)=>Fe(o,ze(e));var K=(o,e,n)=>(oe(o,typeof e!="symbol"?e+"":e,n),n);import{w as writable,S as SvelteComponent,i as init,s as safe_not_equal,e as element,a as space,b as attr,c as append,d as insert,n as noop,f as detach,g as component_subscribe,o as onMount,t,h as binding_callbacks,j as toggle_class,k as empty,l as group_outros,m as transition_out,p as check_outros,q as transition_in,r as text,u as set_data,v as create_slot,x as listen,y as update_slot_base,z as get_all_dirty_from_scope,A as get_slot_changes,B as createEventDispatcher,C as set_custom_element_data,D as create_component,E as mount_component,F as destroy_component,G as shortid,H as set_style,I as destroy_each,J as add_render_callback,K as create_bidirectional_transition,L as scale,M as fade,N as get_spread_update,O as get_spread_object,P as assign,T as Texture,Q as SvelteComponentDev,R as slide,U as update_keyed_each,V as backInOut,W as outro_and_destroy_block,X as flush,Y as svg_element,Z as run_all,_ as monotoneCubicSpline,$ as set_input_value,a0 as to_number,a1 as subtract,a2 as normalize,a3 as cross$1,a4 as dot,a5 as identity,a6 as rotate,a7 as mul,a8 as transformMat4,a9 as add$1,aa as mod,ab as Vec3,ac as Geometry,ad as wrap,ae as Transform,af as Renderer$1,ag as Camera,ah as Orbit,ai as Program,aj as Mesh,ak as Box,al as storage,am as stop_propagation,an as ResizeObserver_1,ao as add_flush_callback,ap as bind,aq as set_store_value,ar as get_store_value,as as Plane,at as Color,au as HtmlTag,av as Src,aw as bubble,ax as handle_promise,ay as update_await_block_branch,az as subscribe}from"./vendor.2896a0c9.js";const p=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}};p();var global="";const dark_shadow="0px 0px 2px rgba(0, 0, 0, 0.7)",light_shadow="0px 0px 5px rgba(0, 0, 0, 0.144)";var styles={"dark_background-color":"#1a1a1a","dark_foreground-color":"#303030","dark_outline-color":"#212121","dark_text-color":"#ffffff",dark_shadow,"light_background-color":"#d0d0d0","light_foreground-color":"white","light_outline-color":"#b9b9b9","light_text-color":"#484848",light_shadow};function stylesToJSON(o){const e={};return Object.entries(o).forEach(([n,s])=>{const[i,r]=n.split("_");i in e?e[i][r]=s:e[i]={[r]:s}}),e}const themes=stylesToJSON(styles),themeNames=Object.keys(themes);let activeTheme="theme"in localStorage?localStorage.getItem("theme"):themeNames[0];themeNames.includes(activeTheme)||(activeTheme=themeNames[0]);const store$4=writable(themes[activeTheme]),setTheme=o=>{themeNames.includes(o)&&(store$4.set(themes[o]),localStorage.setItem("theme",o))};function create_fragment$u(o){let e,n;return{c(){e=element("style"),n=space(),attr(e,"type","text/css")},m(s,i){append(document.head,e),o[3](e),insert(s,n,i)},p:noop,i:noop,o:noop,d(s){detach(e),o[3](null),s&&detach(n)}}}function instance$r(o,e,n){let s,i;component_subscribe(o,store$4,f=>n(2,i=f));let r,c=!1;function d(){c||!r||(c=!0,n(0,r.innerHTML="* {transition: color 0.2s ease, background-color 0.2s ease, outline 0.2s ease !important;}",r),setTimeout(()=>{n(0,r.innerHTML=`* {transition: color 0.2s ease, background-color 0.2s ease, outline 0.2s ease !important;} :root{${s}}`,r),setTimeout(()=>{n(0,r.innerHTML=`:root{${s}}`,r),c=!1},200)},1))}onMount(()=>{n(0,r.innerHTML=`:root{${s}}`,r)});function u(f){binding_callbacks[f?"unshift":"push"](()=>{r=f,n(0,r)})}return o.$$.update=()=>{o.$$.dirty&4&&n(1,s=t(i)),o.$$.dirty&2&&s&&d()},[r,s,i,u]}class ThemeProvider extends SvelteComponent{constructor(e){super();init(this,e,instance$r,create_fragment$u,safe_not_equal,{})}}function getBrowser$1(){return"window"in globalThis}const isBrowser=getBrowser$1();var arrow=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.2" baseProfile="tiny" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	 x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" xml:space="preserve">
</svg>
`,branch=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>branch</title>
  <path class="cls-1" d="M49.59,57.35,72.15,38.69"/>
  <path class="cls-1" d="M51.58,29.45,38,11.21"/>
  <path class="cls-1" d="M53.14,82.61,21.78,55.74"/>
  <path class="cls-1" d="M33.46,47.91l4,21"/>
  <polyline class="cls-1" points="56 97 50 58 51 28 56 16"/>
</svg>`,checkmark='<svg id="e7691b6e-31fa-49a4-aaec-be19b623d191" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><style>.b50603dd-20d5-40a2-a0ce-2fdf3b92ec21{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:5px;}</style></defs><title>checkmark</title><path class="b50603dd-20d5-40a2-a0ce-2fdf3b92ec21" d="M75.5,30,40.43,72.47a2,2,0,0,1-3.08,0L24.5,57"/></svg>',cog=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
<defs>
	<style>
		circle, path{
			fill:none;
			stroke: var(--text, white);
			stroke-width: 5px;
		}
	</style>
</defs>
	<circle class="cls-1" cx="50.37" cy="50.5" r="17.23"/>
  <path class="cls-1" d="M38.07,20.49,32.17,8.05,50.83,4.41l.61,13.8,12.13,2.28L68.73,8.05l14,10.16-9,10L81.17,38.7l12-5.47,3.34,17.3H81.93L80.57,63l12.59,6.37L82.7,83.62l-9-9.86L63.58,81.19l5.15,11.23-17.9,3.64V82.71L38.08,81.19,32.77,92.42,17.44,82.71l10.17-8.35L19.11,63,8.19,69.36,4.4,50.56H17.45l1.67-13.81L8.2,30.84l9.25-13.2,11.08,8.81Z"/>
</svg>
`,cross=`<svg
  xmlns="http://www.w3.org/2000/svg"
	viewBox="0 0 100 100">
  <line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="27.836" y1="72.164" x2="72.164" y2="27.836"/>
  <line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="27.836" y1="27.988" x2="72.164" y2="72.012"/>
</svg>
`,exclamation=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M50.552 59.3295L39.0695 13.7056H60.2078L50.552 59.3295Z" stroke="white" stroke-width="5" stroke-linejoin="round"/>
<path d="M58.4305 77.2411C58.4305 80.8276 55.4725 83.7944 51.7497 83.7944C48.0269 83.7944 45.0688 80.8276 45.0688 77.2411C45.0688 73.6546 48.0269 70.6878 51.7497 70.6878C55.4725 70.6878 58.4305 73.6546 58.4305 77.2411Z" stroke="white" stroke-width="5"/>
</svg>
`,folder=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">

<defs>
	<style>
		path{
			stroke: white;
			stroke-width: 5px;
		}
	</style>
</defs>

<path d="M23.5167 72.9513V32.1483H82.1056L87.6855 37.0307V76.09L82.1056 78.5312H29.4453L23.5167 72.9513Z" />
<path d="M23.2747 73.6489L12.3145 30.0463L15.8885 21.4688H71.8808L75.693 32.9055" />
<path d="M25.488 43.9781H86.7394" />
</svg>
`,hand=`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
<path d="M70.5 26.5L77.5 23.5L82 32V69L77.5 82L64.5 92.5H47L32 82L18 46L21 40H27L35 57.5V15.5L39.5 11L45.5 13.5M70.5 26.5L69 15.5L58.5 14M70.5 26.5V57.5M58.5 14L55 8L45.5 13.5M58.5 14V49M45.5 13.5V49" stroke-width="5"/>
</svg>
`,leaf$1=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>leaf</title>
  <path class="cls-1" d="M50.69,96.21,72.86,72.33,77,47,65.91,21.7,50.66,4.5"/>
  <path class="cls-1" d="M53.37,96.21,31.2,72.33,27.07,47,38.15,21.7,53.4,4.5"/>
</svg>`,pointing=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M30.2312 46.4809V15.6962L33.3006 8H40.8035L44.3844 11.0785V29.7203H52.9104L55.9798 33.8249H65.0173L68.0867 38.9557L76.2717 40.1529L79 56.0583L73.7139 72.9899L66.8931 93H36.5405L30.2312 75.5553L20 60.334L21.7052 50.2435L30.2312 46.4809ZM30.2312 46.4809V58.1107M44.3844 29.3783V46.3099M56.4913 34.5091V46.3099M68.7688 39.2978V50.4145" stroke="white" stroke-width="5"/>
</svg>
`,stem=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>stem</title>
  <path class="cls-1" d="M49,95.5l8.66-23.19L43.24,46.07l10.59-21L43.24,4.5"/>
</svg>`,triangle=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" xml:space="preserve">
  <polygon fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" points="33.5,73.759 33.5,26.241 67.441,50 "/>
</svg>
`,warning=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M54.7631 15.1799L91.7944 79.3201C93.9114 82.9867 91.2652 87.5701 87.0313 87.5701H12.9687C8.73476 87.5701 6.08857 82.9867 8.20552 79.3201L45.2368 15.1799C47.3538 11.5133 52.6462 11.5133 54.7631 15.1799Z" stroke="white" stroke-width="5" stroke-linejoin="round"/>
<ellipse cx="50.0578" cy="73.7787" rx="5.98166" ry="5.89858" fill="white"/>
<path d="M52.9755 60.2707C52.5275 63.7615 47.4723 63.7615 47.0243 60.2707L43.5981 33.5748C43.3678 31.781 44.7652 30.1929 46.5736 30.1929L53.4261 30.1929C55.2346 30.1929 56.6319 31.781 56.4017 33.5748L52.9755 60.2707Z" fill="white"/>
</svg>
`,question=`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
<path d="M32.7792 25.4477L45.6598 15.6472L61.6205 20.4075L67.2208 32.728L54.3402 46.4486L50.9801 59.3291V63.9218" stroke-width="8"/>
<path d="M47.3642 83.3434L44.983 79.0169L46.821 74.3331L51.3861 73.0881L55.5363 75.0446L56.307 80.8548L52.3347 84.3528L47.3642 83.3434Z" />
</svg>

`,icons=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",arrow,branch,checkmark,cog,cross,exclamation,folder,hand,leaf:leaf$1,pointing,stem,triangle,warning,question}),Icon_svelte_svelte_type_style_lang="";function create_fragment$t(o){let e;return{c(){e=element("div"),attr(e,"class","icon-wrapper svelte-1ho94ty"),toggle_class(e,"active",o[0]),toggle_class(e,"dark",o[1]),toggle_class(e,"circle",o[2])},m(n,s){insert(n,e,s),e.innerHTML=o[3]},p(n,[s]){s&8&&(e.innerHTML=n[3]),s&1&&toggle_class(e,"active",n[0]),s&2&&toggle_class(e,"dark",n[1]),s&4&&toggle_class(e,"circle",n[2])},i:noop,o:noop,d(n){n&&detach(e)}}}function instance$q(o,e,n){let s,{name:i="triangle"}=e,{active:r=!1}=e,{dark:c=!1}=e,{circle:d=!1}=e;return o.$$set=u=>{"name"in u&&n(4,i=u.name),"active"in u&&n(0,r=u.active),"dark"in u&&n(1,c=u.dark),"circle"in u&&n(2,d=u.circle)},o.$$.update=()=>{o.$$.dirty&16&&n(3,s=i in icons?icons[i]:i.toString()+" icon not found")},[r,c,d,s,i]}class Icon extends SvelteComponent{constructor(e){super();init(this,e,instance$q,create_fragment$t,safe_not_equal,{name:4,active:0,dark:1,circle:2})}}var Button_svelte_svelte_type_style_lang="";function create_if_block_1$9(o){let e,n,s,i;const r=[create_if_block_2$7,create_else_block$7],c=[];function d(u,f){return u[6]?0:1}return e=d(o),n=c[e]=r[e](o),{c(){n.c(),s=empty()},m(u,f){c[e].m(u,f),insert(u,s,f),i=!0},p(u,f){let h=e;e=d(u),e===h?c[e].p(u,f):(group_outros(),transition_out(c[h],1,1,()=>{c[h]=null}),check_outros(),n=c[e],n?n.p(u,f):(n=c[e]=r[e](u),n.c()),transition_in(n,1),n.m(s.parentNode,s))},i(u){i||(transition_in(n),i=!0)},o(u){transition_out(n),i=!1},d(u){c[e].d(u),u&&detach(s)}}}function create_else_block$7(o){let e;return{c(){e=element("plant-icon"),set_custom_element_data(e,"name",o[1]),set_custom_element_data(e,"active",o[0]),set_custom_element_data(e,"class","svelte-1uu4rv2")},m(n,s){insert(n,e,s)},p(n,s){s&2&&set_custom_element_data(e,"name",n[1]),s&1&&set_custom_element_data(e,"active",n[0])},i:noop,o:noop,d(n){n&&detach(e)}}}function create_if_block_2$7(o){let e,n;return e=new Icon({props:{name:o[1],active:o[0]}}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&2&&(r.name=s[1]),i&1&&(r.active=s[0]),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_if_block$f(o){let e,n;return{c(){e=element("p"),n=text(o[2]),attr(e,"class","svelte-1uu4rv2")},m(s,i){insert(s,e,i),append(e,n)},p(s,i){i&4&&set_data(n,s[2])},d(s){s&&detach(e)}}}function create_fragment$s(o){let e,n,s,i,r,c,d,u=o[1]&&create_if_block_1$9(o),f=o[2]&&create_if_block$f(o);const h=o[9].default,m=create_slot(h,o,o[8],null);return{c(){e=element("button"),u&&u.c(),n=space(),f&&f.c(),s=space(),i=element("div"),m&&m.c(),attr(i,"class","content svelte-1uu4rv2"),e.disabled=o[4],attr(e,"class","svelte-1uu4rv2"),toggle_class(e,"active",o[0]),toggle_class(e,"useActive",o[3]),toggle_class(e,"only-icon",!o[2]),toggle_class(e,"has-icon",!!o[1])},m(_,v){insert(_,e,v),u&&u.m(e,null),append(e,n),f&&f.m(e,null),append(e,s),append(e,i),m&&m.m(i,null),o[10](e),r=!0,c||(d=listen(e,"click",o[7]),c=!0)},p(_,[v]){_[1]?u?(u.p(_,v),v&2&&transition_in(u,1)):(u=create_if_block_1$9(_),u.c(),transition_in(u,1),u.m(e,n)):u&&(group_outros(),transition_out(u,1,1,()=>{u=null}),check_outros()),_[2]?f?f.p(_,v):(f=create_if_block$f(_),f.c(),f.m(e,s)):f&&(f.d(1),f=null),m&&m.p&&(!r||v&256)&&update_slot_base(m,h,_,_[8],r?get_slot_changes(h,_[8],v,null):get_all_dirty_from_scope(_[8]),null),(!r||v&16)&&(e.disabled=_[4]),v&1&&toggle_class(e,"active",_[0]),v&8&&toggle_class(e,"useActive",_[3]),v&4&&toggle_class(e,"only-icon",!_[2]),v&2&&toggle_class(e,"has-icon",!!_[1])},i(_){r||(transition_in(u),transition_in(m,_),r=!0)},o(_){transition_out(u),transition_out(m,_),r=!1},d(_){_&&detach(e),u&&u.d(),f&&f.d(),m&&m.d(_),o[10](null),c=!1,d()}}}function instance$p(o,e,n){let s,{$$slots:i={},$$scope:r}=e,{icon:c=void 0}=e,{name:d=""}=e,{active:u=!1}=e,{useActive:f=!1}=e,{disabled:h=!1}=e,m;const _=createEventDispatcher(),v=()=>{n(0,u=!u),_("click")};function g(y){binding_callbacks[y?"unshift":"push"](()=>{m=y,n(5,m)})}return o.$$set=y=>{"icon"in y&&n(1,c=y.icon),"name"in y&&n(2,d=y.name),"active"in y&&n(0,u=y.active),"useActive"in y&&n(3,f=y.useActive),"disabled"in y&&n(4,h=y.disabled),"$$scope"in y&&n(8,r=y.$$scope)},o.$$.update=()=>{o.$$.dirty&32&&n(6,s=m&&!!m.parentElement)},[u,c,d,f,h,m,s,v,r,i,g]}class Button extends SvelteComponent{constructor(e){super();init(this,e,instance$p,create_fragment$s,safe_not_equal,{icon:1,name:2,active:0,useActive:3,disabled:4})}}var MessageType$1;(function(o){o.INFO="info",o.WARNING="warning",o.ERROR="error",o.SUCCESS="success"})(MessageType$1||(MessageType$1={}));const createMessageFactory=o=>(e,n={})=>{var c;if(!e&&!n)return;const s=Array.isArray(n==null?void 0:n.values),i={id:shortid(),type:MessageType$1.INFO,content:e,props:n.props,title:(c=n==null?void 0:n.title)!=null?c:n==null?void 0:n.type,values:n==null?void 0:n.values,timeout:n==null?void 0:n.timeout},r=new Promise((d,u)=>{i.resolve=d,i.reject=u});if(r.finally(()=>o.update(d=>d.filter(u=>u.id!==i.id))),n&&"type"in n){const d=n.type.toLowerCase();Object.values(MessageType$1).forEach(u=>{d===u&&(i.type=u)})}if(e instanceof Error&&(i.type=MessageType$1.ERROR),typeof i.timeout=="undefined"){let d;i.type===MessageType$1.SUCCESS&&(d=3e3),i.type===MessageType$1.INFO&&(d=2e3),i.type===MessageType$1.WARNING&&(d=7e3),d&&!s&&(i.timeout=d)}return"title"in i||(i.title=i.type.toUpperCase().slice(0,1)+i.type.slice(1)),o.update(d=>[...d,i]),i.timeout&&setTimeout(i.resolve,i.timeout),r};var createMessageStore=()=>{const o=writable([]),e=createMessageFactory(o);return{store:o,createMessage:e,MessageType:MessageType$1}};const{store:_store$1,createMessage:createMessage$1,MessageType}=createMessageStore(),store$3=_store$1,createAlert=createMessage$1;var AlertWrapper_svelte_svelte_type_style_lang="";function get_each_context$c(o,e,n){const s=o.slice();return s[6]=e[n],s}function create_if_block$e(o){let e,n,s,i,r,c,d,u,f,h,m,_,v,g;i=new Button({props:{icon:"cross"}}),i.$on("click",o[4]);let y=o[0].title&&create_if_block_3$2(o);const b=[create_if_block_2$6,create_else_block$6],w=[];function S($,P){return typeof $[0].content=="string"?0:1}u=S(o),f=w[u]=b[u](o);let k=o[0].values&&create_if_block_1$8(o);return{c(){e=element("div"),n=element("div"),s=element("div"),r=element("div"),create_component(i.$$.fragment),c=space(),y&&y.c(),d=space(),f.c(),h=space(),k&&k.c(),set_style(r,"display","contents"),set_style(r,"--bg","transparent"),attr(s,"class","close-wrapper svelte-r4wwk4"),attr(n,"class",m="alert-wrapper alert-"+o[0].type+" svelte-r4wwk4"),toggle_class(n,"isInverted",o[1]),attr(e,"class","alert-container svelte-r4wwk4")},m($,P){insert($,e,P),append(e,n),append(n,s),append(s,r),mount_component(i,r,null),append(n,c),y&&y.m(n,null),append(n,d),w[u].m(n,null),append(n,h),k&&k.m(n,null),g=!0},p($,P){$[0].title?y?y.p($,P):(y=create_if_block_3$2($),y.c(),y.m(n,d)):y&&(y.d(1),y=null);let x=u;u=S($),u===x?w[u].p($,P):(group_outros(),transition_out(w[x],1,1,()=>{w[x]=null}),check_outros(),f=w[u],f?f.p($,P):(f=w[u]=b[u]($),f.c()),transition_in(f,1),f.m(n,h)),$[0].values?k?(k.p($,P),P&1&&transition_in(k,1)):(k=create_if_block_1$8($),k.c(),transition_in(k,1),k.m(n,null)):k&&(group_outros(),transition_out(k,1,1,()=>{k=null}),check_outros()),(!g||P&1&&m!==(m="alert-wrapper alert-"+$[0].type+" svelte-r4wwk4"))&&attr(n,"class",m),P&3&&toggle_class(n,"isInverted",$[1])},i($){g||(transition_in(i.$$.fragment,$),transition_in(f),transition_in(k),add_render_callback(()=>{_||(_=create_bidirectional_transition(n,scale,{},!0)),_.run(1)}),add_render_callback(()=>{v||(v=create_bidirectional_transition(e,fade,{},!0)),v.run(1)}),g=!0)},o($){transition_out(i.$$.fragment,$),transition_out(f),transition_out(k),_||(_=create_bidirectional_transition(n,scale,{},!1)),_.run(0),v||(v=create_bidirectional_transition(e,fade,{},!1)),v.run(0),g=!1},d($){$&&detach(e),destroy_component(i),y&&y.d(),w[u].d(),k&&k.d(),$&&_&&_.end(),$&&v&&v.end()}}}function create_if_block_3$2(o){let e,n=o[0].title+"",s;return{c(){e=element("h2"),s=text(n),attr(e,"class","svelte-r4wwk4")},m(i,r){insert(i,e,r),append(e,s)},p(i,r){r&1&&n!==(n=i[0].title+"")&&set_data(s,n)},d(i){i&&detach(e)}}}function create_else_block$6(o){let e,n,s;const i=[o[0].props];var r=o[0].content;function c(d){let u={};for(let f=0;f<i.length;f+=1)u=assign(u,i[f]);return{props:u}}return r&&(e=new r(c())),{c(){e&&create_component(e.$$.fragment),n=empty()},m(d,u){e&&mount_component(e,d,u),insert(d,n,u),s=!0},p(d,u){const f=u&1?get_spread_update(i,[get_spread_object(d[0].props)]):{};if(r!==(r=d[0].content)){if(e){group_outros();const h=e;transition_out(h.$$.fragment,1,0,()=>{destroy_component(h,1)}),check_outros()}r?(e=new r(c()),create_component(e.$$.fragment),transition_in(e.$$.fragment,1),mount_component(e,n.parentNode,n)):e=null}else r&&e.$set(f)},i(d){s||(e&&transition_in(e.$$.fragment,d),s=!0)},o(d){e&&transition_out(e.$$.fragment,d),s=!1},d(d){d&&detach(n),e&&destroy_component(e,d)}}}function create_if_block_2$6(o){let e,n=o[0].content+"";return{c(){e=element("p")},m(s,i){insert(s,e,i),e.innerHTML=n},p(s,i){i&1&&n!==(n=s[0].content+"")&&(e.innerHTML=n)},i:noop,o:noop,d(s){s&&detach(e)}}}function create_if_block_1$8(o){let e,n,s=o[0].values,i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$c(get_each_context$c(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){e=element("div");for(let c=0;c<i.length;c+=1)i[c].c();attr(e,"class","options-wrapper svelte-r4wwk4")},m(c,d){insert(c,e,d);for(let u=0;u<i.length;u+=1)i[u].m(e,null);n=!0},p(c,d){if(d&1){s=c[0].values;let u;for(u=0;u<s.length;u+=1){const f=get_each_context$c(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$c(f),i[u].c(),transition_in(i[u],1),i[u].m(e,null))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){c&&detach(e),destroy_each(i,c)}}}function create_each_block$c(o){let e,n,s;function i(){return o[5](o[6])}return e=new Button({props:{name:o[6]}}),e.$on("click",i),{c(){n=element("div"),create_component(e.$$.fragment),set_style(n,"display","contents"),set_style(n,"--bg","#303030"),set_style(n,"--text","white")},m(r,c){insert(r,n,c),mount_component(e,n,null),s=!0},p(r,c){o=r;const d={};c&1&&(d.name=o[6]),e.$set(d)},i(r){s||(transition_in(e.$$.fragment,r),s=!0)},o(r){transition_out(e.$$.fragment,r),s=!1},d(r){r&&detach(n),destroy_component(e,r)}}}function create_fragment$r(o){let e,n,s,i,r=o[0]&&create_if_block$e(o);return{c(){r&&r.c(),e=empty()},m(c,d){r&&r.m(c,d),insert(c,e,d),n=!0,s||(i=listen(window,"keydown",o[2]),s=!0)},p(c,[d]){c[0]?r?(r.p(c,d),d&1&&transition_in(r,1)):(r=create_if_block$e(c),r.c(),transition_in(r,1),r.m(e.parentNode,e)):r&&(group_outros(),transition_out(r,1,1,()=>{r=null}),check_outros())},i(c){n||(transition_in(r),n=!0)},o(c){transition_out(r),n=!1},d(c){r&&r.d(c),c&&detach(e),s=!1,i()}}}function instance$o(o,e,n){let s,i,r;component_subscribe(o,store$3,f=>n(3,r=f));function c(f){f.key==="Escape"&&s&&s.reject()}const d=()=>{s.reject()},u=f=>s.resolve(f);return o.$$.update=()=>{o.$$.dirty&8&&n(0,s=r[0]),o.$$.dirty&1&&(s?isBrowser&&document.body.classList.add("overlay-visible"):isBrowser&&document.body.classList.remove("overlay-visible")),o.$$.dirty&1&&n(1,i=s&&(s.type==="success"||s.type==="warning"))},[s,i,c,r,d,u]}class AlertWrapper extends SvelteComponent{constructor(e){super();init(this,e,instance$o,create_fragment$r,safe_not_equal,{})}}const{store:_store,createMessage}=createMessageStore(),store$2=_store,createToast=createMessage;var aggregate=(o,...e)=>{const n=(i,r)=>{Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r).map(c=>c.toString())).forEach(c=>{c.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(i,c,Object.getOwnPropertyDescriptor(r,c))})},s=class extends o{constructor(...r){super(...r);e.forEach(c=>n(this,new c))}};return e.forEach(i=>{n(s.prototype,i.prototype),n(s,i)}),s},convertHexToRGB=o=>{o[0]==="#"&&(o=o.replace("#","")),o.length===3&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]);const e=o.match(/.{1,2}/g);return[parseInt(e[0],16)/255,parseInt(e[1],16)/255,parseInt(e[2],16)/255]};const tension=.4;function plotCBez(o,e,n,s,i,r,c,d,u,f){const h=i-n,m=c-i,_=u-c,v=r-s,g=d-r,y=f-d;let b,w,S,k,$=-1e4,P=-1e4;const x=[{x:n,y:s}];for(let j=1;j<o;j++){const N=j/o;b=n+h*N,S=i+m*N;const A=c+_*N;b+=(S-b)*N,S+=(A-S)*N,w=s+v*N,k=r+g*N;const O=d+y*N;w+=(k-w)*N,k+=(O-k)*N;const R=b+(S-b)*N,I=w+(k-w)*N,D=R-$,E=I-P;D*D+E*E>e&&(x.push({x:R,y:I}),$=R,P=I)}return x.push({x:u,y:f}),x}function computeControlPoints(o){const e=o.length-1;return o.map((n,s,i)=>{if(s===0)return{rx:i[s+1].x*tension*0,ry:n.y+(i[s+1].y-n.y)*tension*0};if(s===e)return{lx:i[s-1].x+(n.x-i[s-1].x)*tension*2,ly:i[s-1].y+(n.y-i[s-1].y)*tension*2};if(n.y>i[s+1].y&&n.y>i[s-1].y||n.y<i[s+1].y&&n.y<i[s-1].y)return{lx:i[s-1].x+(n.x-i[s-1].x)*tension,ly:n.y,rx:n.x+(i[s+1].x-n.x)*tension,ry:n.y};{const c={x:i[s-1].x-i[s+1].x,y:i[s-1].y-i[s+1].y},d=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2));c.x/=d,c.y/=d;const u=i[s+1].x-n.x,f=n.x-i[s-1].x;return{lx:n.x+c.x*f*tension,ly:n.y+c.y*f*tension,rx:n.x-c.x*u*tension,ry:n.y-c.y*u*tension}}})}function toArray(o){const e=o.length-1,n={},s=computeControlPoints(o);return o.map((i,r,c)=>{if(r<e)return plotCBez(e*20,0,i.x,i.y,s[r].rx,s[r].ry,s[r+1].lx,s[r+1].ly,c[r+1].x,c[r+1].y)}).flat().filter(i=>!i||i.x in n?!1:(n[i.x]=!0,!0))}function debounce(o,e,n){let s;return(...i)=>{const r=()=>{s=null,n||o(...i)},c=n&&!s;clearTimeout(s),s=setTimeout(r,e),c&&o(...i)}}function Debounce(o,e=!1){return function(n,s,i){let r;const c=i.value;return i.value=function(...d){const u=()=>{r=null,e||c.apply(this,d)},f=e&&!r;clearTimeout(r),r=setTimeout(u,o),f&&c.apply(this,d)},i}}function throttle(o,e){let n,s,i,r=null,c=0;const d=o,u=()=>{c=0,r=null,i=d.apply(n,s),r||(n=s=null)};return function(){const h=Date.now();c||(c=h);const m=e-(h-c);return n=this,s=arguments,m<=0||m>e?(r&&(window.clearTimeout(r),r=null),c=h,i=d.apply(n,s),r||(n=s=null)):r||(r=window.setTimeout(u,m)),i}}const debug={amountEmitters:0,amountCallbacks:0,emitters:[]};typeof self!="undefined"&&"window"in self&&(window.debug=debug);class EventEmitter{constructor(){K(this,"index",0);K(this,"cbs",{});K(this,"cbsOnce",{});this.index=debug.amountEmitters,debug.amountEmitters++}emit(e,n){e in this.cbs&&this.cbs[e].forEach(s=>s(n)),e in this.cbsOnce&&(this.cbsOnce[e].forEach(s=>s(n)),delete this.cbsOnce[e])}on(e,n,s=0){s>0&&(n=throttle(n,s));const i=Object.assign(this.cbs,{[e]:[...this.cbs[e]||[],n]});return this.cbs=i,debug.emitters[this.index]={name:this.constructor.name,cbs:Object.fromEntries(Object.keys(this.cbs).map(r=>[r,this.cbs[r].length]))},debug.amountCallbacks++,()=>{var r;debug.amountCallbacks--,(r=i[e])==null||r.splice(i[e].indexOf(n),1),debug.emitters[this.index]={name:this.constructor.name,cbs:Object.fromEntries(Object.keys(this.cbs).map(c=>[c,this.cbs[c].length]))}}}once(e,n){return this.cbsOnce[e]=[...this.cbsOnce[e]||[],n],()=>{this.cbsOnce[e].splice(this.cbsOnce[e].indexOf(n),1)}}destroyEventEmitter(){debug.amountEmitters--,Object.keys(this.cbs).forEach(e=>{debug.amountCallbacks-=this.cbs[e].length,delete this.cbs[e]}),Object.keys(this.cbsOnce).forEach(e=>delete this.cbsOnce[e]),this.cbs={},this.cbsOnce={},delete debug.emitters[this.index]}}function fastHash(o){if(o.length===0)return 0;let e=0;for(let n=0;n<o.length;n++)e=(e<<5)-e+o.charCodeAt(n),e=e&e;return e}var genId=()=>{const o={};let e=0;const n=(s=0,i=0)=>{if(i>500)throw new Error("Infinite loop in id generation algo");return s in o?n(Math.max(s++,e++),i+1):(o[s]=!0,s.toString())};return n.reset=()=>{Object.keys(o).forEach(s=>delete o[+s]),e=0},n};function groupArray(o,e){const n=[],s=o.length/e;for(let i=0;i<s;i++){const r=[];for(let c=0;c<e;c++)r[c]=o[i*e+c];n.push(r)}return n}const getPluralS=o=>o>1?"s":"",time=o=>{if(typeof o!="number"||isNaN(o))return"never";if(o<1e3)return"< 1 second";const e=Math.floor(o/1e3);if(e<60)return e+" second"+getPluralS(e);const n=Math.floor(e/60);if(n<60)return n+" minute"+getPluralS(n);const s=Math.floor(n/60);if(s<24)return s+" hour"+getPluralS(s);const i=Math.floor(s/24);if(i<7)return i+" day"+getPluralS(i);const r=Math.floor(i/7);if(r<30)return r+" week"+getPluralS(r);const c=Math.floor(r/30);if(c<12)return c+" month"+getPluralS(c);const d=Math.floor(c/12);if(d<10)return d+" year"+getPluralS(d);const u=Math.floor(c/10);return u+" decade"+getPluralS(u)};function memo(o){let e,n={length:NaN};const s=(i,r)=>i===n[r];return function(...r){return(r.length!==n.length||!r.every(s))&&(n=r,e=o.apply(this,r)),e}}const textureCache={},loadTexture=(o,e,n={})=>{if(textureCache[e])return textureCache[e];const s=new Texture(o,n),i=new Image;return textureCache[e]=s,i.onload=()=>{s.image=i},i.src=e,s};var loader={texture:loadTexture};let filters=[],level=2,longestName=0;const scopes={};let currentIndex=0;const colors=["#00ffff","#f0ffff","#f5f5dc","#000000","#0000ff","#a52a2a","#00ffff","#00008b","#008b8b","#a9a9a9","#006400","#bdb76b","#8b008b","#556b2f","#ff8c00","#9932cc","#8b0000","#e9967a","#9400d3","#ff00ff","#ffd700","#008000","#4b0082","#f0e68c","#add8e6","#e0ffff","#90ee90","#d3d3d3","#ffb6c1","#ffffe0","#00ff00","#ff00ff","#800000","#000080","#808000","#ffa500","#ffc0cb","#800080","#800080","#ff0000","#c0c0c0","#ffffff","#ffff00"];function log$8(o){longestName=Math.max(longestName,o.length);const e=currentIndex;scopes[o]=colors[currentIndex],currentIndex++;const n=(...s)=>{if((!filters.length||filters.includes(o))&&level===0){if(typeof s[0]=="string"&&typeof s[1]=="object"){console.groupCollapsed(`%c[${o.padEnd(longestName," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,s[0]),console.log(...s.slice(1)),console.groupEnd();return}console.log(`%c[${o.padEnd(longestName," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,...s)}};return n.group=(...s)=>{level<1&&console.groupCollapsed(`%c[${o.padEnd(longestName," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,...s)},n.warn=(...s)=>{level<=1&&console.warn(`[${o.padEnd(longestName," ")}]`,...s)},n.error=s=>{console.error(`[${o.padEnd(longestName," ")}]`,s)},n}log$8.setFilter=(...o)=>{filters=o};log$8.setLevel=(o=0)=>{level=o};function memoize(o){const e={};return(...n)=>{const s=fastHash(JSON.stringify(n));return s in e?e[s]:e[s]=o(...n)}}const regex=/^(?:[ ]+)?(?:at )([^ ]*)?(?: )?(?:\[(.*?)\] )?(?:\(([^()]+)\))?$/gm,stripPath=o=>o.replace(window.location.href,"").replace(/^node_modules/,"").replace(/.+?(?=plantarium)plantarium\//,"");var parseStackTrace=o=>{const[e,...n]=o.split(`
`),[s,i]=e.split(":"),r=n.map(c=>{const d=[...c.matchAll(regex)][0],[,u,f,h]=d;return V(V({name:stripPath(u)},h?{location:stripPath(h)}:{}),f?{alias:f.trim().replace("as ","")}:{})});return{title:i,type:s,lines:r}},StackTrace_svelte_svelte_type_style_lang="";function get_each_context$b(o,e,n){const s=o.slice();return s[1]=e[n],s}function create_if_block$d(o){let e,n,s,i=o[0].type+"",r,c,d,u=o[0].title+"",f,h,m,_,v=o[0].lines,g=[];for(let y=0;y<v.length;y+=1)g[y]=create_each_block$b(get_each_context$b(o,v,y));return{c(){e=element("div"),n=element("p"),s=element("b"),r=text(i),c=text(":"),d=space(),f=text(u),h=space(),m=element("pre"),_=element("code");for(let y=0;y<g.length;y+=1)g[y].c();attr(m,"class","svelte-1e5rtbs"),attr(e,"class","wrapper svelte-1e5rtbs")},m(y,b){insert(y,e,b),append(e,n),append(n,s),append(s,r),append(s,c),append(n,d),append(n,f),append(e,h),append(e,m),append(m,_);for(let w=0;w<g.length;w+=1)g[w].m(_,null)},p(y,b){if(b&1&&i!==(i=y[0].type+"")&&set_data(r,i),b&1&&u!==(u=y[0].title+"")&&set_data(f,u),b&1){v=y[0].lines;let w;for(w=0;w<v.length;w+=1){const S=get_each_context$b(y,v,w);g[w]?g[w].p(S,b):(g[w]=create_each_block$b(S),g[w].c(),g[w].m(_,null))}for(;w<g.length;w+=1)g[w].d(1);g.length=v.length}},d(y){y&&detach(e),destroy_each(g,y)}}}function create_if_block_2$5(o){let e,n,s,i=o[1].alias+"",r;return{c(){e=text("as "),n=element("strong"),s=text("$"),r=text(i)},m(c,d){insert(c,e,d),insert(c,n,d),append(n,s),append(n,r)},p(c,d){d&1&&i!==(i=c[1].alias+"")&&set_data(r,i)},d(c){c&&detach(e),c&&detach(n)}}}function create_if_block_1$7(o){let e,n,s=o[1].location+"",i,r;return{c(){e=text("\xA0("),n=element("i"),i=text(s),r=text(")")},m(c,d){insert(c,e,d),insert(c,n,d),append(n,i),insert(c,r,d)},p(c,d){d&1&&s!==(s=c[1].location+"")&&set_data(i,s)},d(c){c&&detach(e),c&&detach(n),c&&detach(r)}}}function create_each_block$b(o){let e,n,s=o[1].name+"",i,r,c,d=o[1].alias&&create_if_block_2$5(o),u=o[1].location&&create_if_block_1$7(o);return{c(){e=text("at "),n=element("strong"),i=text(s),d&&d.c(),r=empty(),u&&u.c(),c=element("br")},m(f,h){insert(f,e,h),insert(f,n,h),append(n,i),d&&d.m(f,h),insert(f,r,h),u&&u.m(f,h),insert(f,c,h)},p(f,h){h&1&&s!==(s=f[1].name+"")&&set_data(i,s),f[1].alias?d?d.p(f,h):(d=create_if_block_2$5(f),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null),f[1].location?u?u.p(f,h):(u=create_if_block_1$7(f),u.c(),u.m(c.parentNode,c)):u&&(u.d(1),u=null)},d(f){f&&detach(e),f&&detach(n),d&&d.d(f),f&&detach(r),u&&u.d(f),f&&detach(c)}}}function create_fragment$q(o){let e,n=o[0]&&create_if_block$d(o);return{c(){n&&n.c(),e=empty()},m(s,i){n&&n.m(s,i),insert(s,e,i)},p(s,[i]){s[0]?n?n.p(s,i):(n=create_if_block$d(s),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:noop,o:noop,d(s){n&&n.d(s),s&&detach(e)}}}function instance$n(o,e,n){let{stacktrace:s}=e;return o.$$set=i=>{"stacktrace"in i&&n(0,s=i.stacktrace)},[s]}class StackTrace extends SvelteComponent{constructor(e){super();init(this,e,instance$n,create_fragment$q,safe_not_equal,{stacktrace:0})}}var Toast_svelte_svelte_type_style_lang="";function get_each_context$a(o,e,n){const s=o.slice();return s[13]=e[n],s}function create_if_block$c(o){let e,n,s,i,r,c,d,u,f,h,m,_,v,g,y,b,w,S,k,$,P,x,j=o[6]&&create_if_block_9(o),N=o[0].title&&create_if_block_8(o);const A=[create_if_block_4$1,create_if_block_5,create_if_block_7],O=[];function R(E,B){return typeof E[0].content=="string"?0:E[0].content instanceof Error?1:E[0].content instanceof SvelteComponentDev?2:-1}~(d=R(o))&&(u=O[d]=A[d](o));let I=o[0].content instanceof Error&&create_if_block_3$1(o),D=o[0].values&&create_if_block_1$6(o);return g=new Icon({props:{name:"cross"}}),{c(){e=element("div"),n=element("div"),s=element("div"),j&&j.c(),i=space(),r=element("div"),N&&N.c(),c=space(),u&&u.c(),f=space(),h=element("div"),I&&I.c(),m=space(),D&&D.c(),_=space(),v=element("div"),y=element("div"),create_component(g.$$.fragment),b=space(),w=element("div"),attr(h,"class","button-wrapper svelte-bnz79m"),attr(r,"class","toast-text svelte-bnz79m"),set_style(y,"display","contents"),set_style(y,"--height","fit-content"),attr(v,"class","toast-close svelte-bnz79m"),attr(s,"class","toast-content svelte-bnz79m"),toggle_class(s,"hasIcon",!!o[6]),attr(w,"style",S=`transition: width ${o[0].timeout}ms linear;`),attr(w,"class","toast-progress svelte-bnz79m"),toggle_class(w,"animateProgress",o[2]),attr(n,"class",k="toast toast-"+o[0].type+" svelte-bnz79m"),toggle_class(n,"isInverted",o[5]),attr(e,"class","wrapper svelte-bnz79m")},m(E,B){insert(E,e,B),append(e,n),append(n,s),j&&j.m(s,null),append(s,i),append(s,r),N&&N.m(r,null),append(r,c),~d&&O[d].m(r,null),append(r,f),append(r,h),I&&I.m(h,null),append(h,m),D&&D.m(h,null),append(s,_),append(s,v),append(v,y),mount_component(g,y,null),append(n,b),append(n,w),o[11](e),$=!0,P||(x=listen(v,"click",o[10]),P=!0)},p(E,B){E[6]?j?(j.p(E,B),B&64&&transition_in(j,1)):(j=create_if_block_9(E),j.c(),transition_in(j,1),j.m(s,i)):j&&(group_outros(),transition_out(j,1,1,()=>{j=null}),check_outros()),E[0].title?N?N.p(E,B):(N=create_if_block_8(E),N.c(),N.m(r,c)):N&&(N.d(1),N=null);let q=d;d=R(E),d===q?~d&&O[d].p(E,B):(u&&(group_outros(),transition_out(O[q],1,1,()=>{O[q]=null}),check_outros()),~d?(u=O[d],u?u.p(E,B):(u=O[d]=A[d](E),u.c()),transition_in(u,1),u.m(r,f)):u=null),E[0].content instanceof Error?I?(I.p(E,B),B&1&&transition_in(I,1)):(I=create_if_block_3$1(E),I.c(),transition_in(I,1),I.m(h,m)):I&&(group_outros(),transition_out(I,1,1,()=>{I=null}),check_outros()),E[0].values?D?(D.p(E,B),B&1&&transition_in(D,1)):(D=create_if_block_1$6(E),D.c(),transition_in(D,1),D.m(h,null)):D&&(group_outros(),transition_out(D,1,1,()=>{D=null}),check_outros()),B&64&&toggle_class(s,"hasIcon",!!E[6]),(!$||B&1&&S!==(S=`transition: width ${E[0].timeout}ms linear;`))&&attr(w,"style",S),B&4&&toggle_class(w,"animateProgress",E[2]),(!$||B&1&&k!==(k="toast toast-"+E[0].type+" svelte-bnz79m"))&&attr(n,"class",k),B&33&&toggle_class(n,"isInverted",E[5])},i(E){$||(transition_in(j),transition_in(u),transition_in(I),transition_in(D),transition_in(g.$$.fragment,E),$=!0)},o(E){transition_out(j),transition_out(u),transition_out(I),transition_out(D),transition_out(g.$$.fragment,E),$=!1},d(E){E&&detach(e),j&&j.d(),N&&N.d(),~d&&O[d].d(),I&&I.d(),D&&D.d(),destroy_component(g),o[11](null),P=!1,x()}}}function create_if_block_9(o){let e,n,s,i;return n=new Icon({props:{name:o[6],circle:!0}}),{c(){e=element("div"),s=element("div"),create_component(n.$$.fragment),set_style(s,"display","contents"),set_style(s,"--width","40px"),set_style(s,"--height","40px"),attr(e,"class","toast-icon svelte-bnz79m")},m(r,c){insert(r,e,c),append(e,s),mount_component(n,s,null),i=!0},p(r,c){const d={};c&64&&(d.name=r[6]),n.$set(d)},i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){r&&detach(e),destroy_component(n)}}}function create_if_block_8(o){let e,n=o[0].title+"",s;return{c(){e=element("h3"),s=text(n),attr(e,"class","svelte-bnz79m")},m(i,r){insert(i,e,r),append(e,s)},p(i,r){r&1&&n!==(n=i[0].title+"")&&set_data(s,n)},d(i){i&&detach(e)}}}function create_if_block_7(o){let e,n,s;var i=o[0].content;function r(c){return{}}return i&&(e=new i(r())),{c(){e&&create_component(e.$$.fragment),n=empty()},m(c,d){e&&mount_component(e,c,d),insert(c,n,d),s=!0},p(c,d){if(i!==(i=c[0].content)){if(e){group_outros();const u=e;transition_out(u.$$.fragment,1,0,()=>{destroy_component(u,1)}),check_outros()}i?(e=new i(r()),create_component(e.$$.fragment),transition_in(e.$$.fragment,1),mount_component(e,n.parentNode,n)):e=null}},i(c){s||(e&&transition_in(e.$$.fragment,c),s=!0)},o(c){e&&transition_out(e.$$.fragment,c),s=!1},d(c){c&&detach(n),e&&destroy_component(e,c)}}}function create_if_block_5(o){let e,n=o[0].content.message+"",s,i,r,c,d=o[3]&&create_if_block_6(o);return{c(){e=element("p"),s=text(n),i=space(),d&&d.c(),r=empty(),attr(e,"class","svelte-bnz79m")},m(u,f){insert(u,e,f),append(e,s),insert(u,i,f),d&&d.m(u,f),insert(u,r,f),c=!0},p(u,f){(!c||f&1)&&n!==(n=u[0].content.message+"")&&set_data(s,n),u[3]?d?(d.p(u,f),f&8&&transition_in(d,1)):(d=create_if_block_6(u),d.c(),transition_in(d,1),d.m(r.parentNode,r)):d&&(group_outros(),transition_out(d,1,1,()=>{d=null}),check_outros())},i(u){c||(transition_in(d),c=!0)},o(u){transition_out(d),c=!1},d(u){u&&detach(e),u&&detach(i),d&&d.d(u),u&&detach(r)}}}function create_if_block_4$1(o){let e,n=o[0].content+"";return{c(){e=element("p"),attr(e,"class","svelte-bnz79m")},m(s,i){insert(s,e,i),e.innerHTML=n},p(s,i){i&1&&n!==(n=s[0].content+"")&&(e.innerHTML=n)},i:noop,o:noop,d(s){s&&detach(e)}}}function create_if_block_6(o){let e,n,s,i;return n=new StackTrace({props:{stacktrace:parseStackTrace(o[0].content.stack)}}),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"class","stack-trace svelte-bnz79m")},m(r,c){insert(r,e,c),mount_component(n,e,null),i=!0},p(r,c){const d={};c&1&&(d.stacktrace=parseStackTrace(r[0].content.stack)),n.$set(d)},i(r){i||(transition_in(n.$$.fragment,r),add_render_callback(()=>{s||(s=create_bidirectional_transition(e,slide,{},!0)),s.run(1)}),i=!0)},o(r){transition_out(n.$$.fragment,r),s||(s=create_bidirectional_transition(e,slide,{},!1)),s.run(0),i=!1},d(r){r&&detach(e),destroy_component(n),r&&s&&s.end()}}}function create_if_block_3$1(o){let e,n,s,i;return e=new Button({props:{name:"> StackTrace"}}),e.$on("click",o[7]),{c(){n=element("div"),create_component(e.$$.fragment),set_style(n,"display","contents"),set_style(n,"--margin","5px 10px 5px -10px"),set_style(n,"--text",s=o[5]?"#1a1a1a":"white"),set_style(n,"--bg","transparent")},m(r,c){insert(r,n,c),mount_component(e,n,null),i=!0},p(r,c){c&32&&s!==(s=r[5]?"#1a1a1a":"white")&&set_style(n,"--text",s)},i(r){i||(transition_in(e.$$.fragment,r),i=!0)},o(r){transition_out(e.$$.fragment,r),i=!1},d(r){r&&detach(n),destroy_component(e,r)}}}function create_if_block_1$6(o){let e,n,s=o[0].values,i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$a(get_each_context$a(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){for(let c=0;c<i.length;c+=1)i[c].c();e=empty()},m(c,d){for(let u=0;u<i.length;u+=1)i[u].m(c,d);insert(c,e,d),n=!0},p(c,d){if(d&49){s=c[0].values;let u;for(u=0;u<s.length;u+=1){const f=get_each_context$a(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$a(f),i[u].c(),transition_in(i[u],1),i[u].m(e.parentNode,e))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){destroy_each(i,c),c&&detach(e)}}}function create_else_block$5(o){let e,n,s,i,r;function c(){return o[9](o[13])}return e=new Button({props:{name:o[13]}}),e.$on("click",c),{c(){n=element("div"),create_component(e.$$.fragment),set_style(n,"display","contents"),set_style(n,"--margin","5px 10px 5px 0"),set_style(n,"--text",s=o[5]?"white":"#1a1a1a"),set_style(n,"--bg",i=o[5]?"#1a1a1a":"white")},m(d,u){insert(d,n,u),mount_component(e,n,null),r=!0},p(d,u){o=d,u&32&&s!==(s=o[5]?"white":"#1a1a1a")&&set_style(n,"--text",s),u&32&&i!==(i=o[5]?"#1a1a1a":"white")&&set_style(n,"--bg",i);const f={};u&1&&(f.name=o[13]),e.$set(f)},i(d){r||(transition_in(e.$$.fragment,d),r=!0)},o(d){transition_out(e.$$.fragment,d),r=!1},d(d){d&&detach(n),destroy_component(e,d)}}}function create_if_block_2$4(o){let e,n,s,i;function r(){return o[8](o[13])}return{c(){e=element("plant-button"),set_custom_element_data(e,"name",n=o[13])},m(c,d){insert(c,e,d),s||(i=listen(e,"click",r),s=!0)},p(c,d){o=c,d&1&&n!==(n=o[13])&&set_custom_element_data(e,"name",n)},i:noop,o:noop,d(c){c&&detach(e),s=!1,i()}}}function create_each_block$a(o){let e,n,s,i,r;const c=[create_if_block_2$4,create_else_block$5],d=[];function u(f,h){return f[4]?0:1}return n=u(o),s=d[n]=c[n](o),{c(){e=element("div"),s.c(),i=space(),attr(e,"class","button-spacer svelte-bnz79m")},m(f,h){insert(f,e,h),d[n].m(e,null),append(e,i),r=!0},p(f,h){let m=n;n=u(f),n===m?d[n].p(f,h):(group_outros(),transition_out(d[m],1,1,()=>{d[m]=null}),check_outros(),s=d[n],s?s.p(f,h):(s=d[n]=c[n](f),s.c()),transition_in(s,1),s.m(e,i))},i(f){r||(transition_in(s),r=!0)},o(f){transition_out(s),r=!1},d(f){f&&detach(e),d[n].d()}}}function create_fragment$p(o){let e,n,s=o[0]&&create_if_block$c(o);return{c(){s&&s.c(),e=empty()},m(i,r){s&&s.m(i,r),insert(i,e,r),n=!0},p(i,[r]){i[0]?s?(s.p(i,r),r&1&&transition_in(s,1)):(s=create_if_block$c(i),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,()=>{s=null}),check_outros())},i(i){n||(transition_in(s),n=!0)},o(i){transition_out(s),n=!1},d(i){s&&s.d(i),i&&detach(e)}}}function instance$m(o,e,n){let s,i,{toast:r}=e,c=!1,d=!1;function u(){if(r.type===MessageType$1.ERROR)return"warning";if(r.type===MessageType$1.SUCCESS)return"checkmark";if(r.type===MessageType$1.WARNING)return"exclamation"}let f=!1,h;onMount(()=>{setTimeout(()=>{n(2,c=!0)},10)});const m=()=>{n(3,d=!d)},_=b=>r.resolve(b),v=b=>r.resolve(b),g=()=>r.reject();function y(b){binding_callbacks[b?"unshift":"push"](()=>{h=b,n(1,h)})}return o.$$set=b=>{"toast"in b&&n(0,r=b.toast)},o.$$.update=()=>{o.$$.dirty&1&&n(6,s=r&&u()),o.$$.dirty&1&&n(5,i=r&&(r.type==="success"||r.type==="warning")),o.$$.dirty&2&&n(4,f=h&&!h.parentElement)},[r,h,c,d,f,i,s,m,_,v,g,y]}class Toast extends SvelteComponent{constructor(e){super();init(this,e,instance$m,create_fragment$p,safe_not_equal,{toast:0})}}var ToastWrapper_svelte_svelte_type_style_lang="";function get_each_context$9(o,e,n){const s=o.slice();return s[4]=e[n],s}function create_else_block$4(o){let e,n;return e=new Toast({props:{toast:o[4]}}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&4&&(r.toast=s[4]),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_if_block$b(o){let e,n;return{c(){e=element("plant-toast"),set_custom_element_data(e,"toast",n=o[4])},m(s,i){insert(s,e,i)},p(s,i){i&4&&n!==(n=s[4])&&set_custom_element_data(e,"toast",n)},i:noop,o:noop,d(s){s&&detach(e)}}}function create_each_block$9(o,e){let n,s,i,r,c,d;const u=[create_if_block$b,create_else_block$4],f=[];function h(m,_){return m[0]?0:1}return s=h(e),i=f[s]=u[s](e),{key:o,first:null,c(){n=element("div"),i.c(),r=space(),this.first=n},m(m,_){insert(m,n,_),f[s].m(n,null),append(n,r),d=!0},p(m,_){e=m;let v=s;s=h(e),s===v?f[s].p(e,_):(group_outros(),transition_out(f[v],1,1,()=>{f[v]=null}),check_outros(),i=f[s],i?i.p(e,_):(i=f[s]=u[s](e),i.c()),transition_in(i,1),i.m(n,r))},i(m){d||(transition_in(i),add_render_callback(()=>{c||(c=create_bidirectional_transition(n,slide,{easing:backInOut},!0)),c.run(1)}),d=!0)},o(m){transition_out(i),c||(c=create_bidirectional_transition(n,slide,{easing:backInOut},!1)),c.run(0),d=!1},d(m){m&&detach(n),f[s].d(),m&&c&&c.end()}}}function create_fragment$o(o){let e,n=[],s=new Map,i,r=o[2];const c=d=>d[4].id;for(let d=0;d<r.length;d+=1){let u=get_each_context$9(o,r,d),f=c(u);s.set(f,n[d]=create_each_block$9(f,u))}return{c(){e=element("div");for(let d=0;d<n.length;d+=1)n[d].c();attr(e,"id","toast-wrapper"),attr(e,"class","svelte-1ujlok7")},m(d,u){insert(d,e,u);for(let f=0;f<n.length;f+=1)n[f].m(e,null);o[3](e),i=!0},p(d,[u]){u&5&&(r=d[2],group_outros(),n=update_keyed_each(n,u,c,1,d,r,s,e,outro_and_destroy_block,create_each_block$9,null,get_each_context$9),check_outros())},i(d){if(!i){for(let u=0;u<r.length;u+=1)transition_in(n[u]);i=!0}},o(d){for(let u=0;u<n.length;u+=1)transition_out(n[u]);i=!1},d(d){d&&detach(e);for(let u=0;u<n.length;u+=1)n[u].d();o[3](null)}}}function instance$l(o,e,n){let s;component_subscribe(o,store$2,d=>n(2,s=d));let i=!1,r;onMount(function(){n(0,i=!r.parentElement)});function c(d){binding_callbacks[d?"unshift":"push"](()=>{r=d,n(1,r)})}return[i,r,s,c]}class ToastWrapper extends SvelteComponent{constructor(e){super();init(this,e,instance$l,create_fragment$o,safe_not_equal,{})}}var InputCheckbox_svelte_svelte_type_style_lang="";function create_fragment$n(o){let e,n,s,i,r,c,d,u,f,h,m;return{c(){e=element("div"),n=element("input"),s=space(),i=element("label"),r=svg_element("svg"),c=svg_element("title"),d=text("cross"),u=svg_element("line"),f=svg_element("line"),attr(n,"type","checkbox"),attr(n,"id",o[1]),attr(n,"class","svelte-ohv39p"),attr(c,"class","svelte-ohv39p"),attr(u,"vector-effect","non-scaling-stroke"),attr(u,"x1","0"),attr(u,"y1","100"),attr(u,"x2","100"),attr(u,"y2","0"),attr(u,"class","svelte-ohv39p"),attr(f,"vector-effect","non-scaling-stroke"),attr(f,"x1","0"),attr(f,"y1","0"),attr(f,"x2","100"),attr(f,"y2","100"),attr(f,"class","svelte-ohv39p"),attr(r,"xmlns","http://www.w3.org/2000/svg"),attr(r,"viewBox","0 0 100 100"),attr(r,"class","svelte-ohv39p"),attr(i,"class","checkbox-label svelte-ohv39p"),attr(i,"for",o[1]),attr(e,"class","component-wrapper svelte-ohv39p")},m(_,v){insert(_,e,v),append(e,n),n.checked=o[0],append(e,s),append(e,i),append(i,r),append(r,c),append(c,d),append(r,u),append(r,f),h||(m=listen(n,"change",o[2]),h=!0)},p(_,[v]){v&2&&attr(n,"id",_[1]),v&1&&(n.checked=_[0]),v&2&&attr(i,"for",_[1])},i:noop,o:noop,d(_){_&&detach(e),h=!1,m()}}}function instance$k(o,e,n){const s=createEventDispatcher();let{value:i=!1}=e,{id:r=shortid()}=e;function c(){i=this.checked,n(0,i)}return o.$$set=d=>{"value"in d&&n(0,i=d.value),"id"in d&&n(1,r=d.id)},o.$$.update=()=>{o.$$.dirty&1&&i!==void 0&&s("change",!!i)},[i,r,c]}class InputCheckbox extends SvelteComponent{constructor(e){super();init(this,e,instance$k,create_fragment$n,safe_not_equal,{value:0,id:1})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),flush()}get id(){return this.$$.ctx[1]}set id(e){this.$$set({id:e}),flush()}}var InputColor_svelte_svelte_type_style_lang="",InputCurve_svelte_svelte_type_style_lang="";function get_each_context$8(o,e,n){const s=o.slice();return s[19]=e[n],s[21]=n,s}function get_each_context_1(o,e,n){const s=o.slice();return s[19]=e[n],s}function create_each_block_1(o){let e,n,s,i,r;function c(){return o[10](o[19])}return{c(){e=svg_element("circle"),attr(e,"cx",n=o[19].x*100),attr(e,"cy",s=o[19].y*100),attr(e,"r","2"),attr(e,"class","svelte-tsaxx5"),toggle_class(e,"pinned",o[19].pinned)},m(d,u){insert(d,e,u),i||(r=listen(e,"mousedown",c),i=!0)},p(d,u){o=d,u&1&&n!==(n=o[19].x*100)&&attr(e,"cx",n),u&1&&s!==(s=o[19].y*100)&&attr(e,"cy",s),u&1&&toggle_class(e,"pinned",o[19].pinned)},d(d){d&&detach(e),i=!1,r()}}}function create_if_block$a(o){let e,n,s,i,r;return{c(){e=svg_element("line"),attr(e,"x1",n=o[3][o[21]-1].x*100),attr(e,"y1",s=o[3][o[21]-1].y*100),attr(e,"x2",i=o[19].x*100),attr(e,"y2",r=o[19].y*100),attr(e,"class","svelte-tsaxx5")},m(c,d){insert(c,e,d)},p:noop,d(c){c&&detach(e)}}}function create_each_block$8(o){let e,n,s,i=o[21]>0&&o[21]%2==0&&create_if_block$a(o);return{c(){i&&i.c(),e=svg_element("circle"),attr(e,"cx",n=o[19].x*100),attr(e,"cy",s=o[19].y*100),attr(e,"r","1"),attr(e,"class","svelte-tsaxx5"),toggle_class(e,"pinned",o[19].pinned)},m(r,c){i&&i.m(r,c),insert(r,e,c)},p(r,c){r[21]>0&&r[21]%2==0&&i.p(r,c)},d(r){i&&i.d(r),r&&detach(e)}}}function create_fragment$m(o){let e,n,s,i,r,c,d=o[0],u=[];for(let m=0;m<d.length;m+=1)u[m]=create_each_block_1(get_each_context_1(o,d,m));let f=o[3],h=[];for(let m=0;m<f.length;m+=1)h[m]=create_each_block$8(get_each_context$8(o,f,m));return{c(){e=element("div"),n=svg_element("svg"),s=svg_element("path");for(let m=0;m<u.length;m+=1)u[m].c();i=svg_element("g");for(let m=0;m<h.length;m+=1)h[m].c();attr(s,"d",o[2]),attr(s,"fill","none"),attr(s,"stroke","grey"),attr(s,"class","svelte-tsaxx5"),attr(i,"id","debug"),attr(i,"class","svelte-tsaxx5"),attr(n,"viewBox","0 0 100 100"),attr(n,"width","100"),attr(n,"height","100"),attr(n,"class","svelte-tsaxx5"),attr(e,"class","component-wrapper svelte-tsaxx5")},m(m,_){insert(m,e,_),append(e,n),append(n,s);for(let v=0;v<u.length;v+=1)u[v].m(n,null);append(n,i);for(let v=0;v<h.length;v+=1)h[v].m(i,null);r||(c=[listen(n,"mousedown",o[5]),listen(n,"mousemove",o[4]),listen(n,"mouseover",o[7]),listen(n,"mouseout",o[8]),listen(n,"mouseup",o[6]),listen(n,"focus",o[7]),listen(n,"blur",o[8])],r=!0)},p(m,[_]){if(_&4&&attr(s,"d",m[2]),_&3){d=m[0];let v;for(v=0;v<d.length;v+=1){const g=get_each_context_1(m,d,v);u[v]?u[v].p(g,_):(u[v]=create_each_block_1(g),u[v].c(),u[v].m(n,i))}for(;v<u.length;v+=1)u[v].d(1);u.length=d.length}if(_&8){f=m[3];let v;for(v=0;v<f.length;v+=1){const g=get_each_context$8(m,f,v);h[v]?h[v].p(g,_):(h[v]=create_each_block$8(g),h[v].c(),h[v].m(i,null))}for(;v<h.length;v+=1)h[v].d(1);h.length=f.length}},i:noop,o:noop,d(m){m&&detach(e),destroy_each(u,m),destroy_each(h,m),r=!1,run_all(c)}}}function instance$j(o,e,n){let s,i;const r=createEventDispatcher();let{value:c=[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}=e,d=!1,u,f,h=0,m=0,_=[];const v=()=>{requestAnimationFrame(()=>{r("change",s),n(0,s=s.sort((x,j)=>x.x>j.x?-1:1))})},g=x=>{x.pinned||(s.splice(s.indexOf(u),1),v())},y=x=>{d&&(h=x.offsetX,m=x.offsetY,u&&(f=u,n(1,u=void 0)),f&&(f.x=h/100,f.y=m/100,v()))},b=()=>{if(!u){const x={x:h/100,y:m/100,pinned:!1};n(1,u=x),s.push(u),v()}},w=()=>{u&&(g(u),n(1,u=void 0)),f=void 0},S=()=>{d=!0},k=()=>{d=!1};function $(x){const j=monotoneCubicSpline.points(x.map(N=>[N.x*100,N.y*100]));return monotoneCubicSpline.svgPath(j)}const P=x=>{n(1,u=x)};return o.$$set=x=>{"value"in x&&n(9,c=x.value)},o.$$.update=()=>{o.$$.dirty&512&&n(0,s=c),o.$$.dirty&1&&n(2,i=$(s))},[s,u,i,_,y,b,w,S,k,c,P]}class InputCurve extends SvelteComponent{constructor(e){super();init(this,e,instance$j,create_fragment$m,safe_not_equal,{value:9})}get value(){return this.$$.ctx[9]}set value(e){this.$$set({value:e}),flush()}}var InputInteger_svelte_svelte_type_style_lang="";function create_if_block$9(o){let e,n;return{c(){e=element("span"),attr(e,"class","overlay svelte-3lnuwn"),attr(e,"style",n=`width: ${(o[0]-o[1])/(o[2]-o[1])*100}%`)},m(s,i){insert(s,e,i)},p(s,i){i&7&&n!==(n=`width: ${(s[0]-s[1])/(s[2]-s[1])*100}%`)&&attr(e,"style",n)},d(s){s&&detach(e)}}}function create_fragment$l(o){let e,n,s,i,r,c,d,u,f,h,m=typeof o[1]!="undefined"&&typeof o[2]!="undefined"&&create_if_block$9(o);return{c(){e=element("div"),m&&m.c(),n=space(),s=element("button"),s.textContent="-",i=space(),r=element("input"),d=space(),u=element("button"),u.textContent="+",attr(s,"class","svelte-3lnuwn"),attr(r,"step",o[3]),attr(r,"max",o[2]),attr(r,"min",o[1]),attr(r,"type","number"),attr(r,"style",c=`width:${o[5]};`),attr(r,"class","svelte-3lnuwn"),attr(u,"class","svelte-3lnuwn"),attr(e,"class","component-wrapper svelte-3lnuwn")},m(_,v){insert(_,e,v),m&&m.m(e,null),append(e,n),append(e,s),append(e,i),append(e,r),set_input_value(r,o[0]),o[11](r),append(e,d),append(e,u),f||(h=[listen(s,"click",o[9]),listen(r,"input",o[10]),listen(r,"mousedown",o[7]),listen(r,"mouseup",o[8]),listen(u,"click",o[12])],f=!0)},p(_,[v]){typeof _[1]!="undefined"&&typeof _[2]!="undefined"?m?m.p(_,v):(m=create_if_block$9(_),m.c(),m.m(e,n)):m&&(m.d(1),m=null),v&8&&attr(r,"step",_[3]),v&4&&attr(r,"max",_[2]),v&2&&attr(r,"min",_[1]),v&32&&c!==(c=`width:${_[5]};`)&&attr(r,"style",c),v&1&&to_number(r.value)!==_[0]&&set_input_value(r,_[0])},i:noop,o:noop,d(_){_&&detach(e),m&&m.d(),o[11](null),f=!1,run_all(h)}}}function instance$i(o,e,n){let s,i;const r=createEventDispatcher();let{min:c=-1/0}=e,{max:d=1/0}=e,{step:u=1}=e,{value:f=0}=e,h;function m(x){n(0,f=Math.max(c,Math.min(+f+x,d)))}let _=0,v=0,g;function y(x){x.preventDefault(),v=f,_=x.clientX,g=h.getBoundingClientRect(),window.removeEventListener("mousemove",w),window.addEventListener("mousemove",w),window.addEventListener("mouseup",b),document.body.style.cursor="ew-resize"}function b(){v===f?h.focus():h.blur(),document.body.style.cursor="unset",window.removeEventListener("mouseup",b),window.removeEventListener("mousemove",w)}function w(x){if(s){const j=(x.clientX-g.left)/g.width;n(0,f=Math.max(Math.min(Math.floor(c+(d-c)*j),d),c))}else{const j=x.clientX-_;n(0,f=v+Math.floor(j/10))}}const S=()=>m(-u);function k(){f=to_number(this.value),n(0,f)}function $(x){binding_callbacks[x?"unshift":"push"](()=>{h=x,n(4,h)})}const P=()=>m(+u);return o.$$set=x=>{"min"in x&&n(1,c=x.min),"max"in x&&n(2,d=x.max),"step"in x&&n(3,u=x.step),"value"in x&&n(0,f=x.value)},o.$$.update=()=>{var x;o.$$.dirty&6&&(s=typeof c!="undefined"&&typeof d!="undefined"&&Number.isFinite(c)&&Number.isFinite(d)),o.$$.dirty&1&&f!==void 0&&r("change",parseFloat(f+"")),o.$$.dirty&1&&n(5,i=Number.isFinite(f)?Math.max(((x=f==null?void 0:f.toString().length)!=null?x:1)*8,30)+"px":"20px")},[f,c,d,u,h,i,m,y,b,S,k,$,P]}class InputInteger extends SvelteComponent{constructor(e){super();init(this,e,instance$i,create_fragment$l,safe_not_equal,{min:1,max:2,step:3,value:0})}get min(){return this.$$.ctx[1]}set min(e){this.$$set({min:e}),flush()}get max(){return this.$$.ctx[2]}set max(e){this.$$set({max:e}),flush()}get step(){return this.$$.ctx[3]}set step(e){this.$$set({step:e}),flush()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),flush()}}var InputFloat_svelte_svelte_type_style_lang="";function create_fragment$k(o){let e,n,s,i,r,c,d,u;return{c(){e=element("div"),n=element("span"),i=space(),r=element("input"),attr(n,"class","overlay svelte-2vvjq7"),attr(n,"style",s=`width: ${(o[0]-o[2])/(o[3]-o[2])*100}%`),attr(r,"step",o[1]),attr(r,"max",o[3]),attr(r,"min",o[2]),attr(r,"type","number"),attr(r,"style",c=`width:${o[6]};`),attr(r,"class","svelte-2vvjq7"),attr(e,"class","component-wrapper svelte-2vvjq7"),toggle_class(e,"is-down",o[5])},m(f,h){insert(f,e,h),append(e,n),append(e,i),append(e,r),set_input_value(r,o[0]),o[10](r),d||(u=[listen(r,"input",o[9]),listen(r,"mousedown",o[7]),listen(r,"mouseup",o[8])],d=!0)},p(f,[h]){h&13&&s!==(s=`width: ${(f[0]-f[2])/(f[3]-f[2])*100}%`)&&attr(n,"style",s),h&2&&attr(r,"step",f[1]),h&8&&attr(r,"max",f[3]),h&4&&attr(r,"min",f[2]),h&64&&c!==(c=`width:${f[6]};`)&&attr(r,"style",c),h&1&&to_number(r.value)!==f[0]&&set_input_value(r,f[0]),h&32&&toggle_class(e,"is-down",f[5])},i:noop,o:noop,d(f){f&&detach(e),o[10](null),d=!1,run_all(u)}}}function strip(o){return parseFloat(o).toPrecision(2)}function instance$h(o,e,n){let s,{value:i=.5}=e,{step:r=.01}=e,{min:c=0}=e,{max:d=1}=e;const u=createEventDispatcher();let f,h=!1,m=0,_=0,v=0,g;function y($){$.preventDefault(),n(5,h=!0),_=i,m=$.clientY,g=f.getBoundingClientRect(),window.removeEventListener("mousemove",w),window.addEventListener("mousemove",w),window.addEventListener("mouseup",b),document.body.style.cursor="ew-resize"}function b(){n(5,h=!1),_===i&&f.focus(),document.body.style.cursor="unset",window.removeEventListener("mouseup",b),window.removeEventListener("mousemove",w)}function w($){v=($.clientX-g.left)/g.width,$.clientY-m,n(0,i=Math.max(Math.min(c+(d-c)*v,d),c))}function S(){i=to_number(this.value),n(0,i)}function k($){binding_callbacks[$?"unshift":"push"](()=>{f=$,n(4,f)})}return o.$$set=$=>{"value"in $&&n(0,i=$.value),"step"in $&&n(1,r=$.step),"min"in $&&n(2,c=$.min),"max"in $&&n(3,d=$.max)},o.$$.update=()=>{var $;o.$$.dirty&1&&i.toString().length>5&&n(0,i=strip(i)),o.$$.dirty&1&&i!==void 0&&u("change",parseFloat(i+"")),o.$$.dirty&1&&n(6,s=Number.isFinite(i)?Math.max((($=i==null?void 0:i.toString().length)!=null?$:1)*8,50)+"px":"20px")},[i,r,c,d,f,h,s,y,b,S,k]}class InputFloat extends SvelteComponent{constructor(e){super();init(this,e,instance$h,create_fragment$k,safe_not_equal,{value:0,step:1,min:2,max:3})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),flush()}get step(){return this.$$.ctx[1]}set step(e){this.$$set({step:e}),flush()}get min(){return this.$$.ctx[2]}set min(e){this.$$set({min:e}),flush()}get max(){return this.$$.ctx[3]}set max(e){this.$$set({max:e}),flush()}}var InputSelect_svelte_svelte_type_style_lang="";function get_each_context$7(o,e,n){const s=o.slice();return s[11]=e[n],s}function create_else_block$3(o){let e,n,s;return{c(){e=element("div"),e.textContent="none",attr(e,"id","selected-value"),attr(e,"class","svelte-1ywe9t")},m(i,r){insert(i,e,r),n||(s=listen(e,"click",o[4]),n=!0)},p:noop,d(i){i&&detach(e),n=!1,s()}}}function create_if_block_1$5(o){let e,n,s,i;return{c(){e=element("div"),n=text(o[0]),attr(e,"id","selected-value"),attr(e,"class","svelte-1ywe9t")},m(r,c){insert(r,e,c),append(e,n),s||(i=listen(e,"click",o[4]),s=!0)},p(r,c){c&1&&set_data(n,r[0])},d(r){r&&detach(e),s=!1,i()}}}function create_if_block$8(o){let e,n=o[11]+"",s,i,r,c,d;function u(){return o[8](o[11])}return{c(){e=element("p"),s=text(n),i=space(),attr(e,"style",r=`opacity: ${o[11]===o[0]?.5:1}`),attr(e,"class","item svelte-1ywe9t")},m(f,h){insert(f,e,h),append(e,s),append(e,i),c||(d=listen(e,"click",u),c=!0)},p(f,h){o=f,h&2&&n!==(n=o[11]+"")&&set_data(s,n),h&3&&r!==(r=`opacity: ${o[11]===o[0]?.5:1}`)&&attr(e,"style",r)},d(f){f&&detach(e),c=!1,d()}}}function create_each_block$7(o){let e,n=o[11]!==o[0]&&create_if_block$8(o);return{c(){n&&n.c(),e=empty()},m(s,i){n&&n.m(s,i),insert(s,e,i)},p(s,i){s[11]!==s[0]?n?n.p(s,i):(n=create_if_block$8(s),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(s){n&&n.d(s),s&&detach(e)}}}function create_fragment$j(o){let e,n,s,i;function r(h,m){return h[0]!==void 0?create_if_block_1$5:create_else_block$3}let c=r(o),d=c(o),u=o[1],f=[];for(let h=0;h<u.length;h+=1)f[h]=create_each_block$7(get_each_context$7(o,u,h));return{c(){e=element("div"),n=element("div"),d.c(),s=space(),i=element("div");for(let h=0;h<f.length;h+=1)f[h].c();attr(i,"id","item-wrapper"),attr(i,"class","svelte-1ywe9t"),attr(n,"id","main"),attr(n,"class","svelte-1ywe9t"),attr(e,"class","component-wrapper svelte-1ywe9t"),toggle_class(e,"open",o[2])},m(h,m){insert(h,e,m),append(e,n),d.m(n,null),append(n,s),append(n,i);for(let _=0;_<f.length;_+=1)f[_].m(i,null);o[9](n)},p(h,[m]){if(c===(c=r(h))&&d?d.p(h,m):(d.d(1),d=c(h),d&&(d.c(),d.m(n,s))),m&35){u=h[1];let _;for(_=0;_<u.length;_+=1){const v=get_each_context$7(h,u,_);f[_]?f[_].p(v,m):(f[_]=create_each_block$7(v),f[_].c(),f[_].m(i,null))}for(;_<f.length;_+=1)f[_].d(1);f.length=u.length}m&4&&toggle_class(e,"open",h[2])},i:noop,o:noop,d(h){h&&detach(e),d.d(),destroy_each(f,h),o[9](null)}}}function instance$g(o,e,n){const s=createEventDispatcher();let{value:i=void 0}=e,r=!1,c;function d(){n(2,r=!0),setTimeout(()=>{document.addEventListener("click",()=>{n(2,r=!1)},{once:!0})},50)}function u(g){n(0,i=g),n(2,r=!1)}let{values:f=[]}=e;function h(g){n(1,f=g)}function m(g){n(0,i=g)}const _=g=>u(g);function v(g){binding_callbacks[g?"unshift":"push"](()=>{c=g,n(3,c)})}return o.$$set=g=>{"value"in g&&n(0,i=g.value),"values"in g&&n(1,f=g.values)},o.$$.update=()=>{o.$$.dirty&1&&i&&s("change",i)},[i,f,r,c,d,u,h,m,_,v]}class InputSelect extends SvelteComponent{constructor(e){super();init(this,e,instance$g,create_fragment$j,safe_not_equal,{value:0,values:1,setItems:6,setValue:7})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),flush()}get values(){return this.$$.ctx[1]}set values(e){this.$$set({values:e}),flush()}get setItems(){return this.$$.ctx[6]}get setValue(){return this.$$.ctx[7]}}var InputShape_svelte_svelte_type_style_lang="";function get_each_context$6(o,e,n){const s=o.slice();return s[19]=e[n],s}function create_each_block$6(o){let e,n,s,i,r;function c(){return o[9](o[19])}return{c(){e=svg_element("circle"),attr(e,"cx",n=o[19].x*100),attr(e,"cy",s=o[19].y*200-50),attr(e,"r","4"),attr(e,"class","svelte-vrnf7c"),toggle_class(e,"pinned",o[19].pinned)},m(d,u){insert(d,e,u),i||(r=listen(e,"mousedown",c),i=!0)},p(d,u){o=d,u&1&&n!==(n=o[19].x*100)&&attr(e,"cx",n),u&1&&s!==(s=o[19].y*200-50)&&attr(e,"cy",s),u&1&&toggle_class(e,"pinned",o[19].pinned)},d(d){d&&detach(e),i=!1,r()}}}function create_fragment$i(o){let e,n,s,i,r,c,d,u,f,h,m,_,v=o[0],g=[];for(let y=0;y<v.length;y+=1)g[y]=create_each_block$6(get_each_context$6(o,v,y));return{c(){e=element("div"),n=svg_element("svg"),s=svg_element("path");for(let y=0;y<g.length;y+=1)g[y].c();i=space(),r=svg_element("svg"),c=svg_element("defs"),d=svg_element("linearGradient"),u=svg_element("stop"),f=svg_element("stop"),h=svg_element("path"),attr(s,"d",o[2]),attr(s,"fill","none"),attr(s,"stroke","#65E2A0"),attr(s,"class","svelte-vrnf7c"),attr(n,"viewBox","0 0 100 100"),attr(n,"width","50"),attr(n,"height","100"),attr(n,"class","svelte-vrnf7c"),attr(u,"offset","0%"),set_style(u,"stop-color","#65E2A0"),set_style(u,"stop-opacity","1"),attr(u,"class","svelte-vrnf7c"),attr(f,"offset","100%"),set_style(f,"stop-color","#469C6E"),set_style(f,"stop-opacity","1"),attr(f,"class","svelte-vrnf7c"),attr(d,"id","grad1"),attr(d,"x1","0%"),attr(d,"y1","0%"),attr(d,"x2","100%"),attr(d,"y2","0%"),attr(d,"class","svelte-vrnf7c"),attr(c,"class","svelte-vrnf7c"),attr(h,"d",o[2]),attr(h,"fill","url(#grad1)"),attr(h,"stroke","grey"),attr(h,"class","svelte-vrnf7c"),attr(r,"id","right"),attr(r,"viewBox","0 0 100 100"),attr(r,"width","50"),attr(r,"height","100"),attr(r,"class","svelte-vrnf7c"),attr(e,"class","component-wrapper svelte-vrnf7c")},m(y,b){insert(y,e,b),append(e,n),append(n,s);for(let w=0;w<g.length;w+=1)g[w].m(n,null);append(e,i),append(e,r),append(r,c),append(c,d),append(d,u),append(d,f),append(r,h),m||(_=[listen(n,"mousedown",o[4]),listen(n,"mousemove",o[3]),listen(n,"mouseover",o[6]),listen(n,"mouseout",o[7]),listen(n,"mouseup",o[5]),listen(n,"focus",o[6]),listen(n,"blur",o[7])],m=!0)},p(y,[b]){if(b&4&&attr(s,"d",y[2]),b&3){v=y[0];let w;for(w=0;w<v.length;w+=1){const S=get_each_context$6(y,v,w);g[w]?g[w].p(S,b):(g[w]=create_each_block$6(S),g[w].c(),g[w].m(n,null))}for(;w<g.length;w+=1)g[w].d(1);g.length=v.length}b&4&&attr(h,"d",y[2])},i:noop,o:noop,d(y){y&&detach(e),destroy_each(g,y),m=!1,run_all(_)}}}function instance$f(o,e,n){let s,i;const r=createEventDispatcher();let{value:c=[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}=e,d=!1,u,f,h=0,m=0;const _=()=>{requestAnimationFrame(()=>{r("change",s),n(0,s=s.sort((x,j)=>x.y>j.y?-1:1))})},v=x=>{x.pinned||(s.splice(s.indexOf(u),1),_())},g=x=>{d&&(h=x.offsetX,m=x.offsetY,u&&(f=u,n(1,u=void 0)),f&&(f.x=h/50,f.y=m/100,_()))},y=()=>{if(!u){const x={x:h/50,y:m/100,pinned:!1};n(1,u=x),s.push(u),_()}},b=()=>{u&&(v(u),n(1,u=void 0)),f=void 0},w=()=>{d=!0},S=()=>{d=!1},k=x=>`L ${x.x*100} ${x.y*200-50}`;function $(x){return x.reduce((j,N,A)=>A===0?`M ${N.x*100},${N.y*200-50}`:`${j} ${k(N)}`,"")}const P=x=>{n(1,u=x)};return o.$$set=x=>{"value"in x&&n(8,c=x.value)},o.$$.update=()=>{o.$$.dirty&256&&n(0,s=c),o.$$.dirty&1&&n(2,i=$(s))},[s,u,i,g,y,b,w,S,c,P]}class InputShape extends SvelteComponent{constructor(e){super();init(this,e,instance$f,create_fragment$i,safe_not_equal,{value:8})}get value(){return this.$$.ctx[8]}set value(e){this.$$set({value:e}),flush()}}var InputSlider_svelte_svelte_type_style_lang="",InputSearch_svelte_svelte_type_style_lang="";function get_each_context$5(o,e,n){const s=o.slice();return s[21]=e[n],s[23]=n,s}function create_if_block$7(o){let e,n=(o[21].title||o[21].value)+"",s,i,r,c;function d(){return o[14](o[21])}function u(){return o[15](o[21])}function f(){return o[16](o[21])}return{c(){e=element("div"),s=text(n),i=space(),attr(e,"class","search-container svelte-qp32fb"),toggle_class(e,"focused",o[21].value===o[3])},m(h,m){insert(h,e,m),append(e,s),append(e,i),r||(c=[listen(e,"focus",d),listen(e,"mouseover",u),listen(e,"click",f)],r=!0)},p(h,m){o=h,m&16&&n!==(n=(o[21].title||o[21].value)+"")&&set_data(s,n),m&24&&toggle_class(e,"focused",o[21].value===o[3])},d(h){h&&detach(e),r=!1,run_all(c)}}}function create_each_block$5(o){let e,n=o[23]<o[0]&&create_if_block$7(o);return{c(){n&&n.c(),e=empty()},m(s,i){n&&n.m(s,i),insert(s,e,i)},p(s,i){s[23]<s[0]?n?n.p(s,i):(n=create_if_block$7(s),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(s){n&&n.d(s),s&&detach(e)}}}function create_fragment$h(o){let e,n,s,i,r,c=o[4],d=[];for(let u=0;u<c.length;u+=1)d[u]=create_each_block$5(get_each_context$5(o,c,u));return{c(){e=element("div"),n=element("input"),s=space();for(let u=0;u<d.length;u+=1)d[u].c();attr(n,"type","text"),attr(n,"placeholder","Search"),attr(n,"class","svelte-qp32fb"),attr(e,"class","search-wrapper svelte-qp32fb")},m(u,f){insert(u,e,f),append(e,n),o[12](n),set_input_value(n,o[1]),append(e,s);for(let h=0;h<d.length;h+=1)d[h].m(e,null);i||(r=[listen(window,"keydown",o[6]),listen(n,"input",o[13])],i=!0)},p(u,[f]){if(f&2&&n.value!==u[1]&&set_input_value(n,u[1]),f&185){c=u[4];let h;for(h=0;h<c.length;h+=1){const m=get_each_context$5(u,c,h);d[h]?d[h].p(m,f):(d[h]=create_each_block$5(m),d[h].c(),d[h].m(e,null))}for(;h<d.length;h+=1)d[h].d(1);d.length=c.length}},i:noop,o:noop,d(u){u&&detach(e),o[12](null),destroy_each(d,u),i=!1,run_all(r)}}}function instance$e(o,e,n){let s,i;const r=createEventDispatcher(),c={};let{limitAmount:d=10}=e,{values:u=[]}=e,f,h="";function m(N,A){if(!(A==null?void 0:A.length))return N;const O=N.filter(I=>!!(I.value.includes(A)||I.title&&I.title.toLowerCase().includes(A)));return O.length?(O.find(I=>I.value===i)||n(3,i=O[0].value),O):[{value:"Nothing Found"}]}function _(){f.focus()}function v(){n(1,h="")}function g({value:N=i}={value:i}){c[N]=c[N]+1||1,r("input",N)}function y(N){if(!i.length){n(3,i=s[0].value);return}const A=s.slice(0,d).find(D=>D.value===i);if(!A)return;const O=s.indexOf(A),R=Math.min(s.length,d),I=((O+N)%R+R)%R;n(3,i=s[I].value)}function b({key:N}){N==="Enter"&&i.length&&g(),N==="ArrowDown"&&y(1),N==="ArrowUp"&&y(-1)}function w(N){n(3,i=N.value)}const S=N=>{n(8,u=N)};function k(N){binding_callbacks[N?"unshift":"push"](()=>{f=N,n(2,f)})}function $(){h=this.value,n(1,h)}const P=N=>w(N),x=N=>w(N),j=N=>g(N);return o.$$set=N=>{"limitAmount"in N&&n(0,d=N.limitAmount),"values"in N&&n(8,u=N.values)},o.$$.update=()=>{o.$$.dirty&258&&n(4,s=m(u,h.toLowerCase()))},n(3,i=""),[d,h,f,i,s,g,b,w,u,_,v,S,k,$,P,x,j]}class InputSearch extends SvelteComponent{constructor(e){super();init(this,e,instance$e,create_fragment$h,safe_not_equal,{limitAmount:0,values:8,focus:9,clear:10,setItems:11})}get focus(){return this.$$.ctx[9]}get clear(){return this.$$.ctx[10]}get setItems(){return this.$$.ctx[11]}}var Section_svelte_svelte_type_style_lang="";function create_if_block$6(o){let e,n,s;return{c(){e=element("div"),n=element("p"),s=text(o[1]),attr(n,"class","svelte-1aw08v2"),attr(e,"class","border svelte-1aw08v2")},m(i,r){insert(i,e,r),append(e,n),append(n,s)},p(i,r){r&2&&set_data(s,i[1])},d(i){i&&detach(e)}}}function create_fragment$g(o){let e,n,s,i,r,c,d,u,f,h,m=o[1]&&create_if_block$6(o);const _=o[4].default,v=create_slot(_,o,o[3],null);return{c(){e=element("div"),n=element("div"),s=svg_element("svg"),i=svg_element("path"),r=space(),m&&m.c(),c=space(),d=element("div"),v&&v.c(),attr(i,"d","M13.172 12l-4.95-4.95 1.414-1.414L16 12l-6.364 6.364-1.414-1.414z"),attr(i,"class","svelte-1aw08v2"),attr(s,"xmlns","http://www.w3.org/2000/svg"),attr(s,"viewBox","0 0 24 24"),attr(s,"width","24"),attr(s,"height","24"),attr(s,"class","svelte-1aw08v2"),attr(n,"class","header svelte-1aw08v2"),attr(d,"class","content svelte-1aw08v2"),attr(e,"class","wrapper svelte-1aw08v2"),toggle_class(e,"open",o[0])},m(g,y){insert(g,e,y),append(e,n),append(n,s),append(s,i),append(n,r),m&&m.m(n,null),append(e,c),append(e,d),v&&v.m(d,null),u=!0,f||(h=listen(n,"click",o[2]),f=!0)},p(g,[y]){g[1]?m?m.p(g,y):(m=create_if_block$6(g),m.c(),m.m(n,null)):m&&(m.d(1),m=null),v&&v.p&&(!u||y&8)&&update_slot_base(v,_,g,g[3],u?get_slot_changes(_,g[3],y,null):get_all_dirty_from_scope(g[3]),null),y&1&&toggle_class(e,"open",g[0])},i(g){u||(transition_in(v,g),u=!0)},o(g){transition_out(v,g),u=!1},d(g){g&&detach(e),m&&m.d(),v&&v.d(g),f=!1,h()}}}function instance$d(o,e,n){let{$$slots:s={},$$scope:i}=e;const r=createEventDispatcher();let{open:c=!1}=e,{name:d=""}=e;const u=()=>{n(0,c=!c),r("toggle",c)};return o.$$set=f=>{"open"in f&&n(0,c=f.open),"name"in f&&n(1,d=f.name),"$$scope"in f&&n(3,i=f.$$scope)},[c,d,u,i,s]}class Section extends SvelteComponent{constructor(e){super();init(this,e,instance$d,create_fragment$g,safe_not_equal,{open:0,name:1})}}function stateToElement({target:o,template:e,value:n}){n===void 0&&"value"in e&&(n=e.value);const s=stateToComponent(e,n),i=V({},e);return delete i.type,delete i.inputType,delete i.defaultValue,delete i.internal,i.value=n,new s({target:o,props:z(V({},i),{"--width":"100%"})})}function stateToComponent(o,e){return o.inputType==="select"||Array.isArray(o.values)?InputSelect:o.inputType==="curve"?InputCurve:o.inputType==="shape"?InputShape:o.type==="number"||typeof e=="number"?o.step&&o.step%1!=0?InputFloat:InputInteger:InputCheckbox}function applyTransformation(o,e=[0,0,0],n=[0,0,0],s=[1,1,1]){const i=new Float32Array(o.position.length),r=o.position.length,c=o.position;for(let d=0;d<r;d+=3){const u=c[d+0]*s[0],f=c[d+1]*s[1],h=c[d+2]*s[2],m=u,_=Math.cos(n[0])*f-Math.sin(n[0])*h,v=Math.sin(n[0])*f+Math.cos(n[0])*h,g=Math.cos(n[1])*m-Math.sin(n[1])*v,y=_,b=Math.sin(n[1])*m+Math.cos(n[1])*v;i[d+0]=g+e[0],i[d+1]=y+e[1],i[d+2]=b+e[2]}return{position:i,uv:o.uv,normal:o.normal,index:o.index}}function convertInstancedGeometry(o){const e=[],n={position:o.position,normal:o.position,uv:o.uv,index:o.index},s=o.offset,i=o.rotation,r=o.scale,c=o.offset.length;for(let d=0;d<c;d+=3)e.push(applyTransformation(n,[s[d+0],s[d+1],s[d+2]],[i[d+0],i[d+1],i[d+2]],[r[d+0],r[d+1],r[d+2]]));return e}function createCircle(o){const e=2*Math.PI/o;return new Array(o).fill(null).map((s,i)=>[Math.cos(e*i),Math.sin(e*i)])}function createIndeces(o,e){const n=new Uint16Array(o*(e-1)*6);for(let s=0;s<e;s++){const i=s*o*6,r=s*o;for(let c=0;c<o;c++){const d=i+c*6,u=r+c;n[d+0]=u,n[d+1]=u-o+1,n[d+2]=u+1,n[d+3]=u+1,n[d+4]=u+o,n[d+5]=u,c===o-1?(n[d+0]=u,n[d+1]=u-o+1,n[d+2]=u+1,n[d+3]=u+1,n[d+4]=u+o,n[d+5]=u):(n[d+0]=u,n[d+1]=u+1,n[d+2]=u+o+1,n[d+3]=u+o+1,n[d+4]=u+o,n[d+5]=u)}}return n}function extrudePath(o,e){const n=[],s=[],i=[],r={position:[],index:createIndeces(e,o.length)},c=createCircle(e),d=c.length,u=o.length;for(let f=0;f<u;f++){const h=[0,0,1];f===0?subtract(s,o[f],o[f+1]):f===u-1?subtract(s,o[f-1],o[f]):subtract(s,o[f-1],o[f+1]),normalize(s,s),cross$1(i,h,s);const m=Math.acos(dot(h,s));identity(n),rotate(n,n,m,i);for(let _=0;_<d;_++){const v=c[_],g=[v[0],v[1],0],y=o[f][3];mul(g,g,[y,y,1]),transformMat4(g,g,n),add$1(g,g,o[f]),r.position.push(g)}}return r}function lerp(o,e,n){return o*(1-n)+e*n}function interpolateArray(o,e=0){const n=(o.length-1)*e,s=Math.floor(n),i=Math.ceil(n);return lerp(o[i],o[s],i-n)}function interpolateSkeleton(o,e){const n=(o.length/4-1)*e,s=Math.floor(n),i=Math.ceil(n),r=i-n;return[lerp(o[i*4+0],o[s*4+0],r),lerp(o[i*4+1],o[s*4+1],r),lerp(o[i*4+2],o[s*4+2],r),lerp(o[i*4+3],o[s*4+3],r)]}function interpolateSkeletonVec(o,e){const n=(o.length/4-1)*e,s=Math.floor(n),i=Math.ceil(n);return[o[i*4+0]-o[s*4+0],o[i*4+1]-o[s*4+1],o[i*4+2]-o[s*4+2],o[i*4+3]+o[s*4+3]/2]}function join(...o){if(o.length===1)return o[0];const e=new Float32Array(o.reduce((h,m)=>h+m.position.length,0)),n=new Float32Array(o.reduce((h,m)=>h+m.normal.length,0)),s=new Float32Array(o.reduce((h,m)=>h+m.uv.length,0)),i=o.reduce((h,m)=>h+m.index.length,0),r=i>65536?new Uint32Array(i):new Uint16Array(i);let c=0,d=0,u=0,f=0;for(let h=0;h<o.length;h++){const m=o[h].normal,_=m.length;for(let k=0;k<_;k++)n[d+k]=m[k];d+=_;const v=o[h].uv,g=v.length;for(let k=0;k<g;k++)s[u+k]=v[k];u+=g;const y=o[h].index,b=y.length;for(let k=0;k<b;k++)r[k+f]=y[k]+c/3;f+=b;const w=o[h].position,S=w.length;for(let k=0;k<S;k++)e[c+k]=w[k];c+=S}return{position:e,normal:n,uv:s,index:r}}var length2D=(o,e)=>Math.sqrt(o*o+e*e),length3D=(o,e,n)=>Math.sqrt(o*o+e*e+n*n);let seed=0,noise2D=mod.makeNoise2D(seed),noise3D=mod.makeNoise3D(seed);var noise={n1d:o=>noise2D(o,0),n2d:(o,e)=>noise2D(o,e),n3d:(o,e,n)=>noise3D(o,e,n),get seed(){return seed},set seed(o){seed=o,noise2D=mod.makeNoise2D(seed),noise3D=mod.makeNoise3D(seed)}},normalize2D=([o,e])=>{const n=length2D(o,e);return n===0?[1,0]:[o/n,e/n]},normalize3D=(o,e,n)=>{const s=length3D(o,e,n);return[o/s,e/s,n/s]},rotate2D=(o,e,n)=>[o*Math.cos(n)-e*Math.sin(n),o*Math.sin(n)+e*Math.cos(n)];function rotate3D(o,e,n){const[s,i,r]=o,[c,d,u]=normalize3D(e[0],e[1],e[2]),f=Math.cos(n),h=Math.sin(n);return new Vec3((f+(1-f)*c*c)*s+((1-f)*c*d-u*h)*i+((1-f)*c*u+d*h)*r,((1-f)*c*d+u*h)*s+(f+(1-f)*d*d)*i+((1-f)*d*u-c*h)*r,((1-f)*c*u-d*h)*s+((1-f)*d*u+c*h)*i+(f+(1-f)*u*u)*r)}function transferToGeometry(o,e){return new Geometry(o,{position:{size:3,data:e.position},normal:{size:3,data:e.normal},uv:{size:2,data:e.uv},index:{data:e.index}})}const totalSize=100,slopeLength=2,groundHeight=1;function ground(o=1,e=12,n=12){const s=360*(Math.PI/180)/n,i=e*n+1,r=(e-1)*n*2+n,c=new Float32Array(i*3),d=new Float32Array(i*3),u=new Float32Array(i*2),f=new Uint16Array(r*3);c[0]=0,c[1]=1-groundHeight,c[2]=0,d[0]=0,d[1]=1,d[2]=0,u[0]=.5,u[1]=.5;const h=new Array(e-1).fill(null).map((_,v,g)=>o+v/(g.length-1)*slopeLength);h.push(totalSize);const m=h.map(_=>{const v=(Math.max(Math.min(_,o+slopeLength),o)-o)/slopeLength;return Math.sin((v+.5)*Math.PI)/2+.5-groundHeight});for(let _=0;_<e;_++){const v=h[_],g=m[_];for(let y=0;y<n;y++){const b=s*y,w=Math.cos(b)*v,S=g,k=Math.sin(b)*v,P=_*n+y+1;if(c[P*3+0]=w,c[P*3+1]=S,c[P*3+2]=k,d[P*3+0]=0,d[P*3+1]=1,d[P*3+2]=0,u[P*2+0]=w,u[P*2+1]=k,_===0){const x=(P-1)*3;f[x+0]=0,f[x+1]=(y+1)%n+1,f[x+2]=y+1}else if(y===n-1){const x=_*n*6+y*6-n*3;f[x+0]=P,f[x+1]=P+1-n-n,f[x+2]=P+1-n,f[x+3]=P,f[x+4]=P-n,f[x+5]=P+1-n*2}else{const x=_*n*6+y*6-n*3;f[x+0]=P,f[x+1]=P+1-n,f[x+2]=P+1,f[x+3]=P,f[x+4]=P-n,f[x+5]=P+1-n}}}return{position:c,normal:d,uv:u,index:f}}function leaf(o,{res:e=1,xCurvature:n=.5,yCurvature:s=.2}={}){const i=o.length,r=3+e*2,c=r*i,d=(r-1)*(i-1)*2,u=new Float32Array(c*3),f=new Float32Array(c*2),h=new Float32Array(c*2),m=new Uint16Array(d*3);return o.forEach((_,v)=>{const g=v*r;for(let y=0;y<r;y++){const b=2-y/(r-1)*2-1;u[g*3+y*3+0]=(_.x-1)*b*.5;const w=-(1-_.y)*(1-_.y)*.5,S=Math.sin(Math.abs(b)*Math.PI)*.01;if(u[g*3+y*3+1]=S*n+w*s,u[g*3+y*3+2]=_.y-1,h[g*2+y*2+0]=u[g*3+y*3+0]+1/2,h[g*2+y*2+1]=u[g*3+y*3+2],v<o.length-1){const k=v*(r-1);m[k*6+y*6+0]=g+y+0,m[k*6+y*6+1]=g+y+1,m[k*6+y*6+2]=g+y+r,m[k*6+y*6+3]=g+y+1,m[k*6+y*6+4]=g+y+r,m[k*6+y*6+5]=g+y+r+1}}}),{position:u,normal:f,index:m,uv:h}}function tube(o,e=8){const n=groupArray(o,4),s=extrudePath(n,e);return{position:Float32Array.from(s.position.map(r=>r.splice(0,3)).flat()),index:s.index,normal:new Float32Array,uv:new Float32Array}}const node$f={title:"Branches",type:"branches",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},length:{type:["number","parameter","curve"],min:0,max:3,step:.05,value:.8},thiccness:{type:"number",min:0,max:1,step:.01,value:.8},offsetSingle:{type:"number",min:0,max:1,step:.01,value:.5},lowestBranch:{type:"number",min:0,max:1,step:.01,value:.2},amount:{type:"number",min:0,max:64,value:10}},computeSkeleton(o,e){const{skeletons:n}=o.input.result,s=e.getSetting("stemResY"),i=n.map(r=>{const c=[],d=e.handleParameter(o.amount),u=e.handleParameter(o.lowestBranch);for(let f=0;f<d;f++){const h=f/d,m=e.handleParameter(o.length,h)*(1-h),_=e.handleParameter(o.thiccness,h),v=e.handleParameter(o.offsetSingle,h),g=f%2==0;let y=u+(1-u)*h;y-=1/d*v*(g?-1:1);const[b,,w]=interpolateSkeletonVec(r,y),S=normalize2D([b,w]),[k,$]=rotate2D(S[0],S[1],g?-Math.PI/2:Math.PI/2),[P,x,j,N]=interpolateSkeleton(r,y),A=Math.max(Math.floor(s*m*10),4),O=new Float32Array(A*4);for(let R=0;R<A*4;R++){const I=R/A;O[R*4+0]=P+k*I*m,O[R*4+1]=x,O[R*4+2]=j+$*I*m,O[R*4+3]=N*_*(1-I)}c.push(O)}return c}).flat();return{skeletons:i,allSkeletons:[...i,...n]}},computeGeometry(o,e,n){const s=n.getSetting("stemResX"),{geometry:i}=o.input.result,{skeletons:r}=e;return{geometry:join(i,...r.map(c=>tube(c,s)))}}},node$e={title:"Curve",type:"curve",outputs:["number"],parameters:{value:{type:"curve",inputType:"curve",internal:!0,label:!1,value:[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}},computeValue(o,e,n){const s=toArray(o.value).map(i=>i.y);return interpolateArray(s,1-n)}},node$d={title:"Gravity",type:"gravity",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,type:"select",values:["simple","verlet","test"]},strength:{type:"number",inputType:"slider",min:0,max:2,step:.05}},computeSkeleton(o,e){const{input:n,type:s,strength:i}=o,{skeletons:r}=n.result;return s==="simple"&&r.forEach(c=>{const d=c.length/4;for(let u=1;u<d;u++){const f=u/d,h=c[u*4+1],m=e.handleParameter(i,f);c[u*4+1]=h-h*f*f*f*m}return c}),s==="test"&&r.forEach(c=>{const d=c.length/4;for(let u=1;u<d;u++){const f=u/d,h=e.handleParameter(i,f),m=c[u*4+0],_=c[u*4+1],v=c[u*4+2],g=c[(u-1)*4+0],y=c[(u-1)*4+1],b=c[(u-1)*4+2],w=g-m,S=y-_,k=y-v,[$,P]=rotate2D(w,k,90);for(let x=u;x<d;x++){const j=c[x*4+0],N=c[x*4+1],A=c[x*4+2],O=j-g,R=N-y,I=A-b;let[D,E,B]=rotate3D([O,R,I],[$,S,P],h*f);const q=D+g,Q=E+y,ee=B+b;c[x*4+0]=q,c[x*4+1]=Q,c[x*4+2]=ee}}return c}),s==="verlet"&&r.forEach(c=>{const d=c.length/4;for(let u=1;u<d;u++){const f=c[u*4+0],h=c[u*4+1],m=c[u*4+2],_=new Vec3(5,0,0).cross(new Vec3(f,h,m),new Vec3(0,1,0)),v=u/d,g=e.handleParameter(i,v);for(let y=u;y<d;y++){const b=rotate3D([f,h,m],_,v*g);c[y*4+0]=b[0],c[y*4+1]=b[1],c[y*4+2]=b[2]}}return c}),{skeletons:r}},computeGeometry(o){return o.input.result}},log$7=log$8("nodes.join"),node$c={title:"Join",type:"join",outputs:["plant"],parameters:{inputA:{type:"plant",label:"plant",external:!0},inputB:{type:"plant",label:"plant",external:!0}},computeSkeleton(o,e){log$7("compute skeleton",o,e);const{inputA:n,inputB:s}=o;if(!n||!s)return n?n.result:s.result;const{skeletons:i,allSkeletons:r}=n.result,{skeletons:c,allSkeletons:d}=s.result;log$7(i,c);const u=[...i,...c],f=[];return r&&f.push(...r),d&&f.push(...d),{allSkeletons:f,skeletons:u}},computeGeometry(o){const{inputA:e,inputB:n}=o;if(!e||!n)return e?e.result:n.result;const{geometry:s,instances:i}=e.result,{geometry:r,instances:c}=n.result,d=join(s,r),u=[];return i&&u.push(...i),c&&u.push(...c),log$7("compute geometry",{geometryA:s,geometryB:r,result:d}),{geometry:d,instances:u}}},defaultValue=[{x:1,y:1,pinned:!0},{x:.62,y:.84,pinned:!1},{x:.54,y:.63,pinned:!1},{x:.38,y:.41,pinned:!0},{x:.44,y:.23,pinned:!1},{x:.64,y:.12,pinned:!1},{x:.98,y:.02,pinned:!0}],node$b={title:"Leaf",type:"leaf",outputs:["plant","leaf"],parameters:{input:{type:"plant",external:!0},size:{type:["number","parameter","curve","vec2"],inputType:"slider",min:0,max:3,step:.05,value:.2},shape:{type:"leaf",external:!0,defaultValue},lowestLeaf:{type:"number",inputType:"slider",min:0,max:1,step:.01,value:.5},curvature:{external:!0,type:"vec2",defaultValue:{x:.5,y:.2}},amount:{type:"number",min:0,max:20,value:10}},computeSkeleton(o,e){const{input:n}=o,{skeletons:s}=n.result,i=s.map((r,c)=>{const d=c/s.length,u=e.handleParameter(o.amount,d),f=new Float32Array(u*3),h=new Float32Array(u*3),m=new Float32Array(u*3);for(let _=0;_<u;_++){const v=_/(u-1),g=e.handleParameter(o.size,1-v),y=e.handleParameter(o.lowestLeaf,v),b=y+(1-y)*v-.001,[w,S,k]=interpolateSkeleton(r,b),[$,,P]=interpolateSkeletonVec(r,b),x=normalize2D([$,P]),j=Math.atan2(-x[0],x[1]);f[_*3+0]=w,f[_*3+1]=S,f[_*3+2]=k,h[_*3+0]=g,h[_*3+1]=1,h[_*3+2]=g,m[_*3+0]=0,m[_*3+1]=j-Math.PI/2*(_%2==0?-1:1),m[_*3+2]=0}return{offset:f,scale:h,rotation:m}});return{allSkeletons:n.result.allSkeletons,skeletons:s,instances:i}},computeGeometry(o,e,n){const{shape:s,input:i,curvature:r}=o,{instances:c}=e,d=n.handleParameter(r),u=leaf(n.handleParameter(s),{res:n.getSetting("leafRes",2),xCurvature:d.x,yCurvature:d.y});return{geometry:i.result.geometry,instances:c.map(f=>V(V({},f),u))}}},node$a={title:"Math",type:"math",outputs:["number"],parameters:{mode:{type:"whatever",internal:!0,inputType:"selection",label:!1,defaultValue:"add",values:["add","multiply","subtract"]},a:{type:"number",defaultValue:0,label:!1},b:{type:"number",defaultValue:0,label:!1}},computeValue(o,e,n){const{mode:s}=o,i=e.handleParameter(o.a,n),r=e.handleParameter(o.b,n);switch(s){case"multiply":return i*r;case"subtract":return i-r;default:return i+r}}},log$6=log$8("nodes.noise"),node$9={title:"Noise",type:"noise",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},size:{type:"number",inputType:"slider",min:0,max:20,step:.05,value:1},strength:{type:"number",inputType:"slider",min:0,max:2,step:.01,value:.5}},computeSkeleton(o,e){log$6(o);const{input:n}=o,s=e.handleParameter(o.size),i=e.handleParameter(o.strength),{skeletons:r}=n.result;return r.forEach((c,d)=>{const u=c.length/4,f=[c[0],c[1],c[2]];let h=0;for(let m=0;m<u;m++){const _=m/u;h+=(Math.abs(f[0]-c[m*4+0])+Math.abs(f[1]-c[m*4+1])+Math.abs(f[2]-c[m*4+2]))/3,f[0]=c[m*4+0],f[1]=c[m*4+1],f[2]=c[m*4+2],c[m*4+0]=c[m*4+0]+noise.n1d(h*s+0+d*500)*i*_,c[m*4+1]=c[m*4+1]+noise.n1d(h*s+1e3+d*500)*i*_,c[m*4+2]=c[m*4+2]+noise.n1d(h*s+2e3+d*500)*i*_}}),{skeletons:r,allSkeletons:n.result.allSkeletons}},computeGeometry(o){return o.input.result}},node$8={title:"Output",type:"output",outputs:[],parameters:{main:{type:"plant",label:"plant",external:!0}},computeNode(o={}){return o.main}},node$7={title:"Parameter",type:"parameter",outputs:["number"],parameters:{value:{type:"number",value:0},variation:{type:"number",inputType:"slider",value:0,min:0,max:1,step:.05}},computeValue(o,e){const{value:n=0,variation:s=0}=o;return s?n+e.n1d(200)*s*Math.max(n,1):n}},getRotationAxis=o=>o==="X"?[1,0,0]:o==="Z"?[0,0,1]:[0,1,0],node$6={title:"Rotate",type:"rotate",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,label:!1,type:"select",values:["Y","X","Z"]},spread:{internal:!0,type:"boolean",value:!0},angle:{type:"number",inputType:"slider",min:0,max:Math.PI*2,step:.05,value:0}},computeSkeleton(o,e){const{input:n,type:s,spread:i}=o,{result:{skeletons:r,allSkeletons:c}}=n,d=getRotationAxis(s);return r.forEach((u,f)=>{const h=u.length/4,m=u[0],_=u[1],v=u[2],g=f/r.length,y=e.handleParameter(o.angle,g)*(i?g:1);for(let b=1;b<h;b++){let w=u[b*4+0],S=u[b*4+1],k=u[b*4+2];w-=m,S-=_,k-=v,[w,S,k]=rotate3D([w,S,k],d,y),w+=m,S+=_,k+=v,u[b*4+0]=w,u[b*4+1]=S,u[b*4+2]=k}}),{skeletons:r,allSkeletons:c}},computeGeometry(o){return o.input.result}},node$5={title:"Shape",type:"shape",outputs:["leaf"],parameters:{value:{type:"leaf",inputType:"shape",internal:!0,label:!1,value:[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}},computeValue(o){return o.value}},node$4={title:"Slider",type:"slider",outputs:["number"],parameters:{value:{type:"number",label:!1,inputType:"slider",internal:!0,min:0,max:1,step:.01,value:0}},computeValue(o){return o.value}},log$5=log$8("nodes.stem"),node$3={title:"Stem",type:"stem",outputs:["plant"],parameters:{origin:{type:"vec3",external:!0,defaultValue:{x:0,y:0,z:0}},height:{type:"number",inputType:"slider",min:0,max:5,step:.05,value:2},thiccness:{type:"number",inputType:"slider",min:0,max:.2,step:.01,value:.06},amount:{type:"number",min:0,max:20,value:1}},computeSkeleton(o,e){log$5("computeSkeleton",o);const n=e.handleParameter(o.amount),s=e.getSetting("stemResY"),i=[];for(let r=0;r<n;r++){const{x:c,y:d,z:u}=e.handleParameter(o.origin),f=e.handleParameter(o.height),h=new Float32Array(s*4);for(let m=0;m<s;m++){const _=m/s,v=e.handleParameter(o.thiccness,_)*(1-_),g=c,y=d+_*f,b=u;h[m*4+0]=g,h[m*4+1]=y,h[m*4+2]=b,h[m*4+3]=v}i.push(h)}return{skeletons:i,allSkeletons:i}},computeGeometry(o,e,n){log$5("computeNode",o,e);const s=n.getSetting("stemResX");return{geometry:join(...e.skeletons.map(i=>tube(i,s)))}}},node$2={title:"Vec2",type:"vec2",outputs:["vec2"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0}}},node$1={title:"Vec3",type:"vec3",outputs:["vec3"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0},z:{label:!1,type:"number",value:0,defaultValue:0}}};var nodes$1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Branch:node$f,Curve:node$e,Gravity:node$d,Join:node$c,Leaf:node$b,Math:node$a,Noise:node$9,Output:node$8,Parameter:node$7,Rotate:node$6,Shape:node$5,Slider:node$4,Stem:node$3,Vec2:node$2,Vec3:node$1});const _nodes=Object.values(nodes$1).map(o=>("computeNode"in o?o.compute=o.computeNode:o.compute=e=>({type:o.type,parameters:e}),o));var index$2="",ConnectionView$1="";const minMax=(o,e)=>n=>Math.min(Math.max(n,o),e),limitDecimals=o=>{const e=10**o;return n=>Math.floor(n*e)/e},limitSafe=minMax(-1e5,1e5),removeDecimals=limitDecimals(1),limit=o=>limitSafe(removeDecimals(o));class ConnectionView{constructor({x1:e=0,y1:n=0,x2:s=0,y2:i=0},r){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x1=e,this.y1=n,this.x2=s,this.y2=i,this.system=r.node.system,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("viewbox","0 0 100 100"),this.svg.setAttribute("width","100"),this.svg.setAttribute("height","100"),this.svg.style.overflow="visible",this.svg.style.position="absolute",this.svg.style.top="3.5px",this.svg.style.pointerEvents="none",this.svg.style.zIndex="-1",r.view.wrapper.append(this.svg),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("node-connection-path"),this.path.setAttribute("vector-effect","non-scaling-stroke"),this.path.setAttribute("d",`
      M 0 0
      C 50 0 
        50 100
				100  100
      `),this.svg.appendChild(this.path),this.setPosition()}setPosition({x1:e=this.x1,y1:n=this.y1,x2:s=this.x2,y2:i=this.y2}={}){var d;this.x1=limit(e),this.y1=limit(n),this.x2=limit(s),this.y2=limit(i);const r=this.x2-this.x1+3.5,c=this.y2-this.y1;(d=this==null?void 0:this.hoverPath)==null||d.setAttribute("d",`
      M 0 0
      C ${r/2} 0 
        ${r/2} ${c}
				${r}  ${c}
      `),this.path.setAttribute("d",`
      M 0 0
      C ${r/2} 0 
        ${r/2} ${c}
				${r}  ${c}
      `)}remove(){var e;this.path.remove(),(e=this==null?void 0:this.hoverPath)==null||e.remove(),this.system.save()}}class NodeConnectionView extends ConnectionView{constructor(e){super({},e.output);this.connection=e,this.input=e.input.view,this.output=e.output.view,this.hoverPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.hoverPath.classList.add("node-connection-hover"),this.hoverPath.setAttribute("vector-effect","non-scaling-stroke"),this.svg.append(this.hoverPath),this.hoverPath.addEventListener("mouseover",()=>{const{activeNode:n}=this.system.view;n&&n.view.active&&n.view.hoveredConnection!==this&&this.handleNodeOver(n)}),this.hoverPath.addEventListener("mouseout",()=>{const{activeNode:n}=this.system.view;this.handleNodeOut(n)}),e.input.node.system.view.colorStore.on(e.input.type[0],n=>{this.path.style.stroke=n})}handleNodeOver(e){this.connection.isNodeJoinable(e)&&(e.view.hoveredConnection=this,this.path.classList.add("hover-active"))}handleNodeOut(e){e&&e.view.hoveredConnection===this&&delete e.view.hoveredConnection,this.path.classList.remove("hover-active")}remove(){super.remove()}}function makeDomController(o){if(!isDomElement(o))throw new Error("panzoom requires DOM element to be attached to the DOM tree");const n=o.parentElement;return o.scrollTop=0,{getBBox:r,getOwner:i,applyTransform:c};function i(){return n}function r(){return{left:0,top:0,width:o.clientWidth,height:o.clientHeight}}function c(d){o.style.transformOrigin="0 0 0",o.style.transform="matrix("+d.scale+", 0, 0, "+d.scale+", "+d.x+", "+d.y+")"}}function isDomElement(o){return o&&o.parentElement&&o.style}function kinetic(o,e,n){typeof n!="object"&&(n={});const s=typeof n.minVelocity=="number"?n.minVelocity:5,i=typeof n.amplitude=="number"?n.amplitude:.25,r=typeof n.cancelAnimationFrame=="function"?n.cancelAnimationFrame:getCancelAnimationFrame(),c=typeof n.requestAnimationFrame=="function"?n.requestAnimationFrame:getRequestAnimationFrame();let d,u;const f=342;let h,m,_,v,g,y,b,w;return{start:k,stop:P,cancel:S};function S(){r(h),r(w)}function k(){d=o(),v=b=m=g=0,u=new Date,r(h),r(w),h=c($)}function $(){const j=Date.now(),N=j-u;u=j;const A=o(),O=A.x-d.x,R=A.y-d.y;d=A;const I=1e3/(1+N);m=.8*O*I+.2*m,g=.8*R*I+.2*g,h=c($)}function P(){r(h),r(w);const j=o();_=j.x,y=j.y,u=Date.now(),(m<-s||m>s)&&(v=i*m,_+=v),(g<-s||g>s)&&(b=i*g,y+=b),w=c(x)}function x(){const j=Date.now()-u;let N=!1,A=0,O=0;v&&(A=-v*Math.exp(-j/f),A>.5||A<-.5?N=!0:A=v=0),b&&(O=-b*Math.exp(-j/f),O>.5||O<-.5?N=!0:O=b=0),N&&(e(_+A,y+O),w=c(x))}}function getCancelAnimationFrame(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function getRequestAnimationFrame(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(o){return setTimeout(o,16)}}const defaultZoomSpeed=.2;function createPanZoom(o,e){const n=makeDomController(o),s=n.getOwner(),i={x:0,y:0};let r=!1;const c={x:0,y:0,scale:1},d=typeof e.pinchSpeed=="number"?e.pinchSpeed:1,u=e.bounds,f=typeof e.maxZoom=="number"?e.maxZoom:Number.POSITIVE_INFINITY,h=typeof e.minZoom=="number"?e.minZoom:0,m=typeof e.boundsPadding=="number"?e.boundsPadding:.05,_=typeof e.zoomSpeed=="number"?e.zoomSpeed:defaultZoomSpeed;let v=parseTransformOrigin(e.transformOrigin);validateBounds(u);let g,y=!1,b=!1,w,S,k;const $=kinetic(xe,je,e.smoothScroll);let P,x=!1;le();const j={dispose:Ee,moveBy:ie,moveTo:te,smoothMoveTo:Te,centerOn:Ce,zoomTo:X,zoomAbs:ae,pause:R,resume:I,isPaused:D,getTransform:q,setTransform:B,getTransformOrigin:Q,setTransformOrigin:ee},N=typeof e.initialX=="number"?e.initialX:c.x,A=typeof e.initialY=="number"?e.initialY:c.y,O=typeof e.initialZoom=="number"?e.initialZoom:c.scale;return(N!=c.x||A!=c.y||O!=c.scale)&&ae(N,A,O),j;function R(){ce(),x=!0}function I(){x&&(le(),x=!1)}function D(){return x}function E(M,C){return i.x=M,i.y=C,i}function B(M,C,T){c.x=M,c.y=C,c.scale=T,H()}function q(){return c}function Q(){return v}function ee(M){v=parseTransformOrigin(M)}function xe(){return{x:c.x,y:c.y}}function te(M,C){c.x=M,c.y=C,ne(),H()}function ie(M,C){te(c.x+M,c.y+C)}function ne(){const M=Me();if(!M)return;let C=!1;const T=Ne();let L=M.left-T.right;return L>0&&(c.x+=L,C=!0),L=M.right-T.left,L<0&&(c.x+=L,C=!0),L=M.top-T.bottom,L>0&&(c.y+=L,C=!0),L=M.bottom-T.top,L<0&&(c.y+=L,C=!0),C}function Me(){if(!!u){if(typeof u=="boolean"){const M=s.getBoundingClientRect(),C=M.width,T=M.height;return{left:C*m,top:T*m,right:C*(1-m),bottom:T*(1-m)}}return u}}function Ne(){const M=n.getBBox(),C=Pe(M.left,M.top);return{left:C.x,top:C.y,right:M.width*c.scale+C.x,bottom:M.height*c.scale+C.y}}function Pe(M,C){return{x:M*c.scale+c.x,y:C*c.scale+c.y}}function H(){r=!0,g=window.requestAnimationFrame(Le)}function re(M,C,T){if(isNaN$1(M)||isNaN$1(C)||isNaN$1(T))throw new Error("zoom requires valid numbers");const L=c.scale*T;if(L<h){if(c.scale===h)return;T=h/c.scale}if(L>f){if(c.scale===f)return;T=f/c.scale}const F=E(M,C);c.x=F.x-T*(F.x-c.x),c.y=F.y-T*(F.y-c.y),u&&m===1&&h===1?(c.scale*=T,ne()):ne()||(c.scale*=T),H()}function ae(M,C,T){const L=T/c.scale;re(M,C,L)}function Ce(M){const C=M.ownerSVGElement;if(!C)throw new Error("ui element is required to be within the scene");const T=M.getBoundingClientRect(),L=T.left+T.width/2,F=T.top+T.height/2,W=C.getBoundingClientRect(),J=W.width/2-L,Z=W.height/2-F;U(J,Z)}function Te(M,C){U(M-c.x,C-c.y)}function U(M,C){return ie(M,C)}function je(M,C){te(M,C)}function Ee(){ce()}function le(){s.addEventListener("mousedown",_e,{passive:!0}),s.addEventListener("dblclick",me,{passive:!1}),s.addEventListener("touchstart",pe,{passive:!0}),s.addEventListener("keydown",ue),s.addEventListener("wheel",be,{passive:!0}),H()}function ce(){s.removeEventListener("wheel",be),s.removeEventListener("mousedown",_e),s.removeEventListener("keydown",ue),s.removeEventListener("dblclick",me),s.removeEventListener("touchstart",pe),g&&(window.cancelAnimationFrame(g),g=0),$.cancel(),ye(),Re(),$e()}function Le(){r&&Ie()}function Ie(){r=!1,n.applyTransform(c),g=0,e.onTransform&&e.onTransform(c)}function ue(M){let C=0;if(M.keyCode===38||M.keyCode===40||M.keyCode===37||M.keyCode===39||(M.keyCode===189||M.keyCode===109?C=1:(M.keyCode===187||M.keyCode===107)&&(C=-1)),C){const T=we(C*100),L=v?se():Oe();X(L.x,L.y,T)}}function Oe(){const M=s.getBoundingClientRect();return{x:M.width/2,y:M.height/2}}function pe(M){if(Ae(M),M.touches.length===1)return De(M);M.touches.length===2&&(k=he(M.touches[0],M.touches[1]),P=!0,de())}function Ae(M){M.stopPropagation(),M.preventDefault()}function Ve(M){M.preventDefault(),M.stopPropagation()}function De(M){const C=M.touches[0],T=G(C),L=E(T.x,T.y);w=L.x,S=L.y,$.cancel(),de()}function de(){y||(y=!0,document.addEventListener("touchmove",fe),document.addEventListener("touchend",Y),document.addEventListener("touchcancel",Y))}function fe(M){if(M.touches.length===1){M.stopPropagation();const C=M.touches[0],T=G(C),L=E(T.x,T.y),F=L.x-w,W=L.y-S;F!==0&&W!==0&&ke(),w=L.x,S=L.y,U(F,W)}else if(M.touches.length===2){P=!0;const C=M.touches[0],T=M.touches[1],L=he(C,T),F=1+(L/k-1)*d,W=G(C),J=G(T);if(w=(W.x+J.x)/2,S=(W.y+J.y)/2,v){const Z=se();w=Z.x,S=Z.y}X(w,S,F),k=L,M.stopPropagation(),M.preventDefault()}}function Y(M){if(M.touches.length>0){const C=G(M.touches[0]),T=E(C.x,C.y);w=T.x,S=T.y}}function he(M,C){const T=M.clientX-C.clientX,L=M.clientY-C.clientY;return Math.sqrt(T*T+L*L)}function me(M){Ve(M)}function _e(M){if(y)return M.stopPropagation(),!1;if(M.target!==s&&M.target!==o||!(M.button===1&&window.event!==null||M.button===0))return;$.cancel();const T=G(M),L=E(T.x,T.y);return w=L.x,S=L.y,document.addEventListener("mousemove",ge),document.addEventListener("mouseup",ve),!1}function ge(M){if(y||M.ctrlKey)return;ke();const C=G(M),T=E(C.x,C.y),L=T.x-w,F=T.y-S;w=T.x,S=T.y,U(L,F)}function ve(){$e(),ye()}function ye(){document.removeEventListener("mousemove",ge),document.removeEventListener("mouseup",ve),b=!1}function Re(){document.removeEventListener("touchmove",fe),document.removeEventListener("touchend",Y),document.removeEventListener("touchcancel",Y),b=!1,P=!1,y=!1}function be(M){$.cancel();let C=M.deltaY;M.deltaMode>0&&(C*=100);const T=we(C);if(T!==1){const L=v?se():G(M);X(L.x,L.y,T)}}function G(M){const C=s.getBoundingClientRect(),T=M.clientX-C.left,L=M.clientY-C.top;return{x:T,y:L}}function se(){const M=s.getBoundingClientRect();return{x:M.width*v.x,y:M.height*v.y}}function X(M,C,T){return $.cancel(),re(M,C,T)}function we(M){const C=Math.sign(M),T=Math.min(.25,Math.abs(_*M/128));return 1-C*T}function ke(){b||(b=!0,$.start())}function $e(){b&&(P||$.stop())}}function parseTransformOrigin(o){if(!!o){if(typeof o=="object")return(!isNumber(o.x)||!isNumber(o.y))&&failTransformOrigin(),o;failTransformOrigin()}}function failTransformOrigin(o){throw new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function validateBounds(o){const e=typeof o;if(e==="undefined"||e==="boolean")return;if(!(isNumber(o.left)&&isNumber(o.top)&&isNumber(o.bottom)&&isNumber(o.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}function isNumber(o){return Number.isFinite(o)}function isNaN$1(o){return Number.isNaN?Number.isNaN(o):o!==o}function rectanglesIntersect(o,e){const n=o.x2<e.x1,s=o.x1>e.x2,i=o.y1>e.y2,r=o.y2<e.y1;return!(n||s||i||r)}var canSocketsConnect=(o,e)=>e.type.includes(o.type)||e.type.includes("*");function diffObjects(o,e){if(o===void 0&&e===void 0)return;const n=Array.isArray(o)?"array":typeof o;if(n==="string"||n==="boolean"||n==="number")return o===e?void 0:e;if(Array.isArray(o)){const c=o.map((d,u)=>typeof e=="object"&&u in e?diffObjects(d,e[u]):e[u]);return!c.length||c.length===1&&!c[0]?void 0:c}if(!o)return e;const s=Object.keys(o),i={};let r=!1;if(s.forEach(c=>{const d=diffObjects(o[c],e[c]);d!==void 0&&(r=!0,i[c]=d)}),!!r)return i}function diffBoth(o,e){return[diffObjects(o,e),diffObjects(e,o)]}function mergeObjects(o,e){const n=typeof o;if(n==="string"||n==="boolean"||n==="number")return e;if(Array.isArray(o))return o.map((s,i)=>e[i]?mergeObjects(s,e[i]):s);if(typeof o=="object"){const s=Object.keys(e),i=V({},o);return s.forEach(r=>{i[r]=mergeObjects(o[r],e[r])}),i}}class NodeConnection{constructor(e,{input:n,output:s}){if(!s||!n)return;if(this.system=e,n.node.getChildren().includes(s.node))throw new Error("Circular reference");if(!canSocketsConnect(s,n))throw new Error("Can't connect type "+n.type+" to "+s.type);this.output=s,this.input=n,e.options.view&&(this.view=new NodeConnectionView(this)),this.output.setConnection(this),this.input.setConnection(this),this.output.node.system.save()}joinNode(e){if(!this.isNodeJoinable(e))return;this.remove(),this.output.node.connectTo(e,0,e.getInputs()[0].key);const n=this.input.node.getInputs(),s=n.indexOf(this.input),i=n[s].key;e.connectTo(this.input.node,0,i)}isNodeJoinable(e){const n=this.input.type,s=this.output.type;if(this.input.node===e||this.output.node===e)return!1;const i=e.getInputs();if(!i.length||!i.find(c=>c.type.includes(s)))return!1;const r=e.outputs;return!(!r.length||!r.find(c=>n.includes(c.type)||n.includes("*")))}remove(){this.view&&this.view.remove(),this.input.removeConnection(),this.output.removeConnection(this)}deserialize(){return{id:this.input.node.attributes.id,out:this.indexOut,in:this.indexIn}}get indexOut(){return this.output.node.outputs.indexOf(this.output)}get indexIn(){return this.input.key}}class Node extends EventEmitter{constructor(e,n){super();this.outputs=[],this._state={},this.states={},this.inputData=[],this.enableUpdates=!0,this.refs=[],this.system=e;const{attributes:s,state:i={}}=n;this._state=i,this.attributes=s,this.id=s.id,this._compute=memoize((r=this._state)=>this.compute(r))}get state(){return this._state}bindView(e){this.view=e,this.outputs.forEach(n=>n.bindView()),Object.values(this.states).forEach(n=>n.bindView())}setAttributes(e){this.enableUpdates&&this.system.history.addAction(),this.attributes=V(V({},this.attributes),e),this==null||this.view.updateViewPosition(),this.save()}compute(e){return e}getChildren(){return this.outputs.map(s=>s.connections).flat().map(s=>s.input.node)}getSockets(){return[...this.getInputs(),...this.outputs]}getInputs(){return Object.values(this.states).map(e=>e.getInput()).filter(e=>!!e)}setStateValue(e,n){this.states[e].setValue(n)}getStateValue(e){return this.state[e]}update(){!this.enableUpdates||(this.computedData=this._compute(this.state),this.emit("computedData",this.computedData),this.refs.forEach(e=>{e.node.enableUpdates=!1,e.keyIn.forEach(n=>{e.node.setStateValue(n,this.computedData)}),e.node.enableUpdates=!0,e.node.update()}),this.save())}remove(){this.system.removeNode(this),this.destroyEventEmitter()}connectTo(e,n=0,s=e.getInputs()[0].key){var u,f,h;const i=this.outputs[n],r=(u=e.states[s])==null?void 0:u.getInput();if(!r)return;const c=new NodeConnection(this.system,{output:i,input:r});(f=i==null?void 0:i.view)==null||f.updatePosition(),(h=r==null?void 0:r.view)==null||h.updatePosition();const d=this.refs.find(m=>m.node.id===e.id&&m.indexOut===n);return d?d.keyIn=[...d.keyIn,s]:this.refs.push({node:e,keyIn:[s],indexOut:n}),this.update(),c}disconnectFrom(e,n,s){this.refs=this.refs.filter(i=>!(i.indexOut!==s||(i.keyIn.splice(i.keyIn.indexOf(n),1),i.keyIn.length===0))),this.update()}deserialize(){const e=Object.assign({},this.attributes);e.refs=this.outputs.map(s=>s.connections).flat().map(s=>s.deserialize());const n={};return Object.values(this.states).forEach(s=>{n[s.key]=s.getValue()}),Object.assign({},{attributes:e,state:n})}save(){this.system.save()}}var BooleanNode={title:"Boolean",type:"boolean",outputs:["boolean"],parameters:{value:{type:"boolean",defaultValue:!1}},compute({value:o=!1}){return o}};const node={title:"Math",type:"math",outputs:["number","number"],parameters:{mode:{type:"whatever",internal:!0,inputType:"selection",label:!1,defaultValue:"add",values:["add","multiply","subtract"]},a:{type:"number",defaultValue:0,label:!1},b:{type:"number",defaultValue:0,label:!1}},compute({mode:o,a:e,b:n}){switch(o){case"multiply":return e*n;case"subtract":return e-n;default:return e+n}}};var NumberNode={title:"Number",type:"number",outputs:["number"],parameters:{value:{type:"number",internal:!0,label:!1,defaultValue:0}},compute({value:o=0}){return o}},NodeStateView$1="";class NodeStateView{constructor(e){this.nodeState=e,this.wrapper=document.createElement("div"),this.input=document.createElement("div"),this.isPaused=!1,this.wrapper.classList.add("node-state-single-wrapper"),this.input.classList.add("node-state-input");const n=e.template,s=n.label||e.key;if(typeof s=="string"){const i=document.createElement("p");i.className="state-label",i.innerHTML=s,this.wrapper.appendChild(i)}(n==null?void 0:n.label)===!1&&this.wrapper.classList.add("hide-label"),n.external||(this.element=stateToElement({target:this.input,template:n,value:e.getValue()}),this.element&&this.element.$on("change",({detail:i})=>{this.isPaused||(this.isPaused=!0,typeof i!="undefined"&&!Number.isNaN(i)&&this.nodeState.setValue(i),this.isPaused=!1)})),e.node.view.stateWrapper.appendChild(this.wrapper),this.wrapper.appendChild(this.input)}updateValue(){this.isPaused||(this.isPaused=!0,setTimeout(()=>{this.element&&(this.element.value=this.nodeState.getValue())},50),this.isPaused=!1)}updatePosition(){var e,n;this.rect=this.wrapper.getBoundingClientRect(),(n=(e=this.nodeState.getInput())==null?void 0:e.view)==null||n.updatePosition()}get y(){return this.rect.y-this.nodeState.node.view.y}get height(){return this.rect.height}setActive(e){this.wrapper.classList[e?"remove":"add"]("disabled")}}var NodeInputView$1="";class NodeInputView{constructor(e){if(!e||!e.node)throw new Error("Somethings missing");this.input=e,this.node=e.node,this.wrapper=document.createElement("div"),this.wrapper.classList.add("node-input-wrapper"),e.type.forEach(n=>{this.wrapper.classList.add(`socket-type-${n==="*"?"all":n}`)}),e.state.view.wrapper.appendChild(this.wrapper),this.wrapper.addEventListener("mousedown",n=>{n.stopPropagation(),n.preventDefault();const s=this.input.connection;s?(s.remove(),this.node.system.view.createFloatingConnection(s.output)):this.node.system.view.createFloatingConnection(this.input)},!1),this.node.system.view.colorStore.on(e.type[0],n=>{const s=window.getComputedStyle(this.wrapper,null).getPropertyValue("background-color");this.wrapper.style.backgroundColor=s!=="rgba(0, 0, 0, 0)"?s:n})}updatePosition(){var e;this.rect=this.wrapper.getBoundingClientRect(),(e=this==null?void 0:this.connection)==null||e.setPosition({x2:this.x,y2:this.y})}remove(){this.wrapper.remove(),this.connection&&this.connection.remove()}set state(e){this.wrapper.classList.forEach(n=>{n.includes("socket-state-")&&this.wrapper.classList.remove(n)}),e&&e.length&&this.wrapper.classList.add("socket-state-"+e)}get x(){return this.node.view.x-3}get y(){const e=this.node.system.view;return(this.rect.y+this.rect.height/2-e.y-e.top)/e.s-e.height/2}}class NodeInput{constructor(e,n,s){this.state=e,this.key=s,this.node=e.node,this.type=Array.isArray(n)?n:[n]}bindView(){this.view=new NodeInputView(this)}removeConnection(){const e=this.connection;delete this.connection,e&&e.remove(),this.node.setStateValue(this.key,void 0),this.state.setIsExternal(!1)}setConnection(e){this.connection&&this.connection.remove(),this.connection=e,this.view&&(this.view.connection=e.view),this.state.setIsExternal(!0)}remove(){this.view&&this.view.remove(),this.removeConnection()}}class NodeState extends EventEmitter{constructor(e,n,s){super();var i,r;this.node=e,this.key=n,this.template=s,this.isExternal=!1,this.value=(r=(i=e.state[n])!=null?i:s.defaultValue)!=null?r:s.value,this.node._state[n]=this.value,this.template.internal||(this.input=new NodeInput(this,s.type,n))}setIsExternal(e=!1){var n;this.isExternal=e,(n=this==null?void 0:this.view)==null||n.setActive(!e)}getValue(){return this.value}setValue(e){this.isExternal||(this.node.enableUpdates&&this.node.system.history.addAction(),this.value=e),this.node._state[this.key]=e,this.node.enableUpdates&&(this==null||this.view.updateValue(),this.node.update())}remove(){}getInput(){return this.input}bindView(){this.view=new NodeStateView(this),this.input&&this.input.bindView()}}var NodeView$1="";class NodeView{constructor(e){this.inputs=[],this.outputs=[],this.active=!1,this.x=0,this.y=0,this.downX=0,this.downY=0,this.mDownX=0,this.mDownY=0,this.height=50,this.width=91,this.node=e,this.system=e.system,this.wrapper=document.createElement("div"),this.wrapper.style.minHeight=this.height+"px",this.wrapper.style.minWidth=this.width+"px",this.wrapper.classList.add("node-wrapper","node-type-"+e.attributes.type.toLowerCase()),this.wrapper.setAttribute("id","node-view-"+this.system.id+"-"+this.node.id),this.outputWrapper=document.createElement("div"),this.outputWrapper.classList.add("node-outputs-wrapper"),this.wrapper.append(this.outputWrapper);const n=document.createElement("p");n.innerHTML=e.attributes.name||e.attributes.type,n.classList.add("node-title"),this.wrapper.appendChild(n),this.stateWrapper=document.createElement("div"),this.stateWrapper.classList.add("node-state-wrapper"),this.wrapper.append(this.stateWrapper),e.system.view.nodeContainer.append(this.wrapper);const{pos:{x:s=0,y:i=0}={}}=e.attributes;this.x=s,this.y=i,this.bindEventListeners(),this.wrapper.style.left=s+"px",this.wrapper.style.top=i+"px",setTimeout(()=>{const{width:r,height:c}=this.wrapper.getBoundingClientRect();this.width=r/this.system.view.s,this.height=c/this.system.view.s,this.updateViewPosition(s,i)},10)}bindEventListeners(){this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e)),this._unsubscribeMouseMove=this.system.view.on("mousemove",e=>this.handleMouseMove(e)),this._unsubscribeMouseUp=this.system.view.on("mouseup",()=>this.handleMouseUp())}removeEventListeners(){this._unsubscribeMouseMove(),this._unsubscribeMouseUp(),this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e))}set state(e){this.wrapper.classList.remove("node-active","node-selected","node-dragging"),this.wrapper.classList.add("node-"+e),this._state=e}get state(){return this._state}handleMouseDown(e){var i,r,c,d;if(this.system.view.keyMap.space||e.button===2||e.target!==e.currentTarget)return;e.stopImmediatePropagation(),e.stopPropagation(),this.node.system.view.setActive(this.node,e);const{rmx:n,rmy:s}=this.system.view;this.mDownX=n,this.mDownY=s,this.downX=((r=(i=this.node.attributes)==null?void 0:i.pos)==null?void 0:r.x)||0,this.downY=((d=(c=this.node.attributes)==null?void 0:c.pos)==null?void 0:d.y)||0,this.active=!0,this.system.view.selectedNodes.length&&this.system.view.selectedNodes.forEach(u=>{u.view.active=!0,u.view.mDownX=n,u.view.mDownY=s,u.view.downX=u.view.x,u.view.downY=u.view.y})}handleMouseUp(){this.active=!1,this.hoveredConnection&&(this.hoveredConnection.connection.joinNode(this.node),delete this.hoveredConnection)}handleMouseMove({mx:e,my:n,keys:s}){if(this.active){this.state="dragging";const i=s.ctrlKey?.02:1;let r=this.mDownX-e,c=this.mDownY-n;s.shiftKey&&(Math.abs(r)>Math.abs(c)?c=0:r=0);const d=Math.round((this.downX-r/this.system.view.s)*i)/i,u=Math.round((this.downY-c/this.system.view.s)*i)/i;this.setPosition(d,u)}}updateViewPosition(e=(r=>(r=(i=>(i=(s=>(s=this.node.attributes)==null?void 0:s.pos)())==null?void 0:i.x)())!=null?r:this.x)(),n=(u=>(u=(d=>(d=(c=>(c=this.node.attributes)==null?void 0:c.pos)())==null?void 0:d.y)())!=null?u:this.y)()){this.wrapper.style.left=e+"px",this.wrapper.style.top=n+"px",Object.values(this.node.states).forEach(f=>{var h;return(h=f==null?void 0:f.view)==null?void 0:h.updatePosition()}),this.node.outputs.forEach(f=>f.view.updatePosition())}setPosition(e,n){this.x=e,this.y=n,this.node.setAttributes({pos:{x:e,y:n}}),this.updateViewPosition()}remove(){this.removeEventListeners(),this.wrapper.remove()}}class DebugNode extends Node{constructor(e,n){super(e,n);this.states={input:new NodeState(this,"input",{type:"*"})},this.outputs=[]}compute({input:e}){return e}}class DebugView extends NodeView{constructor(e){super(e);const n=document.createElement("div");e.on("computedData",s=>{n.innerHTML="";const i=document.createElement("p");i.innerHTML=JSON.stringify(s,null," "),n.append(i)}),this.wrapper.appendChild(n)}}var DebugNode$1={title:"Debug",meta:{description:"Outputs any inputs for debug purposes"},node:DebugNode,view:DebugView};class OutputNode extends Node{constructor(e,n){super(e,n);this.states={input:new NodeState(this,"input",{type:"*",external:!0,label:!1})},this.outputs=[]}compute({input:e}){return e}}class OutputView extends NodeView{constructor(e){super(e);const n=document.createElement("p");n.style.margin="0px",n.style.padding="4px",n.style.color="white",n.style.fontWeight="bold",e.on("computedData",s=>{n.innerHTML=JSON.stringify(s,null,2)}),this.wrapper.appendChild(n)}}var OutputNode$1={title:"Output",meta:{description:"Outputs the final value"},node:OutputNode,view:OutputView};const types={BooleanNode,MathNode:node,NumberNode,DebugNode:DebugNode$1,OutputNode:OutputNode$1};var AddMenu="";let longestModuleName=0;class Logger{constructor(e,n="system"in e?e.system.log.level:2){this.isGrouped=!1,this.output=log$8("logger"),this.module=e,this.name=e.constructor.name,this.length=this.name.length,longestModuleName=Math.max(longestModuleName,this.length),this.level=n,this.output=log$8(this.getModuleName())}getModuleName(){return this.isGrouped?"":`${this.name.padEnd(longestModuleName," ")}`}handle(e,n,s){s&&s.length?(console.groupCollapsed(`${this.getModuleName()} ${n}`),e(...s),console.groupEnd()):e(`${this.getModuleName()} ${n}`)}info(e,...n){this.level>=3&&this.output(e,...n)}log(e,...n){this.level>=2&&this.output(e,...n)}warn(e,...n){this.level>=1&&this.output.warn(e,...n)}error(e,...n){this.level>=0&&(this.output.error(e),this.output(...n))}group(e){this.output.group(e),this.isGrouped=!0}groupEnd(){console.groupEnd(),this.isGrouped=!1}}class RightClickMenu{constructor(e){this.x=0,this.y=0,this.view=e,this.system=e.system,this.log=new Logger(this),this.wrapper=document.createElement("div"),this.wrapper.classList.add("context-wrapper"),this.search=new InputSearch({target:this.wrapper}),this.search.$on("input",({detail:n})=>{this.resolve(n)}),this.view.wrapper.append(this.wrapper),this.view.system.store.on("types",n=>this.updateTypes(n),20),this.view.on("keydown",({key:n})=>n==="Escape"&&this.hide())}updateTypes(e){this.search.setItems(e.map(n=>({value:n.type||n.title,title:n.title})))}handleWindowClick(e){e.composedPath().includes(this.wrapper)||this.reject()}reject(){this.rej&&this.rej(),this.hide()}resolve(e){const n=this.system.store.getByName(e),{x:s,y:i}=this.view.projectWindowToLocal(this.x,this.y),r=s-this.view.width/2,c=i-this.view.height/2;n?this.res({attributes:{pos:{x:r,y:c},id:"",name:n.title,type:n.title,refs:[]},state:{value:void 0}}):this.reject(),this.hide()}hide(){this.search.clear(),this.wrapper.classList.remove("context-visible"),this.wrapper.blur(),this.res=e=>e,this.reject=()=>{}}show({x:e,y:n,socket:s}){return this.x=e,this.y=n,this.socket=s,this.wrapper.style.left=e+"px",this.wrapper.style.top=n+"px",setTimeout(()=>{this.wrapper.classList.add("context-visible"),this.search.focus()},10),new Promise((i,r)=>{this.res=i,this.rej=r})}}var BoxSelection="";class BoxSelectionView extends EventEmitter{constructor(e){super();this.mDownX=0,this.mDownY=0,this.downX=0,this.downY=0,this.isShiftKey=!1,this.view=e,this.wrapper=document.createElement("div"),this.wrapper.classList.add("box-selection-wrapper"),this.view.wrapper.append(this.wrapper),this.view.on("mousedown",({target:n,mx:s,x:i,my:r,y:c,keys:d})=>{var u;d.space||d.shiftKey||d.button===2||!d.ctrlKey||n&&!((u=n==null?void 0:n.className)==null?void 0:u.includes("nodesystem"))||(this.mDownX=s,this.mDownY=r,this.downX=i,this.downY=c,this.wrapper.style.left=s+"px",this.wrapper.style.top=r+"px",this.wrapper.style.width="0px",this.wrapper.style.height="0px",this.isShiftKey=d.shift,this.show())})}show(){this.wrapper.classList.add("box-selection-visible");const e=this.view.system.nodes.map(i=>{const{width:r,height:c}=i.view,{x:d,y:u}=i.view,f=d+this.view.width/2,h=u+this.view.height/2,m=f+r,_=h+c;return{n:i,state:i.view.state,x1:f,y1:h,x2:m,y2:_}});let n=[];const s=this.view.on("mousemove",({mx:i,my:r,x:c,y:d})=>{const{mDownX:u,mDownY:f,downX:h,downY:m,isShiftKey:_}=this,v={x1:Math.min(i,u),x2:Math.max(i,u),y1:Math.min(r,f),y2:Math.max(r,f)};this.wrapper.style.left=v.x1+"px",this.wrapper.style.top=v.y1+"px",this.wrapper.style.width=Math.abs(u-i)+"px",this.wrapper.style.height=Math.abs(f-r)+"px";const g={x1:Math.min(c,h),x2:Math.max(c,h),y1:Math.min(d,m),y2:Math.max(d,m)};n=e.filter(y=>rectanglesIntersect(g,y)?!0:(_||(y.state="normal",y.n.view.state="normal"),!1)).map(({n:y,state:b})=>(b!=="active"&&(b="selected",y.view.state="selected"),y))},5);this.view.once("mouseup",()=>{s(),this.hide(),this.emit("selection",n)})}projectBox(e){const{x:n,y:s}=this.view.projectWindowToLocal(e.x1,e.y1),{x:i,y:r}=this.view.projectWindowToLocal(e.x2,e.y2);return{x1:n,y1:s,x2:i,y2:r}}hide(){this.wrapper.classList.remove("box-selection-visible")}}var NodeOutputView$1="";class NodeOutputView{constructor(e){this.connections=[],this.output=e,this.node=e.node,this.wrapper=document.createElement("div"),this.wrapper.classList.add("node-output-wrapper"),this.wrapper.classList.add(`socket-type-${e.type}`),e.node.view.outputWrapper.appendChild(this.wrapper),this.wrapper.addEventListener("mousedown",n=>{n.stopPropagation(),n.preventDefault(),this.node.system.view.createFloatingConnection(this.output)},!1),this.node.system.view.colorStore.on(e.type,n=>{const s=window.getComputedStyle(this.wrapper,null).getPropertyValue("background-color");this.wrapper.style.backgroundColor=s!=="rgba(0, 0, 0, 0)"&&s!=="rgb(0,0,0)"?s:n})}remove(){this.wrapper.remove(),this.connections.forEach(e=>e.remove())}set state(e){this.wrapper.classList.forEach(n=>{n.includes("socket-state-")&&this.wrapper.classList.remove(n)}),e&&e.length&&this.wrapper.classList.add("socket-state-"+e)}updatePosition(){this.rect=this.wrapper.getBoundingClientRect(),this.output.connections.forEach(e=>e.view.setPosition({x1:this.x,y1:this.y}))}get x(){return this.node.view.x+this.node.view.width+3}get y(){const e=this.node.system.view;return(this.rect.y+this.rect.height/2-e.y-e.top)/e.s-e.height/2}}class NodeOutput{constructor(e,n){if(this.connections=[],this.node=e,this.type=n,Array.isArray(n))throw new Error("Output can only output one type, not "+n)}bindView(){this.view=new NodeOutputView(this)}connectTo(e){const n=this.node.outputs.indexOf(this);return this.node.connectTo(e.node,n,e.key)}removeConnection(e){const n=this.connections.indexOf(e);this.connections.splice(n,1),this.node.disconnectFrom(e.input.node,e.indexIn,e.indexOut),this.view&&this.view.connections.splice(n,1)}setConnection(e){this.connections.push(e),this.view&&this.view.connections.push(e.view)}remove(){this.connections.forEach(e=>e.remove())}}class FloatingConnectionView extends aggregate(ConnectionView,EventEmitter){constructor(e,n={}){const{system:s}=e.node;super({},e);this.view=s.view,this.path.style.zIndex="999";const i=Array.isArray(e.type)?e.type[0]:e.type;s.view.colorStore.on(i,m=>{this.path.style.stroke=m}),e.view.updatePosition();const r=e.view.x,c=e.view.y;let d=r,u=c;n&&(d=n.x-s.view.width/2,u=n.y-s.view.height/2),this.setPosition({x1:r,y1:c,x2:d,y2:u}),this.dx2=this.x2,this.dy2=this.y2,this.isInput=e instanceof NodeInput,this.allSockets=e instanceof NodeInput?s.getOutputs(e.type):s.getInputs(e.type),this.allSockets.forEach(m=>m.view.state="potential");let f=this.allSockets.filter(m=>m.node.attributes.id!==e.node.attributes.id);f.forEach(m=>m.view.state="middle");const h="connection"in e?[e.connection]:e.connections;if(h&&!!h.length){const m=h.map(_=>[_.input,_.output]).flat();f=f.filter(_=>!m.includes(_))}this.potentialSockets=f,this.potentialSockets.forEach(m=>m.view.updatePosition()),this.potentialSockets.forEach(m=>m.view.state="highlight"),this._unsubMouseUp=this.view.on("mouseup",this.handleMouseUp.bind(this)),this._unsubMouseMove=this.view.on("mousemove",this.handleMouseMove.bind(this)),this.mdx=this.view.mx,this.mdy=this.view.my,this.socket=e}handleMouseUp(e){const{x:n,y:s,keys:i}=e;this._unsubMouseUp(),this._unsubMouseMove(),this.allSockets.forEach(d=>d.view.state="");let r,c=0;this.socket instanceof NodeInput&&this.hoveredSocket instanceof NodeOutput?(r=this.socket.key,c=this.hoveredSocket.node.outputs.indexOf(this.hoveredSocket)):this.socket instanceof NodeOutput&&this.hoveredSocket instanceof NodeInput&&(r=this.hoveredSocket.key,c=this.socket.node.outputs.indexOf(this.socket)),this.hoveredSocket?(this.emit("connection",{keyIn:r,indexOut:c,inputNode:this.isInput?this.socket.node:this.hoveredSocket.node,outputNode:this.isInput?this.hoveredSocket.node:this.socket.node}),this.remove()):i.ctrlKey?this.view.addMenu.show({x:n,y:s,socket:this.socket}).then(d=>this.view.system.createNode(d)).then(d=>{this.socket instanceof NodeOutput?this.socket.node.connectTo(d,c,r):d.connectTo(this.socket.node,c,r)}).catch(()=>{}).finally(()=>{this.remove()}):this.remove()}handleMouseMove(e){const{x:n,y:s}=e;this.mdx||(this.mdx=n,this.mdy=s);const i=this.dx2+(n-this.mdx),r=this.dy2+(s-this.mdy),c=20,d=this.potentialSockets.map(u=>{const{x:f,y:h}=u.view;return{socket:u,distance:Math.abs(i-f)+Math.abs(r-h)}}).filter(u=>u.distance<c).sort((u,f)=>u.distance>f.distance?-1:1).map(u=>u.socket);if(d.length){const{x:u,y:f}=d[0].view;this.hoveredSocket=d[0],this.setPosition({x2:u,y2:f})}else this.hoveredSocket=void 0,this.setPosition({x2:i,y2:r})}remove(){super.remove()}}var NodeSystemView$1="";const COLORS=[{color:"#a52a2a",name:"brown"},{color:"#008000",name:"green"},{color:"#4b0082",name:"indigo"},{color:"#f0e68c",name:"khaki"},{color:"#add8e6",name:"lightblue"},{color:"#e0ffff",name:"lightcyan"},{color:"#90ee90",name:"lightgreen"},{color:"#d3d3d3",name:"lightgrey"},{color:"#ffb6c1",name:"lightpink"},{color:"#ffffe0",name:"lightyellow"},{color:"#00ff00",name:"lime"},{color:"#ff00ff",name:"magenta"},{color:"#800000",name:"maroon"},{color:"#000080",name:"navy"},{color:"#808000",name:"olive"},{color:"#ffa500",name:"orange"},{color:"#ffc0cb",name:"pink"},{color:"#800080",name:"purple"},{color:"#800080",name:"violet"},{color:"#ff0000",name:"red"},{color:"#c0c0c0",name:"silver"},{color:"#ffffff",name:"white"}];class ColorStore extends EventEmitter{constructor(){super();this.colors={boolean:"#f00",number:"#fff",plant:"#65e2a0",vec3:"#6363C7"},this.index=0}setType(e){e in this.colors||(this.colors[e]=COLORS[this.index].color,this.index++),this.emit(e,this.colors[e])}on(e,n){return this.setType(e),n(this.colors[e]),super.on(e,n)}}class NodeSystemView extends EventEmitter{constructor(e){super();var n,s,i,r;this.colorStore=new ColorStore,this.width=0,this.height=0,this.top=0,this.left=0,this.x=window.innerWidth/2,this.y=window.innerHeight/2,this.s=1,this.mx=0,this.my=0,this.mdx=0,this.mdy=0,this.rmx=0,this.rmy=0,this.mouseDown=!1,this.keyMap={},this.selectedNodes=[],this.selectedNodesDown=[],this.clipboard=[],this.system=e,this.wrapper=(s=(n=e.options)==null?void 0:n.wrapper)!=null?s:document.createElement("div"),this.wrapper.classList.add("nodesystem-wrapper"),e.options.parent&&e.options.parent.appendChild(this.wrapper),this.transformWrapper=document.createElement("div"),this.transformWrapper.classList.add("nodesystem-transform"),this.wrapper.appendChild(this.transformWrapper),this.nodeContainer=document.createElement("div"),this.nodeContainer.classList.add("nodes-container"),this.transformWrapper.append(this.nodeContainer),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("viewBox","0 0 1 1"),this.svg.setAttribute("height","1"),this.svg.setAttribute("width","1"),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.style.transform=`scale(${(i=window.devicePixelRatio)!=null?i:1})`,this.transformWrapper.appendChild(this.svg),this.addMenu=new RightClickMenu(this),this.boxSelection=new BoxSelectionView(this),this.boxSelection.on("selection",c=>{this.selectedNodes=c}),this.dpr=(r=window.devicePixelRatio)!=null?r:1,this.bindEventListeners(),this.handleResize()}createFloatingConnection(e){new FloatingConnectionView(e,{x:this.mx,y:this.my}).once("connection",({inputNode:s,outputNode:i,keyIn:r,indexOut:c})=>{i.connectTo(s,c,r)})}setActive(e,{shiftKey:n=!1,ctrlKey:s=!1}={}){if(!e)this.activeNode&&(this.activeNode.view.state="normal",this.activeNode=void 0),this.selectedNodes.forEach(i=>i.view.state="normal"),this.selectedNodes=[];else if(n&&s){if(this.activeNode&&(this.activeNode.view.state="normal",this.activeNode=void 0),this.activeNode=e,this.activeNode.view.state="active",this.activeNode.outputs.length){const i=this.system.createNode({state:{},attributes:{type:"debug",id:"0",name:"debug",refs:[],pos:{x:this.activeNode.view.x+this.activeNode.view.width+10,y:this.activeNode.view.y}}});i.enableUpdates=!0,this.activeNode.connectTo(i,0,"input")}}else n?this.activeNode?(this.selectedNodes.push(this.activeNode),this.activeNode.view.state="selected",this.activeNode=e,this.activeNode.view.state="active"):(this.activeNode=e,this.activeNode.view.state="active"):this.activeNode?(this.selectedNodes.forEach(i=>i.view.state="normal"),this.selectedNodes=[],this.activeNode!==e&&(this.activeNode.view.state="normal",this.activeNode=e,this.activeNode.view.state="active")):(this.activeNode=e,this.activeNode.view.state="active")}getSelectedNodes(){return this.activeNode&&this.selectedNodes.includes(this.activeNode)?this.selectedNodes:this.activeNode?[...this.selectedNodes,this.activeNode]:[...this.selectedNodes]}projectLocalToWindow(e,n){const s=e+this.x,i=n+this.y,r=s*this.s,c=i*this.s;return{x:r,y:c}}projectWindowToLocal(e,n){const s=e-this.x,i=n-this.y,r=s/this.s,c=i/this.s;return{x:r,y:c}}setTransform({x:e=this.x,y:n=this.y,s=this.s}={}){this.x=e,this.y=n,this.s=s/this.dpr,this.panzoom.setTransform(e,n,s/this.dpr)}bindEventListeners(){window.addEventListener("keydown",e=>this.handleKeyDown(e)),window.addEventListener("keyup",e=>this.handleKeyUp(e)),this.wrapper.addEventListener("mousemove",e=>this.handleMouseMove(e)),this.wrapper.addEventListener("contextmenu",e=>{e.preventDefault(),this.addMenu.show({x:this.rmx,y:this.rmy}).then(n=>{this.system.createNode(n)}).catch()}),this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e)),this.wrapper.addEventListener("touchdown",e=>this.handleMouseDown(e)),this.wrapper.addEventListener("mouseup",e=>this.handleMouseUp(e)),window.addEventListener("resize",throttle(()=>this.handleResize(),10)),this.panzoom=createPanZoom(this.transformWrapper,{minZoom:.2,maxZoom:5,onTransform:({x:e,y:n,scale:s})=>{this.x=e,this.y=n,this.s=s,this.wrapper.style.backgroundPosition=`${e}px ${n}px`,this.wrapper.style.backgroundSize=s*this.height*.02+"% "+s*this.width*.02+"%",this.wrapper.style.backgroundOrigin=`${e}px ${n}px`,window.t={x:e,y:n,s},this.system.setMetaData({transform:{x:e,y:n,s}})}})}handleResize(){const{width:e,height:n,top:s,left:i}=this.wrapper.getBoundingClientRect();this.width=e,this.height=n,this.top=s,this.left=i,this.emit("resize",{width:e,height:n})}handleMouseMove(e){this.ev=e;const{clientX:n,clientY:s,shiftKey:i,ctrlKey:r}=e;this.rmx=n-this.left,this.rmy=s-this.top;const{x:c,y:d}=this.projectWindowToLocal(this.rmx,this.rmy);this.mx=c,this.my=d,this.emit("mousemove",{x:c,y:d,mx:this.rmx,my:this.rmy,keys:z(V({},this.keyMap),{shiftKey:i,ctrlKey:r})})}handleMouseDown(e){const{shiftKey:n,ctrlKey:s,clientX:i,clientY:r,button:c,target:d}=e;n||this.setActive(),[...e.path].includes(this.addMenu.wrapper)||(this.addMenu.hide(),e.preventDefault()),this.mouseDown=!0,this.rmx=i-this.left,this.rmy=r-this.top;const{x:u,y:f}=this.projectWindowToLocal(this.rmx,this.rmy);this.mx=u,this.my=f,this.selectedNodesDown=this.selectedNodes.map(h=>[h.view.x,h.view.y]),this.emit("mousedown",{x:u,y:f,mx:this.rmx,my:this.rmy,target:d,keys:z(V({},this.keyMap),{shiftKey:n,ctrlKey:s,button:c})})}handleMouseUp({clientX:e,clientY:n,shiftKey:s,ctrlKey:i}){this.mouseDown=!1;const r=e-this.left,c=n-this.top;this.emit("mouseup",{x:r,y:c,keys:z(V({},this.keyMap),{shiftKey:s,ctrlKey:i})})}handleKeyUp({key:e}){e===" "&&(e="space"),delete this.keyMap[e&&e.toLowerCase()],this.emit("keyup",{key:e,keys:this.keyMap})}handleKeyDown({key:e,ctrlKey:n,shiftKey:s}){switch(e=e===" "?"space":e.toLowerCase(),this.keyMap[e&&e.toLowerCase()]=!0,e==="space"&&this.ev&&this.handleMouseDown(this.ev),e){case"escape":this.addMenu.hide();break;case"a":s&&this.addMenu.show({x:this.rmx,y:this.rmy}).then(i=>{this.system.createNode(i)}).catch();break;case"c":if(s&&n)localStorage.clear(),window.location.reload();else if(n){const i=this.selectedNodes.splice(0);this.activeNode&&!i.includes(this.activeNode)&&i.push(this.activeNode),this.clipboard=i.map(r=>r.deserialize())}else this.selectedNodes.length&&this.activeNode&&this.selectedNodes[0].connectTo(this.activeNode);break;case"f":this.setTransform({x:0,y:0,s:1});break;case"g":this.keyMap.g||(this.mdx=this.mx,this.mdy=this.my,this.selectedNodesDown=this.selectedNodes.map(i=>[i.view.x,i.view.y]));break;case"x":this.activeNode&&(n?this.system.spliceNode(this.activeNode):this.system.removeNode(this.activeNode)),this.selectedNodes.forEach(i=>i.remove());break;case"y":this.system.history&&n&&this.system.history.redo();break;case"z":this.system.history&&n&&this.system.history.undo();break;case"l":this.activeNode&&(console.log(this.activeNode),console.log(this.activeNode.deserialize()));break;case"v":if(n){const i=this.clipboard.sort((f,h)=>{const{pos:{x:m=0,y:_=0}={}}=f.attributes,{pos:{x:v=0,y:g=0}={}}=h.attributes;return m+_<v+g?-1:1});let{pos:{x:r=0,y:c=0}={}}=i[0].attributes;const{x:d,y:u}=this.projectWindowToLocal(this.mx,this.my);r-=d,c-=u,this.clipboard.map(f=>{const{pos:{x:h=0,y:m=0}={}}=f.attributes;return f.attributes.pos={x:h-r,y:m-c},f}).forEach(f=>this.system.createNode(f))}break}this.emit("keydown",{key:e,keys:z(V({},this.keyMap),{ctrlKey:n})})}}class NodeFactory{constructor(e){this.id=genId(),this.system=e,this.log=new Logger(this),this.log.info("Initialized")}reset(){this.id.reset(),this.log.info("Reset id generator")}create(e){const{attributes:n}=e,s=n.type.toLowerCase(),i=this.system.store.getByName(s);n.id=this.id(+n.id);const r=new i.node(this.system,e);if(this.system.options.view&&i.view){const c=new i.view(r);r.bindView(c)}return s==="output"&&this.system.setOutputNode(r),this.log.info(`Created node with type ${n.type}`,e),r}}class NodeHistory{constructor(e){this.system=e,this.history=[],this.historyIndex=-1,this.isApplyingChanges=!1,this.log=new Logger(this),this.log.info("Instantiated"),this.addAction=(()=>{let n;return()=>{!this.system.isLoaded||this.isApplyingChanges||(n?clearTimeout(n):this.prevState=this.system.serialize().nodes,n=setTimeout(()=>{this._addAction(),n=!1},200))}})().bind(this)}_addAction(){if(this.log.info("Register History Step"),this.isApplyingChanges)return;this.historyIndex!==this.history.length-1&&(this.history.length=this.historyIndex+1);const e=this.system.serialize().nodes,[n,s]=diffBoth(this.prevState,e);!s||!n||(this.history.push({previous:s,next:n}),this.history.length>60&&(this.history=this.history.reverse().slice(0,60).reverse()),this.historyIndex=this.history.length-1)}serialize(){return{steps:this.history,index:this.historyIndex}}deserialize(e){this.historyIndex=e.index,this.history=e.steps}undo(){if(this.isApplyingChanges)return;if(this.isApplyingChanges=!0,this.historyIndex<0){this.log.info("Reached beginning of Stack"),this.isApplyingChanges=!1;return}const{previous:e}=this.history[this.historyIndex],n=this.system.serialize(),s=mergeObjects(n.nodes,e);n.nodes=s,this.system.load(n),this.historyIndex--,this.isApplyingChanges=!1}redo(){if(this.isApplyingChanges)return;if(this.isApplyingChanges=!0,this.historyIndex>=this.history.length-1){this.log.info("Reached end of Stack"),this.isApplyingChanges=!1;return}const{next:e}=this.history[this.historyIndex+1],n=this.system.serialize(),s=mergeObjects(n.nodes,e);n.nodes=s,this.system.load(n),this.historyIndex++,this.isApplyingChanges=!1}}class NodeParser{constructor(o){this.system=o}parseSystem(o){const{nodes:e}=o,n=new Map,s=e.map(i=>{const r=this.system.factory.create(i);return r.enableUpdates=!1,n.set(r.id,r),r});return s.forEach(i=>{i.attributes.refs&&i.attributes.refs.forEach(r=>{const c=n.get(r.id);if(!c)throw new Error(`Failed ref: from ${i.attributes.name||i.attributes.id} to ${r.id} `);i.connectTo(c,r.out,r.in)})}),s.forEach(i=>{i.enableUpdates=!0,i.update()}),s}parseType(typeData){const{compute,meta,outputs,title:name,parameters}=typeData,TempNode=eval(`(outputs, compute) => class ${name} extends Node {
      constructor(system, props) {
        super(system, props);
        if (compute) this.compute = compute;

        if (outputs) {
          const _outputs = Array.isArray(outputs) ? outputs : [outputs];
          this.outputs = _outputs.map((s) => new NodeOutput(this, s));
        }

        Object.entries(parameters).forEach(([key, template]) => {
          this.states[key] = new NodeState(this, key, template);
        });
      }
    }`)(outputs,compute,NodeState,NodeOutput,Node),inputs=Object.values(parameters).filter(o=>o.internal!==!0).map(o=>o.type);if(this.system.options.view){const o=class extends NodeView{constructor(n){super(n)}};return z(V({},typeData),{inputs,title:name,meta,node:TempNode,view:o})}return z(V({inputs},typeData),{title:name,meta,node:TempNode})}getData(){return{meta:this.system.meta,nodes:this.system.nodes.map(o=>o.deserialize())}}}const log$4=log$8("NodeTypeStore");class NodeTypeStore extends EventEmitter{constructor(){super();this.types=[],this.typeMap={}}add(e){log$4("register new type "+e.title,e),this.types=[...this.types.filter(n=>n.title.toLowerCase()!==e.title.toLowerCase()),e],this.typeMap[e.title.toLowerCase()]=e,this.emit("types",this.types),this.emit("type",e)}getByName(e){if(e in this.typeMap)return this.typeMap[e];throw new Error("NodeTypeStore: type "+e+" does not exist")}}var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(o,e,n,s)=>{for(var i=s>1?void 0:s?__getOwnPropDesc(e,n):e,r=o.length-1,c;r>=0;r--)(c=o[r])&&(i=(s?c(e,n,i):c(i))||i);return s&&i&&__defProp(e,n,i),i};let systemID=0;class NodeSystem extends EventEmitter{constructor(e={}){super();this.parser=new NodeParser(this),this.meta={lastSaved:Date.now()},this.isLoaded=!1,this.isPaused=!1,this.nodes=[],this.states=[],this.id=systemID++;const{view:n=!1,wrapper:s,defaultNodes:i=!1,registerNodes:r=!1,logLevel:c=5}=e;this.options={view:n,wrapper:s};try{if(this.log=new Logger(this,c),this.log.group(`Instantiated id:${this.id}`),this.store=new NodeTypeStore,this.factory=new NodeFactory(this),this.history=new NodeHistory(this),n&&(this.view=new NodeSystemView(this)),i){const d=[];i===!0?d.push(...Object.entries(types).map(u=>u[1])):Array.isArray(i)&&i.length&&i.forEach(u=>{typeof u=="string"&&u in types&&d.push(types[u])}),d.forEach(u=>this.registerNodeType(u))}r&&r.length&&r.forEach(this.registerNodeType.bind(this)),this.log.groupEnd()}catch(d){this.emit("error",{type:"init",error:d})}}get result(){return this._result}set result(e){this._result=e,this.isLoaded&&this.emit("result",e)}setMetaData(e){this.meta=V(V({},this.meta),e),this.save()}load(e){var n;try{this.isLoaded=!1,this.isPaused=!0,this.nodes.forEach(i=>i.enableUpdates=!1),this.nodes.forEach(i=>i.remove()),this.factory.reset();const s=this.parser.parseSystem(e);return this.addNodes(s),this.meta=e.meta||{lastSaved:0},this.meta.lastSaved=Date.now(),(n=this==null?void 0:this.view)==null||n.setTransform(this.meta.transform),this.log.info(`Loaded NodeSystemData with ${s.length} Nodes`,e),"history"in e&&this.history.deserialize(e.history),this.isPaused=!1,this.isLoaded=!0,this.result=this._result,this}catch(s){this.emit("error",{type:"loading",error:s})}}serialize(){return z(V({},this.parser.getData()),{history:this.history.serialize(),meta:this.meta})}save(){this.isLoaded&&(this.meta.lastSaved=Date.now(),this.log.info("save system",this.serialize()),this.emit("save",this.serialize()))}setOutputNode(e){this.outputNode&&this.outputNode.remove(),this.outputNode=e,e.on("computedData",n=>this.result=n)}addNodes(e){e.forEach(n=>this.addNode(n))}addNode(e){this.history.addAction(),this.nodes.push(e),this.save()}removeNode(e){this.history.addAction(),e.enableUpdates=!1,e.view.remove(),Object.values(e.states).forEach(n=>n.remove()),e.outputs.forEach(n=>n.remove()),e.getInputs().forEach(n=>n.remove()),this.nodes=this.nodes.filter(n=>n!==e),this.save(),this.log.info(`Removed Node id:${e.id} type:${e.attributes.type}`,e.deserialize())}spliceNode(e){const n=e.getInputs().map(i=>{var r;return(r=i==null?void 0:i.connection)==null?void 0:r.output}),s=e.outputs.map(i=>i.connections).flat().map(i=>i.input);for(let i=0;i<n.length;i++){const r=n[i],c=s[i];!c||!r||r.connectTo(c)}return this.removeNode(e)}getSockets(e){const n=this.nodes.map(s=>[...s.getSockets()]).flat();return e?n.filter(s=>s.type===e):n}getInputs(e){const n=this.nodes.map(s=>s.getInputs()).flat();return!e||e==="*"?n:n.filter(s=>s.type.includes("*")||s.type.includes(e))}getOutputs(e){const n=this.nodes.map(s=>s.outputs).flat();return!e||e.includes("*")?n:n.filter(s=>s.type==="*"||e.includes(s.type))}createNode(e){const n=this.factory.create(e);return this.addNode(n),this.save(),this.log.info(`Created new node id:${e.attributes.id} type:${e.attributes.type}`,e),n}getNodes(){return this.nodes}findNodeById(e){return this.nodes.filter(n=>n.id===e)[0]}getNodeTypes(){return this.store.types}registerNodeType(e){if("node"in e)this.store.add(e);else{const n=this.parser.parseType(e);this.store.add(n)}this.log.info(`Registered new nodeType type:${e.title}`,e)}}__decorateClass([Debounce(1e3)],NodeSystem.prototype,"save",1);const savedState=JSON.parse(localStorage.getItem("pt_local_state")),state=V({},savedState),set=debounce((o,e)=>{state[o]=e,localStorage.setItem("pt_local_state",JSON.stringify(state))},100,!1);var localState={get(o,e){var n;return state[o]=(n=state[o])!=null?n:e,state[o]},set},isNode=o=>typeof o=="object"&&"type"in o,uniqID=(()=>{let o=Math.random();return()=>(o=o>0?o-Math.random():o+Math.random(),o.toString().split(".")[1])})();const nodes={};_nodes.forEach(o=>{nodes[o.type]=o,"computeSkeleton"in o&&(o.computeSkeleton=memo(o.computeSkeleton)),"computeGeometry"in o&&(o.computeGeometry=memo(o.computeGeometry)),"computeValue"in o&&(o.computeValue=memo(o.computeValue))});function executeSkeletonNode(o,e){return o.type in nodes&&nodes[o.type].computeSkeleton?nodes[o.type].computeSkeleton(o.computedParameters,e):o.computedParameters}function executeGeometryNode(o,e){return o.type in nodes&&nodes[o.type].computeGeometry?nodes[o.type].computeGeometry(o.computedParameters,o.result,e):o.computedParameters}function executeValueNode(o,e,n){return o.type in nodes&&nodes[o.type].computeValue?nodes[o.type].computeValue(o.computedParameters,e,n):o.computedParameters}const walkSkeletonNode=(o,e)=>(o.computedParameters={},Object.entries(o.parameters).forEach(([n,s])=>{isNode(s)?o.computedParameters[n]=walkSkeletonNode(s,e):o.computedParameters[n]=s}),o.result=executeSkeletonNode(o,e),o),walkGeometryNode=(o,e)=>(o.computedParameters={},Object.entries(o.parameters).forEach(([n,s])=>{isNode(s)?o.computedParameters[n]=walkGeometryNode(s,e):o.computedParameters[n]=s}),o.result=V(V({},o.result),executeGeometryNode(o,e)),o),walkValueNode=(o,e,n)=>{var s;return o.computedParameters=(s=o.computedParameters)!=null?s:{},Object.entries(o.parameters).forEach(([i,r])=>{isNode(r)?o.computedParameters[i]=walkValueNode(r,e,n):o.computedParameters[i]=r}),executeValueNode(o,e,n)};let lastSettings="",lastCtx,currentNoise=0;const createContext=o=>{let e=0;noise.seed=0;let n=uniqID();return{handleParameter(s,i=1){return typeof s=="number"?s:isNode(s)?walkValueNode(s,this,i):s},n1d(s){return noise.n1d(currentNoise++*s)},getSetting(s){return o[s]},get settings(){return o},get seed(){return e},refresh(){currentNoise=0,(o==null?void 0:o.useRandomSeed)&&(e=Math.floor(Math.random()*1e5),noise.seed=e),n=uniqID()}}};var createContext$1=o=>{const e=JSON.stringify(o);return e!==lastSettings&&(lastSettings=e,lastCtx=createContext(o)),lastCtx.refresh(),lastCtx};const log$3=log$8("gen.plant");function plant(o,e){var d;log$3("-------- ~generator started~ --------");const n=performance.now(),s=createContext$1(e),i=walkSkeletonNode(o,s);log$3("final skeleton",i.result);const r=walkGeometryNode(i,s);log$3("final geometry",r);const{result:c}=r;if(c.instances){const u=(d=c.instances)==null?void 0:d.map(f=>convertInstancedGeometry(f)).flat();c.geometry=join(c.geometry,...u)}return log$3("generated in ",Math.floor((performance.now()-n)*10)/10,"ms"),c}function WorkerWrapper(){return new Worker("assets/webWorker.5d7c92aa.js",{type:"module"})}var worker=()=>{const o=WorkerWrapper(),e=wrap(o);let n=!1;async function s(i,r){if(n)return;n=!0;const c=await e.plant(i,r);return n=!1,c}return{plant:s}};let a=0;class Renderer extends EventEmitter{constructor({canvas:e,width:n,height:s,clearColor:i="ffffff",alpha:r=!1,camPos:c=[0,2,4]}={}){super();if(this.scene=new Transform,this.lastCamPos=new Vec3(0,0,0),this.canvas=e,(!n||!s)&&e){const d=e.getBoundingClientRect();n=d.width,s=d.height}this.renderer=new Renderer$1({canvas:e,width:n,premultipliedAlpha:!0,height:s,alpha:r,antialias:!0,dpr:1}),this.gl=this.renderer.gl,this.gl.clearColor(...convertHexToRGB(i),0),this.renderer.gl.canvas&&(this.canvas=this.renderer.gl.canvas),this.camera=new Camera(this.gl,{fov:70,aspect:n/s}),this.lastCamPos.set(c),this.camera.position.set(c),this.camera.lookAt(new Vec3(0,0,0)),e&&(this.controls=new Orbit(this.camera,{element:e,target:new Vec3(0,.2,0),maxPolarAngle:1.6,minDistance:.2,maxDistance:15,ease:.7,rotateSpeed:.5,inertia:.5})),this.bindEventlisteners(),e&&this.render()}setControlTarget(e){Number.isNaN(e.x)||(this.controlTarget||(this.controls.target=e),this.controlTarget=e)}setClearColor(e){this.gl.clearColor(...convertHexToRGB(e),1)}renderScene(e){this.renderer.render({scene:e,camera:this.camera})}render(){requestAnimationFrame(this.render.bind(this)),this.lastCamPos.equals(this.camera.position)||(this.lastCamPos.set(this.camera.position),this.emit("camPos",this.camera.position.toArray())),this.controlTarget&&(this.controlTarget.squaredDistance(this.controls.target)<5e-5?this.controls.target=this.controlTarget:this.controls.target.lerp(this.controlTarget,.05)),window.target=this.controls.target,this.controls.update(),this.renderer.render({scene:this.scene,camera:this.camera}),this.emit("perf",performance.now()-a),a=performance.now()}bindEventlisteners(){const e=throttle(()=>this.handleResize(),500);window.addEventListener("resize",()=>{this.canvas.classList.add("resizing"),e()})}handleResize(){let e=this.canvas.parentElement;e||(e=this.canvas);const{width:n,height:s}=e.getBoundingClientRect();this.renderer.setSize(n,s),this.camera.perspective({aspect:this.gl.canvas.width/this.gl.canvas.height}),this.canvas.classList.remove("resizing")}}var GroundShaderFrag=`precision highp float;precision highp int;
#define GLSLIFY 1
uniform float uTime;uniform sampler2D tMap;uniform vec3 uFogColor;uniform float uFogNear;uniform float uFogFar;uniform float texScale;varying vec2 vUv;varying vec4 vMVPos;varying vec3 vPos;void main(){vec3 tex=texture2D(tMap,vUv*texScale).rgb;float dist=length(vMVPos);float fog=smoothstep(uFogNear,uFogFar,dist);tex=mix(tex,uFogColor,fog);tex=mix(tex,uFogColor,smoothstep(0.0,-1.0,vPos.y));gl_FragColor.rgb=tex;}`,GroundShaderVert=`precision highp float;precision highp int;
#define GLSLIFY 1
attribute vec2 uv;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform float uTime;varying vec2 vUv;varying vec4 vMVPos;varying vec3 vPos;void main(){vUv=uv;vec3 pos=position;vPos=pos;vMVPos=modelViewMatrix*vec4(pos,1.0);gl_Position=projectionMatrix*vMVPos;}`,MatCapFrag=`#version 300 es
precision highp float;
#define varying in
#define texture2D texture
#define gl_FragColor FragColor
out vec4 FragColor;precision highp float;
#define GLSLIFY 1
uniform sampler2D tMap;varying vec4 vMVPos;vec3 normals(vec3 pos){vec3 fdx=dFdx(pos);vec3 fdy=dFdy(pos);return normalize(cross(fdx,fdy));}vec2 matcap(vec3 eye,vec3 normal){vec3 reflected=reflect(eye,normal);float m=2.8284271247461903*sqrt(reflected.z+1.0);return reflected.xy/m+0.5;}void main(){vec3 normal=normals(vMVPos.xyz);vec3 mat=texture2D(tMap,matcap(normalize(vMVPos.xyz),normal)).rgb;gl_FragColor.rgb=mat;gl_FragColor.a=1.0;}`,MatCapVert=`#version 300 es
#define GLSLIFY 1
#define attribute in
#define varying out
attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;varying vec4 vMVPos;void main(){vMVPos=modelViewMatrix*vec4(position,1.0);gl_Position=projectionMatrix*vMVPos;}`,ParticleFrag=`precision highp float;
#define GLSLIFY 1
float pointSize=0.02;varying float distToCamera;void main(){vec2 uv=gl_PointCoord.xy;float dist=2.0-distToCamera;float circle=pointSize*dist>length(uv-0.5)?0.8:0.0;float xMask=min(abs(uv.x-0.5),abs(uv.y-0.5));circle=xMask>0.003?0.0:circle;gl_FragColor.rgb=vec3(0.0,0.0,0.0);gl_FragColor.a=circle;}`,ParticleVert=`#define GLSLIFY 1
attribute vec3 position;uniform mat4 modelMatrix;uniform mat4 viewMatrix;uniform mat4 projectionMatrix;varying float distToCamera;void main(){vec4 mPos=modelMatrix*vec4(position,1.0);vec4 mvPos=viewMatrix*mPos;gl_PointSize=300.0/length(mvPos.xyz);distToCamera=-mvPos.z/10.0+1.0;gl_Position=projectionMatrix*mvPos;}`,WireFrameFrag=`precision highp float;precision highp int;
#define GLSLIFY 1
void main(){gl_FragColor=vec4(1.,.9,.4,.7);}`,WireFrameVert=`precision highp float;precision highp int;
#define GLSLIFY 1
attribute vec2 uv;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat3 normalMatrix;void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}`;const GroundShader={fragment:GroundShaderFrag,vertex:GroundShaderVert},WireFrameShader={fragment:WireFrameFrag,vertex:WireFrameVert},ParticleShader={fragment:ParticleFrag,vertex:ParticleVert},MatCapShader=o=>{const e=new Texture(o),n=new Image;return n.onload=()=>e.image=n,n.src="assets/matcap_green.jpg",new Program(o,{vertex:MatCapVert,fragment:MatCapFrag,uniforms:{tMap:{value:e}},cullFace:null})},webWorker=worker(),renderer=new Renderer({width:100,height:100,alpha:!0,clearColor:"000"}),nodeSystem$1=new NodeSystem({view:!1,defaultNodes:!1,registerNodes:_nodes}),mesh=new Mesh(renderer.gl,{geometry:new Box(renderer.gl,{width:0,height:0,depth:0}),program:MatCapShader(renderer.gl)}),renderCanvas=document.createElement("canvas");renderCanvas.width=renderCanvas.height=100;const ctx=renderCanvas.getContext("2d");mesh.setParent(renderer.scene);async function renderProject({pd:o,geo:e}){nodeSystem$1.load(o);const n=nodeSystem$1.result;let s;if(e&&(s=e),o&&!s&&(s=(await(await webWorker).plant(n,{stemResX:12,stemResY:12})).geometry),!s)return;mesh.geometry=transferToGeometry(renderer.gl,s),mesh.geometry.computeBoundingBox(),renderer.camera.position.x=mesh.geometry.bounds.center.x,renderer.camera.position.y=mesh.geometry.bounds.center.y;const r=(mesh.geometry.bounds.max.y-mesh.geometry.bounds.center.y)*2/2/Math.tan(Math.PI*renderer.camera.fov/360);renderer.camera.position.z=r,renderer.camera.lookAt(mesh.geometry.bounds.center),renderer.renderScene(renderer.scene),ctx.clearRect(0,0,100,100);for(let c=0;c<1;c++)ctx.drawImage(renderCanvas,0,0),ctx.drawImage(renderer.canvas,0,0),ctx.filter="blur(7px) opacity(0.6) brightness(0.95)";return ctx.filter="blur(0px) drop-shadow(0px 0px 10px rgba(0, 0, 0, 0.8))",ctx.drawImage(renderer.canvas,0,0),renderCanvas.toDataURL("image/webp",1)}class BrowserInfo{constructor(e,n,s){this.name=e,this.version=n,this.os=s,this.type="browser"}}class NodeInfo{constructor(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}}class SearchBotDeviceInfo{constructor(e,n,s,i){this.name=e,this.version=n,this.os=s,this.bot=i,this.type="bot-device"}}class BotInfo{constructor(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}class ReactNativeInfo{constructor(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}const SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(o){return o?parseUserAgent(o):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new ReactNativeInfo:typeof navigator!="undefined"?parseUserAgent(navigator.userAgent):getNodeVersion()}function matchUserAgent(o){return o!==""&&userAgentRules.reduce((e,[n,s])=>{if(e)return e;const i=s.exec(o);return!!i&&[n,i]},!1)}function parseUserAgent(o){const e=matchUserAgent(o);if(!e)return null;const[n,s]=e;if(n==="searchbot")return new BotInfo;let i=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);i?i.length<REQUIRED_VERSION_PARTS&&(i=[...i,...createVersionParts(REQUIRED_VERSION_PARTS-i.length)]):i=[];const r=i.join("."),c=detectOS(o),d=SEARCHBOT_OS_REGEX.exec(o);return d&&d[1]?new SearchBotDeviceInfo(n,r,c,d[1]):new BrowserInfo(n,r,c)}function detectOS(o){for(let e=0,n=operatingSystemRules.length;e<n;e++){const[s,i]=operatingSystemRules[e];if(i.exec(o))return s}return null}function getNodeVersion(){return typeof process!="undefined"&&process.version?new NodeInfo(process.version.slice(1)):null}function createVersionParts(o){const e=[];for(let n=0;n<o;n++)e.push("0");return e}function getBrowser(){return"window"in globalThis}let _user={};(()=>{"sessionStorage"in globalThis||(globalThis.sessionStorage={getItem:o=>{},setItem:(o,e)=>{}})})();if("user"in sessionStorage)try{_user=JSON.parse(sessionStorage.getItem("user"))}catch{}const user$1=writable(_user);user$1.subscribe(o=>{sessionStorage.setItem("user",JSON.stringify(o))});const userStore=user$1,{VITE_API_URL="http://localhost:3000"}={VITE_API_URL:"https://plant-api.jim-fx.com",BASE_URL:"",MODE:"production",DEV:!1,PROD:!0};function parseJwt(o){const n=o.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}const browser=getBrowser(),store$1=(()=>{let o=browser&&localStorage.getItem("token");function e(){if(!o||o.length<10){userStore.set({});return}const n=parseJwt(o);userStore.set({username:n.username,id:n.sub})}return e(),{set token(n){o=n,browser&&localStorage.setItem("token",n),e()},get token(){return o}}})();async function send({method:o,path:e,data:n,isJSON:s=!0}){const i={method:o,headers:{}};n&&(i.headers["Content-Type"]="application/json",i.body=JSON.stringify(n)),store$1.token&&(i.headers["access-token"]=`Bearer ${store$1.token}`);const r=await fetch(`${VITE_API_URL}/${e}`,i);if(r.ok){if(s)try{return await r.json()}catch(d){console.error("Response from "+e+" failed to parse"),console.error(d)}return r.text()}const c=await r.json();return console.error(c),c}function get(o,e={}){return send(V({method:"GET",path:o},e))}function del(o){return send({method:"DELETE",path:o})}function post(o,e){return send({method:"POST",path:o,data:e})}function getReport(o){return send({method:"GET",path:`api/report/${o}`})}function publishReport(o){return send({method:"PUT",path:`api/report/${o}/publish`})}function unpublishReport(o){return send({method:"PUT",path:`api/report/${o}/unpublish`})}function getAvailableLabels(){return send({method:"GET",path:"api/report/labels"})}function setReportLabels(o,e){return send({method:"PUT",path:`api/report/${o}`,data:{labels:e}})}var admin=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getReport,publishReport,unpublishReport,getAvailableLabels,setReportLabels});async function login(o,e){const n=await post("api/auth/login",{username:o,password:e});store$1.token=n.access_token}function logout(){store$1.token=""}function submitReport(o){return send({method:"POST",path:"api/report",data:o})}function deleteReport(o){return del(`api/report/${o}`)}async function getRole(){const o=await get("api/user/role",{isJSON:!1});return userStore.update(e=>(e.role=o,e)),o}async function getPermission(){const o=await get("api/user/permission");return userStore.update(e=>(e.permissions=o,e)),o}var user=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",login,logout,submitReport,deleteReport,getRole,getPermission});V(V({},admin),user);const log$2=log$8("ProjectManager"),PTP_PREFIX="pt_project_";class ProjectManager extends EventEmitter{constructor(){super();this.activeProject=writable(),this.projects={},this.store=writable([]),this.loadProjects()}createNewProject(){const e=Object.values(this.projects).filter(s=>/^DefaultProject((\d)+)?/.test(s.meta.name)).length,n={meta:{name:"DefaultProject"+(e||""),id:shortid(),transform:{x:0,y:0,s:1}},nodes:[{attributes:{pos:{x:-100,y:0},type:"stem",id:"1",refs:[{id:"0",in:"main",out:0}]}},{attributes:{pos:{x:0,y:0},type:"output",id:"0",refs:[]}}]};return log$2("created new plant",n),n}createNew(){const e=this.createNewProject();this.emit("new",e),this.saveProject(e)}async updateProjectMeta(e,n){const s=await this.getProject(e);s.meta=V(V({},s.meta),n),log$2("update meta",e),this.emit("update",s),this.saveProject(s)}async saveProject(e){var s;const n=JSON.parse(JSON.stringify(e));this.projects[n.meta.id]=n,this.emit("save",n),((s=n==null?void 0:n.meta)==null?void 0:s.thumbnail)||this.renderThumbnail({project:n}),await storage.setItem("pt_project_ids",Object.keys(this.projects)),await storage.setItem(PTP_PREFIX+n.meta.id,n),log$2("saved plant id: ",n.meta.id),this.store.set(Object.values(this.projects))}async getProject(e){if(e in this.projects)return this.projects[e];const n=await storage.getItem(PTP_PREFIX+e);return this.projects[e]=n,n}async deleteProject(e){e in this.projects?(delete this.projects[e],await storage.removeItem(PTP_PREFIX+e),await storage.setItem("pt_project_ids",Object.keys(this.projects)),this.store.set(Object.values(this.projects)),this.emit("delete",e),log$2("deleted project with id: "+e)):log$2.warn("cant delete project with id: "+e)}async setActiveProject(e){if(this.loadingActiveProject&&await this.loadingActiveProject,e===this.activeProjectId)return;this.activeProjectId=e,this.loadingActiveProject=this.getProject(e);const n=await this.loadingActiveProject;this.loadingActiveProject?(this.activeProjectId=e,this.saveProject(n),this.activeProject.set(n),await storage.setItem("pt_active_id",e),log$2("set active project to id: "+e),this.emit("load",n),delete this.loadingActiveProject):log$2.warn("cant find plant with id: "+e)}async renderThumbnail({project:e,geo:n}){var d;const s=((d=e==null?void 0:e.meta)==null?void 0:d.id)||this.activeProjectId;if(!(s in this.projects))return;const i=performance.now(),r=await renderProject(n?{geo:n}:{pd:e}),c=performance.now()-i;this.projects[s].meta.thumbnail=r,log$2("generated thumbnail for "+s+" in "+Math.floor(c)+"ms"),this.saveProject(this.projects[s]),this.store.set(Object.values(this.projects))}async loadProjects(){const e=await storage.getItem("pt_project_ids")||[];log$2("loaded project ids",e);const n=await storage.getItem("pt_active_id");if(!e.length){const s=this.createNewProject();e.push(s.meta.id),await this.saveProject(s)}await Promise.all(e.map(async s=>{const i=await this.getProject(s);log$2("loaded ",s),this.projects[s]=i})),n&&e.includes(n)?this.setActiveProject(n):this.setActiveProject(e[0]),this.store.set(Object.values(this.projects))}setProject(e){this.plant=e,this.emit("plant",e)}getActiveProject(){return this.plant}setSettings(e){this.emit("settings",e)}}var Project_svelte_svelte_type_style_lang="";function create_fragment$f(o){let e,n,s,i,r,c,d,u,f,h=time(Date.now()-o[0].meta.lastSaved)+"",m,_,v,g,y,b,w,S,k;return{c(){e=element("div"),n=element("div"),s=space(),i=element("div"),r=element("div"),c=element("input"),u=space(),f=element("p"),m=text(h),_=text(" ago"),v=space(),g=element("div"),y=space(),b=element("div"),w=element("button"),w.textContent="delete",attr(n,"class","project-image svelte-cu2aw0"),set_style(n,"background-image","url("+o[0].meta.thumbnail+")"),attr(c,"contenteditable",""),c.value=d=o[0].meta.name,attr(c,"class","svelte-cu2aw0"),attr(f,"class","svelte-cu2aw0"),attr(r,"class","project-content-header svelte-cu2aw0"),attr(g,"class","project-content-main svelte-cu2aw0"),attr(w,"class","delete svelte-cu2aw0"),attr(b,"class","project-content-footer svelte-cu2aw0"),attr(i,"class","project-content svelte-cu2aw0"),attr(e,"class","project-wrapper svelte-cu2aw0"),toggle_class(e,"active",o[0].meta.id===projectManager.activeProjectId||o[1])},m($,P){insert($,e,P),append(e,n),append(e,s),append(e,i),append(i,r),append(r,c),append(r,u),append(r,f),append(f,m),append(f,_),append(i,v),append(i,g),append(i,y),append(i,b),append(b,w),S||(k=[listen(c,"blur",o[3]),listen(c,"keydown",o[4]),listen(w,"click",stop_propagation(o[5])),listen(e,"resize",alert),listen(e,"click",o[6])],S=!0)},p($,[P]){P&1&&set_style(n,"background-image","url("+$[0].meta.thumbnail+")"),P&1&&d!==(d=$[0].meta.name)&&c.value!==d&&(c.value=d),P&1&&h!==(h=time(Date.now()-$[0].meta.lastSaved)+"")&&set_data(m,h),P&3&&toggle_class(e,"active",$[0].meta.id===projectManager.activeProjectId||$[1])},i:noop,o:noop,d($){$&&detach(e),S=!1,run_all(k)}}}function instance$c(o,e,n){let{project:s}=e,i=!1;function r(){return n(1,i=!0),setTimeout(()=>{n(1,i=!1)},100),!0}const c=function(){const h=this.value.split(`
`).join("").trim();projectManager.updateProjectMeta(s.meta.id,{name:h})},d=function(h){if(h.key==="Enter"){const m=this.value.split(`
`).join("").trim();this.blur(),h.preventDefault(),projectManager.updateProjectMeta(s.meta.id,{name:m})}},u=()=>projectManager.deleteProject(s.meta.id),f=()=>r()&&projectManager.setActiveProject(s.meta.id);return o.$$set=h=>{"project"in h&&n(0,s=h.project)},[s,i,r,c,d,u,f]}class Project extends SvelteComponent{constructor(e){super();init(this,e,instance$c,create_fragment$f,safe_not_equal,{project:0})}}var ProjectManagerView_svelte_svelte_type_style_lang="";function get_each_context$4(o,e,n){const s=o.slice();return s[9]=e[n],s}function create_else_block$2(o){let e;return{c(){e=element("div"),attr(e,"class","svelte-7wgw1o")},m(n,s){insert(n,e,s)},p:noop,d(n){n&&detach(e)}}}function create_if_block_2$3(o){let e,n,s;return{c(){e=element("input"),attr(e,"type","text"),attr(e,"class","search svelte-7wgw1o"),attr(e,"placeholder","Search")},m(i,r){insert(i,e,r),set_input_value(e,o[1]),n||(s=listen(e,"input",o[8]),n=!0)},p(i,r){r&2&&e.value!==i[1]&&set_input_value(e,i[1])},d(i){i&&detach(e),n=!1,s()}}}function create_if_block$5(o){let e,n,s=o[2],i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$4(get_each_context$4(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){e=element("div");for(let c=0;c<i.length;c+=1)i[c].c();attr(e,"class","project-list svelte-7wgw1o")},m(c,d){insert(c,e,d);for(let u=0;u<i.length;u+=1)i[u].m(e,null);n=!0},p(c,d){if(d&6){s=c[2];let u;for(u=0;u<s.length;u+=1){const f=get_each_context$4(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$4(f),i[u].c(),transition_in(i[u],1),i[u].m(e,null))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){c&&detach(e),destroy_each(i,c)}}}function create_if_block_1$4(o){let e,n;return e=new Project({props:{project:o[9]}}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&4&&(r.project=s[9]),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_each_block$4(o){let e=showProject(o[1],o[9]),n,s,i=e&&create_if_block_1$4(o);return{c(){i&&i.c(),n=empty()},m(r,c){i&&i.m(r,c),insert(r,n,c),s=!0},p(r,c){c&6&&(e=showProject(r[1],r[9])),e?i?(i.p(r,c),c&6&&transition_in(i,1)):(i=create_if_block_1$4(r),i.c(),transition_in(i,1),i.m(n.parentNode,n)):i&&(group_outros(),transition_out(i,1,1,()=>{i=null}),check_outros())},i(r){s||(transition_in(i),s=!0)},o(r){transition_out(i),s=!1},d(r){i&&i.d(r),r&&detach(n)}}}function create_fragment$e(o){let e,n,s,i,r,c,d,u,f,h;n=new ResizeObserver_1({}),n.$on("resize",o[6]);function m(y,b){return y[2].length>3?create_if_block_2$3:create_else_block$2}let _=m(o),v=_(o),g=o[0]&&create_if_block$5(o);return{c(){e=element("div"),create_component(n.$$.fragment),s=space(),i=element("div"),r=element("button"),r.innerHTML='<p class="svelte-7wgw1o">new</p>',c=space(),v.c(),d=space(),g&&g.c(),attr(r,"class","add-new svelte-7wgw1o"),attr(i,"class","header svelte-7wgw1o"),attr(e,"class","project-manager-wrapper svelte-7wgw1o"),attr(e,"style",`width: ${o[4]}px; height: ${o[5]}px;`)},m(y,b){insert(y,e,b),mount_component(n,e,null),append(e,s),append(e,i),append(i,r),append(i,c),v.m(i,null),append(e,d),g&&g.m(e,null),u=!0,f||(h=listen(r,"click",o[7]),f=!0)},p(y,[b]){_===(_=m(y))&&v?v.p(y,b):(v.d(1),v=_(y),v&&(v.c(),v.m(i,null))),y[0]?g?(g.p(y,b),b&1&&transition_in(g,1)):(g=create_if_block$5(y),g.c(),transition_in(g,1),g.m(e,null)):g&&(group_outros(),transition_out(g,1,1,()=>{g=null}),check_outros())},i(y){u||(transition_in(n.$$.fragment,y),transition_in(g),u=!0)},o(y){transition_out(n.$$.fragment,y),transition_out(g),u=!1},d(y){y&&detach(e),destroy_component(n),v.d(),g&&g.d(),f=!1,h()}}}function showProject(o,e){if(!o||o.length<1)return!0;const n=e.meta.name.toLowerCase();return o=o.toLowerCase(),!!(n.includes(o)||o.includes(n))}function instance$b(o,e,n){let s;const{store:i}=projectManager;component_subscribe(o,i,_=>n(2,s=_));let{visible:r}=e,c;const{width:d,height:u}=localState.get("projectManagerSize",{width:300,height:window.innerHeight/2}),f=_=>{r&&localState.set("projectManagerSize",{width:_.detail.clientWidth,height:_.detail.clientHeight})},h=()=>projectManager.createNew();function m(){c=this.value,n(1,c)}return o.$$set=_=>{"visible"in _&&n(0,r=_.visible)},[r,c,s,i,d,u,f,h,m]}class ProjectManagerView extends SvelteComponent{constructor(e){super();init(this,e,instance$b,create_fragment$e,safe_not_equal,{visible:0})}}var index$1="";const template={enableSync:{type:"boolean",defaultValue:!1},useRandomSeed:{type:"boolean",defaultValue:!1},theme:{type:"select",values:["dark","light"],defaultValue:"dark"},debug:{onlyDev:!0,options:{renderPerf:{type:"boolean",defaultValue:!1},generatePerf:{type:"boolean",defaultValue:!1},pd:{type:"boolean",defaultValue:!1},skeleton:{type:"boolean",defaultValue:!1},wireframe:{type:"boolean",defaultValue:!1},logLevel:{type:"number",min:0,max:2,defaultValue:1}}},background:{options:{grid:{label:"Show Grid",type:"boolean",defaultValue:!1},ground:{label:"Show Ground",type:"boolean",defaultValue:!0},resX:{onlyDev:!0,type:"number",min:8,max:64,step:1,defaultValue:8},resY:{onlyDev:!0,type:"number",min:8,max:64,step:1,defaultValue:16},scale:{type:"number",min:0,max:5,step:.1,defaultValue:1}}},leafRes:{onlyDev:!0,type:"number",min:3,max:12,step:1,defaultValue:2},stemResX:{onlyDev:!0,type:"number",min:3,max:32,step:1,defaultValue:3},stemResY:{onlyDev:!0,type:"number",min:3,max:64,step:1,defaultValue:32},isDev:{label:"Advanced",type:"boolean",defaultValue:!1}},log$1=log$8("SettingsManager"),templateToSettings=(o,e)=>{const n={};return Object.entries(o).forEach(([s,i])=>{var c;const r=e&&s in e?e[s]:void 0;"options"in i?n[s]=templateToSettings(i.options,r):n[s]=(c=r!=null?r:i.defaultValue)!=null?c:i.value}),n},resolveDeep=(o,e)=>{const n=e.shift();if(n&&n in o)return e.length?resolveDeep(o[n],e):o[n]},keyToPath=o=>o.includes(".")?o.split("."):[o];class SettingsManager extends EventEmitter{constructor(){super();this.settings={},this.store=writable(this.settings),this._save=debounce(()=>{storage.setItem("pt_settings",this.settings)},500,!1)}save(){var e,n,s;this.emit("settings",this.settings),log$8.setLevel((s=(n=(e=this.settings)==null?void 0:e.debug)==null?void 0:n.logLevel)!=null?s:2),this.store.set(this.settings),log$1("save settings",this.settings),this._save()}async loadFromLocal(){var n,s,i;const e=await storage.getItem("pt_settings")||{};this.settings=templateToSettings(template,e),log$8.setLevel((i=(s=(n=this.settings)==null?void 0:n.debug)==null?void 0:s.logLevel)!=null?i:2),this.store.set(this.settings),log$1("loaded settings from local",this.settings),this.emit("settings",this.settings)}set(e,n){const s=keyToPath(e);if(s.length>1){const i=s.pop(),r=resolveDeep(this.settings,s);r&&(r[i]=n)}else this.settings[s[0]]=n;log$1(`Set ${s}`,n),this.emit(s+".update",n),this.save()}get(e){return resolveDeep(this.settings,keyToPath(e))}getSettings(){return JSON.parse(JSON.stringify(this.settings))}}let index=0;const sections=localState.get("sections")||[];var sectionOpen=()=>{const o=index++;return{get(){return sections[o]||!1},set(e){sections[o]=e,localState.set("sections",sections)}}},SettingsSection_svelte_svelte_type_style_lang="";function get_each_context$3(o,e,n){const s=o.slice();return s[11]=e[n][0],s[12]=e[n][1],s}function create_if_block$4(o){let e,n,s,i,r;const c=[create_if_block_1$3,create_else_block_1],d=[];function u(f,h){return f[3].options?0:1}return n=u(o),s=d[n]=c[n](o),{c(){e=element("div"),s.c(),attr(e,"class","wrapper svelte-1glihwf")},m(f,h){insert(f,e,h),d[n].m(e,null),r=!0},p(f,h){let m=n;n=u(f),n===m?d[n].p(f,h):(group_outros(),transition_out(d[m],1,1,()=>{d[m]=null}),check_outros(),s=d[n],s?s.p(f,h):(s=d[n]=c[n](f),s.c()),transition_in(s,1),s.m(e,null))},i(f){r||(transition_in(s),add_render_callback(()=>{i||(i=create_bidirectional_transition(e,slide,{},!0)),i.run(1)}),r=!0)},o(f){transition_out(s),i||(i=create_bidirectional_transition(e,slide,{},!1)),i.run(0),r=!1},d(f){f&&detach(e),d[n].d(),f&&i&&i.end()}}}function create_else_block_1(o){let e,n=(o[3].label||o[2])+"",s,i,r,c,d;const u=[{value:o[1]},o[8](o[6])];var f=stateToComponent(o[6],o[1]);function h(m){let _={};for(let v=0;v<u.length;v+=1)_=assign(_,u[v]);return{props:_}}return f&&(r=new f(h()),r.$on("change",o[10])),{c(){e=element("p"),s=text(n),i=space(),r&&create_component(r.$$.fragment),c=empty()},m(m,_){insert(m,e,_),append(e,s),insert(m,i,_),r&&mount_component(r,m,_),insert(m,c,_),d=!0},p(m,_){(!d||_&12)&&n!==(n=(m[3].label||m[2])+"")&&set_data(s,n);const v=_&322?get_spread_update(u,[_&2&&{value:m[1]},_&320&&get_spread_object(m[8](m[6]))]):{};if(f!==(f=stateToComponent(m[6],m[1]))){if(r){group_outros();const g=r;transition_out(g.$$.fragment,1,0,()=>{destroy_component(g,1)}),check_outros()}f?(r=new f(h()),r.$on("change",m[10]),create_component(r.$$.fragment),transition_in(r.$$.fragment,1),mount_component(r,c.parentNode,c)):r=null}else f&&r.$set(v)},i(m){d||(r&&transition_in(r.$$.fragment,m),d=!0)},o(m){r&&transition_out(r.$$.fragment,m),d=!1},d(m){m&&detach(e),m&&detach(i),m&&detach(c),r&&destroy_component(r,m)}}}function create_if_block_1$3(o){let e,n;return e=new Section({props:{name:o[2],open:o[7].get(),$$slots:{default:[create_default_slot$2]},$$scope:{ctx:o}}}),e.$on("toggle",o[9]),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&4&&(r.name=s[2]),i&32779&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_else_block$1(o){let e;return{c(){e=element("p"),e.textContent="error"},m(n,s){insert(n,e,s)},p:noop,i:noop,o:noop,d(n){n&&detach(e)}}}function create_if_block_2$2(o){let e,n;return e=new SettingsSection({props:{path:o[0],value:o[12],key:o[11],template:o[3].options[o[11]]}}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&1&&(r.path=s[0]),i&2&&(r.value=s[12]),i&2&&(r.key=s[11]),i&10&&(r.template=s[3].options[s[11]]),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_each_block$3(o){let e,n,s,i;const r=[create_if_block_2$2,create_else_block$1],c=[];function d(u,f){return u[11]in u[3].options?0:1}return e=d(o),n=c[e]=r[e](o),{c(){n.c(),s=empty()},m(u,f){c[e].m(u,f),insert(u,s,f),i=!0},p(u,f){let h=e;e=d(u),e===h?c[e].p(u,f):(group_outros(),transition_out(c[h],1,1,()=>{c[h]=null}),check_outros(),n=c[e],n?n.p(u,f):(n=c[e]=r[e](u),n.c()),transition_in(n,1),n.m(s.parentNode,s))},i(u){i||(transition_in(n),i=!0)},o(u){transition_out(n),i=!1},d(u){c[e].d(u),u&&detach(s)}}}function create_default_slot$2(o){let e,n,s=Object.entries(o[1]),i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$3(get_each_context$3(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){for(let c=0;c<i.length;c+=1)i[c].c();e=empty()},m(c,d){for(let u=0;u<i.length;u+=1)i[u].m(c,d);insert(c,e,d),n=!0},p(c,d){if(d&11){s=Object.entries(c[1]);let u;for(u=0;u<s.length;u+=1){const f=get_each_context$3(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$3(f),i[u].c(),transition_in(i[u],1),i[u].m(e.parentNode,e))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){destroy_each(i,c),c&&detach(e)}}}function create_fragment$d(o){let e,n,s=(o[4].isDev||!o[3].onlyDev)&&create_if_block$4(o);return{c(){s&&s.c(),e=empty()},m(i,r){s&&s.m(i,r),insert(i,e,r),n=!0},p(i,[r]){i[4].isDev||!i[3].onlyDev?s?(s.p(i,r),r&24&&transition_in(s,1)):(s=create_if_block$4(i),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,()=>{s=null}),check_outros())},i(i){n||(transition_in(s),n=!0)},o(i){transition_out(s),n=!1},d(i){s&&s.d(i),i&&detach(e)}}}function instance$a(o,e,n){let s;const i=settingsManager.store;component_subscribe(o,i,g=>n(4,s=g));let{value:r}=e,{key:c}=e,{path:d=""}=e;d=d+(d.length?".":"")+c;let{template:u}=e,f=u;const h=sectionOpen(),m=g=>{const y=V({},g);return delete y.defaultValue,delete y.type,y},_=({detail:g})=>h.set(g),v=g=>settingsManager.set(d,g.detail);return o.$$set=g=>{"value"in g&&n(1,r=g.value),"key"in g&&n(2,c=g.key),"path"in g&&n(0,d=g.path),"template"in g&&n(3,u=g.template)},[d,r,c,u,s,i,f,h,m,_,v]}class SettingsSection extends SvelteComponent{constructor(e){super();init(this,e,instance$a,create_fragment$d,safe_not_equal,{value:1,key:2,path:0,template:3})}}function get_each_context$2(o,e,n){const s=o.slice();return s[2]=e[n][0],s[3]=e[n][1],s}function create_each_block$2(o){let e,n;return e=new SettingsSection({props:{key:o[2],value:o[3],template:template[o[2]]}}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,i){const r={};i&1&&(r.key=s[2]),i&1&&(r.value=s[3]),i&1&&(r.template=template[s[2]]),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_fragment$c(o){let e,n,s=Object.entries(o[0]),i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$2(get_each_context$2(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){for(let c=0;c<i.length;c+=1)i[c].c();e=empty()},m(c,d){for(let u=0;u<i.length;u+=1)i[u].m(c,d);insert(c,e,d),n=!0},p(c,[d]){if(d&1){s=Object.entries(c[0]);let u;for(u=0;u<s.length;u+=1){const f=get_each_context$2(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$2(f),i[u].c(),transition_in(i[u],1),i[u].m(e.parentNode,e))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){destroy_each(i,c),c&&detach(e)}}}function instance$9(o,e,n){let s;const i=settingsManager.store;return component_subscribe(o,i,r=>n(0,s=r)),[s,i]}class SettingsManagerView extends SvelteComponent{constructor(e){super();init(this,e,instance$9,create_fragment$c,safe_not_equal,{})}}var Final_svelte_svelte_type_style_lang="";function create_fragment$b(o){let e;return{c(){e=element("p"),e.textContent=`\u{1F389} Now you have all the knowledge to use the Plantarium. Have some fun with
  it.`,attr(e,"class","svelte-1h3eb6p")},m(n,s){insert(n,e,s)},p:noop,i:noop,o:noop,d(n){n&&detach(e)}}}class Final extends SvelteComponent{constructor(e){super();init(this,e,null,create_fragment$b,safe_not_equal,{})}}var Greeting_svelte_svelte_type_style_lang="";function create_fragment$a(o){let e,n,s,i,r,c,d,u;return i=new Icon({props:{name:"hand"}}),{c(){e=element("p"),n=text("Hey there "),s=element("span"),r=element("div"),create_component(i.$$.fragment),c=space(),d=element("p"),d.innerHTML=`Welcome to <b>Plantarium</b>, a tool for creating parametrized, procedural 3D
  plants.`,set_style(r,"display","contents"),set_style(r,"--stroke","#1a1a1a"),attr(s,"class","svelte-1tutruj"),attr(e,"class","svelte-1tutruj"),attr(d,"class","svelte-1tutruj")},m(f,h){insert(f,e,h),append(e,n),append(e,s),append(s,r),mount_component(i,r,null),insert(f,c,h),insert(f,d,h),u=!0},p:noop,i(f){u||(transition_in(i.$$.fragment,f),u=!0)},o(f){transition_out(i.$$.fragment,f),u=!1},d(f){f&&detach(e),destroy_component(i),f&&detach(c),f&&detach(d)}}}class Greeting extends SvelteComponent{constructor(e){super();init(this,e,null,create_fragment$a,safe_not_equal,{})}}const steps=[{title:"Tutorial",description:Greeting,options:{"lets go":()=>{}},type:"alert"},{description:`This is the <b>Plant View</b>, here you can explore the generated 3D model of your plant. 
      Try to change the view by:`,selector:".scene-wrapper",checks:[{description:"Clicking and dragging",setup:function(o,{c:e}){const n=document.querySelector(e.selector);n.getAttribute("setup")!=="true"&&(n.setAttribute("setup","true"),n.addEventListener("click",o,{once:!0}))}},{description:"Scrolling / Zooming",setup:(o,{c:e})=>{const n=document.querySelector(e.selector+"> canvas");n.getAttribute("setup")!=="true"&&(n.setAttribute("setup","true"),n.addEventListener("wheel",o,{once:!0,passive:!0}))}}]},{selector:"#nodesystem-view",description:"This is the <b>Node View</b>, here you define the way your plant looks. Try playing with some of the settings. If you are not so sure how this works, maybe visit the NodeTutorial"},{description:"This Button opens the project view",clickSelector:"header > div.left > div > div"},{description:"This is the ProjectView, here you can create/rename/delete projects.",selector:".project-manager-wrapper",checks:[{description:"create a new project",setup:(o,{pm:e})=>{e.once("new",o)}},{description:"rename the project",setup:(o,{pm:e})=>{e.once("update",o)}},{description:"delete the project",setup:(o,{pm:e})=>{e.once("delete",o)}}]},{description:"This Button opens the <b>Settings View</b>",clickSelector:"header > div.right > div:nth-child(2) .icon-wrapper"},{description:"This is the <b>SettingView</b>, here you can change some general settings.",selector:"header > div.right > div:nth-child(2) > div > div > div.wrapper.right.visible"},{description:"When you encounter something which doesnt work or you have an Idea for a new feature, use this button to report it.",clickSelector:"header > div.right > div:nth-child(1) > div"},{title:"Tutorial",description:Final,options:{"lets go":()=>{}},type:"alert"}];var store=writable(void 0),Tutor_svelte_svelte_type_style_lang="";function get_each_context$1(o,e,n){const s=o.slice();return s[14]=e[n],s[15]=e,s[16]=n,s}function create_if_block$3(o){let e,n,s,i,r,c,d,u,f=o[6].description+"",h,m,_,v,g,y=o[3]&&create_if_block_4(o);r=new Button({props:{icon:"cross"}}),r.$on("click",o[11]);let b=o[1]&&create_if_block_3(o),w=!o[4]&&create_if_block_2$1(o),S=o[0]&&o[5]&&create_if_block_1$2(o);return{c(){e=element("span"),y&&y.c(),n=space(),s=element("div"),i=element("div"),c=element("div"),create_component(r.$$.fragment),d=space(),u=element("p"),h=space(),b&&b.c(),m=space(),w&&w.c(),v=space(),S&&S.c(),set_style(c,"display","contents"),set_style(c,"--bg","transparent"),attr(i,"class","close-wrapper svelte-zb5b7g"),attr(u,"class","svelte-zb5b7g"),attr(s,"class","wrapper svelte-zb5b7g"),attr(s,"style",_=`left: ${o[8]}px; top: ${o[0].top+20}px;`),attr(e,"class","svelte-zb5b7g"),toggle_class(e,"isLeft",o[2]),toggle_class(e,"hasElement",!!o[5]),toggle_class(e,"hasClick",!!o[3])},m(k,$){insert(k,e,$),y&&y.m(e,null),append(e,n),append(e,s),append(s,i),append(i,c),mount_component(r,c,null),append(s,d),append(s,u),u.innerHTML=f,append(s,h),b&&b.m(s,null),append(s,m),w&&w.m(s,null),append(e,v),S&&S.m(e,null),g=!0},p(k,$){k[3]?y?(y.p(k,$),$&8&&transition_in(y,1)):(y=create_if_block_4(k),y.c(),transition_in(y,1),y.m(e,n)):y&&(group_outros(),transition_out(y,1,1,()=>{y=null}),check_outros()),(!g||$&64)&&f!==(f=k[6].description+"")&&(u.innerHTML=f),k[1]?b?(b.p(k,$),$&2&&transition_in(b,1)):(b=create_if_block_3(k),b.c(),transition_in(b,1),b.m(s,m)):b&&(group_outros(),transition_out(b,1,1,()=>{b=null}),check_outros()),k[4]?w&&(group_outros(),transition_out(w,1,1,()=>{w=null}),check_outros()):w?(w.p(k,$),$&16&&transition_in(w,1)):(w=create_if_block_2$1(k),w.c(),transition_in(w,1),w.m(s,null)),(!g||$&257&&_!==(_=`left: ${k[8]}px; top: ${k[0].top+20}px;`))&&attr(s,"style",_),k[0]&&k[5]?S?S.p(k,$):(S=create_if_block_1$2(k),S.c(),S.m(e,null)):S&&(S.d(1),S=null),$&4&&toggle_class(e,"isLeft",k[2]),$&32&&toggle_class(e,"hasElement",!!k[5]),$&8&&toggle_class(e,"hasClick",!!k[3])},i(k){g||(transition_in(y),transition_in(r.$$.fragment,k),transition_in(b),transition_in(w),g=!0)},o(k){transition_out(y),transition_out(r.$$.fragment,k),transition_out(b),transition_out(w),g=!1},d(k){k&&detach(e),y&&y.d(),destroy_component(r),b&&b.d(),w&&w.d(),S&&S.d()}}}function create_if_block_4(o){let e,n,s,i,r;return n=new Icon({props:{name:"pointing"}}),{c(){e=element("div"),s=element("div"),create_component(n.$$.fragment),set_style(s,"display","contents"),set_style(s,"--fill","#303030"),attr(e,"class","click-wrapper svelte-zb5b7g"),attr(e,"style",i=`top: ${o[0].top+20}px; left: ${o[8]-(o[2]?20:-0)}px;`)},m(c,d){insert(c,e,d),append(e,s),mount_component(n,s,null),r=!0},p(c,d){(!r||d&261&&i!==(i=`top: ${c[0].top+20}px; left: ${c[8]-(c[2]?20:-0)}px;`))&&attr(e,"style",i)},i(c){r||(transition_in(n.$$.fragment,c),r=!0)},o(c){transition_out(n.$$.fragment,c),r=!1},d(c){c&&detach(e),destroy_component(n)}}}function create_if_block_3(o){let e,n,s=o[1],i=[];for(let c=0;c<s.length;c+=1)i[c]=create_each_block$1(get_each_context$1(o,s,c));const r=c=>transition_out(i[c],1,1,()=>{i[c]=null});return{c(){e=element("div");for(let c=0;c<i.length;c+=1)i[c].c();attr(e,"class","checks-wrapper svelte-zb5b7g")},m(c,d){insert(c,e,d);for(let u=0;u<i.length;u+=1)i[u].m(e,null);n=!0},p(c,d){if(d&2){s=c[1];let u;for(u=0;u<s.length;u+=1){const f=get_each_context$1(c,s,u);i[u]?(i[u].p(f,d),transition_in(i[u],1)):(i[u]=create_each_block$1(f),i[u].c(),transition_in(i[u],1),i[u].m(e,null))}for(group_outros(),u=s.length;u<i.length;u+=1)r(u);check_outros()}},i(c){if(!n){for(let d=0;d<s.length;d+=1)transition_in(i[d]);n=!0}},o(c){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)transition_out(i[d]);n=!1},d(c){c&&detach(e),destroy_each(i,c)}}}function create_each_block$1(o){let e,n,s,i,r,c=o[14].description+"",d,u,f;function h(_){o[12](_,o[14])}let m={};return o[14]._isCompleted!==void 0&&(m.value=o[14]._isCompleted),n=new InputCheckbox({props:m}),binding_callbacks.push(()=>bind(n,"value",h)),{c(){e=element("div"),create_component(n.$$.fragment),i=space(),r=element("p"),d=text(c),u=space(),attr(r,"class","svelte-zb5b7g"),attr(e,"class","check-wrapper svelte-zb5b7g"),toggle_class(e,"is-completed",o[14]._isCompleted)},m(_,v){insert(_,e,v),mount_component(n,e,null),append(e,i),append(e,r),append(r,d),append(e,u),f=!0},p(_,v){o=_;const g={};!s&&v&2&&(s=!0,g.value=o[14]._isCompleted,add_flush_callback(()=>s=!1)),n.$set(g),(!f||v&2)&&c!==(c=o[14].description+"")&&set_data(d,c),v&2&&toggle_class(e,"is-completed",o[14]._isCompleted)},i(_){f||(transition_in(n.$$.fragment,_),f=!0)},o(_){transition_out(n.$$.fragment,_),f=!1},d(_){_&&detach(e),destroy_component(n)}}}function create_if_block_2$1(o){let e,n,s,i;return n=new Button({props:{name:"next"}}),n.$on("click",o[13]),{c(){e=element("div"),s=element("div"),create_component(n.$$.fragment),set_style(s,"display","contents"),set_style(s,"--text","white"),set_style(s,"--bg","#303030"),attr(e,"class","next-wrapper svelte-zb5b7g")},m(r,c){insert(r,e,c),append(e,s),mount_component(n,s,null),i=!0},p:noop,i(r){i||(transition_in(n.$$.fragment,r),i=!0)},o(r){transition_out(n.$$.fragment,r),i=!1},d(r){r&&detach(e),destroy_component(n)}}}function create_if_block_1$2(o){let e,n;return{c(){e=element("span"),attr(e,"class","highlighter  svelte-zb5b7g"),attr(e,"style",n=`width: ${o[0].width}px; height: ${o[0].height}px; left: ${o[0].left}px; top: ${o[0].top}px;`)},m(s,i){insert(s,e,i)},p(s,i){i&1&&n!==(n=`width: ${s[0].width}px; height: ${s[0].height}px; left: ${s[0].left}px; top: ${s[0].top}px;`)&&attr(e,"style",n)},d(s){s&&detach(e)}}}function create_fragment$9(o){let e,n,s=o[7]&&create_if_block$3(o);return{c(){s&&s.c(),e=empty()},m(i,r){s&&s.m(i,r),insert(i,e,r),n=!0},p(i,[r]){i[7]?s?(s.p(i,r),r&128&&transition_in(s,1)):(s=create_if_block$3(i),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,()=>{s=null}),check_outros())},i(i){n||(transition_in(s),n=!0)},o(i){transition_out(s),n=!1},d(i){s&&s.d(i),i&&detach(e)}}}function instance$8(o,e,n){let s,i,r,c,d,u,f,h,m,_,v;component_subscribe(o,store,w=>n(6,v=w));const g=()=>{n(7,_=!1)};function y(w,S){o.$$.not_equal(S._isCompleted,w)&&(S._isCompleted=w,n(1,m),n(6,v))}const b=()=>set_store_value(store,v._isCompleted=!0,v);return o.$$.update=()=>{if(o.$$.dirty&64&&v&&v.clickSelector){const w=document.querySelector(v.clickSelector);w&&w.getAttribute("setup")!=="true"&&(w.setAttribute("setup","true"),w.addEventListener("click",()=>{setTimeout(()=>{set_store_value(store,v._isCompleted=!0,v)},20)},{once:!0}))}o.$$.dirty&64&&n(10,s=v&&v.selector),o.$$.dirty&1024&&n(5,i=s&&document.querySelector(s)),o.$$.dirty&32&&n(9,r=i&&i.getBoundingClientRect()),o.$$.dirty&64&&n(4,c=v&&v.clickSelector&&document.querySelector(v.clickSelector)),o.$$.dirty&16&&n(3,d=c&&c.getBoundingClientRect()),o.$$.dirty&520&&n(0,u=r||d),o.$$.dirty&1&&n(2,f=u&&u.left+u.width>window.innerWidth-100),o.$$.dirty&5&&n(8,h=u&&(f?u.left-10:u.left+u.width+10)),o.$$.dirty&64&&n(1,m=v&&v.checks),o.$$.dirty&66&&m&&m.forEach((w,S)=>(w._isSetup||(w._isSetup=!0,w.setup(()=>{n(1,m[S]._isCompleted=!0,m),n(1,m),n(6,v)},{pm:projectManager,c:v})),w)),o.$$.dirty&1&&n(7,_=!!u)},[u,m,f,d,c,i,v,_,h,r,s,g,y,b]}class Tutor$1 extends SvelteComponent{constructor(e){super();init(this,e,instance$8,create_fragment$9,safe_not_equal,{})}}const affirmatives=["yes","next","lets go","okay"];let pm;const Tutor={handleReject:()=>{localState.set("hasViewedTutorial",!0),createToast("The tutorial is accessable under...")},currentIndex:0,previous:async function(){},next:async function(){var n;const o=steps[this.currentIndex];if(this.currentIndex===steps.length)return;if(o.setup&&await o.setup({pm}),store.set(o),this.currentIndex++,this.currentIndex>2&&localState.set("hasViewedTutorial",!0),o.title=(n=o.title)!=null?n:`Tutorial (${this.currentIndex}/${steps.length})`,o.type==="alert"){const s=await createAlert(o.description,{title:o.title,type:"success",values:o.options?Object.keys(o.options):void 0,timeout:0});if(affirmatives.includes(s.toString()))return this.next()}if(o.type==="toast"){const s=await createToast(o.description,{values:o.options?Object.keys(o.options):void 0,timeout:0});if(affirmatives.includes(s.toString()))return this.next()}const e=store.subscribe(s=>{s._isCompleted&&(e(),this.next())})},init:function({projectManager:o}){if(localState.get("hasViewedTutorial"))return;pm=o;const e=`It looks like this is your first time here...
    Want to take a little tour? `;setTimeout(async()=>{await createToast(e,{title:"",timeout:8e3,values:["nah","yes"]})==="yes"?this.next():this.handleReject()},1e4)},restart:function(){localState.set("hasViewedTutorial",!1),this.currentIndex=0,this.next()}},renderPerf=writable([]),generatePerf=writable([]),timers={},enabled={render:!1,generate:!1},times={render:renderPerf,generate:generatePerf};function start(o){timers[o]=performance.now()}function setSettings(o){var e,n;enabled.render=!!((e=o==null?void 0:o.debug)==null?void 0:e.renderPerf),enabled.generate=!!((n=o==null?void 0:o.debug)==null?void 0:n.generatePerf)}function add(o,e){(o in times?times[o]:writable([])).update(s=>(s.push(e),s.length>200&&s.shift(),s)),o in canvasUpdates&&canvasUpdates[o]()}function stop(o){var n;if(!enabled[o])return;const e=performance.now()-((n=timers[o])!=null?n:0);add(o,e)}const canvases={},canvasUpdates={};function createCanvas(o,e){e=e||canvases[o]||document.createElement("canvas"),canvases[o]=e;const n=200,s=100;e.width=n,e.height=s;const i=e.getContext("2d");canvasUpdates[o]=()=>{const r=[...get_store_value(times[o])],c=Math.max(...r);let d=0;const u=n/200;i.clearRect(0,0,n,s),i.fillStyle="rgba(255, 255, 255, 0.5)",i.fillRect(0,0,n,s);for(let f=0;f<r.length;f++){d+=r[f];const h=r[f]*(s/c);i.fillStyle="rgba(0, 0, 0, 0.5)",i.fillRect(f*u,s-h,u,h)}i.fillStyle="black",i.textAlign="left",i.fillText(o+"",10,10),i.textAlign="right",i.fillText(`avg: ${Math.floor(d/r.length*10)/10}ms max: ${Math.floor(c*10)/10}ms`,180,10)}}const settingsManager=new SettingsManager,projectManager=new ProjectManager;setTheme(settingsManager.get("theme"));setSettings(settingsManager.getSettings());settingsManager.on("enableSync.update",o=>{createToast(`${o?"Enabled":"Disabled"} sync`,{type:"success"})});settingsManager.on("theme.update",o=>{setTheme(o)});const nodeSystem=new NodeSystem({view:!0,defaultNodes:!1,registerNodes:_nodes});projectManager.on("load",o=>nodeSystem.load(o));nodeSystem.on("result",o=>projectManager.setProject(o),50);nodeSystem.on("save",o=>projectManager.saveProject(o));settingsManager.on("settings",o=>{projectManager.setSettings(o),setSettings(o)},50);Tutor.init({projectManager});const createGround=(o,e)=>{const{background:{scale:n=1,resX:s=16,resY:i=16}={}}=e||{},r=n!=null?n:0,c=s!=null?s:8,d=i!=null?i:8,u=ground(r,c,d);return transferToGeometry(o,u)};class BackgroundScene{constructor(e,n){this.scene=e,this.gl=e.renderer.gl,this.initMeshes(),n.on("settings",this.setSettings.bind(this)),this.setSettings(settingsManager.getSettings())}initMeshes(){const e=new Plane(this.gl),n=loader.texture(this.gl,"assets/rocky_dirt1-albedo.jpg",{wrapS:this.gl.REPEAT,wrapT:this.gl.REPEAT}),s=new Program(this.gl,{vertex:GroundShader.vertex,fragment:GroundShader.fragment,uniforms:{uTime:{value:0},tMap:{value:n},uFogColor:{value:new Color("#ffffff")},uFogNear:{value:10},uFogFar:{value:30},texScale:{value:1}}});this.ground=this.scene.addMesh({geometry:e,program:s});const i=(r=0)=>{requestAnimationFrame(i),s.uniforms.uTime.value=r};i()}setSettings(e){var n,s;this.settings=e,((n=e==null?void 0:e.background)==null?void 0:n.ground)&&(this.ground.geometry=createGround(this.gl,e)),this.ground.visible=!!((s=e==null?void 0:e.background)==null?void 0:s.ground)}}function create_fragment$8(o){let e,n,s=(o[1]?"<b>[NEW]</b>":"")+"",i,r=o[0].subject+"",c;return{c(){e=element("p"),n=new HtmlTag,i=space(),c=text(r),n.a=i},m(d,u){insert(d,e,u),n.m(s,e),append(e,i),append(e,c)},p(d,[u]){u&2&&s!==(s=(d[1]?"<b>[NEW]</b>":"")+"")&&n.p(s),u&1&&r!==(r=d[0].subject+"")&&set_data(c,r)},i:noop,o:noop,d(d){d&&detach(e)}}}function instance$7(o,e,n){let{commit:s}=e,{isNew:i=!1}=e;return o.$$set=r=>{"commit"in r&&n(0,s=r.commit),"isNew"in r&&n(1,i=r.isNew)},[s,i]}class Commit extends SvelteComponent{constructor(e){super();init(this,e,instance$7,create_fragment$8,safe_not_equal,{commit:0,isNew:1})}}const commits=writable([]);let lastUpdated=localState.get("lastUpdated",Date.now());function parseCommit(o){const e=Date.parse(o.date);return z(V({},o),{date:e,new:lastUpdated<e})}let commitPromise;async function _fetchCommits(){const e=await(await fetch("commits.json")).json();return lastUpdated=Date.now(),localState.set("lastUpdated",lastUpdated),e.map(n=>parseCommit(n))}const fetchCommits=async()=>{if(commitPromise)return commitPromise;commitPromise=_fetchCommits();const o=await commitPromise;commits.set(o)};var ChangeLog_svelte_svelte_type_style_lang="";function get_each_context(o,e,n){const s=o.slice();return s[4]=e[n],s}function create_if_block$2(o){let e,n=o[2](o[4].date)+"",s;return{c(){e=element("h3"),s=text(n),attr(e,"class","svelte-13vbnbr")},m(i,r){insert(i,e,r),append(e,s)},p(i,r){r&1&&n!==(n=i[2](i[4].date)+"")&&set_data(s,n)},d(i){i&&detach(e)}}}function create_each_block(o){let e=o[1](o[4]),n,s,i,r=e&&create_if_block$2(o);return s=new Commit({props:{commit:o[4]}}),{c(){r&&r.c(),n=space(),create_component(s.$$.fragment)},m(c,d){r&&r.m(c,d),insert(c,n,d),mount_component(s,c,d),i=!0},p(c,d){d&1&&(e=c[1](c[4])),e?r?r.p(c,d):(r=create_if_block$2(c),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null);const u={};d&1&&(u.commit=c[4]),s.$set(u)},i(c){i||(transition_in(s.$$.fragment,c),i=!0)},o(c){transition_out(s.$$.fragment,c),i=!1},d(c){r&&r.d(c),c&&detach(n),destroy_component(s,c)}}}function create_fragment$7(o){let e,n,s,i,r=o[0],c=[];for(let u=0;u<r.length;u+=1)c[u]=create_each_block(get_each_context(o,r,u));const d=u=>transition_out(c[u],1,1,()=>{c[u]=null});return{c(){e=element("h1"),e.textContent="Changelog",n=space(),s=element("div");for(let u=0;u<c.length;u+=1)c[u].c();attr(s,"class","svelte-13vbnbr")},m(u,f){insert(u,e,f),insert(u,n,f),insert(u,s,f);for(let h=0;h<c.length;h+=1)c[h].m(s,null);i=!0},p(u,[f]){if(f&7){r=u[0];let h;for(h=0;h<r.length;h+=1){const m=get_each_context(u,r,h);c[h]?(c[h].p(m,f),transition_in(c[h],1)):(c[h]=create_each_block(m),c[h].c(),transition_in(c[h],1),c[h].m(s,null))}for(group_outros(),h=r.length;h<c.length;h+=1)d(h);check_outros()}},i(u){if(!i){for(let f=0;f<r.length;f+=1)transition_in(c[f]);i=!0}},o(u){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)transition_out(c[f]);i=!1},d(u){u&&detach(e),u&&detach(n),u&&detach(s),destroy_each(c,u)}}}function instance$6(o,e,n){let s;component_subscribe(o,commits,d=>n(0,s=d)),fetchCommits();let i=s.length&&new Date(s[0].date).getDay();return[s,d=>{const u=new Date(d.date);return u.getDay()!=i?(i=u.getDay(),!0):!1},d=>new Date(d).toLocaleDateString()]}class ChangeLog extends SvelteComponent{constructor(e){super();init(this,e,instance$6,create_fragment$7,safe_not_equal,{})}}var HoverWindow_svelte_svelte_type_style_lang="";function create_default_slot$1(o){let e,n,s,i,r,c,d,u,f;function h(g){o[6](g)}let m={useActive:!0,icon:o[3],name:o[1]};o[0]!==void 0&&(m.active=o[0]),n=new Button({props:m}),binding_callbacks.push(()=>bind(n,"active",h));var _=o[4];function v(g){return{props:{visible:g[0]}}}return _&&(u=new _(v(o))),{c(){e=element("div"),s=element("div"),create_component(n.$$.fragment),c=space(),d=element("div"),u&&create_component(u.$$.fragment),set_style(s,"display","contents"),set_style(s,"--bg","transparent"),set_style(s,"--text",r=o[5]["text-color"]),attr(d,"class","wrapper svelte-1e2gb7"),toggle_class(d,"visible",o[0]),toggle_class(d,"right",o[2]),attr(e,"class","icon-wrapper svelte-1e2gb7"),toggle_class(e,"active",o[0])},m(g,y){insert(g,e,y),append(e,s),mount_component(n,s,null),append(e,c),append(e,d),u&&mount_component(u,d,null),f=!0},p(g,y){y&32&&r!==(r=g[5]["text-color"])&&set_style(s,"--text",r);const b={};y&8&&(b.icon=g[3]),y&2&&(b.name=g[1]),!i&&y&1&&(i=!0,b.active=g[0],add_flush_callback(()=>i=!1)),n.$set(b);const w={};if(y&1&&(w.visible=g[0]),_!==(_=g[4])){if(u){group_outros();const S=u;transition_out(S.$$.fragment,1,0,()=>{destroy_component(S,1)}),check_outros()}_?(u=new _(v(g)),create_component(u.$$.fragment),transition_in(u.$$.fragment,1),mount_component(u,d,null)):u=null}else _&&u.$set(w);y&1&&toggle_class(d,"visible",g[0]),y&4&&toggle_class(d,"right",g[2]),y&1&&toggle_class(e,"active",g[0])},i(g){f||(transition_in(n.$$.fragment,g),u&&transition_in(u.$$.fragment,g),f=!0)},o(g){transition_out(n.$$.fragment,g),u&&transition_out(u.$$.fragment,g),f=!1},d(g){g&&detach(e),destroy_component(n),u&&destroy_component(u)}}}function create_fragment$6(o){let e,n;return e=new Src({props:{$$slots:{default:[create_default_slot$1]},$$scope:{ctx:o}}}),e.$on("clickoutside",o[7]),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},p(s,[i]){const r={};i&319&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function instance$5(o,e,n){let s;component_subscribe(o,store$4,m=>n(5,s=m));let{name:i}=e,{right:r=!1}=e,{icon:c}=e,{component:d}=e,{visible:u=!1}=e;function f(m){u=m,n(0,u)}const h=()=>n(0,u=!1);return o.$$set=m=>{"name"in m&&n(1,i=m.name),"right"in m&&n(2,r=m.right),"icon"in m&&n(3,c=m.icon),"component"in m&&n(4,d=m.component),"visible"in m&&n(0,u=m.visible)},[u,i,r,c,d,s,f,h]}class HoverWindow extends SvelteComponent{constructor(e){super();init(this,e,instance$5,create_fragment$6,safe_not_equal,{name:1,right:2,icon:3,component:4,visible:0})}}var Report_svelte_svelte_type_style_lang="";function create_else_block(o){let e,n,s,i,r,c,d,u,f,h,m,_,v,g,y,b,w,S=o[0]==="bug"&&create_if_block_1$1(o);return v=new Button({props:{name:"Submit"}}),v.$on("click",o[9]),{c(){e=element("section"),n=element("label"),n.textContent="Title",s=space(),i=element("input"),r=space(),c=element("section"),d=element("label"),d.textContent="Description",u=space(),f=element("textarea"),m=space(),S&&S.c(),_=space(),g=element("div"),create_component(v.$$.fragment),attr(n,"for","title"),attr(n,"class","svelte-1725buf"),attr(i,"type","text"),attr(i,"id","title"),attr(i,"placeholder","Simple Title"),attr(i,"class","svelte-1725buf"),attr(e,"class","svelte-1725buf"),attr(d,"for","description"),attr(d,"class","svelte-1725buf"),attr(f,"type","text"),attr(f,"id","description"),attr(f,"rowspan","5"),attr(f,"placeholder",h=o[0]==="bug"?"Please provide a detailed description of what happened.":"Please describe the feature."),attr(f,"class","svelte-1725buf"),attr(c,"class","svelte-1725buf"),set_style(g,"display","contents"),set_style(g,"--bg","white"),set_style(g,"--text-color","#303030")},m(k,$){insert(k,e,$),append(e,n),append(e,s),append(e,i),set_input_value(i,o[2]),insert(k,r,$),insert(k,c,$),append(c,d),append(c,u),append(c,f),set_input_value(f,o[3]),insert(k,m,$),S&&S.m(k,$),insert(k,_,$),insert(k,g,$),mount_component(v,g,null),y=!0,b||(w=[listen(i,"keydown",stop_propagation(o[11])),listen(i,"input",o[12]),listen(f,"keydown",stop_propagation(o[10])),listen(f,"input",o[13])],b=!0)},p(k,$){$&4&&i.value!==k[2]&&set_input_value(i,k[2]),(!y||$&1&&h!==(h=k[0]==="bug"?"Please provide a detailed description of what happened.":"Please describe the feature."))&&attr(f,"placeholder",h),$&8&&set_input_value(f,k[3]),k[0]==="bug"?S?(S.p(k,$),$&1&&transition_in(S,1)):(S=create_if_block_1$1(k),S.c(),transition_in(S,1),S.m(_.parentNode,_)):S&&(group_outros(),transition_out(S,1,1,()=>{S=null}),check_outros())},i(k){y||(transition_in(S),transition_in(v.$$.fragment,k),y=!0)},o(k){transition_out(S),transition_out(v.$$.fragment,k),y=!1},d(k){k&&detach(e),k&&detach(r),k&&detach(c),k&&detach(m),S&&S.d(k),k&&detach(_),k&&detach(g),destroy_component(v,k),b=!1,run_all(w)}}}function create_if_block$1(o){let e,n,s,i={ctx:o,current:null,token:null,hasCatch:!0,pending:create_pending_block$1,then:create_then_block$1,catch:create_catch_block$1,value:16,error:17,blocks:[,,,]};return handle_promise(n=o[6],i),{c(){e=empty(),i.block.c()},m(r,c){insert(r,e,c),i.block.m(r,i.anchor=c),i.mount=()=>e.parentNode,i.anchor=e,s=!0},p(r,c){o=r,i.ctx=o,c&64&&n!==(n=o[6])&&handle_promise(n,i)||update_await_block_branch(i,o,c)},i(r){s||(transition_in(i.block),s=!0)},o(r){for(let c=0;c<3;c+=1){const d=i.blocks[c];transition_out(d)}s=!1},d(r){r&&detach(e),i.block.d(r),i.token=null,i=null}}}function create_if_block_1$1(o){let e,n,s,i,r,c,d,u,f,h,m,_=o[7]&&create_if_block_2(o);function v(y){o[15](y)}let g={};return o[4]!==void 0&&(g.value=o[4]),i=new InputCheckbox({props:g}),binding_callbacks.push(()=>bind(i,"value",v)),h=new Section({props:{name:"What is that?",$$slots:{default:[create_default_slot]},$$scope:{ctx:o}}}),{c(){_&&_.c(),e=space(),n=element("section"),s=element("div"),create_component(i.$$.fragment),c=space(),d=element("p"),d.textContent="Include Browser Info",u=space(),f=element("div"),create_component(h.$$.fragment),set_style(d,"margin-left","5px"),set_style(s,"display","flex"),set_style(s,"align-items","center"),attr(f,"class","info svelte-1725buf"),attr(n,"class","svelte-1725buf")},m(y,b){_&&_.m(y,b),insert(y,e,b),insert(y,n,b),append(n,s),mount_component(i,s,null),append(s,c),append(s,d),append(n,u),append(n,f),mount_component(h,f,null),m=!0},p(y,b){y[7]?_?(_.p(y,b),b&128&&transition_in(_,1)):(_=create_if_block_2(y),_.c(),transition_in(_,1),_.m(e.parentNode,e)):_&&(group_outros(),transition_out(_,1,1,()=>{_=null}),check_outros());const w={};!r&&b&16&&(r=!0,w.value=y[4],add_flush_callback(()=>r=!1)),i.$set(w);const S={};b&262144&&(S.$$scope={dirty:b,ctx:y}),h.$set(S)},i(y){m||(transition_in(_),transition_in(i.$$.fragment,y),transition_in(h.$$.fragment,y),m=!0)},o(y){transition_out(_),transition_out(i.$$.fragment,y),transition_out(h.$$.fragment,y),m=!1},d(y){_&&_.d(y),y&&detach(e),y&&detach(n),destroy_component(i),destroy_component(h)}}}function create_if_block_2(o){let e,n,s,i,r,c,d,u,f,h;function m(v){o[14](v)}let _={};return o[5]!==void 0&&(_.value=o[5]),s=new InputCheckbox({props:_}),binding_callbacks.push(()=>bind(s,"value",m)),f=new Section({props:{name:"What is that?",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:o}}}),{c(){e=element("section"),n=element("div"),create_component(s.$$.fragment),r=space(),c=element("p"),c.textContent="Include StackTrace",d=space(),u=element("div"),create_component(f.$$.fragment),set_style(c,"margin-left","5px"),set_style(n,"display","flex"),set_style(n,"align-items","center"),attr(u,"class","info svelte-1725buf"),attr(e,"class","svelte-1725buf")},m(v,g){insert(v,e,g),append(e,n),mount_component(s,n,null),append(n,r),append(n,c),append(e,d),append(e,u),mount_component(f,u,null),h=!0},p(v,g){const y={};!i&&g&32&&(i=!0,y.value=v[5],add_flush_callback(()=>i=!1)),s.$set(y);const b={};g&262146&&(b.$$scope={dirty:g,ctx:v}),f.$set(b)},i(v){h||(transition_in(s.$$.fragment,v),transition_in(f.$$.fragment,v),h=!0)},o(v){transition_out(s.$$.fragment,v),transition_out(f.$$.fragment,v),h=!1},d(v){v&&detach(e),destroy_component(s),destroy_component(f)}}}function create_default_slot_1(o){let e,n,s=o[1].stack+"",i;return{c(){e=element("pre"),n=element("code"),i=text(s)},m(r,c){insert(r,e,c),append(e,n),append(n,i)},p(r,c){c&2&&s!==(s=r[1].stack+"")&&set_data(i,s)},d(r){r&&detach(e)}}}function create_default_slot(o){let e,n,s,i,r,c,d,u,f,h,m,_,v,g,y,b,w,S;return{c(){e=element("p"),e.textContent=`This information makes it easier for a developer to track down what
            might have caused the bug.`,n=space(),s=element("ul"),i=element("li"),r=text("OS "),c=element("i"),c.textContent=`(${o[8].os})`,d=space(),u=element("li"),f=text("Browser "),h=element("i"),h.textContent=`(${o[8].name} / ${o[8].version})`,m=space(),_=element("li"),v=text("Screen Resolution "),g=element("i"),g.textContent=`(${window.innerWidth}x${window.innerHeight})`,y=space(),b=element("li"),w=text("Screen DPI "),S=element("i"),S.textContent=`(${window.devicePixelRatio})`},m(k,$){insert(k,e,$),insert(k,n,$),insert(k,s,$),append(s,i),append(i,r),append(i,c),append(s,d),append(s,u),append(u,f),append(u,h),append(s,m),append(s,_),append(_,v),append(_,g),append(s,y),append(s,b),append(b,w),append(b,S)},p:noop,d(k){k&&detach(e),k&&detach(n),k&&detach(s)}}}function create_catch_block$1(o){let e,n,s,i=JSON.stringify(o[17],null,2)+"",r;return{c(){e=element("p"),e.textContent="Errror",n=space(),s=element("code"),r=text(i)},m(c,d){insert(c,e,d),insert(c,n,d),insert(c,s,d),append(s,r)},p(c,d){d&64&&i!==(i=JSON.stringify(c[17],null,2)+"")&&set_data(r,i)},i:noop,o:noop,d(c){c&&detach(e),c&&detach(n),c&&detach(s)}}}function create_then_block$1(o){let e,n,s,i=JSON.stringify(o[16],null,2)+"",r,c;return e=new Button({props:{name:"Done",icon:"checkmark"}}),{c(){create_component(e.$$.fragment),n=space(),s=element("code"),r=text(i)},m(d,u){mount_component(e,d,u),insert(d,n,u),insert(d,s,u),append(s,r),c=!0},p(d,u){(!c||u&64)&&i!==(i=JSON.stringify(d[16],null,2)+"")&&set_data(r,i)},i(d){c||(transition_in(e.$$.fragment,d),c=!0)},o(d){transition_out(e.$$.fragment,d),c=!1},d(d){destroy_component(e,d),d&&detach(n),d&&detach(s)}}}function create_pending_block$1(o){let e;return{c(){e=text("Submitting Reprot")},m(n,s){insert(n,e,s)},p:noop,i:noop,o:noop,d(n){n&&detach(e)}}}function create_fragment$5(o){let e,n,s,i;const r=[create_if_block$1,create_else_block],c=[];function d(u,f){return u[6]?0:1}return e=d(o),n=c[e]=r[e](o),{c(){n.c(),s=empty()},m(u,f){c[e].m(u,f),insert(u,s,f),i=!0},p(u,[f]){let h=e;e=d(u),e===h?c[e].p(u,f):(group_outros(),transition_out(c[h],1,1,()=>{c[h]=null}),check_outros(),n=c[e],n?n.p(u,f):(n=c[e]=r[e](u),n.c()),transition_in(n,1),n.m(s.parentNode,s))},i(u){i||(transition_in(n),i=!0)},o(u){transition_out(n),i=!1},d(u){c[e].d(u),u&&detach(s)}}}function instance$4(o,e,n){let s,{mode:i="bug"}=e,r=detect(),c,d,u=!1,{error:f}=e,h=!0,m;function _(){const k={type:i,title:c,description:d};h&&(k.stacktrace=s),u&&(k.browser=detect(),k.browser.screen={width:window.innerWidth,height:window.innerHeight,dpi:window.devicePixelRatio}),n(6,m=submitReport(k))}onMount(async()=>{s&&n(2,c=s.type+": "+s.title)});function v(k){bubble.call(this,o,k)}function g(k){bubble.call(this,o,k)}function y(){c=this.value,n(2,c)}function b(){d=this.value,n(3,d)}function w(k){h=k,n(5,h)}function S(k){u=k,n(4,u)}return o.$$set=k=>{"mode"in k&&n(0,i=k.mode),"error"in k&&n(1,f=k.error)},o.$$.update=()=>{o.$$.dirty&2&&n(7,s=f&&parseStackTrace(f.stack))},[i,f,c,d,u,h,m,s,r,_,v,g,y,b,w,S]}class Report extends SvelteComponent{constructor(e){super();init(this,e,instance$4,create_fragment$5,safe_not_equal,{mode:0,error:1})}}class DebugScene{constructor(e,n){this.scene=e,this.pm=n,this.m={},this.gl=e.renderer.gl,this.initGeometry(),this.setSettings(settingsManager.getSettings()),n.on("settings",this.setSettings.bind(this))}initGeometry(){this.m.skeleton=this.scene.addMesh({geometry:new Geometry(this.gl,{position:{size:3,data:new Float32Array([0,0,0])},uv:{size:2,data:new Float32Array([0,0])},index:{size:1,data:new Uint16Array([0])}}),program:new Program(this.gl,{vertex:WireFrameShader.vertex,fragment:WireFrameShader.fragment,depthTest:!1}),mode:this.gl.LINES}),this.m.vertices=this.scene.addMesh({mode:this.gl.POINTS,geometry:new Geometry(this.gl,{position:{size:3,data:new Float32Array(3)}}),program:new Program(this.gl,{vertex:ParticleShader.vertex,fragment:ParticleShader.fragment,depthTest:!1,transparent:!0})})}setSettings(e){var n,s;this.settings=JSON.parse(JSON.stringify(e)),this.m.skeleton.visible=!!((n=this.settings.debug)==null?void 0:n.skeleton),this.m.vertices.visible=!!((s=this.settings.debug)==null?void 0:s.skeleton),this.update()}setPlant(e){this.plant=e,this.update()}update(e=this.plant,n=this.settings){var s,i;if(!(!e||!n)&&(e.allSkeletons||e.skeletons)&&((s=n.debug)==null?void 0:s.skeleton)){const r=(i=e.allSkeletons)!=null?i:e.skeletons;let c=0;for(const h of r)c+=h.length/4*3;const d=new Float32Array(c),u=new Uint32Array((c/3-1)*2);let f=0;r.forEach(h=>{const m=h.length/4;for(let _=0;_<m;_++)d[f*3+_*3+0]=h[_*4+0],d[f*3+_*3+1]=h[_*4+1],d[f*3+_*3+2]=h[_*4+2];for(let _=0;_<m-1;_++)u[f*2+_*2]=f+_,u[f*2+_*2+1]=f+_+1;f+=m}),this.m.skeleton.geometry=new Geometry(this.gl,{position:{size:3,data:d},index:{size:1,data:u}}),this.m.vertices.geometry=new Geometry(this.gl,{position:{size:3,data:d}})}}}const updateThumbnail=throttle(o=>{projectManager.renderThumbnail({geo:o})},5e3),log=log$8("scene.foreground");class ForegroundScene{constructor(e,n){this.scene=e,this.pm=n,this.worker=worker(),this.gl=e.renderer.gl,this.initGeometry(),this.dbg=new DebugScene(e,n),this.setSettings(settingsManager.getSettings()),this.setPlant(n.getActiveProject()),this.pm.on("settings",this.setSettings.bind(this)),this.pm.on("plant",this.setPlant.bind(this))}initGeometry(){const e=new Box(this.scene.gl,{width:0,height:0,depth:0});this.mesh=this.scene.addMesh({geometry:e,program:MatCapShader(this.gl)})}setSettings(e){this.settings=JSON.parse(JSON.stringify(e)),this.update()}setPlant(e){!e||(this.plant=JSON.parse(JSON.stringify(e)),this.update())}async update(e=this.plant,n=this.settings){var s;if(!(!e||!n)){this.scene.isLoading.set(!0);try{start("generate");const i=await this.worker.plant(e,n);if(stop("generate"),!i)return;updateThumbnail(i.geometry),this.scene.isLoading.set(!1),this.mesh.mode=((s=n==null?void 0:n.debug)==null?void 0:s.wireframe)?this.gl.LINES:this.gl.TRIANGLES,this.dbg.setPlant(i),this.mesh.geometry=transferToGeometry(this.gl,i.geometry),this.mesh.geometry.computeBoundingBox(),this.scene.renderer.setControlTarget(this.mesh.geometry.bounds.center)}catch(i){log.error(i),await createToast(i,{title:"Error [Generator]",values:["report"]})==="report"&&createAlert(Report,{timeout:0,title:"Report Bug",type:"error",props:{mode:"bug",error:i}})}}}}class Scene{constructor(e,n){this.isLoading=writable(!1),this.renderer=new Renderer({canvas:n,camPos:localState.get("camPos")}),this.renderer.on("camPos",s=>localState.set("camPos",s)),this.renderer.on("perf",s=>add("render",s),40),this.renderer.handleResize(),this.scene=this.renderer.scene,this.gl=this.renderer.gl,this.wrapper=n.parentElement,this.bg=new BackgroundScene(this,e),this.fg=new ForegroundScene(this,e)}addMesh(e){const n=new Mesh(this.gl,e);return n.setParent(this.scene),n}}var Scene_svelte_svelte_type_style_lang="";function create_if_block_1(o){let e,n,s=JSON.stringify(o[1],null,2)+"",i;return{c(){e=element("pre"),n=element("code"),i=text(s),attr(n,"class","svelte-jamjfg"),attr(e,"class","svelte-jamjfg")},m(r,c){insert(r,e,c),append(e,n),append(n,i)},p(r,c){c&2&&s!==(s=JSON.stringify(r[1],null,2)+"")&&set_data(i,s)},d(r){r&&detach(e)}}}function create_if_block(o){let e;return{c(){e=element("div"),e.innerHTML='<p class="svelte-jamjfg">Is Loading</p>',attr(e,"class","is-loading svelte-jamjfg")},m(n,s){insert(n,e,s)},d(n){n&&detach(e)}}}function create_fragment$4(o){var g,y;let e,n,s,i,r,c,d,u,f,h,m,_=((y=(g=o[6])==null?void 0:g.debug)==null?void 0:y.pd)&&o[1]&&create_if_block_1(o),v=o[7]&&create_if_block();return{c(){var b,w,S,k;e=element("div"),_&&_.c(),n=space(),s=element("div"),i=element("canvas"),c=space(),d=element("canvas"),f=space(),h=element("canvas"),m=space(),v&&v.c(),attr(i,"style",r=`display: ${((w=(b=o[6])==null?void 0:b.debug)==null?void 0:w.generatePerf)?"visible":"none"}`),attr(i,"class","svelte-jamjfg"),attr(d,"style",u=`display: ${((k=(S=o[6])==null?void 0:S.debug)==null?void 0:k.renderPerf)?"visible":"none"}`),attr(d,"class","svelte-jamjfg"),attr(s,"class","performance-wrapper svelte-jamjfg"),attr(h,"class","svelte-jamjfg"),attr(e,"class","scene-wrapper svelte-jamjfg")},m(b,w){insert(b,e,w),_&&_.m(e,null),append(e,n),append(e,s),append(s,i),o[10](i),append(s,c),append(s,d),o[11](d),append(e,f),append(e,h),o[12](h),append(e,m),v&&v.m(e,null)},p(b,[w]){var S,k,$,P,x,j;((k=(S=b[6])==null?void 0:S.debug)==null?void 0:k.pd)&&b[1]?_?_.p(b,w):(_=create_if_block_1(b),_.c(),_.m(e,n)):_&&(_.d(1),_=null),w&64&&r!==(r=`display: ${((P=($=b[6])==null?void 0:$.debug)==null?void 0:P.generatePerf)?"visible":"none"}`)&&attr(i,"style",r),w&64&&u!==(u=`display: ${((j=(x=b[6])==null?void 0:x.debug)==null?void 0:j.renderPerf)?"visible":"none"}`)&&attr(d,"style",u),b[7]?v||(v=create_if_block(),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i:noop,o:noop,d(b){b&&detach(e),_&&_.d(),o[10](null),o[11](null),o[12](null),v&&v.d()}}}function instance$3(o,e,n){let s,i,r=noop,c=()=>(r(),r=subscribe(g,$=>n(6,i=$)),g),d,u=noop,f=()=>(u(),u=subscribe(s,$=>n(7,d=$)),s);o.$$.on_destroy.push(()=>r()),o.$$.on_destroy.push(()=>u());let h,m,_,v,g,y,b;onMount(()=>{createCanvas("render",b),createCanvas("generate",y)});function w($){binding_callbacks[$?"unshift":"push"](()=>{y=$,n(3,y)})}function S($){binding_callbacks[$?"unshift":"push"](()=>{b=$,n(4,b)})}function k($){binding_callbacks[$?"unshift":"push"](()=>{h=$,n(0,h)})}return o.$$.update=()=>{o.$$.dirty&257&&h&&projectManager&&!m&&n(8,m=new Scene(projectManager,h)),o.$$.dirty&256&&f(n(5,s=m&&m.isLoading)),o.$$.dirty&512&&projectManager&&(v&&v(),n(9,v=projectManager.on("save",$=>n(1,_=$))))},settingsManager&&c(n(2,g=settingsManager.store)),[h,_,g,y,b,s,i,d,m,v,w,S,k]}class Scene_1 extends SvelteComponent{constructor(e){super();init(this,e,instance$3,create_fragment$4,safe_not_equal,{})}}var Help_svelte_svelte_type_style_lang="";function create_fragment$3(o){let e,n,s,i,r,c,d,u,f,h,m,_,v;return n=new Button({props:{name:"Tutorial",icon:"hand"}}),n.$on("click",o[0]),r=new Button({props:{name:"Report Bug",icon:"exclamation"}}),r.$on("click",o[1]),u=new Button({props:{name:"Request Feature"}}),u.$on("click",o[2]),m=new Button({props:{name:"Changelog"}}),m.$on("click",o[3]),{c(){e=element("div"),s=element("div"),create_component(n.$$.fragment),i=space(),c=element("div"),create_component(r.$$.fragment),d=space(),f=element("div"),create_component(u.$$.fragment),h=space(),_=element("div"),create_component(m.$$.fragment),set_style(s,"display","contents"),set_style(s,"--bg","#303030"),set_style(s,"--text","white"),set_style(c,"display","contents"),set_style(c,"--bg","#303030"),set_style(c,"--text","white"),set_style(f,"display","contents"),set_style(f,"--bg","#303030"),set_style(f,"--text","white"),set_style(_,"display","contents"),set_style(_,"--bg","#303030"),set_style(_,"--text","white"),attr(e,"class","svelte-4ypi13")},m(g,y){insert(g,e,y),append(e,s),mount_component(n,s,null),append(e,i),append(e,c),mount_component(r,c,null),append(e,d),append(e,f),mount_component(u,f,null),append(e,h),append(e,_),mount_component(m,_,null),v=!0},p:noop,i(g){v||(transition_in(n.$$.fragment,g),transition_in(r.$$.fragment,g),transition_in(u.$$.fragment,g),transition_in(m.$$.fragment,g),v=!0)},o(g){transition_out(n.$$.fragment,g),transition_out(r.$$.fragment,g),transition_out(u.$$.fragment,g),transition_out(m.$$.fragment,g),v=!1},d(g){g&&detach(e),destroy_component(n),destroy_component(r),destroy_component(u),destroy_component(m)}}}function instance$2(o){return[()=>Tutor.restart(),()=>createAlert(Report,{timeout:0,title:"Report Bug",type:"error",props:{mode:"bug"}}),()=>createAlert(Report,{timeout:0,title:"Request Feature",props:{mode:"feat"}}),()=>createAlert(ChangeLog,{timeout:0})]}class Help extends SvelteComponent{constructor(e){super();init(this,e,instance$2,create_fragment$3,safe_not_equal,{})}}var Header_svelte_svelte_type_style_lang="";function create_fragment$2(o){var y,b;let e,n,s,i,r,c=((b=(y=o[0])==null?void 0:y.meta.name)!=null?b:"")+"",d,u,f,h,m,_,v,g;return s=new HoverWindow({props:{icon:"folder",name:"Projects",component:ProjectManagerView}}),h=new HoverWindow({props:{icon:"question",component:Help,right:!0}}),_=new HoverWindow({props:{icon:"cog",component:SettingsManagerView,right:!0}}),{c(){e=element("header"),n=element("div"),create_component(s.$$.fragment),i=space(),r=element("h3"),d=text(c),u=space(),f=element("div"),create_component(h.$$.fragment),m=space(),v=element("div"),create_component(_.$$.fragment),attr(n,"class","left svelte-1dyrwb1"),attr(r,"class","svelte-1dyrwb1"),set_style(v,"display","contents"),set_style(v,"--min-width","250px"),attr(f,"class","right svelte-1dyrwb1"),attr(e,"class","svelte-1dyrwb1")},m(w,S){insert(w,e,S),append(e,n),mount_component(s,n,null),append(e,i),append(e,r),append(r,d),append(e,u),append(e,f),mount_component(h,f,null),append(f,m),append(f,v),mount_component(_,v,null),g=!0},p(w,[S]){var k,$;(!g||S&1)&&c!==(c=(($=(k=w[0])==null?void 0:k.meta.name)!=null?$:"")+"")&&set_data(d,c)},i(w){g||(transition_in(s.$$.fragment,w),transition_in(h.$$.fragment,w),transition_in(_.$$.fragment,w),g=!0)},o(w){transition_out(s.$$.fragment,w),transition_out(h.$$.fragment,w),transition_out(_.$$.fragment,w),g=!1},d(w){w&&detach(e),destroy_component(s),destroy_component(h),destroy_component(_)}}}function instance$1(o,e,n){let s;const i=projectManager.activeProject;return component_subscribe(o,i,r=>n(0,s=r)),[s,i]}class Header extends SvelteComponent{constructor(e){super();init(this,e,instance$1,create_fragment$2,safe_not_equal,{})}}var App_svelte_svelte_type_style_lang="";function create_fragment$1(o){let e,n,s,i,r,c,d,u,f,h,m,_,v,g,y;return e=new ThemeProvider({}),s=new AlertWrapper({}),r=new ToastWrapper({}),d=new Tutor$1({}),f=new Header({}),_=new Scene_1({}),{c(){create_component(e.$$.fragment),n=space(),create_component(s.$$.fragment),i=space(),create_component(r.$$.fragment),c=space(),create_component(d.$$.fragment),u=space(),create_component(f.$$.fragment),h=space(),m=element("main"),create_component(_.$$.fragment),v=space(),g=element("div"),attr(g,"id","nodesystem-view"),attr(g,"class","svelte-1hr3zx4"),attr(m,"class","svelte-1hr3zx4")},m(b,w){mount_component(e,b,w),insert(b,n,w),mount_component(s,b,w),insert(b,i,w),mount_component(r,b,w),insert(b,c,w),mount_component(d,b,w),insert(b,u,w),mount_component(f,b,w),insert(b,h,w),insert(b,m,w),mount_component(_,m,null),append(m,v),append(m,g),o[1](g),y=!0},p:noop,i(b){y||(transition_in(e.$$.fragment,b),transition_in(s.$$.fragment,b),transition_in(r.$$.fragment,b),transition_in(d.$$.fragment,b),transition_in(f.$$.fragment,b),transition_in(_.$$.fragment,b),y=!0)},o(b){transition_out(e.$$.fragment,b),transition_out(s.$$.fragment,b),transition_out(r.$$.fragment,b),transition_out(d.$$.fragment,b),transition_out(f.$$.fragment,b),transition_out(_.$$.fragment,b),y=!1},d(b){destroy_component(e,b),b&&detach(n),destroy_component(s,b),b&&detach(i),destroy_component(r,b),b&&detach(c),destroy_component(d,b),b&&detach(u),destroy_component(f,b),b&&detach(h),b&&detach(m),destroy_component(_),o[1](null)}}}function instance(o,e,n){let s;onMount(async()=>{s.append(nodeSystem.view.wrapper),nodeSystem.view.handleResize()});function i(r){binding_callbacks[r?"unshift":"push"](()=>{s=r,n(0,s)})}return[s,i]}class App extends SvelteComponent{constructor(e){super();init(this,e,instance,create_fragment$1,safe_not_equal,{})}}function create_catch_block(o){return{c:noop,m:noop,i:noop,o:noop,d:noop}}function create_then_block(o){let e,n;return e=new App({}),{c(){create_component(e.$$.fragment)},m(s,i){mount_component(e,s,i),n=!0},i(s){n||(transition_in(e.$$.fragment,s),n=!0)},o(s){transition_out(e.$$.fragment,s),n=!1},d(s){destroy_component(e,s)}}}function create_pending_block(o){let e;return{c(){e=element("p"),e.textContent="Loading"},m(n,s){insert(n,e,s)},i:noop,o:noop,d(n){n&&detach(e)}}}function create_fragment(o){let e,n,s={ctx:o,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:0,blocks:[,,,]};return handle_promise(settingsManager.loadFromLocal(),s),{c(){e=empty(),s.block.c()},m(i,r){insert(i,e,r),s.block.m(i,s.anchor=r),s.mount=()=>e.parentNode,s.anchor=e,n=!0},p(i,[r]){o=i},i(i){n||(transition_in(s.block),n=!0)},o(i){for(let r=0;r<3;r+=1){const c=s.blocks[r];transition_out(c)}n=!1},d(i){i&&detach(e),s.block.d(i),s.token=null,s=null}}}class Loader extends SvelteComponent{constructor(e){super();init(this,e,null,create_fragment,safe_not_equal,{})}}let l;try{l=new Loader({target:document.body})}catch(o){console.log(o)}
//# sourceMappingURL=index.a0860ccb.js.map
