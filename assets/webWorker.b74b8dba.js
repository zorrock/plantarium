var yn=Object.defineProperty;var Ee=Object.getOwnPropertySymbols;var gn=Object.prototype.hasOwnProperty,xn=Object.prototype.propertyIsEnumerable;var ze=(F,$,U)=>$ in F?yn(F,$,{enumerable:!0,configurable:!0,writable:!0,value:U}):F[$]=U,h1=(F,$)=>{for(var U in $||($={}))gn.call($,U)&&ze(F,U,$[U]);if(Ee)for(var U of Ee($))xn.call($,U)&&ze(F,U,$[U]);return F};(function(){"use strict";const F=Symbol("Comlink.proxy"),$=Symbol("Comlink.endpoint"),U=Symbol("Comlink.releaseProxy"),z1=Symbol("Comlink.thrown"),X1=e=>typeof e=="object"&&e!==null||typeof e=="function",De={canHandle:e=>X1(e)&&e[F],serialize(e){const{port1:n,port2:t}=new MessageChannel;return D1(e,n),[t,[t]]},deserialize(e){return e.start(),je(e)}},Oe={canHandle:e=>X1(e)&&z1 in e,serialize({value:e}){let n;return e instanceof Error?n={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:n={isError:!1,value:e},[n,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},ee=new Map([["proxy",De],["throw",Oe]]);function D1(e,n=self){n.addEventListener("message",function t(r){if(!r||!r.data)return;const{id:o,type:s,path:a}=Object.assign({path:[]},r.data),l=(r.data.argumentList||[]).map(H);let i;try{const u=a.slice(0,-1).reduce((f,p)=>f[p],e),c=a.reduce((f,p)=>f[p],e);switch(s){case"GET":i=c;break;case"SET":u[a.slice(-1)[0]]=H(r.data.value),i=!0;break;case"APPLY":i=c.apply(u,l);break;case"CONSTRUCT":{const f=new c(...l);i=Te(f)}break;case"ENDPOINT":{const{port1:f,port2:p}=new MessageChannel;D1(e,p),i=Le(f,[f])}break;case"RELEASE":i=void 0;break;default:return}}catch(u){i={value:u,[z1]:0}}Promise.resolve(i).catch(u=>({value:u,[z1]:0})).then(u=>{const[c,f]=N1(u);n.postMessage(Object.assign(Object.assign({},c),{id:o}),f),s==="RELEASE"&&(n.removeEventListener("message",t),te(n))})}),n.start&&n.start()}function Ne(e){return e.constructor.name==="MessagePort"}function te(e){Ne(e)&&e.close()}function je(e,n){return O1(e,[],n)}function d1(e){if(e)throw new Error("Proxy has been released and is not useable")}function O1(e,n=[],t=function(){}){let r=!1;const o=new Proxy(t,{get(s,a){if(d1(r),a===U)return()=>J(e,{type:"RELEASE",path:n.map(l=>l.toString())}).then(()=>{te(e),r=!0});if(a==="then"){if(n.length===0)return{then:()=>o};const l=J(e,{type:"GET",path:n.map(i=>i.toString())}).then(H);return l.then.bind(l)}return O1(e,[...n,a])},set(s,a,l){d1(r);const[i,u]=N1(l);return J(e,{type:"SET",path:[...n,a].map(c=>c.toString()),value:i},u).then(H)},apply(s,a,l){d1(r);const i=n[n.length-1];if(i===$)return J(e,{type:"ENDPOINT"}).then(H);if(i==="bind")return O1(e,n.slice(0,-1));const[u,c]=ne(l);return J(e,{type:"APPLY",path:n.map(f=>f.toString()),argumentList:u},c).then(H)},construct(s,a){d1(r);const[l,i]=ne(a);return J(e,{type:"CONSTRUCT",path:n.map(u=>u.toString()),argumentList:l},i).then(H)}});return o}function Re(e){return Array.prototype.concat.apply([],e)}function ne(e){const n=e.map(N1);return[n.map(t=>t[0]),Re(n.map(t=>t[1]))]}const re=new WeakMap;function Le(e,n){return re.set(e,n),e}function Te(e){return Object.assign(e,{[F]:!0})}function N1(e){for(const[n,t]of ee)if(t.canHandle(e)){const[r,o]=t.serialize(e);return[{type:"HANDLER",name:n,value:r},o]}return[{type:"RAW",value:e},re.get(e)||[]]}function H(e){switch(e.type){case"HANDLER":return ee.get(e.name).deserialize(e.value);case"RAW":return e.value}}function J(e,n,t){return new Promise(r=>{const o=$e();e.addEventListener("message",function s(a){!a.data||!a.data.id||a.data.id!==o||(e.removeEventListener("message",s),r(a.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},n),t)})}function $e(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function oe(e){let n=e[0],t=e[1],r=e[2];return Math.sqrt(n*n+t*t+r*r)}function j1(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Ue(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e}function ae(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function se(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function Ve(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function qe(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function R1(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function Fe(e,n){let t=n[0]-e[0],r=n[1]-e[1],o=n[2]-e[2];return Math.sqrt(t*t+r*r+o*o)}function Ce(e,n){let t=n[0]-e[0],r=n[1]-e[1],o=n[2]-e[2];return t*t+r*r+o*o}function ie(e){let n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function Ie(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function ke(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function L1(e,n){let t=n[0],r=n[1],o=n[2],s=t*t+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function le(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function ue(e,n,t){let r=n[0],o=n[1],s=n[2],a=t[0],l=t[1],i=t[2];return e[0]=o*i-s*l,e[1]=s*a-r*i,e[2]=r*l-o*a,e}function Ge(e,n,t,r){let o=n[0],s=n[1],a=n[2];return e[0]=o+r*(t[0]-o),e[1]=s+r*(t[1]-s),e[2]=a+r*(t[2]-a),e}function Be(e,n,t){let r=n[0],o=n[1],s=n[2],a=t[3]*r+t[7]*o+t[11]*s+t[15];return a=a||1,e[0]=(t[0]*r+t[4]*o+t[8]*s+t[12])/a,e[1]=(t[1]*r+t[5]*o+t[9]*s+t[13])/a,e[2]=(t[2]*r+t[6]*o+t[10]*s+t[14])/a,e}function He(e,n,t){let r=n[0],o=n[1],s=n[2],a=t[3]*r+t[7]*o+t[11]*s+t[15];return a=a||1,e[0]=(t[0]*r+t[4]*o+t[8]*s)/a,e[1]=(t[1]*r+t[5]*o+t[9]*s)/a,e[2]=(t[2]*r+t[6]*o+t[10]*s)/a,e}function Ye(e,n,t){let r=n[0],o=n[1],s=n[2],a=t[0],l=t[1],i=t[2],u=t[3],c=l*s-i*o,f=i*r-a*s,p=a*o-l*r,v=l*p-i*f,d=i*c-a*p,h=a*f-l*c,y=u*2;return c*=y,f*=y,p*=y,v*=2,d*=2,h*=2,e[0]=r+c+v,e[1]=o+f+d,e[2]=s+p+h,e}const We=function(){const e=[0,0,0],n=[0,0,0];return function(t,r){j1(e,t),j1(n,r),L1(e,e),L1(n,n);let o=le(e,n);return o>1?0:o<-1?Math.PI:Math.acos(o)}}();function Je(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}class Q extends Array{constructor(n=0,t=n,r=n){super(n,t,r);return this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(n){this[0]=n}set y(n){this[1]=n}set z(n){this[2]=n}set(n,t=n,r=n){return n.length?this.copy(n):(Ue(this,n,t,r),this)}copy(n){return j1(this,n),this}add(n,t){return t?ae(this,n,t):ae(this,this,n),this}sub(n,t){return t?se(this,n,t):se(this,this,n),this}multiply(n){return n.length?Ve(this,this,n):R1(this,this,n),this}divide(n){return n.length?qe(this,this,n):R1(this,this,1/n),this}inverse(n=this){return ke(this,n),this}len(){return oe(this)}distance(n){return n?Fe(this,n):oe(this)}squaredLen(){return ie(this)}squaredDistance(n){return n?Ce(this,n):ie(this)}negate(n=this){return Ie(this,n),this}cross(n,t){return t?ue(this,n,t):ue(this,this,n),this}scale(n){return R1(this,this,n),this}normalize(){return L1(this,this),this}dot(n){return le(this,n)}equals(n){return Je(this,n)}applyMatrix4(n){return Be(this,this,n),this}scaleRotateMatrix4(n){return He(this,this,n),this}applyQuaternion(n){return Ye(this,this,n),this}angle(n){return We(this,n)}lerp(n,t){return Ge(this,this,n,t),this}clone(){return new Q(this[0],this[1],this[2])}fromArray(n,t=0){return this[0]=n[t],this[1]=n[t+1],this[2]=n[t+2],this}toArray(n=[],t=0){return n[t]=this[0],n[t+1]=this[1],n[t+2]=this[2],n}transformDirection(n){const t=this[0],r=this[1],o=this[2];return this[0]=n[0]*t+n[4]*r+n[8]*o,this[1]=n[1]*t+n[5]*r+n[9]*o,this[2]=n[2]*t+n[6]*r+n[10]*o,this.normalize()}}function Qe(e,n=[0,0,0],t=[0,0,0],r=[1,1,1]){const o=new Float32Array(e.position.length),s=e.position.length,a=e.position;for(let l=0;l<s;l+=3){const i=a[l+0]*r[0],u=a[l+1]*r[1],c=a[l+2]*r[2],f=i,p=Math.cos(t[0])*u-Math.sin(t[0])*c,v=Math.sin(t[0])*u+Math.cos(t[0])*c,d=Math.cos(t[1])*f-Math.sin(t[1])*v,h=p,y=Math.sin(t[1])*f+Math.cos(t[1])*v;o[l+0]=d+n[0],o[l+1]=h+n[1],o[l+2]=y+n[2]}return{position:o,uv:e.uv,normal:e.normal,index:e.index}}function Ze(e){const n=[],t={position:e.position,normal:e.position,uv:e.uv,index:e.index},r=e.offset,o=e.rotation,s=e.scale,a=e.offset.length;for(let l=0;l<a;l+=3)n.push(Qe(t,[r[l+0],r[l+1],r[l+2]],[o[l+0],o[l+1],o[l+2]],[s[l+0],s[l+1],s[l+2]]));return n}const C=.4;function Ke(e,n,t,r,o,s,a,l,i,u){const c=o-t,f=a-o,p=i-a,v=s-r,d=l-s,h=u-l;let y,x,g,m,S=-1e4,z=-1e4;const b=[{x:t,y:r}];for(let P=1;P<e;P++){const w=P/e;y=t+c*w,g=o+f*w;const A=a+p*w;y+=(g-y)*w,g+=(A-g)*w,x=r+v*w,m=s+d*w;const E=l+h*w;x+=(m-x)*w,m+=(E-m)*w;const _=y+(g-y)*w,M=x+(m-x)*w,D=_-S,O=M-z;D*D+O*O>n&&(b.push({x:_,y:M}),S=_,z=M)}return b.push({x:i,y:u}),b}function Xe(e){const n=e.length-1;return e.map((t,r,o)=>{if(r===0)return{rx:o[r+1].x*C*0,ry:t.y+(o[r+1].y-t.y)*C*0};if(r===n)return{lx:o[r-1].x+(t.x-o[r-1].x)*C*2,ly:o[r-1].y+(t.y-o[r-1].y)*C*2};if(t.y>o[r+1].y&&t.y>o[r-1].y||t.y<o[r+1].y&&t.y<o[r-1].y)return{lx:o[r-1].x+(t.x-o[r-1].x)*C,ly:t.y,rx:t.x+(o[r+1].x-t.x)*C,ry:t.y};{const a={x:o[r-1].x-o[r+1].x,y:o[r-1].y-o[r+1].y},l=Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2));a.x/=l,a.y/=l;const i=o[r+1].x-t.x,u=t.x-o[r-1].x;return{lx:t.x+a.x*u*C,ly:t.y+a.y*u*C,rx:t.x-a.x*i*C,ry:t.y-a.y*i*C}}})}function et(e){const n=e.length-1,t={},r=Xe(e);return e.map((o,s,a)=>{if(s<n)return Ke(n*20,0,o.x,o.y,r[s].rx,r[s].ry,r[s+1].lx,r[s+1].ly,a[s+1].x,a[s+1].y)}).flat().filter(o=>!o||o.x in t?!1:(t[o.x]=!0,!0))}var n1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},tt={exports:{}};(function(e,n){(function(t,r){r()})(n1,function(){function t(u,c){return typeof c=="undefined"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function r(u,c,f){var p=new XMLHttpRequest;p.open("GET",u),p.responseType="blob",p.onload=function(){i(p.response,c,f)},p.onerror=function(){console.error("could not download file")},p.send()}function o(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function s(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof n1=="object"&&n1.global===n1?n1:void 0,l=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(u,c,f){var p=a.URL||a.webkitURL,v=document.createElement("a");c=c||u.name||"download",v.download=c,v.rel="noopener",typeof u=="string"?(v.href=u,v.origin===location.origin?s(v):o(v.href)?r(u,c,f):s(v,v.target="_blank")):(v.href=p.createObjectURL(u),setTimeout(function(){p.revokeObjectURL(v.href)},4e4),setTimeout(function(){s(v)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,f){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(t(u,f),c);else if(o(u))r(u,c,f);else{var p=document.createElement("a");p.href=u,p.target="_blank",setTimeout(function(){s(p)})}}:function(u,c,f,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof u=="string")return r(u,c,f);var v=u.type==="application/octet-stream",d=/constructor/i.test(a.HTMLElement)||a.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||v&&d||l)&&typeof FileReader!="undefined"){var y=new FileReader;y.onloadend=function(){var m=y.result;m=h?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=m:location=m,p=null},y.readAsDataURL(u)}else{var x=a.URL||a.webkitURL,g=x.createObjectURL(u);p?p.location=g:location.href=g,p=null,setTimeout(function(){x.revokeObjectURL(g)},4e4)}});a.saveAs=i.saveAs=i,e.exports=i})})(tt);const nt={amountEmitters:0,amountCallbacks:0,emitters:[]};typeof self!="undefined"&&"window"in self&&(window.debug=nt);function rt(e,n){const t=[],r=e.length/n;for(let o=0;o<r;o++){const s=[];for(let a=0;a<n;a++)s[a]=e[o*n+a];t.push(s)}return t}function T1(e){let n,t={length:NaN};const r=(o,s)=>o===t[s];return function(...s){return(s.length!==t.length||!s.every(r))&&(t=s,n=e.apply(this,s)),n}}function $1(){}function ot(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}Promise.resolve();const Z=[];function at(e,n=$1){let t;const r=new Set;function o(l){if(ot(e,l)&&(e=l,t)){const i=!Z.length;for(const u of r)u[1](),Z.push(u,e);if(i){for(let u=0;u<Z.length;u+=2)Z[u][0](Z[u+1]);Z.length=0}}}function s(l){o(l(e))}function a(l,i=$1){const u=[l,i];return r.add(u),r.size===1&&(t=n(o)||$1),l(e),()=>{r.delete(u),r.size===0&&(t(),t=null)}}return{set:o,update:s,subscribe:a}}let U1=[],V1=2,K=0;const st={};let q1=0;const it=["#00ffff","#f0ffff","#f5f5dc","#000000","#0000ff","#a52a2a","#00ffff","#00008b","#008b8b","#a9a9a9","#006400","#bdb76b","#8b008b","#556b2f","#ff8c00","#9932cc","#8b0000","#e9967a","#9400d3","#ff00ff","#ffd700","#008000","#4b0082","#f0e68c","#add8e6","#e0ffff","#90ee90","#d3d3d3","#ffb6c1","#ffffe0","#00ff00","#ff00ff","#800000","#000080","#808000","#ffa500","#ffc0cb","#800080","#800080","#ff0000","#c0c0c0","#ffffff","#ffff00"],F1="plant.log.history",ce="localStorage"in globalThis,r1=ce?F1 in localStorage?JSON.parse(localStorage.getItem(F1)):[]:[];function lt(){ce&&localStorage.setItem(F1,JSON.stringify(r1))}let X;function Y(e){K=Math.max(K,e.length);const n=q1;st[e]=it[q1],q1++;const t=(o,s)=>{if(r1.push({scope:e,args:o,level:V1}),r1.length=Math.min(100,r1.length),X&&X.set(r1),lt(),(!U1.length||U1.includes(e))&&s<=V1){if(o instanceof Error||s===2){console.error(`[${e.padEnd(K," ")}]`,o);return}if(Array.isArray(o)&&typeof o[0]=="string"&&typeof o[1]=="object"){console.groupCollapsed(`%c[${e.padEnd(K," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,o[0]),console.log(...o.slice(1)),console.groupEnd();return}s===0&&console.log(`%c[${e.padEnd(K," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,...o),s===1&&console.warn(`[${e.padEnd(K," ")}]`,...o)}},r=(...o)=>t(o,0);return r.warn=(...o)=>t(o,1),r.error=o=>t(o,2),r}Y.getStore=function(){return X||(X=at([]),X)},Y.setFilter=(...e)=>{U1=e},Y.setLevel=(e=0)=>{V1=e};var ut=1e-6,fe=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function ct(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ft(e,n,t,r){var o=r[0],s=r[1],a=r[2],l=Math.hypot(o,s,a),i,u,c,f,p,v,d,h,y,x,g,m,S,z,b,P,w,A,E,_,M,D,O,N;return l<ut?null:(l=1/l,o*=l,s*=l,a*=l,i=Math.sin(t),u=Math.cos(t),c=1-u,f=n[0],p=n[1],v=n[2],d=n[3],h=n[4],y=n[5],x=n[6],g=n[7],m=n[8],S=n[9],z=n[10],b=n[11],P=o*o*c+u,w=s*o*c+a*i,A=a*o*c-s*i,E=o*s*c-a*i,_=s*s*c+u,M=a*s*c+o*i,D=o*a*c+s*i,O=s*a*c-o*i,N=a*a*c+u,e[0]=f*P+h*w+m*A,e[1]=p*P+y*w+S*A,e[2]=v*P+x*w+z*A,e[3]=d*P+g*w+b*A,e[4]=f*E+h*_+m*M,e[5]=p*E+y*_+S*M,e[6]=v*E+x*_+z*M,e[7]=d*E+g*_+b*M,e[8]=f*D+h*O+m*N,e[9]=p*D+y*O+S*N,e[10]=v*D+x*O+z*N,e[11]=d*D+g*O+b*N,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}function pt(){var e=new fe(3);return fe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ht(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function C1(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function dt(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function mt(e,n){var t=n[0],r=n[1],o=n[2],s=t*t+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function vt(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function yt(e,n,t){var r=n[0],o=n[1],s=n[2],a=t[0],l=t[1],i=t[2];return e[0]=o*i-s*l,e[1]=s*a-r*i,e[2]=r*l-o*a,e}function gt(e,n,t){var r=n[0],o=n[1],s=n[2],a=t[3]*r+t[7]*o+t[11]*s+t[15];return a=a||1,e[0]=(t[0]*r+t[4]*o+t[8]*s+t[12])/a,e[1]=(t[1]*r+t[5]*o+t[9]*s+t[13])/a,e[2]=(t[2]*r+t[6]*o+t[10]*s+t[14])/a,e}var xt=dt;(function(){var e=pt();return function(n,t,r,o,s,a){var l,i;for(t||(t=3),r||(r=0),o?i=Math.min(o*t+r,n.length):i=n.length,l=r;l<i;l+=t)e[0]=n[l],e[1]=n[l+1],e[2]=n[l+2],s(e,e,a),n[l]=e[0],n[l+1]=e[1],n[l+2]=e[2];return n}})();function bt(e){const n=2*Math.PI/e;return new Array(e).fill(null).map((r,o)=>[Math.cos(n*o),Math.sin(n*o)])}function wt(e,n){const t=new Uint16Array(e*(n-1)*6);for(let r=0;r<n;r++){const o=r*e*6,s=r*e;for(let a=0;a<e;a++){const l=o+a*6,i=s+a;t[l+0]=i,t[l+1]=i-e+1,t[l+2]=i+1,t[l+3]=i+1,t[l+4]=i+e,t[l+5]=i,a===e-1?(t[l+0]=i,t[l+1]=i-e+1,t[l+2]=i+1,t[l+3]=i+1,t[l+4]=i+e,t[l+5]=i):(t[l+0]=i,t[l+1]=i+1,t[l+2]=i+e+1,t[l+3]=i+e+1,t[l+4]=i+e,t[l+5]=i)}}return t}function Mt(e,n){const t=[],r=[],o=[],s={position:[],index:wt(n,e.length)},a=bt(n),l=a.length,i=e.length;for(let u=0;u<i;u++){const c=[0,0,1];u===0?C1(r,e[u],e[u+1]):u===i-1?C1(r,e[u-1],e[u]):C1(r,e[u-1],e[u+1]),mt(r,r),yt(o,c,r);const f=Math.acos(vt(c,r));ct(t),ft(t,t,f,o);for(let p=0;p<l;p++){const v=a[p],d=[v[0],v[1],0],h=e[u][3];xt(d,d,[h,h,1]),gt(d,d,t),ht(d,d,e[u]),s.position.push(d)}}return s}function o1(e,n,t){return e*(1-t)+n*t}function _t(e,n=0){const t=(e.length-1)*n,r=Math.floor(t),o=Math.ceil(t);return o1(e[o],e[r],o-t)}function pe(e,n){const t=(e.length/4-1)*n,r=Math.floor(t),o=Math.ceil(t),s=o-t;return[o1(e[o*4+0],e[r*4+0],s),o1(e[o*4+1],e[r*4+1],s),o1(e[o*4+2],e[r*4+2],s),o1(e[o*4+3],e[r*4+3],s)]}function he(e,n){const t=(e.length/4-1)*n,r=Math.floor(t),o=Math.ceil(t);return[e[o*4+0]-e[r*4+0],e[o*4+1]-e[r*4+1],e[o*4+2]-e[r*4+2],e[o*4+3]+e[r*4+3]/2]}function m1(...e){if(e.length===1)return e[0];const n=new Float32Array(e.reduce((c,f)=>c+f.position.length,0)),t=new Float32Array(e.reduce((c,f)=>c+f.normal.length,0)),r=new Float32Array(e.reduce((c,f)=>c+f.uv.length,0)),o=e.reduce((c,f)=>c+f.index.length,0),s=o>65536?new Uint32Array(o):new Uint16Array(o);let a=0,l=0,i=0,u=0;for(let c=0;c<e.length;c++){const f=e[c].normal,p=f.length;for(let m=0;m<p;m++)t[l+m]=f[m];l+=p;const v=e[c].uv,d=v.length;for(let m=0;m<d;m++)r[i+m]=v[m];i+=d;const h=e[c].index,y=h.length;for(let m=0;m<y;m++)s[m+u]=h[m]+a/3;u+=y;const x=e[c].position,g=x.length;for(let m=0;m<g;m++)n[a+m]=x[m];a+=g}return{position:n,normal:t,uv:r,index:s}}var Pt=(e,n)=>Math.sqrt(e*e+n*n),St=(e,n,t)=>Math.sqrt(e*e+n*n+t*t),a1={},v1={},s1={};Object.defineProperty(s1,"__esModule",{value:!0});function At(e){var n=new Uint32Array(1);return n[0]=e[0]*1664525+1013904223,n}s1.default=At,Object.defineProperty(v1,"__esModule",{value:!0}),v1.makeNoise2D=void 0;var y1=s1,Et=1/47,I1=(Math.sqrt(2+1)-1)/2,zt=(1/Math.sqrt(2+1)-1)/2;function de(e,n,t){return{dx:-n-e*I1,dy:-t-e*I1,xsb:n,ysb:t}}function Dt(e){for(var n=[],t=0;t<i1.length;t+=4){for(var r=Ot[i1[t]],o=null,s=null,a=0;a<r.length;a+=3)s=de(r[a],r[a+1],r[a+2]),o===null?n[t/4]=s:o.next=s,o=s;s.next=de(i1[t+1],i1[t+2],i1[t+3])}for(var l=[],t=0;t<k1.length;t+=2)l[k1[t]]=n[k1[t+1]];for(var i=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256),t=0;t<256;t++)c[t]=t;var f=new Uint32Array(1);f[0]=e,f=y1.default(y1.default(y1.default(f)));for(var t=255;t>=0;t--){f=y1.default(f);var p=new Uint32Array(1);p[0]=(f[0]+31)%(t+1),p[0]<0&&(p[0]+=t+1),i[t]=c[p[0]],u[t]=i[t]&14,c[p[0]]=c[t]}return function(v,d){for(var h=(v+d)*zt,y=v+h,x=d+h,g=Math.floor(y),m=Math.floor(x),S=(g+m)*I1,z=v-(g+S),b=d-(m+S),P=y-g,w=x-m,A=P+w,E=P-w+1|A<<1|A+w<<2|A+P<<4,_=0,M=l[E];M!==void 0;M=M.next){var D=z+M.dx,O=b+M.dy,N=2-D*D-O*O;if(N>0){var V=g+M.xsb,j=m+M.ysb,L=i[V&255],q=u[L+j&255],W=me[q]*D+me[q+1]*O;_+=N*N*N*N*W}}return _*Et}}v1.makeNoise2D=Dt;var Ot=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],me=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],k1=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],i1=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],g1={};Object.defineProperty(g1,"__esModule",{value:!0}),g1.makeNoise3D=void 0;var x1=s1,Nt=1/103,b1=(Math.sqrt(3+1)-1)/3,jt=(1/Math.sqrt(3+1)-1)/3;function G1(e,n,t,r){return{dx:-n-e*b1,dy:-t-e*b1,dz:-r-e*b1,xsb:n,ysb:t,zsb:r}}function Rt(e){for(var n=[],t=0;t<I.length;t+=9){for(var r=Lt[I[t]],o=null,s=null,a=0;a<r.length;a+=4)s=G1(r[a],r[a+1],r[a+2],r[a+3]),o===null?n[t/9]=s:o.next=s,o=s;s.next=G1(I[t+1],I[t+2],I[t+3],I[t+4]),s.next.next=G1(I[t+5],I[t+6],I[t+7],I[t+8])}for(var l=[],t=0;t<H1.length;t+=2)l[H1[t]]=n[H1[t+1]];for(var i=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256),t=0;t<256;t++)c[t]=t;var f=new Uint32Array(1);f[0]=e,f=x1.default(x1.default(x1.default(f)));for(var t=255;t>=0;t--){f=x1.default(f);var p=new Uint32Array(1);p[0]=(f[0]+31)%(t+1),p[0]<0&&(p[0]+=t+1),i[t]=c[p[0]],u[t]=i[t]%24*3,c[p[0]]=c[t]}return function(v,d,h){for(var y=(v+d+h)*jt,x=v+y,g=d+y,m=h+y,S=Math.floor(x),z=Math.floor(g),b=Math.floor(m),P=(S+z+b)*b1,w=v-(S+P),A=d-(z+P),E=h-(b+P),_=x-S,M=g-z,D=m-b,O=_+M+D,N=M-D+1|_-M+1<<1|_-D+1<<2|O<<3|O+D<<5|O+M<<7|O+_<<9,V=0,j=l[N];j!==void 0;j=j.next){var L=w+j.dx,q=A+j.dy,W=E+j.dz,B=2-L*L-q*q-W*W;if(B>0){var T=S+j.xsb,u1=z+j.ysb,c1=b+j.zsb,f1=i[T&255],p1=i[f1+u1&255],G=u[p1+c1&255],K1=B1[G]*L+B1[G+1]*q+B1[G+2]*W;V+=B*B*B*B*K1}}return V*Nt}}g1.makeNoise3D=Rt;var Lt=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],B1=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],H1=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],I=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],w1={};Object.defineProperty(w1,"__esModule",{value:!0}),w1.makeNoise4D=void 0;var M1=s1,Tt=1/30,l1=(Math.sqrt(4+1)-1)/4,$t=(1/Math.sqrt(4+1)-1)/4;function _1(e,n,t,r,o){return{dx:-n-e*l1,dy:-t-e*l1,dz:-r-e*l1,dw:-o-e*l1,xsb:n,ysb:t,zsb:r,wsb:o}}function Ut(e){for(var n=[],t=0;t<R.length;t+=16){for(var r=Vt[R[t]],o=null,s=null,a=0;a<r.length;a+=5)s=_1(r[a],r[a+1],r[a+2],r[a+3],r[a+4]),o===null?n[t/16]=s:o.next=s,o=s;s.next=_1(R[t+1],R[t+2],R[t+3],R[t+4],R[t+5]),s.next.next=_1(R[t+6],R[t+7],R[t+8],R[t+9],R[t+10]),s.next.next.next=_1(R[t+11],R[t+12],R[t+13],R[t+14],R[t+15])}for(var l=[],t=0;t<Y1.length;t+=2)l[Y1[t]]=n[Y1[t+1]];for(var i=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256),t=0;t<256;t++)c[t]=t;var f=new Uint32Array(1);f[0]=e,f=M1.default(M1.default(M1.default(f)));for(var t=255;t>=0;t--){f=M1.default(f);var p=new Uint32Array(1);p[0]=(f[0]+31)%(t+1),p[0]<0&&(p[0]+=t+1),i[t]=c[p[0]],u[t]=i[t]&252,c[p[0]]=c[t]}return function(v,d,h,y){for(var x=(v+d+h+y)*$t,g=v+x,m=d+x,S=h+x,z=y+x,b=Math.floor(g),P=Math.floor(m),w=Math.floor(S),A=Math.floor(z),E=(b+P+w+A)*l1,_=v-(b+E),M=d-(P+E),D=h-(w+E),O=y-(A+E),N=g-b,V=m-P,j=S-w,L=z-A,q=N+V+j+L,W=j-L+1|V-j+1<<1|V-L+1<<2|N-V+1<<3|N-j+1<<4|N-L+1<<5|q<<6|q+L<<8|q+j<<11|q+V<<14|q+N<<17,B=0,T=l[W];T!==void 0;T=T.next){var u1=_+T.dx,c1=M+T.dy,f1=D+T.dz,p1=O+T.dw,G=2-u1*u1-c1*c1-f1*f1-p1*p1;if(G>0){var K1=b+T.xsb,cn=P+T.ysb,fn=w+T.zsb,pn=A+T.wsb,hn=i[K1&255],dn=i[hn+cn&255],mn=i[dn+fn&255],E1=u[mn+pn&255],vn=P1[E1]*u1+P1[E1+1]*c1+P1[E1+2]*f1+P1[E1+3]*p1;B+=G*G*G*G*vn}}return B*Tt}}w1.makeNoise4D=Ut;var Vt=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],P1=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],Y1=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],R=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.makeNoise4D=e.makeNoise3D=e.makeNoise2D=void 0;var n=v1;Object.defineProperty(e,"makeNoise2D",{enumerable:!0,get:function(){return n.makeNoise2D}});var t=g1;Object.defineProperty(e,"makeNoise3D",{enumerable:!0,get:function(){return t.makeNoise3D}});var r=w1;Object.defineProperty(e,"makeNoise4D",{enumerable:!0,get:function(){return r.makeNoise4D}})})(a1);let e1=0,W1=a1.makeNoise2D(e1),ve=a1.makeNoise3D(e1);var t1={n1d:e=>W1(e,0),n2d:(e,n)=>W1(e,n),n3d:(e,n,t)=>ve(e,n,t),get seed(){return e1},set seed(e){e1=e,W1=a1.makeNoise2D(e1),ve=a1.makeNoise3D(e1)}},ye=([e,n])=>{const t=Pt(e,n);return t===0?[1,0]:[e/t,n/t]},qt=(e,n,t)=>{const r=St(e,n,t);return[e/r,n/r,t/r]},ge=(e,n,t)=>[e*Math.cos(t)-n*Math.sin(t),e*Math.sin(t)+n*Math.cos(t)];function J1(e,n,t){const[r,o,s]=e,[a,l,i]=qt(n[0],n[1],n[2]),u=Math.cos(t),c=Math.sin(t);return new Q((u+(1-u)*a*a)*r+((1-u)*a*l-i*c)*o+((1-u)*a*i+l*c)*s,((1-u)*a*l+i*c)*r+(u+(1-u)*l*l)*o+((1-u)*l*i-a*c)*s,((1-u)*a*i-l*c)*r+((1-u)*l*i+a*c)*o+(u+(1-u)*i*i)*s)}function Ft(e,{res:n=1,xCurvature:t=.5,yCurvature:r=.2}={}){const o=e.length,s=3+n*2,a=s*o,l=(s-1)*(o-1)*2,i=new Float32Array(a*3),u=new Float32Array(a*2),c=new Float32Array(a*2),f=new Uint16Array(l*3);return e.forEach((p,v)=>{const d=v*s;for(let h=0;h<s;h++){const y=2-h/(s-1)*2-1;i[d*3+h*3+0]=(p.x-1)*y*.5;const x=-(1-p.y)*(1-p.y)*.5,g=Math.sin(Math.abs(y)*Math.PI)*.01;if(i[d*3+h*3+1]=g*t+x*r,i[d*3+h*3+2]=p.y-1,c[d*2+h*2+0]=i[d*3+h*3+0]+1/2,c[d*2+h*2+1]=i[d*3+h*3+2],v<e.length-1){const m=v*(s-1);f[m*6+h*6+0]=d+h+0,f[m*6+h*6+1]=d+h+1,f[m*6+h*6+2]=d+h+s,f[m*6+h*6+3]=d+h+1,f[m*6+h*6+4]=d+h+s,f[m*6+h*6+5]=d+h+s+1}}}),{position:i,normal:u,index:f,uv:c}}function xe(e,n=8){const t=rt(e,4),r=Mt(t,n);return{position:Float32Array.from(r.position.map(s=>s.splice(0,3)).flat()),index:r.index,normal:new Float32Array,uv:new Float32Array}}var S1=e=>typeof e=="object"&&"type"in e,be=(()=>{let e=Math.random();return()=>(e=e>0?e-Math.random():e+Math.random(),e.toString().split(".")[1])})();const Ct={title:"Branches",type:"branches",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},length:{type:["number","parameter","curve"],min:0,max:3,step:.05,value:.8},thiccness:{type:"number",min:0,max:1,step:.01,value:.8},offsetSingle:{type:"number",min:0,max:1,step:.01,value:.5},lowestBranch:{type:"number",min:0,max:1,step:.01,value:.2},amount:{type:"number",min:0,max:64,value:10}},computeSkeleton(e,n){const{skeletons:t}=e.input.result,r=n.getSetting("stemResY"),o=t.map(s=>{const a=[],l=n.handleParameter(e.amount),i=n.handleParameter(e.lowestBranch);for(let u=0;u<l;u++){const c=u/l,f=n.handleParameter(e.length,c)*(1-c),p=n.handleParameter(e.thiccness,c),v=n.handleParameter(e.offsetSingle,c),d=u%2==0;let h=i+(1-i)*c;h-=1/l*v*(d?-1:1);const[y,,x]=he(s,h),g=ye([y,x]),[m,S]=ge(g[0],g[1],d?-Math.PI/2:Math.PI/2),[z,b,P,w]=pe(s,h),A=Math.max(Math.floor(r*f*10),4),E=new Float32Array(A*4);for(let _=0;_<A*4;_++){const M=_/A;E[_*4+0]=z+m*M*f,E[_*4+1]=b,E[_*4+2]=P+S*M*f,E[_*4+3]=w*p*(1-M)}a.push(E)}return a}).flat();return{skeletons:o,allSkeletons:[...o,...t]}},computeGeometry(e,n,t){const r=t.getSetting("stemResX"),{geometry:o}=e.input.result,{skeletons:s}=n;return{geometry:m1(o,...s.map(a=>xe(a,r)))}}},It={title:"Curve",type:"curve",outputs:["number"],parameters:{value:{type:"curve",inputType:"curve",internal:!0,label:!1,value:[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}},computeValue(e,n,t){const r=et(e.value).map(o=>o.y);return _t(r,1-t)}},kt={title:"Gravity",type:"gravity",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,type:"select",values:["simple","verlet","test"]},strength:{type:"number",inputType:"slider",min:0,max:2,step:.05}},computeSkeleton(e,n){const{input:t,type:r,strength:o}=e,{skeletons:s}=t.result;return r==="simple"&&s.forEach(a=>{const l=a.length/4;for(let i=1;i<l;i++){const u=i/l,c=a[i*4+1],f=n.handleParameter(o,u);a[i*4+1]=c-c*u*u*u*f}return a}),r==="test"&&s.forEach(a=>{const l=a.length/4;for(let i=1;i<l;i++){const u=i/l,c=n.handleParameter(o,u),f=a[i*4+0],p=a[i*4+1],v=a[i*4+2],d=a[(i-1)*4+0],h=a[(i-1)*4+1],y=a[(i-1)*4+2],x=d-f,g=h-p,m=h-v,[S,z]=ge(x,m,90);for(let b=i;b<l;b++){const P=a[b*4+0],w=a[b*4+1],A=a[b*4+2],E=P-d,_=w-h,M=A-y;let[D,O,N]=J1([E,_,M],[S,g,z],c*u);const V=D+d,j=O+h,L=N+y;a[b*4+0]=V,a[b*4+1]=j,a[b*4+2]=L}}return a}),r==="verlet"&&s.forEach(a=>{const l=a.length/4;for(let i=1;i<l;i++){const u=a[i*4+0],c=a[i*4+1],f=a[i*4+2],p=new Q(5,0,0).cross(new Q(u,c,f),new Q(0,1,0)),v=i/l,d=n.handleParameter(o,v);for(let h=i;h<l;h++){const y=J1([u,c,f],p,v*d);a[h*4+0]=y[0],a[h*4+1]=y[1],a[h*4+2]=y[2]}}return a}),{skeletons:s}},computeGeometry(e){return e.input.result}},Q1=Y("nodes.join"),Gt={title:"Join",type:"join",outputs:["plant"],parameters:{inputA:{type:"plant",label:"plant",external:!0},inputB:{type:"plant",label:"plant",external:!0}},computeSkeleton(e,n){Q1("compute skeleton",e,n);const{inputA:t,inputB:r}=e;if(!t||!r)return t?t.result:r.result;const{skeletons:o,allSkeletons:s}=t.result,{skeletons:a,allSkeletons:l}=r.result;Q1(o,a);const i=[...o,...a],u=[];return s&&u.push(...s),l&&u.push(...l),{allSkeletons:u,skeletons:i}},computeGeometry(e){const{inputA:n,inputB:t}=e;if(!n||!t)return n?n.result:t.result;const{geometry:r,instances:o}=n.result,{geometry:s,instances:a}=t.result,l=m1(r,s),i=[];return o&&i.push(...o),a&&i.push(...a),Q1("compute geometry",{geometryA:r,geometryB:s,result:l}),{geometry:l,instances:i}}},Bt={title:"Leaf",type:"leaf",outputs:["plant","leaf"],parameters:{input:{type:"plant",external:!0},size:{type:["number","parameter","curve","vec2"],inputType:"slider",min:0,max:3,step:.05,value:.2},shape:{type:"leaf",external:!0,defaultValue:[{x:1,y:1,pinned:!0},{x:.62,y:.84,pinned:!1},{x:.54,y:.63,pinned:!1},{x:.38,y:.41,pinned:!0},{x:.44,y:.23,pinned:!1},{x:.64,y:.12,pinned:!1},{x:.98,y:.02,pinned:!0}]},lowestLeaf:{type:"number",inputType:"slider",min:0,max:1,step:.01,value:.5},curvature:{external:!0,type:"vec2",defaultValue:{x:.5,y:.2}},amount:{type:"number",min:0,max:20,value:10}},computeSkeleton(e,n){const{input:t}=e,{skeletons:r}=t.result,o=r.map((s,a)=>{const l=a/r.length,i=n.handleParameter(e.amount,l),u=new Float32Array(i*3),c=new Float32Array(i*3),f=new Float32Array(i*3);for(let p=0;p<i;p++){const v=p/(i-1),d=n.handleParameter(e.size,1-v),h=n.handleParameter(e.lowestLeaf,v),y=h+(1-h)*v-.001,[x,g,m]=pe(s,y),[S,,z]=he(s,y),b=ye([S,z]),P=Math.atan2(-b[0],b[1]);u[p*3+0]=x,u[p*3+1]=g,u[p*3+2]=m,c[p*3+0]=d,c[p*3+1]=1,c[p*3+2]=d,f[p*3+0]=0,f[p*3+1]=P-Math.PI/2*(p%2==0?-1:1),f[p*3+2]=0}return{offset:u,scale:c,rotation:f}});return{allSkeletons:t.result.allSkeletons,skeletons:r,instances:o}},computeGeometry(e,n,t){const{shape:r,input:o,curvature:s}=e,{instances:a}=n,l=t.handleParameter(s),i=Ft(t.handleParameter(r),{res:t.getSetting("leafRes",2),xCurvature:l.x,yCurvature:l.y});return{geometry:o.result.geometry,instances:a.map(u=>h1(h1({},u),i))}}},Ht={title:"Math",type:"math",outputs:["number"],parameters:{mode:{type:"whatever",internal:!0,inputType:"selection",label:!1,defaultValue:"add",values:["add","multiply","subtract"]},a:{type:"number",defaultValue:0,label:!1},b:{type:"number",defaultValue:0,label:!1}},computeValue(e,n,t){const{mode:r}=e,o=n.handleParameter(e.a,t),s=n.handleParameter(e.b,t);switch(r){case"multiply":return o*s;case"subtract":return o-s;default:return o+s}}},Yt=Y("nodes.noise"),Wt={title:"Noise",type:"noise",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},size:{type:"number",inputType:"slider",min:0,max:20,step:.05,value:1},strength:{type:"number",inputType:"slider",min:0,max:2,step:.01,value:.5}},computeSkeleton(e,n){Yt(e);const{input:t}=e,r=n.handleParameter(e.size),o=n.handleParameter(e.strength),{skeletons:s}=t.result;return s.forEach((a,l)=>{const i=a.length/4,u=[a[0],a[1],a[2]];let c=0;for(let f=0;f<i;f++){const p=f/i;c+=(Math.abs(u[0]-a[f*4+0])+Math.abs(u[1]-a[f*4+1])+Math.abs(u[2]-a[f*4+2]))/3,u[0]=a[f*4+0],u[1]=a[f*4+1],u[2]=a[f*4+2],a[f*4+0]=a[f*4+0]+t1.n1d(c*r+0+l*500)*o*p,a[f*4+1]=a[f*4+1]+t1.n1d(c*r+1e3+l*500)*o*p,a[f*4+2]=a[f*4+2]+t1.n1d(c*r+2e3+l*500)*o*p}}),{skeletons:s,allSkeletons:t.result.allSkeletons}},computeGeometry(e){return e.input.result}},Jt={title:"Output",type:"output",outputs:[],parameters:{main:{type:"plant",label:"plant",external:!0}},computeNode(e={}){return e.main}},Qt={title:"Parameter",type:"parameter",outputs:["number"],parameters:{value:{type:"number",value:0},variation:{type:"number",inputType:"slider",value:0,min:0,max:1,step:.05}},computeValue(e,n){const{value:t=0,variation:r=0}=e;return r?t+n.n1d(200)*r*Math.max(t,1):t}},Zt=e=>e==="X"?[1,0,0]:e==="Z"?[0,0,1]:[0,1,0],Kt={title:"Rotate",type:"rotate",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,label:!1,type:"select",values:["Y","X","Z"]},spread:{internal:!0,type:"boolean",value:!0},angle:{type:"number",inputType:"slider",min:0,max:Math.PI*2,step:.05,value:0}},computeSkeleton(e,n){const{input:t,type:r,spread:o}=e,{result:{skeletons:s,allSkeletons:a}}=t,l=Zt(r);return s.forEach((i,u)=>{const c=i.length/4,f=i[0],p=i[1],v=i[2],d=u/s.length,h=n.handleParameter(e.angle,d)*(o?d:1);for(let y=1;y<c;y++){let x=i[y*4+0],g=i[y*4+1],m=i[y*4+2];x-=f,g-=p,m-=v,[x,g,m]=J1([x,g,m],l,h),x+=f,g+=p,m+=v,i[y*4+0]=x,i[y*4+1]=g,i[y*4+2]=m}}),{skeletons:s,allSkeletons:a}},computeGeometry(e){return e.input.result}},Xt={title:"Shape",type:"shape",outputs:["leaf"],parameters:{value:{type:"leaf",inputType:"shape",internal:!0,label:!1,value:[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}},computeValue(e){return e.value}},en={title:"Slider",type:"slider",outputs:["number"],parameters:{value:{type:"number",label:!1,inputType:"slider",internal:!0,min:0,max:1,step:.01,value:0}},computeValue(e){return e.value}},we=Y("nodes.stem");var tn=Object.freeze({__proto__:null,Branch:Ct,Curve:It,Gravity:kt,Join:Gt,Leaf:Bt,Math:Ht,Noise:Wt,Output:Jt,Parameter:Qt,Rotate:Kt,Shape:Xt,Slider:en,Stem:{title:"Stem",type:"stem",outputs:["plant"],parameters:{origin:{type:"vec3",external:!0,defaultValue:{x:0,y:0,z:0}},height:{type:"number",inputType:"slider",min:0,max:5,step:.05,value:2},thiccness:{type:"number",inputType:"slider",min:0,max:.2,step:.01,value:.06},amount:{type:"number",min:0,max:20,value:1}},computeSkeleton(e,n){we("computeSkeleton",e);const t=n.handleParameter(e.amount),r=n.getSetting("stemResY"),o=[];for(let s=0;s<t;s++){const{x:a,y:l,z:i}=n.handleParameter(e.origin),u=n.handleParameter(e.height),c=new Float32Array(r*4);for(let f=0;f<r;f++){const p=f/r,v=n.handleParameter(e.thiccness,p)*(1-p),d=a,h=l+p*u,y=i;c[f*4+0]=d,c[f*4+1]=h,c[f*4+2]=y,c[f*4+3]=v}o.push(c)}return{skeletons:o,allSkeletons:o}},computeGeometry(e,n,t){we("computeNode",e,n);const r=t.getSetting("stemResX");return{geometry:m1(...n.skeletons.map(o=>xe(o,r)))}}},Vec2:{title:"Vec2",type:"vec2",outputs:["vec2"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0}}},Vec3:{title:"Vec3",type:"vec3",outputs:["vec3"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0},z:{label:!1,type:"number",value:0,defaultValue:0}}}});const nn=Object.values(tn).map(e=>("computeNode"in e?e.compute=e.computeNode:e.compute=n=>({type:e.type,parameters:n}),e)),k={};nn.forEach(e=>{k[e.type]=e,"computeSkeleton"in e&&(e.computeSkeleton=T1(e.computeSkeleton)),"computeGeometry"in e&&(e.computeGeometry=T1(e.computeGeometry)),"computeValue"in e&&(e.computeValue=T1(e.computeValue))});function rn(e,n){return e.type in k&&k[e.type].computeSkeleton?k[e.type].computeSkeleton(e.computedParameters,n):e.computedParameters}function on(e,n){return e.type in k&&k[e.type].computeGeometry?k[e.type].computeGeometry(e.computedParameters,e.result,n):e.computedParameters}function an(e,n,t){return e.type in k&&k[e.type].computeValue?k[e.type].computeValue(e.computedParameters,n,t):e.computedParameters}const Me=(e,n)=>(e.computedParameters={},Object.entries(e.parameters).forEach(([t,r])=>{S1(r)?e.computedParameters[t]=Me(r,n):e.computedParameters[t]=r}),e.result=rn(e,n),e),_e=(e,n)=>(e.computedParameters={},Object.entries(e.parameters).forEach(([t,r])=>{S1(r)?e.computedParameters[t]=_e(r,n):e.computedParameters[t]=r}),e.result=h1(h1({},e.result),on(e,n)),e),Pe=(e,n,t)=>{var r;return e.computedParameters=(r=e.computedParameters)!=null?r:{},Object.entries(e.parameters).forEach(([o,s])=>{S1(s)?e.computedParameters[o]=Pe(s,n,t):e.computedParameters[o]=s}),an(e,n,t)};let Se="",Z1,Ae=0;const sn=e=>{let n=0;t1.seed=0;let t=be();return{handleParameter(r,o=1){return typeof r=="number"?r:S1(r)?Pe(r,this,o):r},n1d(r){return t1.n1d(Ae++*r)},getSetting(r){return e[r]},get settings(){return e},get seed(){return n},refresh(){Ae=0,(e==null?void 0:e.useRandomSeed)&&(n=Math.floor(Math.random()*1e5),t1.seed=n),t=be()}}};var ln=e=>{const n=JSON.stringify(e);return n!==Se&&(Se=n,Z1=sn(e)),Z1.refresh(),Z1};const A1=Y("gen.plant");function un(e,n){var l;A1("-------- ~generator started~ --------");const t=performance.now(),r=ln(n),o=Me(e,r);A1("final skeleton",o.result);const s=_e(o,r);A1("final geometry",s);const{result:a}=s;if(a.instances){const i=(l=a.instances)==null?void 0:l.map(u=>Ze(u)).flat();a.geometry=m1(a.geometry,...i)}return A1("generated in ",Math.floor((performance.now()-t)*10)/10,"ms"),a}D1({plant:un})})();
