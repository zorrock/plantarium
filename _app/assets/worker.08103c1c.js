var O0=Object.defineProperty,T0=Object.defineProperties;var R0=Object.getOwnPropertyDescriptors;var Ke=Object.getOwnPropertySymbols;var $0=Object.prototype.hasOwnProperty,P0=Object.prototype.propertyIsEnumerable;var en=(F,C,P)=>C in F?O0(F,C,{enumerable:!0,configurable:!0,writable:!0,value:P}):F[C]=P,m1=(F,C)=>{for(var P in C||(C={}))$0.call(C,P)&&en(F,P,C[P]);if(Ke)for(var P of Ke(C))P0.call(C,P)&&en(F,P,C[P]);return F},ae=(F,C)=>T0(F,R0(C));(function(){"use strict";const F=class extends Error{constructor(e,n={}){super(e),this.detail=e,this.meta=n}static fromParent(e,n,t,r){return new F(t,Object.assign({cause:e},r))}getCause(){return this.meta.cause||void 0}unwrapChain(e=this){return F.unwrapChain(e)}};let C=F;C.unwrapChain=e=>{const n=[e];let t=e.getCause();for(;t;)n.push(t),t=t.getCause();return n};const P=.4;function nn(e,n,t,r,a,s,i,l,c,o){const v=a-t,h=i-a,f=c-i,u=s-r,m=l-s,d=o-l;let p,y,x,M,w=-1e4,b=-1e4;const g=[{x:t,y:r}];for(let z=1;z<e;z++){const A=z/e;p=t+v*A,x=a+h*A;const D=i+f*A;p+=(x-p)*A,x+=(D-x)*A,y=r+u*A,M=s+m*A;const O=l+d*A;y+=(M-y)*A,M+=(O-M)*A;const _=p+(x-p)*A,S=y+(M-y)*A,E=_-w,N=S-b;E*E+N*N>n&&(g.push({x:_,y:S}),w=_,b=S)}return g.push({x:c,y:o}),g}function tn(e){const n=e.length-1;return e.map((t,r,a)=>{if(r===0)return{rx:a[r+1].x*P*0,ry:t.y+(a[r+1].y-t.y)*P*0};if(r===n)return{lx:a[r-1].x+(t.x-a[r-1].x)*P*2,ly:a[r-1].y+(t.y-a[r-1].y)*P*2};if(t.y>a[r+1].y&&t.y>a[r-1].y||t.y<a[r+1].y&&t.y<a[r-1].y)return{lx:a[r-1].x+(t.x-a[r-1].x)*P,ly:t.y,rx:t.x+(a[r+1].x-t.x)*P,ry:t.y};{const i={x:a[r-1].x-a[r+1].x,y:a[r-1].y-a[r+1].y},l=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));i.x/=l,i.y/=l;const c=a[r+1].x-t.x,o=t.x-a[r-1].x;return{lx:t.x+i.x*o*P,ly:t.y+i.y*o*P,rx:t.x-i.x*c*P,ry:t.y-i.y*c*P}}})}function rn(e){const n=e.length-1,t={},r=tn(e);return e.map((a,s,i)=>{if(s<n)return nn(n*20,0,a.x,a.y,r[s].rx,r[s].ry,r[s+1].lx,r[s+1].ly,i[s+1].x,i[s+1].y)}).flat().filter(a=>!a||a.x in t?!1:(t[a.x]=!0,!0))}var i1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},an={exports:{}};(function(e,n){(function(t,r){r()})(i1,function(){function t(o,v){return typeof v=="undefined"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function r(o,v,h){var f=new XMLHttpRequest;f.open("GET",o),f.responseType="blob",f.onload=function(){c(f.response,v,h)},f.onerror=function(){console.error("could not download file")},f.send()}function a(o){var v=new XMLHttpRequest;v.open("HEAD",o,!1);try{v.send()}catch{}return 200<=v.status&&299>=v.status}function s(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(v)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof i1=="object"&&i1.global===i1?i1:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(o,v,h){var f=i.URL||i.webkitURL,u=document.createElement("a");v=v||o.name||"download",u.download=v,u.rel="noopener",typeof o=="string"?(u.href=o,u.origin===location.origin?s(u):a(u.href)?r(o,v,h):s(u,u.target="_blank")):(u.href=f.createObjectURL(o),setTimeout(function(){f.revokeObjectURL(u.href)},4e4),setTimeout(function(){s(u)},0))}:"msSaveOrOpenBlob"in navigator?function(o,v,h){if(v=v||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(t(o,h),v);else if(a(o))r(o,v,h);else{var f=document.createElement("a");f.href=o,f.target="_blank",setTimeout(function(){s(f)})}}:function(o,v,h,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof o=="string")return r(o,v,h);var u=o.type==="application/octet-stream",m=/constructor/i.test(i.HTMLElement)||i.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||u&&m||l)&&typeof FileReader!="undefined"){var p=new FileReader;p.onloadend=function(){var M=p.result;M=d?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=M:location=M,f=null},p.readAsDataURL(o)}else{var y=i.URL||i.webkitURL,x=y.createObjectURL(o);f?f.location=x:location.href=x,f=null,setTimeout(function(){y.revokeObjectURL(x)},4e4)}});i.saveAs=c.saveAs=c,e.exports=c})})(an);const sn={amountEmitters:0,amountCallbacks:0,emitters:[]};typeof self!="undefined"&&"window"in self&&(globalThis.debug=sn);function $1(e){let n,t={length:NaN};const r=(a,s)=>a===t[s];return function(...s){return(s.length!==t.length||!s.every(r))&&(t=s,n=e.apply(this,s)),n}}function se(e){let n=e[0],t=e[1],r=e[2];return Math.sqrt(n*n+t*t+r*r)}function P1(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ln(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e}function ie(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function le(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function cn(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function on(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function j1(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function fn(e,n){let t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return Math.sqrt(t*t+r*r+a*a)}function hn(e,n){let t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return t*t+r*r+a*a}function ce(e){let n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function vn(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function pn(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function L1(e,n){let t=n[0],r=n[1],a=n[2],s=t*t+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function oe(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function fe(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[0],l=t[1],c=t[2];return e[0]=a*c-s*l,e[1]=s*i-r*c,e[2]=r*l-a*i,e}function un(e,n,t,r){let a=n[0],s=n[1],i=n[2];return e[0]=a+r*(t[0]-a),e[1]=s+r*(t[1]-s),e[2]=i+r*(t[2]-i),e}function dn(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s+t[12])/i,e[1]=(t[1]*r+t[5]*a+t[9]*s+t[13])/i,e[2]=(t[2]*r+t[6]*a+t[10]*s+t[14])/i,e}function mn(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s)/i,e[1]=(t[1]*r+t[5]*a+t[9]*s)/i,e[2]=(t[2]*r+t[6]*a+t[10]*s)/i,e}function yn(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[0],l=t[1],c=t[2],o=t[3],v=l*s-c*a,h=c*r-i*s,f=i*a-l*r,u=l*f-c*h,m=c*v-i*f,d=i*h-l*v,p=o*2;return v*=p,h*=p,f*=p,u*=2,m*=2,d*=2,e[0]=r+v+u,e[1]=a+h+m,e[2]=s+f+d,e}const xn=function(){const e=[0,0,0],n=[0,0,0];return function(t,r){P1(e,t),P1(n,r),L1(e,e),L1(n,n);let a=oe(e,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}}();function gn(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}const Mn=e=>!!e.length;class I extends Array{constructor(n=0,t=n,r=n){return super(n,t,r),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(n){this[0]=n}set y(n){this[1]=n}set z(n){this[2]=n}set(n,t=n,r=n){return Mn(n)?this.copy(n):(ln(this,n,t,r),this)}copy(n){return P1(this,n),this}add(n,t){return t?ie(this,n,t):ie(this,this,n),this}sub(n,t){return t?le(this,n,t):le(this,this,n),this}multiply(n){return n.length?cn(this,this,n):j1(this,this,n),this}divide(n){return n.length?on(this,this,n):j1(this,this,1/n),this}inverse(n=this){return pn(this,n),this}len(){return se(this)}distance(n){return n?fn(this,n):se(this)}squaredLen(){return ce(this)}squaredDistance(n){return n?hn(this,n):ce(this)}negate(n=this){return vn(this,n),this}cross(n,t){return t?fe(this,n,t):fe(this,this,n),this}scale(n){return j1(this,this,n),this}normalize(){return L1(this,this),this}dot(n){return oe(this,n)}equals(n){return gn(this,n)}applyMatrix4(n){return dn(this,this,n),this}scaleRotateMatrix4(n){return mn(this,this,n),this}applyQuaternion(n){return yn(this,this,n),this}angle(n){return xn(this,n)}lerp(n,t){return un(this,this,n,t),this}clone(){return new I(this[0],this[1],this[2])}fromArray(n,t=0){return this[0]=n[t],this[1]=n[t+1],this[2]=n[t+2],this}toArray(n=[],t=0){return n[t]=this[0],n[t+1]=this[1],n[t+2]=this[2],n}transformDirection(n){const t=this[0],r=this[1],a=this[2];return this[0]=n[0]*t+n[4]*r+n[8]*a,this[1]=n[1]*t+n[5]*r+n[9]*a,this[2]=n[2]*t+n[6]*r+n[10]*a,this.normalize()}}const he={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function ve(e){e.length===4&&(e=e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n||console.warn(`Unable to convert hex string ${e} to rgb values`),[parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255]}function wn(e){return e=parseInt(e),[(e>>16&255)/255,(e>>8&255)/255,(e&255)/255]}function pe(e=null){return e?arguments.length===3?arguments:isNaN(e)?e[0]==="#"?ve(e):he[e.toLowerCase()]?ve(he[e.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):wn(e):[0,0,0]}class bn extends Array{constructor(n=null){Array.isArray(n)?super(...n):super(...pe(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(n){this[0]=n}set g(n){this[1]=n}set b(n){this[2]=n}set(n){return Array.isArray(n)?this.copy(n):this.copy(pe(...arguments))}copy(n){return this[0]=n[0],this[1]=n[1],this[2]=n[2],this}}function q1(){}function zn(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}Promise.resolve();const e1=[];function An(e,n=q1){let t;const r=new Set;function a(l){if(zn(e,l)&&(e=l,t)){const c=!e1.length;for(const o of r)o[1](),e1.push(o,e);if(c){for(let o=0;o<e1.length;o+=2)e1[o][0](e1[o+1]);e1.length=0}}}function s(l){a(l(e))}function i(l,c=q1){const o=[l,c];return r.add(o),r.size===1&&(t=n(a)||q1),l(e),()=>{r.delete(o),r.size===0&&(t(),t=null)}}return{set:a,update:s,subscribe:i}}const Sn=typeof globalThis.WorkerGlobalScope!="undefined"&&self instanceof globalThis.WorkerGlobalScope;let y1=[],x1=2,Z=0,ue=0;const V1="plant.log.history",I1="localStorage"in globalThis,n1=I1?V1 in localStorage?JSON.parse(localStorage.getItem(V1)):[]:[];I1&&(x1=parseInt(localStorage.getItem("pt-log-level"))||2);function Nn(){I1&&localStorage.setItem(V1,JSON.stringify(n1))}let t1;function W(e){Z=Math.max(Z,e.length);const n=ue;ue++;const t=(a,s)=>{if(!Sn&&(n1.push({scope:e,args:a,level:x1,date:Date.now()}),n1.length=Math.min(100,n1.length),t1&&t1.set(n1),Nn(),(!y1.length||y1.includes(e))&&s<=x1)){if(a instanceof Error){console.error(`[${e.padEnd(Z," ")}]`,a);return}if(Array.isArray(a)&&typeof a[0]=="string"&&typeof a[1]=="object"){console.groupCollapsed(`%c[${e.padEnd(Z," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,a[0]),console.log(...a.slice(1)),console.groupEnd();return}if(s===0){console.error(`%c[${e.padEnd(Z," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,...a);return}if(s===1){console.warn(`[${e.padEnd(Z," ")}]`,...a);return}s===2&&console.log(`%c[${e.padEnd(Z," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,...a)}},r=(...a)=>t(a,2);return r.warn=(...a)=>t(a,1),r.error=a=>t(a,0),r}W.getStore=function(){return t1||(t1=An([]),t1)},W.getHistory=function(){return[...n1]},W.setFilter=(...e)=>{y1=e,console.log("[log] set filter",{filters:y1})},W.setLevel=(e=0)=>{x1=e,localStorage.setItem("pt-log-level",""+e)};let de;function me(e){const n=e.position,t=e.index,r=e.normal;for(let a=0;a<t.length/3;a++){const s=new I(n[t[a*3+0]*3+0],n[t[a*3+0]*3+1],n[t[a*3+0]*3+2]),i=new I(n[t[a*3+1]*3+0]-s.x,n[t[a*3+1]*3+1]-s.y,n[t[a*3+1]*3+2]-s.z),l=new I(n[t[a*3+2]*3+0]-s.x,n[t[a*3+2]*3+1]-s.y,n[t[a*3+2]*3+2]-s.z);let c=new I().cross(i,l).normalize();c[0]===0&&c[1]===0&&c[3]===0&&(c=de);for(let o=0;o<3;o++)r[t[a*3+o]*3+0]=c.x,r[t[a*3+o]*3+1]=c.y,r[t[a*3+o]*3+2]=c.z;de=c}return e}function _n(e,n=[0,0,0],t=[0,0,0],r=[1,1,1]){const a=new Float32Array(e.position.length),s=e.position.length,i=e.position;for(let l=0;l<s;l+=3){const c=i[l+0]*r[0],o=i[l+1]*r[1],v=i[l+2]*r[2],h=c,f=Math.cos(t[0])*o-Math.sin(t[0])*v,u=Math.sin(t[0])*o+Math.cos(t[0])*v,m=Math.cos(t[1])*h-Math.sin(t[1])*u,d=f,p=Math.sin(t[1])*h+Math.cos(t[1])*u;a[l+0]=m+n[0],a[l+1]=d+n[1],a[l+2]=p+n[2]}return{position:a,uv:e.uv,normal:e.normal,index:e.index}}function ye(e){if(Array.isArray(e))return e.map(l=>ye(l)).flat();const n=[],t={position:e.position,normal:e.normal,uv:e.uv,index:e.index},r=e.offset,a=e.rotation,s=e.scale,i=e.offset.length;for(let l=0;l<i;l+=3)n.push(_n(t,[r[l+0],r[l+1],r[l+2]],[a[l+0],a[l+1],a[l+2]],[s[l+0],s[l+1],s[l+2]]));return n}var $=1e-6,B=typeof Float32Array!="undefined"?Float32Array:Array,xe=Math.random;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function En(){var e=new B(16);return B!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Dn(e){var n=new B(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function On(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function Tn(e,n,t,r,a,s,i,l,c,o,v,h,f,u,m,d){var p=new B(16);return p[0]=e,p[1]=n,p[2]=t,p[3]=r,p[4]=a,p[5]=s,p[6]=i,p[7]=l,p[8]=c,p[9]=o,p[10]=v,p[11]=h,p[12]=f,p[13]=u,p[14]=m,p[15]=d,p}function Rn(e,n,t,r,a,s,i,l,c,o,v,h,f,u,m,d,p){return e[0]=n,e[1]=t,e[2]=r,e[3]=a,e[4]=s,e[5]=i,e[6]=l,e[7]=c,e[8]=o,e[9]=v,e[10]=h,e[11]=f,e[12]=u,e[13]=m,e[14]=d,e[15]=p,e}function ge(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $n(e,n){if(e===n){var t=n[1],r=n[2],a=n[3],s=n[6],i=n[7],l=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=r,e[9]=s,e[11]=n[14],e[12]=a,e[13]=i,e[14]=l}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}function Pn(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=n[4],l=n[5],c=n[6],o=n[7],v=n[8],h=n[9],f=n[10],u=n[11],m=n[12],d=n[13],p=n[14],y=n[15],x=t*l-r*i,M=t*c-a*i,w=t*o-s*i,b=r*c-a*l,g=r*o-s*l,z=a*o-s*c,A=v*d-h*m,D=v*p-f*m,O=v*y-u*m,_=h*p-f*d,S=h*y-u*d,E=f*y-u*p,N=x*E-M*S+w*_+b*O-g*D+z*A;return N?(N=1/N,e[0]=(l*E-c*S+o*_)*N,e[1]=(a*S-r*E-s*_)*N,e[2]=(d*z-p*g+y*b)*N,e[3]=(f*g-h*z-u*b)*N,e[4]=(c*O-i*E-o*D)*N,e[5]=(t*E-a*O+s*D)*N,e[6]=(p*w-m*z-y*M)*N,e[7]=(v*z-f*w+u*M)*N,e[8]=(i*S-l*O+o*A)*N,e[9]=(r*O-t*S-s*A)*N,e[10]=(m*g-d*w+y*x)*N,e[11]=(h*w-v*g-u*x)*N,e[12]=(l*D-i*_-c*A)*N,e[13]=(t*_-r*D+a*A)*N,e[14]=(d*M-m*b-p*x)*N,e[15]=(v*b-h*M+f*x)*N,e):null}function jn(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=n[4],l=n[5],c=n[6],o=n[7],v=n[8],h=n[9],f=n[10],u=n[11],m=n[12],d=n[13],p=n[14],y=n[15];return e[0]=l*(f*y-u*p)-h*(c*y-o*p)+d*(c*u-o*f),e[1]=-(r*(f*y-u*p)-h*(a*y-s*p)+d*(a*u-s*f)),e[2]=r*(c*y-o*p)-l*(a*y-s*p)+d*(a*o-s*c),e[3]=-(r*(c*u-o*f)-l*(a*u-s*f)+h*(a*o-s*c)),e[4]=-(i*(f*y-u*p)-v*(c*y-o*p)+m*(c*u-o*f)),e[5]=t*(f*y-u*p)-v*(a*y-s*p)+m*(a*u-s*f),e[6]=-(t*(c*y-o*p)-i*(a*y-s*p)+m*(a*o-s*c)),e[7]=t*(c*u-o*f)-i*(a*u-s*f)+v*(a*o-s*c),e[8]=i*(h*y-u*d)-v*(l*y-o*d)+m*(l*u-o*h),e[9]=-(t*(h*y-u*d)-v*(r*y-s*d)+m*(r*u-s*h)),e[10]=t*(l*y-o*d)-i*(r*y-s*d)+m*(r*o-s*l),e[11]=-(t*(l*u-o*h)-i*(r*u-s*h)+v*(r*o-s*l)),e[12]=-(i*(h*p-f*d)-v*(l*p-c*d)+m*(l*f-c*h)),e[13]=t*(h*p-f*d)-v*(r*p-a*d)+m*(r*f-a*h),e[14]=-(t*(l*p-c*d)-i*(r*p-a*d)+m*(r*c-a*l)),e[15]=t*(l*f-c*h)-i*(r*f-a*h)+v*(r*c-a*l),e}function Ln(e){var n=e[0],t=e[1],r=e[2],a=e[3],s=e[4],i=e[5],l=e[6],c=e[7],o=e[8],v=e[9],h=e[10],f=e[11],u=e[12],m=e[13],d=e[14],p=e[15],y=n*i-t*s,x=n*l-r*s,M=n*c-a*s,w=t*l-r*i,b=t*c-a*i,g=r*c-a*l,z=o*m-v*u,A=o*d-h*u,D=o*p-f*u,O=v*d-h*m,_=v*p-f*m,S=h*p-f*d;return y*S-x*_+M*O+w*D-b*A+g*z}function Me(e,n,t){var r=n[0],a=n[1],s=n[2],i=n[3],l=n[4],c=n[5],o=n[6],v=n[7],h=n[8],f=n[9],u=n[10],m=n[11],d=n[12],p=n[13],y=n[14],x=n[15],M=t[0],w=t[1],b=t[2],g=t[3];return e[0]=M*r+w*l+b*h+g*d,e[1]=M*a+w*c+b*f+g*p,e[2]=M*s+w*o+b*u+g*y,e[3]=M*i+w*v+b*m+g*x,M=t[4],w=t[5],b=t[6],g=t[7],e[4]=M*r+w*l+b*h+g*d,e[5]=M*a+w*c+b*f+g*p,e[6]=M*s+w*o+b*u+g*y,e[7]=M*i+w*v+b*m+g*x,M=t[8],w=t[9],b=t[10],g=t[11],e[8]=M*r+w*l+b*h+g*d,e[9]=M*a+w*c+b*f+g*p,e[10]=M*s+w*o+b*u+g*y,e[11]=M*i+w*v+b*m+g*x,M=t[12],w=t[13],b=t[14],g=t[15],e[12]=M*r+w*l+b*h+g*d,e[13]=M*a+w*c+b*f+g*p,e[14]=M*s+w*o+b*u+g*y,e[15]=M*i+w*v+b*m+g*x,e}function qn(e,n,t){var r=t[0],a=t[1],s=t[2],i,l,c,o,v,h,f,u,m,d,p,y;return n===e?(e[12]=n[0]*r+n[4]*a+n[8]*s+n[12],e[13]=n[1]*r+n[5]*a+n[9]*s+n[13],e[14]=n[2]*r+n[6]*a+n[10]*s+n[14],e[15]=n[3]*r+n[7]*a+n[11]*s+n[15]):(i=n[0],l=n[1],c=n[2],o=n[3],v=n[4],h=n[5],f=n[6],u=n[7],m=n[8],d=n[9],p=n[10],y=n[11],e[0]=i,e[1]=l,e[2]=c,e[3]=o,e[4]=v,e[5]=h,e[6]=f,e[7]=u,e[8]=m,e[9]=d,e[10]=p,e[11]=y,e[12]=i*r+v*a+m*s+n[12],e[13]=l*r+h*a+d*s+n[13],e[14]=c*r+f*a+p*s+n[14],e[15]=o*r+u*a+y*s+n[15]),e}function Vn(e,n,t){var r=t[0],a=t[1],s=t[2];return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=n[3]*r,e[4]=n[4]*a,e[5]=n[5]*a,e[6]=n[6]*a,e[7]=n[7]*a,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=n[11]*s,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function In(e,n,t,r){var a=r[0],s=r[1],i=r[2],l=Math.hypot(a,s,i),c,o,v,h,f,u,m,d,p,y,x,M,w,b,g,z,A,D,O,_,S,E,N,T;return l<$?null:(l=1/l,a*=l,s*=l,i*=l,c=Math.sin(t),o=Math.cos(t),v=1-o,h=n[0],f=n[1],u=n[2],m=n[3],d=n[4],p=n[5],y=n[6],x=n[7],M=n[8],w=n[9],b=n[10],g=n[11],z=a*a*v+o,A=s*a*v+i*c,D=i*a*v-s*c,O=a*s*v-i*c,_=s*s*v+o,S=i*s*v+a*c,E=a*i*v+s*c,N=s*i*v-a*c,T=i*i*v+o,e[0]=h*z+d*A+M*D,e[1]=f*z+p*A+w*D,e[2]=u*z+y*A+b*D,e[3]=m*z+x*A+g*D,e[4]=h*O+d*_+M*S,e[5]=f*O+p*_+w*S,e[6]=u*O+y*_+b*S,e[7]=m*O+x*_+g*S,e[8]=h*E+d*N+M*T,e[9]=f*E+p*N+w*T,e[10]=u*E+y*N+b*T,e[11]=m*E+x*N+g*T,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}function Cn(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[4],i=n[5],l=n[6],c=n[7],o=n[8],v=n[9],h=n[10],f=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=s*a+o*r,e[5]=i*a+v*r,e[6]=l*a+h*r,e[7]=c*a+f*r,e[8]=o*a-s*r,e[9]=v*a-i*r,e[10]=h*a-l*r,e[11]=f*a-c*r,e}function Fn(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[0],i=n[1],l=n[2],c=n[3],o=n[8],v=n[9],h=n[10],f=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*a-o*r,e[1]=i*a-v*r,e[2]=l*a-h*r,e[3]=c*a-f*r,e[8]=s*r+o*a,e[9]=i*r+v*a,e[10]=l*r+h*a,e[11]=c*r+f*a,e}function Un(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[0],i=n[1],l=n[2],c=n[3],o=n[4],v=n[5],h=n[6],f=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*a+o*r,e[1]=i*a+v*r,e[2]=l*a+h*r,e[3]=c*a+f*r,e[4]=o*a-s*r,e[5]=v*a-i*r,e[6]=h*a-l*r,e[7]=f*a-c*r,e}function Bn(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Gn(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Hn(e,n,t){var r=t[0],a=t[1],s=t[2],i=Math.hypot(r,a,s),l,c,o;return i<$?null:(i=1/i,r*=i,a*=i,s*=i,l=Math.sin(n),c=Math.cos(n),o=1-c,e[0]=r*r*o+c,e[1]=a*r*o+s*l,e[2]=s*r*o-a*l,e[3]=0,e[4]=r*a*o-s*l,e[5]=a*a*o+c,e[6]=s*a*o+r*l,e[7]=0,e[8]=r*s*o+a*l,e[9]=a*s*o-r*l,e[10]=s*s*o+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function kn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Yn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Zn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function we(e,n,t){var r=n[0],a=n[1],s=n[2],i=n[3],l=r+r,c=a+a,o=s+s,v=r*l,h=r*c,f=r*o,u=a*c,m=a*o,d=s*o,p=i*l,y=i*c,x=i*o;return e[0]=1-(u+d),e[1]=h+x,e[2]=f-y,e[3]=0,e[4]=h-x,e[5]=1-(v+d),e[6]=m+p,e[7]=0,e[8]=f+y,e[9]=m-p,e[10]=1-(v+u),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Wn(e,n){var t=new B(3),r=-n[0],a=-n[1],s=-n[2],i=n[3],l=n[4],c=n[5],o=n[6],v=n[7],h=r*r+a*a+s*s+i*i;return h>0?(t[0]=(l*i+v*r+c*s-o*a)*2/h,t[1]=(c*i+v*a+o*r-l*s)*2/h,t[2]=(o*i+v*s+l*a-c*r)*2/h):(t[0]=(l*i+v*r+c*s-o*a)*2,t[1]=(c*i+v*a+o*r-l*s)*2,t[2]=(o*i+v*s+l*a-c*r)*2),we(e,n,t),e}function Qn(e,n){return e[0]=n[12],e[1]=n[13],e[2]=n[14],e}function be(e,n){var t=n[0],r=n[1],a=n[2],s=n[4],i=n[5],l=n[6],c=n[8],o=n[9],v=n[10];return e[0]=Math.hypot(t,r,a),e[1]=Math.hypot(s,i,l),e[2]=Math.hypot(c,o,v),e}function Jn(e,n){var t=new B(3);be(t,n);var r=1/t[0],a=1/t[1],s=1/t[2],i=n[0]*r,l=n[1]*a,c=n[2]*s,o=n[4]*r,v=n[5]*a,h=n[6]*s,f=n[8]*r,u=n[9]*a,m=n[10]*s,d=i+v+m,p=0;return d>0?(p=Math.sqrt(d+1)*2,e[3]=.25*p,e[0]=(h-u)/p,e[1]=(f-c)/p,e[2]=(l-o)/p):i>v&&i>m?(p=Math.sqrt(1+i-v-m)*2,e[3]=(h-u)/p,e[0]=.25*p,e[1]=(l+o)/p,e[2]=(f+c)/p):v>m?(p=Math.sqrt(1+v-i-m)*2,e[3]=(f-c)/p,e[0]=(l+o)/p,e[1]=.25*p,e[2]=(h+u)/p):(p=Math.sqrt(1+m-i-v)*2,e[3]=(l-o)/p,e[0]=(f+c)/p,e[1]=(h+u)/p,e[2]=.25*p),e}function Xn(e,n,t,r){var a=n[0],s=n[1],i=n[2],l=n[3],c=a+a,o=s+s,v=i+i,h=a*c,f=a*o,u=a*v,m=s*o,d=s*v,p=i*v,y=l*c,x=l*o,M=l*v,w=r[0],b=r[1],g=r[2];return e[0]=(1-(m+p))*w,e[1]=(f+M)*w,e[2]=(u-x)*w,e[3]=0,e[4]=(f-M)*b,e[5]=(1-(h+p))*b,e[6]=(d+y)*b,e[7]=0,e[8]=(u+x)*g,e[9]=(d-y)*g,e[10]=(1-(h+m))*g,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Kn(e,n,t,r,a){var s=n[0],i=n[1],l=n[2],c=n[3],o=s+s,v=i+i,h=l+l,f=s*o,u=s*v,m=s*h,d=i*v,p=i*h,y=l*h,x=c*o,M=c*v,w=c*h,b=r[0],g=r[1],z=r[2],A=a[0],D=a[1],O=a[2],_=(1-(d+y))*b,S=(u+w)*b,E=(m-M)*b,N=(u-w)*g,T=(1-(f+y))*g,j=(p+x)*g,R=(m+M)*z,V=(p-x)*z,q=(1-(f+d))*z;return e[0]=_,e[1]=S,e[2]=E,e[3]=0,e[4]=N,e[5]=T,e[6]=j,e[7]=0,e[8]=R,e[9]=V,e[10]=q,e[11]=0,e[12]=t[0]+A-(_*A+N*D+R*O),e[13]=t[1]+D-(S*A+T*D+V*O),e[14]=t[2]+O-(E*A+j*D+q*O),e[15]=1,e}function et(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=t+t,l=r+r,c=a+a,o=t*i,v=r*i,h=r*l,f=a*i,u=a*l,m=a*c,d=s*i,p=s*l,y=s*c;return e[0]=1-h-m,e[1]=v+y,e[2]=f-p,e[3]=0,e[4]=v-y,e[5]=1-o-m,e[6]=u+d,e[7]=0,e[8]=f+p,e[9]=u-d,e[10]=1-o-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function nt(e,n,t,r,a,s,i){var l=1/(t-n),c=1/(a-r),o=1/(s-i);return e[0]=s*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*c,e[6]=0,e[7]=0,e[8]=(t+n)*l,e[9]=(a+r)*c,e[10]=(i+s)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*s*2*o,e[15]=0,e}function ze(e,n,t,r,a){var s=1/Math.tan(n/2),i;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(i=1/(r-a),e[10]=(a+r)*i,e[14]=2*a*r*i):(e[10]=-1,e[14]=-2*r),e}var tt=ze;function rt(e,n,t,r,a){var s=1/Math.tan(n/2),i;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(i=1/(r-a),e[10]=a*i,e[14]=a*r*i):(e[10]=-1,e[14]=-r),e}function at(e,n,t,r){var a=Math.tan(n.upDegrees*Math.PI/180),s=Math.tan(n.downDegrees*Math.PI/180),i=Math.tan(n.leftDegrees*Math.PI/180),l=Math.tan(n.rightDegrees*Math.PI/180),c=2/(i+l),o=2/(a+s);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=-((i-l)*c*.5),e[9]=(a-s)*o*.5,e[10]=r/(t-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*t/(t-r),e[15]=0,e}function Ae(e,n,t,r,a,s,i){var l=1/(n-t),c=1/(r-a),o=1/(s-i);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*o,e[11]=0,e[12]=(n+t)*l,e[13]=(a+r)*c,e[14]=(i+s)*o,e[15]=1,e}var st=Ae;function it(e,n,t,r,a,s,i){var l=1/(n-t),c=1/(r-a),o=1/(s-i);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=o,e[11]=0,e[12]=(n+t)*l,e[13]=(a+r)*c,e[14]=s*o,e[15]=1,e}function lt(e,n,t,r){var a,s,i,l,c,o,v,h,f,u,m=n[0],d=n[1],p=n[2],y=r[0],x=r[1],M=r[2],w=t[0],b=t[1],g=t[2];return Math.abs(m-w)<$&&Math.abs(d-b)<$&&Math.abs(p-g)<$?ge(e):(v=m-w,h=d-b,f=p-g,u=1/Math.hypot(v,h,f),v*=u,h*=u,f*=u,a=x*f-M*h,s=M*v-y*f,i=y*h-x*v,u=Math.hypot(a,s,i),u?(u=1/u,a*=u,s*=u,i*=u):(a=0,s=0,i=0),l=h*i-f*s,c=f*a-v*i,o=v*s-h*a,u=Math.hypot(l,c,o),u?(u=1/u,l*=u,c*=u,o*=u):(l=0,c=0,o=0),e[0]=a,e[1]=l,e[2]=v,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=i,e[9]=o,e[10]=f,e[11]=0,e[12]=-(a*m+s*d+i*p),e[13]=-(l*m+c*d+o*p),e[14]=-(v*m+h*d+f*p),e[15]=1,e)}function ct(e,n,t,r){var a=n[0],s=n[1],i=n[2],l=r[0],c=r[1],o=r[2],v=a-t[0],h=s-t[1],f=i-t[2],u=v*v+h*h+f*f;u>0&&(u=1/Math.sqrt(u),v*=u,h*=u,f*=u);var m=c*f-o*h,d=o*v-l*f,p=l*h-c*v;return u=m*m+d*d+p*p,u>0&&(u=1/Math.sqrt(u),m*=u,d*=u,p*=u),e[0]=m,e[1]=d,e[2]=p,e[3]=0,e[4]=h*p-f*d,e[5]=f*m-v*p,e[6]=v*d-h*m,e[7]=0,e[8]=v,e[9]=h,e[10]=f,e[11]=0,e[12]=a,e[13]=s,e[14]=i,e[15]=1,e}function ot(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function ft(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ht(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e[8]=n[8]+t[8],e[9]=n[9]+t[9],e[10]=n[10]+t[10],e[11]=n[11]+t[11],e[12]=n[12]+t[12],e[13]=n[13]+t[13],e[14]=n[14]+t[14],e[15]=n[15]+t[15],e}function Se(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e[6]=n[6]-t[6],e[7]=n[7]-t[7],e[8]=n[8]-t[8],e[9]=n[9]-t[9],e[10]=n[10]-t[10],e[11]=n[11]-t[11],e[12]=n[12]-t[12],e[13]=n[13]-t[13],e[14]=n[14]-t[14],e[15]=n[15]-t[15],e}function vt(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=n[11]*t,e[12]=n[12]*t,e[13]=n[13]*t,e[14]=n[14]*t,e[15]=n[15]*t,e}function pt(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e[4]=n[4]+t[4]*r,e[5]=n[5]+t[5]*r,e[6]=n[6]+t[6]*r,e[7]=n[7]+t[7]*r,e[8]=n[8]+t[8]*r,e[9]=n[9]+t[9]*r,e[10]=n[10]+t[10]*r,e[11]=n[11]+t[11]*r,e[12]=n[12]+t[12]*r,e[13]=n[13]+t[13]*r,e[14]=n[14]+t[14]*r,e[15]=n[15]+t[15]*r,e}function ut(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}function dt(e,n){var t=e[0],r=e[1],a=e[2],s=e[3],i=e[4],l=e[5],c=e[6],o=e[7],v=e[8],h=e[9],f=e[10],u=e[11],m=e[12],d=e[13],p=e[14],y=e[15],x=n[0],M=n[1],w=n[2],b=n[3],g=n[4],z=n[5],A=n[6],D=n[7],O=n[8],_=n[9],S=n[10],E=n[11],N=n[12],T=n[13],j=n[14],R=n[15];return Math.abs(t-x)<=$*Math.max(1,Math.abs(t),Math.abs(x))&&Math.abs(r-M)<=$*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(a-w)<=$*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-b)<=$*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(i-g)<=$*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(l-z)<=$*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(c-A)<=$*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(o-D)<=$*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(v-O)<=$*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(h-_)<=$*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(f-S)<=$*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(u-E)<=$*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(m-N)<=$*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(d-T)<=$*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-j)<=$*Math.max(1,Math.abs(p),Math.abs(j))&&Math.abs(y-R)<=$*Math.max(1,Math.abs(y),Math.abs(R))}var mt=Me,yt=Se,xt=Object.freeze({__proto__:null,create:En,clone:Dn,copy:On,fromValues:Tn,set:Rn,identity:ge,transpose:$n,invert:Pn,adjoint:jn,determinant:Ln,multiply:Me,translate:qn,scale:Vn,rotate:In,rotateX:Cn,rotateY:Fn,rotateZ:Un,fromTranslation:Bn,fromScaling:Gn,fromRotation:Hn,fromXRotation:kn,fromYRotation:Yn,fromZRotation:Zn,fromRotationTranslation:we,fromQuat2:Wn,getTranslation:Qn,getScaling:be,getRotation:Jn,fromRotationTranslationScale:Xn,fromRotationTranslationScaleOrigin:Kn,fromQuat:et,frustum:nt,perspectiveNO:ze,perspective:tt,perspectiveZO:rt,perspectiveFromFieldOfView:at,orthoNO:Ae,ortho:st,orthoZO:it,lookAt:lt,targetTo:ct,str:ot,frob:ft,add:ht,subtract:Se,multiplyScalar:vt,multiplyScalarAndAdd:pt,exactEquals:ut,equals:dt,mul:mt,sub:yt});function Ne(){var e=new B(3);return B!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function gt(e){var n=new B(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function _e(e){var n=e[0],t=e[1],r=e[2];return Math.hypot(n,t,r)}function Mt(e,n,t){var r=new B(3);return r[0]=e,r[1]=n,r[2]=t,r}function wt(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function bt(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e}function zt(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function Ee(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function De(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function Oe(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function At(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}function St(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}function Nt(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e}function _t(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e}function Et(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e}function Dt(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function Ot(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e}function Te(e,n){var t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return Math.hypot(t,r,a)}function Re(e,n){var t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return t*t+r*r+a*a}function $e(e){var n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function Tt(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function Rt(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function $t(e,n){var t=n[0],r=n[1],a=n[2],s=t*t+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function Pe(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function Pt(e,n,t){var r=n[0],a=n[1],s=n[2],i=t[0],l=t[1],c=t[2];return e[0]=a*c-s*l,e[1]=s*i-r*c,e[2]=r*l-a*i,e}function jt(e,n,t,r){var a=n[0],s=n[1],i=n[2];return e[0]=a+r*(t[0]-a),e[1]=s+r*(t[1]-s),e[2]=i+r*(t[2]-i),e}function Lt(e,n,t,r,a,s){var i=s*s,l=i*(2*s-3)+1,c=i*(s-2)+s,o=i*(s-1),v=i*(3-2*s);return e[0]=n[0]*l+t[0]*c+r[0]*o+a[0]*v,e[1]=n[1]*l+t[1]*c+r[1]*o+a[1]*v,e[2]=n[2]*l+t[2]*c+r[2]*o+a[2]*v,e}function qt(e,n,t,r,a,s){var i=1-s,l=i*i,c=s*s,o=l*i,v=3*s*l,h=3*c*i,f=c*s;return e[0]=n[0]*o+t[0]*v+r[0]*h+a[0]*f,e[1]=n[1]*o+t[1]*v+r[1]*h+a[1]*f,e[2]=n[2]*o+t[2]*v+r[2]*h+a[2]*f,e}function Vt(e,n){n=n||1;var t=xe()*2*Math.PI,r=xe()*2-1,a=Math.sqrt(1-r*r)*n;return e[0]=Math.cos(t)*a,e[1]=Math.sin(t)*a,e[2]=r*n,e}function It(e,n,t){var r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s+t[12])/i,e[1]=(t[1]*r+t[5]*a+t[9]*s+t[13])/i,e[2]=(t[2]*r+t[6]*a+t[10]*s+t[14])/i,e}function Ct(e,n,t){var r=n[0],a=n[1],s=n[2];return e[0]=r*t[0]+a*t[3]+s*t[6],e[1]=r*t[1]+a*t[4]+s*t[7],e[2]=r*t[2]+a*t[5]+s*t[8],e}function Ft(e,n,t){var r=t[0],a=t[1],s=t[2],i=t[3],l=n[0],c=n[1],o=n[2],v=a*o-s*c,h=s*l-r*o,f=r*c-a*l,u=a*f-s*h,m=s*v-r*f,d=r*h-a*v,p=i*2;return v*=p,h*=p,f*=p,u*=2,m*=2,d*=2,e[0]=l+v+u,e[1]=c+h+m,e[2]=o+f+d,e}function Ut(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[0],s[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),s[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Bt(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),s[1]=a[1],s[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Gt(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),s[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),s[2]=a[2],e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Ht(e,n){var t=e[0],r=e[1],a=e[2],s=n[0],i=n[1],l=n[2],c=Math.sqrt(t*t+r*r+a*a),o=Math.sqrt(s*s+i*i+l*l),v=c*o,h=v&&Pe(e,n)/v;return Math.acos(Math.min(Math.max(h,-1),1))}function kt(e){return e[0]=0,e[1]=0,e[2]=0,e}function Yt(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Zt(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Wt(e,n){var t=e[0],r=e[1],a=e[2],s=n[0],i=n[1],l=n[2];return Math.abs(t-s)<=$*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(r-i)<=$*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-l)<=$*Math.max(1,Math.abs(a),Math.abs(l))}var Qt=Ee,Jt=De,Xt=Oe,Kt=Te,er=Re,nr=_e,tr=$e,rr=function(){var e=Ne();return function(n,t,r,a,s,i){var l,c;for(t||(t=3),r||(r=0),a?c=Math.min(a*t+r,n.length):c=n.length,l=r;l<c;l+=t)e[0]=n[l],e[1]=n[l+1],e[2]=n[l+2],s(e,e,i),n[l]=e[0],n[l+1]=e[1],n[l+2]=e[2];return n}}(),ar=Object.freeze({__proto__:null,create:Ne,clone:gt,length:_e,fromValues:Mt,copy:wt,set:bt,add:zt,subtract:Ee,multiply:De,divide:Oe,ceil:At,floor:St,min:Nt,max:_t,round:Et,scale:Dt,scaleAndAdd:Ot,distance:Te,squaredDistance:Re,squaredLength:$e,negate:Tt,inverse:Rt,normalize:$t,dot:Pe,cross:Pt,lerp:jt,hermite:Lt,bezier:qt,random:Vt,transformMat4:It,transformMat3:Ct,transformQuat:Ft,rotateX:Ut,rotateY:Bt,rotateZ:Gt,angle:Ht,zero:kt,str:Yt,exactEquals:Zt,equals:Wt,sub:Qt,mul:Jt,div:Xt,dist:Kt,sqrDist:er,len:nr,sqrLen:tr,forEach:rr});function k(e,n,t){for(let r=0;r<t.length;r++)e[n+r]=t[r]}const{identity:sr,rotate:ir}=xt,{add:lr,cross:cr,dot:or,mul:fr,normalize:hr,subtract:C1,transformMat4:vr}=ar;function pr(e){const n=2*Math.PI/e;return new Array(e).fill(null).map((t,r)=>[Math.cos(n*r),Math.sin(n*r)])}function ur(e,n=1){const t=new Uint16Array(e*(Math.max(n,1)-1)*6);for(let r=0;r<n;r++){const a=r*e*6,s=r*e;for(let i=0;i<e;i++){const l=a+i*6,c=s+i;i===e-1?(t[l+0]=c+1,t[l+1]=c-e+1,t[l+2]=c,t[l+3]=c,t[l+4]=c+e,t[l+5]=c+1):(t[l+0]=c+e+1,t[l+1]=c+1,t[l+2]=c,t[l+3]=c,t[l+4]=c+e,t[l+5]=c+e+1)}}return t}function dr(e,n=3){const t=[],r=[],a=[],s=e.length/4,i=s*n,l=new Float32Array(i*3),c=new Float32Array(i*3),o=new Float32Array(i*2),v=ur(n,s),h=pr(n);for(let f=0;f<s;f++){const u=[0,0,1],m=e.slice(f*4,f*4+3),d=e.slice((f+1)*4,(f+1)*4+3),p=e.slice((f-1)*4,(f-1)*4+3),y=e[f*4+3];f===0?C1(r,m,d):f===s-1?C1(r,p,m):C1(r,p,d),hr(r,r),cr(a,u,r);const x=Math.acos(or(u,r));sr(t),ir(t,t,x,a);for(let M=0;M<n;M++){const w=[...h[M],0];fr(w,w,[y,y,1]),vr(w,w,t);const b=f*n*3+M*3;lr(w,w,m),k(l,b,w),k(o,f*n*2+M*2,[M/n,f/s])}}return{position:l,normal:c,uv:o,index:v}}function l1(e,n,t){return e*(1-t)+n*t}function mr(e,n=0){const t=(e.length-1)*n,r=Math.floor(t),a=Math.ceil(t);return l1(e[a],e[r],a-t)}function je(e,n){const t=e.length/4*Math.max(Math.min(n,.9999),1e-4),r=Math.max(Math.floor(t),0),a=Math.min(Math.ceil(t),e.length/4-1),s=a-t;return[l1(e[a*4+0],e[r*4+0],s),l1(e[a*4+1],e[r*4+1],s),l1(e[a*4+2],e[r*4+2],s),l1(e[a*4+3],e[r*4+3],s)]}function F1(e,n){const t=e.length/4*Math.max(Math.min(n,.9999),1e-4),r=Math.max(Math.floor(t),0),a=Math.min(Math.ceil(t),e.length/4-1);return[e[a*4+0]-e[r*4+0],e[a*4+1]-e[r*4+1],e[a*4+2]-e[r*4+2],e[a*4+3]+e[r*4+3]/2]}function g1(...e){const n=e.filter(u=>!!u);if(n.length===1)return n[0];let t=0,r=0,a=0;for(const{position:u,index:m,uv:d}of n)t+=u.length,r+=d.length,a+=m.length;const s=new Float32Array(r),i=new Float32Array(t),l=new Float32Array(t),c=a>65536?new Uint32Array(a):new Uint16Array(a);let o=0,v=0,h=0,f=0;for(let u=0;u<n.length;u++){const m=n[u].normal,d=m.length;for(let g=0;g<d;g++)l[v+g]=m[g];v+=d;const p=n[u].uv,y=p.length;for(let g=0;g<y;g++)s[h+g]=p[g];h+=y;const x=n[u].index,M=x.length;for(let g=0;g<M;g++)c[g+f]=x[g]+o/3;f+=M;const w=n[u].position,b=w.length;for(let g=0;g<b;g++)i[o+g]=w[g];o+=b}return{position:i,normal:l,uv:s,index:c}}var yr=(e,n)=>Math.sqrt(e*e+n*n),xr=(e,n,t)=>Math.sqrt(e*e+n*n+t*t),c1={},M1={},o1={};Object.defineProperty(o1,"__esModule",{value:!0});function gr(e){var n=new Uint32Array(1);return n[0]=e[0]*1664525+1013904223,n}o1.default=gr,Object.defineProperty(M1,"__esModule",{value:!0}),M1.makeNoise2D=void 0;var w1=o1,Mr=1/47,U1=(Math.sqrt(2+1)-1)/2,wr=(1/Math.sqrt(2+1)-1)/2;function Le(e,n,t){return{dx:-n-e*U1,dy:-t-e*U1,xsb:n,ysb:t}}function br(e){for(var n=[],t=0;t<f1.length;t+=4){for(var r=zr[f1[t]],a=null,s=null,i=0;i<r.length;i+=3)s=Le(r[i],r[i+1],r[i+2]),a===null?n[t/4]=s:a.next=s,a=s;s.next=Le(f1[t+1],f1[t+2],f1[t+3])}for(var l=[],t=0;t<B1.length;t+=2)l[B1[t]]=n[B1[t+1]];for(var c=new Uint8Array(256),o=new Uint8Array(256),v=new Uint8Array(256),t=0;t<256;t++)v[t]=t;var h=new Uint32Array(1);h[0]=e,h=w1.default(w1.default(w1.default(h)));for(var t=255;t>=0;t--){h=w1.default(h);var f=new Uint32Array(1);f[0]=(h[0]+31)%(t+1),f[0]<0&&(f[0]+=t+1),c[t]=v[f[0]],o[t]=c[t]&14,v[f[0]]=v[t]}return function(u,m){for(var d=(u+m)*wr,p=u+d,y=m+d,x=Math.floor(p),M=Math.floor(y),w=(x+M)*U1,b=u-(x+w),g=m-(M+w),z=p-x,A=y-M,D=z+A,O=z-A+1|D<<1|D+A<<2|D+z<<4,_=0,S=l[O];S!==void 0;S=S.next){var E=b+S.dx,N=g+S.dy,T=2-E*E-N*N;if(T>0){var j=x+S.xsb,R=M+S.ysb,V=c[j&255],q=o[V+R&255],K=qe[q]*E+qe[q+1]*N;_+=T*T*T*T*K}}return _*Mr}}M1.makeNoise2D=br;var zr=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],qe=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],B1=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],f1=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],b1={};Object.defineProperty(b1,"__esModule",{value:!0}),b1.makeNoise3D=void 0;var z1=o1,Ar=1/103,A1=(Math.sqrt(3+1)-1)/3,Sr=(1/Math.sqrt(3+1)-1)/3;function G1(e,n,t,r){return{dx:-n-e*A1,dy:-t-e*A1,dz:-r-e*A1,xsb:n,ysb:t,zsb:r}}function Nr(e){for(var n=[],t=0;t<G.length;t+=9){for(var r=_r[G[t]],a=null,s=null,i=0;i<r.length;i+=4)s=G1(r[i],r[i+1],r[i+2],r[i+3]),a===null?n[t/9]=s:a.next=s,a=s;s.next=G1(G[t+1],G[t+2],G[t+3],G[t+4]),s.next.next=G1(G[t+5],G[t+6],G[t+7],G[t+8])}for(var l=[],t=0;t<k1.length;t+=2)l[k1[t]]=n[k1[t+1]];for(var c=new Uint8Array(256),o=new Uint8Array(256),v=new Uint8Array(256),t=0;t<256;t++)v[t]=t;var h=new Uint32Array(1);h[0]=e,h=z1.default(z1.default(z1.default(h)));for(var t=255;t>=0;t--){h=z1.default(h);var f=new Uint32Array(1);f[0]=(h[0]+31)%(t+1),f[0]<0&&(f[0]+=t+1),c[t]=v[f[0]],o[t]=c[t]%24*3,v[f[0]]=v[t]}return function(u,m,d){for(var p=(u+m+d)*Sr,y=u+p,x=m+p,M=d+p,w=Math.floor(y),b=Math.floor(x),g=Math.floor(M),z=(w+b+g)*A1,A=u-(w+z),D=m-(b+z),O=d-(g+z),_=y-w,S=x-b,E=M-g,N=_+S+E,T=S-E+1|_-S+1<<1|_-E+1<<2|N<<3|N+E<<5|N+S<<7|N+_<<9,j=0,R=l[T];R!==void 0;R=R.next){var V=A+R.dx,q=D+R.dy,K=O+R.dz,Y=2-V*V-q*q-K*K;if(Y>0){var U=w+R.xsb,v1=b+R.ysb,p1=g+R.zsb,u1=c[U&255],d1=c[u1+v1&255],H=o[d1+p1&255],re=H1[H]*V+H1[H+1]*q+H1[H+2]*K;j+=Y*Y*Y*Y*re}}return j*Ar}}b1.makeNoise3D=Nr;var _r=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],H1=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],k1=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],G=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],S1={};Object.defineProperty(S1,"__esModule",{value:!0}),S1.makeNoise4D=void 0;var N1=o1,Er=1/30,h1=(Math.sqrt(4+1)-1)/4,Dr=(1/Math.sqrt(4+1)-1)/4;function _1(e,n,t,r,a){return{dx:-n-e*h1,dy:-t-e*h1,dz:-r-e*h1,dw:-a-e*h1,xsb:n,ysb:t,zsb:r,wsb:a}}function Or(e){for(var n=[],t=0;t<L.length;t+=16){for(var r=Tr[L[t]],a=null,s=null,i=0;i<r.length;i+=5)s=_1(r[i],r[i+1],r[i+2],r[i+3],r[i+4]),a===null?n[t/16]=s:a.next=s,a=s;s.next=_1(L[t+1],L[t+2],L[t+3],L[t+4],L[t+5]),s.next.next=_1(L[t+6],L[t+7],L[t+8],L[t+9],L[t+10]),s.next.next.next=_1(L[t+11],L[t+12],L[t+13],L[t+14],L[t+15])}for(var l=[],t=0;t<Y1.length;t+=2)l[Y1[t]]=n[Y1[t+1]];for(var c=new Uint8Array(256),o=new Uint8Array(256),v=new Uint8Array(256),t=0;t<256;t++)v[t]=t;var h=new Uint32Array(1);h[0]=e,h=N1.default(N1.default(N1.default(h)));for(var t=255;t>=0;t--){h=N1.default(h);var f=new Uint32Array(1);f[0]=(h[0]+31)%(t+1),f[0]<0&&(f[0]+=t+1),c[t]=v[f[0]],o[t]=c[t]&252,v[f[0]]=v[t]}return function(u,m,d,p){for(var y=(u+m+d+p)*Dr,x=u+y,M=m+y,w=d+y,b=p+y,g=Math.floor(x),z=Math.floor(M),A=Math.floor(w),D=Math.floor(b),O=(g+z+A+D)*h1,_=u-(g+O),S=m-(z+O),E=d-(A+O),N=p-(D+O),T=x-g,j=M-z,R=w-A,V=b-D,q=T+j+R+V,K=R-V+1|j-R+1<<1|j-V+1<<2|T-j+1<<3|T-R+1<<4|T-V+1<<5|q<<6|q+V<<8|q+R<<11|q+j<<14|q+T<<17,Y=0,U=l[K];U!==void 0;U=U.next){var v1=_+U.dx,p1=S+U.dy,u1=E+U.dz,d1=N+U.dw,H=2-v1*v1-p1*p1-u1*u1-d1*d1;if(H>0){var re=g+U.xsb,z0=z+U.ysb,A0=A+U.zsb,S0=D+U.wsb,N0=c[re&255],_0=c[N0+z0&255],E0=c[_0+A0&255],R1=o[E0+S0&255],D0=E1[R1]*v1+E1[R1+1]*p1+E1[R1+2]*u1+E1[R1+3]*d1;Y+=H*H*H*H*D0}}return Y*Er}}S1.makeNoise4D=Or;var Tr=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],E1=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],Y1=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],L=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.makeNoise4D=e.makeNoise3D=e.makeNoise2D=void 0;var n=M1;Object.defineProperty(e,"makeNoise2D",{enumerable:!0,get:function(){return n.makeNoise2D}});var t=b1;Object.defineProperty(e,"makeNoise3D",{enumerable:!0,get:function(){return t.makeNoise3D}});var r=S1;Object.defineProperty(e,"makeNoise4D",{enumerable:!0,get:function(){return r.makeNoise4D}})})(c1);let Q=0,Z1=c1.makeNoise2D(Q),Ve=c1.makeNoise3D(Q);var J={n1d:e=>Z1(e,0),n2d:(e,n)=>Z1(e,n),n3d:(e,n,t)=>Ve(e,n,t),get seed(){return Q},set seed(e){e!==Q&&(Q=e,Z1=c1.makeNoise2D(Q),Ve=c1.makeNoise3D(Q))}},Ie=([e,n])=>{const t=yr(e,n);return t===0?[1,0]:[e/t,n/t]},W1=([e,n,t])=>{const r=xr(e,n,t);return[e/r,n/r,t/r]};function Rr(e,{offset:n,scale:t,rotation:r,id:a,baseAlpha:s,depth:i}){const l=Math.max(...[n==null?void 0:n.length,t==null?void 0:t.length,r==null?void 0:r.length].filter(h=>!!h)),c=new Float32Array(l),o=new Float32Array(l).fill(1),v=new Float32Array(l);return n!=null&&n.length&&k(c,0,n),t!=null&&t.length&&k(o,0,t),r!=null&&r.length&&k(v,0,r),ae(m1({},e),{id:a,baseAlpha:s,depth:i,offset:c,scale:o,rotation:v})}var D1=([e,n],t)=>t===0?[e,n]:[e*Math.cos(-t)-n*Math.sin(-t),e*Math.sin(-t)+n*Math.cos(-t)];function O1(e,n,t){const[r,a,s]=e,[i,l,c]=W1(n),o=Math.cos(t),v=Math.sin(t);return new I((o+(1-o)*i*i)*r+((1-o)*i*l-c*v)*a+((1-o)*i*c+l*v)*s,((1-o)*i*l+c*v)*r+(o+(1-o)*l*l)*a+((1-o)*l*c-i*v)*s,((1-o)*i*c-l*v)*r+((1-o)*l*c+i*v)*a+(o+(1-o)*c*c)*s)}function $r(e){const n=Array.isArray(e)?e:[e];console.log("TOOBJ",n);let t="",r=0,a=0,s=0;const i=[];function l(c){let o=0,v=0,h=0;const{index:f,uv:u,normal:m,position:d}=c;if(f.includes(NaN)&&console.warn("Export will fail, index includes NaN"),u.includes(NaN)&&console.warn("Export will fail, uv includes NaN"),m.includes(NaN)&&console.warn("Export will fail, normal includes NaN"),d.includes(NaN)&&console.warn("Export will fail, position includes NaN"),t+=`o plant
`,d!=null&&d.length)for(let p=0;p<d.length;p+=3){const[y,x,M]=d.slice(p,p+3);t+="v "+y+" "+x+" "+M+`
`}if(u!=null&&u.length)for(let p=0;p<u.length;p+=2){const[y,x]=u.slice(p,p+2);t+="vt "+y+" "+x+`
`}if(m!=null&&m.length)for(let p=0;p<m.length;p+=3){const[y,x,M]=m.slice(p,p+3);t+="vn "+y+" "+x+" "+M+`
`}if(f!=null&&f.length)for(let p=0;p<f.length;p+=3){for(let y=0;y<3;y++){const x=f[p+y]+1;i[y]=r+x+(m||u?"/"+(u?a+x:"")+(m?"/"+(s+x):""):"")}t+="f "+i.join(" ")+`
`}else for(let p=0,y=d.length;p<y;p+=3){for(let x=0;x<3;x++){const M=p+x+1;i[x]=r+M+(m||u?"/"+(u?a+M:"")+(m?"/"+(s+M):""):"")}t+="f "+i.join(" ")+`
`}r+=o,a+=h,s+=v}return n.forEach(c=>l(c)),t}new I,new I,new I,new I,new I,new bn;const r1=e=>{console.groupCollapsed(e),console.trace(),console.groupEnd()};function Ce(e,n=!1){const t=e.normal.includes(NaN);t&&r1("Normals has NaN");const r=e.index.includes(NaN);r&&r1("Index has NaN");const a=e.position.includes(NaN);a&&r1("Position has NaN");const s=e.uv.includes(NaN);s&&r1("UV has NaN");const i=e.position.length/3;e.position.length!==e.normal.length&&r1("position and normal amount not eqal"),e.uv.length!==i*2&&r1("uv amount not correct, should be "+i*2+" is "+e.uv.length),(t||r||a||s||n)&&console.log("Check",{p:e.position.length,pn:a,n:e.normal.length,nn:t,i:e.index.length,in:r,u:e.uv.length,un:s})}function Pr([e,n,t]){return e===0&&t===0?[1,0,0]:[1,1,-((e+n)/t)]}function jr(e,{res:n=1,xCurvature:t=.5,yCurvature:r=.2}={}){const a=e.length,s=3+n*2,i=s*a,l=(s-1)*(a-1)*2,c=new Float32Array(i*3),o=new Float32Array(i*3),v=new Float32Array(i*2),h=new Uint16Array(l*3);let f=0,u=0,m=0,d=0;return e.sort((p,y)=>p.y>y.y?1:-1).forEach((p,y)=>{const x=y*s;let M=p.y-u;d+=M*r;let[w,b]=D1([M,0],d);const g=Math.sin(Math.PI*p.y);for(let z=0;z<s;z++){const A=2-z/(s-1)*2-1,D=Math.sin(Math.abs(A)*Math.PI)*.01;let[O,_]=D1([1e-4,D*t*g],d),S=(Math.min(Math.max(p.x,.001),.999)-1)*A*.5;if(c[x*3+z*3+0]=S,c[x*3+z*3+1]=_+b+m,c[x*3+z*3+2]=O+w+f,v[x*2+z*2+0]=c[x*3+z*3+0]+1/2,v[x*2+z*2+1]=c[x*3+z*3+2],y!==e.length-1){const E=y*(s-1);h[E*6+z*6+0]=x+z+s,h[E*6+z*6+1]=x+z+1,h[E*6+z*6+2]=x+z+0,h[E*6+z*6+3]=x+z+1,h[E*6+z*6+4]=x+z+s,h[E*6+z*6+5]=x+z+s+1}}m+=b,f+=w,u=p.y}),me({position:c,normal:o,index:h,uv:v})}function Fe(e,n=8){return dr(e,n)}function Lr(e,n=1,t=1,r=0,a=!0){var p,y,x,M,w,b;const s=Array.isArray(t)?1:t,i=((p=t[0])!=null?p:s)*10,l=((y=t[1])!=null?y:s)*10,c=((x=t[2])!=null?x:s)*10,o=Array.isArray(r)?0:r,v=(M=r[0])!=null?M:o,h=(w=r[1])!=null?w:o,f=(b=r[2])!=null?b:o,u=e.length/4,m=[e[0],e[1],e[2]];let d=0;for(let g=0;g<u;g++){const z=g/u;d+=(Math.abs(m[0]-e[g*4+0])+Math.abs(m[1]-e[g*4+1])+Math.abs(m[2]-e[g*4+2]))/3,m[0]=e[g*4+0],m[1]=e[g*4+1],m[2]=e[g*4+2];const A=a?n*z:n,[D,O,_]=e.slice(g*4,g*4+3);e[g*4+0]=D+J.n1d(1e3+v+d*i)*A,e[g*4+1]=O+J.n1d(2e3+h+d*l)*A,e[g*4+2]=_+J.n1d(3e3+f+d*c)*A}return e}function Ue(e,[n,t,r]){let a=e.length/4,s=-1;for(;s++<a-1;)e[s*4+0]=e[s*4+0]+n,e[s*4+1]=e[s*4+1]+t,e[s*4+2]=e[s*4+2]+r;return e}function Be(e,n,t=1,r,a=!1){const[s=0,i=0,l=0]=r||e;s&&i&&l&&Ue(e,[-s,-i,-l]);const c=e.length/4;let o=-1;for(;o++<c-1;){const v=e.slice(o*4,o*4+3),h=o/c,f=O1([...v],n,a?t*h:t);e[o*4+0]=f[0],e[o*4+1]=f[1],e[o*4+2]=f[2]}return s&&i&&l&&Ue(e,[s,i,l]),e}function qr(e,n=.5,t=2,r=1){const a=Math.max(Math.min(n,1),0),s=Math.floor(Math.max(0,t));if(s<2)return[e];const i=e.length/4,l=Math.floor(i*a),c=W1(F1(e,a)),o=W1(Pr(c));return[...l<0?[]:[e.slice(0,l*4)],...new Array(s).fill(null).map((v,h)=>{const f=e.slice((l-2)*4),u=h/t;return Be(f,o,r,void 0,!0),Be(f,c,u*6),f})].filter(v=>v.length>4)}function Ge({stems:e=[],instances:n=[]}){return Math.max(...e.map(t=>t.depth),...n.map(t=>t.depth),0)}function Vr(e,n=0,t=1,r=-1){return e.filter(a=>{if(r!==-1&&a.depth!==r)return!0;let s=a.baseAlpha.filter(h=>h>=n&&h<=t).length;if(!s)return!1;if(s===a.baseAlpha.length)return!0;const i=new Float32Array(s*3),l=new Float32Array(s*3),c=new Float32Array(s*3),o=new Float32Array(s);let v=0;for(let h=0;h<a.baseAlpha.length;h++)a.baseAlpha[h]>=n&&a.baseAlpha[h]<=t&&(k(i,v*3,a.scale.slice(h*3,h*3+3)),k(l,v*3,a.offset.slice(h*3,h*3+3)),k(c,v*3,a.rotation.slice(h*3,h*3+3)),o[v]=a.baseAlpha[h],v++);return a.baseAlpha=o,a.offset=l,a.rotation=c,a.scale=i,!0})}function j0(e){return e}var Ir={title:"Branches",type:"branches",outputs:["plant"],meta:{description:"The branch node places branches along the input stem, resulting in new branches."},parameters:{input:{type:"plant",label:"plant",external:!0,required:!0},length:{type:"number",min:0,max:3,step:.05,value:.8},thiccness:{type:"number",min:0,max:1,step:.01,value:.8},offsetSingle:{type:"number",min:0,max:1,step:.01,value:.5},lowestBranch:{type:"number",min:0,max:1,step:.01,value:.2},amount:{type:"number",min:0,max:64,value:10}},computeStem(e,n){if(!e.input)return{stems:[]};const t=e.input(),r=n.getSetting("stemResY"),a=Ge(t),s=t.stems.map(i=>{const l=[];if(a!==i.depth)return[];const c=e.amount(),o=e.lowestBranch();for(let v=0;v<c;v++){const h=v/c,f=e.length(h)*(1-h),u=e.thiccness(h),m=e.offsetSingle(h),d=v%2===0;let p=o+(1-o)*h;p=Math.min(p-1/c*m*(d?-1:1),1);const[y,,x]=F1(i.skeleton,p),M=Ie([y,x]),[w,b]=D1(M,d?-Math.PI/2:Math.PI/2),[g,z,A,D]=je(i.skeleton,p),O=Math.max(Math.floor(r),4),_=new Float32Array(O*4);for(let S=0;S<O*4;S++){const E=S/O;_[S*4+0]=g+w*E*f,_[S*4+1]=z,_[S*4+2]=A+b*E*f,_[S*4+3]=D*u*(1-E)}l.push({skeleton:_,id:i.id+"-"+v,baseAlpha:p,depth:i.depth+1})}return l}).flat();return{instances:t.instances,stems:[...t.stems,...s]}}},Cr={title:"Random",type:"random",outputs:["number"],meta:{description:"Generates random value between min and max."},parameters:{min:{type:"number",value:0,min:0,max:1,step:.05},max:{type:"number",value:1,min:0,max:1,step:.05}},computeValue(e,n,t){const r=e.max(),a=e.min();return r?a+n.n1dn(200+t*1e3)*Math.abs(r-a):0}},Fr={title:"Curve",type:"curve",outputs:["number"],parameters:{value:{type:"curve",internal:!0,label:!1,value:[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}},computeValue(e,n,t){const r=rn(e.value).map(a=>a.y);return mr(r,1-t)}},Ur={title:"Gravity",type:"gravity",outputs:["plant"],meta:{description:"The gravity node applies simple gravity to branches and stems."},parameters:{input:{type:"plant",required:!0,external:!0},type:{internal:!0,type:"select",values:["simple","verlet","test"],value:"simple",description:"How the gravity should be calculated, right now only simple and test work."},strength:{type:"number",min:0,max:2,step:.05,value:1}},computeStem(e){const{input:n,type:t,strength:r}=e,{stems:a}=n(),s=Math.max(...a.map(i=>i.depth));return t==="simple"&&a.forEach(({skeleton:i,depth:l},c)=>{if(l!==s)return;const o=i.length/4,v=r(c/a.length);for(let h=1;h<o;h++){const f=h/o,u=i[h*4+1];i[h*4+1]=u-u*f*f*f*v}return i}),t==="test"&&a.forEach(({skeleton:i,depth:l})=>{if(l!==s)return;const c=i.length/4;for(let o=1;o<c;o++){const v=o/c,h=r(v),f=i[o*4+0],u=i[o*4+1],m=i[o*4+2],d=i[(o-1)*4+0],p=i[(o-1)*4+1],y=i[(o-1)*4+2],x=d-f,M=p-u,w=p-m,[b,g]=D1([x,w],Math.PI/2);for(let z=o;z<c;z++){const A=i[z*4+0],D=i[z*4+1],O=i[z*4+2],_=A-d,S=D-p,E=O-y;let[N,T,j]=O1([_,S,E],[b,M,g],h*v);const R=N+d,V=T+p,q=j+y;i[z*4+0]=R,i[z*4+1]=V,i[z*4+2]=q}}return i}),t==="verlet"&&a.forEach(({skeleton:i})=>{const l=i.length/4;for(let c=1;c<l;c++){const o=i[c*4+0],v=i[c*4+1],h=i[c*4+2],f=new I(5,0,0).cross(new I(o,v,h),new I(0,1,0)),u=c/l,m=r(u);for(let d=c;d<l;d++){const p=O1([o,v,h],f,u*m);i[d*4+0]=p[0],i[d*4+1]=p[1],i[d*4+2]=p[2]}}return i}),{stems:a}},computeGeometry(e){return e.input()}};const Q1=W("nodes.join");var Br={title:"Join",type:"join",outputs:["plant"],meta:{description:"The join node takes two plants and joins them to form a single new one."},parameters:{inputA:{type:"plant",label:"plant",required:!0,external:!0},inputB:{type:"plant",label:"plant",required:!0,external:!0}},computeStem(e,n){Q1("compute skeleton",e,n);const{inputA:t,inputB:r}=e;if(!t||!r)return t?t():r();const{stems:a}=t(),{stems:s}=r();return Q1(a,s),{stems:[...a,...s]}},computeGeometry(e){const{inputA:n,inputB:t}=e;if(!n||!t)return n?n():t();const{geometry:r,instances:a}=n(),{geometry:s,instances:i}=t(),l=g1(r,s),c=[];return a&&c.push(a),i&&c.push(i),Q1("compute geometry",{geometryA:r,geometryB:s,result:l}),{geometry:l,instances:c}}},Gr={title:"Leaf",type:"leaf",outputs:["plant"],meta:{description:"The leaf node instances leafs along branches or stems, you can override the shape of the leaf by plugging a shape node into the shape input."},parameters:{input:{type:"plant",required:!0,external:!0,description:"The input the leafs will be placed on."},size:{type:"number",min:0,max:3,step:.05,value:.2,description:"Size of the individual leaves."},shape:{type:"shape",external:!0,value:[{x:.8,y:1,pinned:!0},{x:.62,y:.84,pinned:!1},{x:.54,y:.63,pinned:!1},{x:.38,y:.41,pinned:!0},{x:.44,y:.23,pinned:!1},{x:.64,y:.12,pinned:!1},{x:.98,y:.02,pinned:!0}],description:"Shape of the indivual leaf, you can connect a shape node here"},lowestLeaf:{type:"number",min:0,max:1,step:.01,value:.5,description:"The lowest leaf on the stem."},curvature:{external:!0,type:"vec2",value:{x:.5,y:.2},description:"Curvature of the leaf along x and y, you can connect a vec2 node here."},amount:{type:"number",min:0,max:20,value:10,description:"How many leaves should be placed."}},computeStem(e){const n=e.input(),t=Ge(n),r=n.stems.map((a,s)=>{const i=s/n.stems.length;if(a.depth!==t)return;const l=e.amount(i);if(!l)return;const c=new Float32Array(l*3),o=new Float32Array(l*3),v=new Float32Array(l*3),h=new Float32Array(l);for(let f=0;f<l;f++){const u=f/(l-1),m=e.size(1-u),d=e.lowestLeaf(u),p=d+(1-d)*u-.001;h[f]=p;const[y,x,M]=je(a.skeleton,p),[w,b,g]=F1(a.skeleton,p),z=Ie([w,g]),A=Math.atan2(-z[0],z[1]);c[f*3+0]=y,c[f*3+1]=x,c[f*3+2]=M,o[f*3+0]=m,o[f*3+1]=m,o[f*3+2]=m,v[f*3+0]=0,v[f*3+1]=A-Math.PI/2*(f%2===0?-1:1),v[f*3+2]=0}return{offset:c,scale:o,rotation:v,id:a.id+"-"+s,baseAlpha:h,depth:a.depth}}).filter(a=>!!a);return n.instances&&r.push(...n.instances),{stems:n.stems,instances:r}},computeGeometry(e,n,t){const{shape:r,input:a,curvature:s}=e,{instances:i}=n,l=s(),c=jr(r(),{res:t.getSetting("leafRes")||2,xCurvature:l.x,yCurvature:l.y});return{geometry:a().geometry,instances:i.map(o=>Rr(c,o))}}},Hr={title:"Math",type:"math",outputs:["number"],meta:{description:"The math node provides some basic math functionality to transform numbers."},parameters:{mode:{type:"select",internal:!0,label:!1,value:"add",values:["add","multiply","subtract"]},a:{type:"number",value:0,label:!1},b:{type:"number",value:0,label:!1}},computeValue(e,n,t){const{mode:r}=e,a=e.a(t),s=e.b(t);switch(r){case"multiply":return a*s;case"subtract":return a-s;default:return a+s}}};const kr=W("nodes.noise");var Yr={title:"Noise",type:"noise",outputs:["plant"],meta:{description:"The noise node applies noise to input branches."},parameters:{input:{type:"plant",label:"plant",external:!0,required:!0},size:{type:"number",min:0,max:2,step:.05,value:1},strength:{type:"number",min:0,max:2,step:.01,value:.5}},computeStem(e){kr("computeSkeleton",e);const{stems:n}=e.input(),t=e.size(),r=e.strength(),a=Math.max(...n.map(s=>s.depth));return n.forEach((s,i)=>{s.depth===a&&Lr(s.skeleton,r,t,i*200)}),{stems:n}},computeGeometry(e,n,t){var i;const r=t.getSetting("stemResX"),a=(i=e==null?void 0:e.input)==null?void 0:i.call(e),{stems:s}=n;return{geometry:g1(a?a.geometry:null,...s.map(({skeleton:l})=>Fe(l,r)))}}},Zr={title:"Output",type:"output",outputs:[],meta:{description:"Every nodesystem needs one output node to create the final output"},parameters:{input:{type:"plant",required:!0,label:"plant",external:!0}}},Wr={title:"Parameter",type:"parameter",outputs:["number"],meta:{description:"The parameter outputs a value with a certain random variation applied to it."},parameters:{value:{type:"number",inputType:"float",value:0,description:"Base value to apply variation to"},variation:{type:"number",value:0,min:0,max:1,step:.05,description:"How much variation should be applied to the base value"}},computeValue(e,n,t=1){const r=e.value(),a=e.variation();return a?r+n.n1d(200*t)*a*Math.max(r,1):r}};const Qr=e=>e==="x"?[1,0,0]:e==="z"?[0,0,1]:[0,1,0];var Jr={title:"Rotate",type:"rotate",outputs:["plant"],meta:{description:"The rotate node rotates a plant around a specified axis by a specified amount."},parameters:{input:{type:"plant",required:!0,external:!0},axis:{type:"select",internal:!0,label:!1,inputType:"tab",values:["x","y","z"],value:"x",description:"Along which axis should we rotate?"},spread:{internal:!0,type:"boolean",value:!0,description:"If multiple objects are connected, should we rotate them as one or spread them?"},angle:{type:"number",min:0,max:Math.PI*2,step:.05,value:0,description:"Rotation angle"}},computeStem(e){const{input:n,axis:t,spread:r}=e,a=n(),s=a.stems,i=Qr(t),{depth:l}=s[s.length-1];return s.forEach((c,o)=>{if(c.depth!==l)return;const v=c.skeleton,h=c.skeleton.length/4,f=v[0],u=v[1],m=v[2],d=o/s.length,p=e.angle(d)*(r?d:1);for(let y=1;y<h;y++){let x=v[y*4+0],M=v[y*4+1],w=v[y*4+2];x-=f,M-=u,w-=m,[x,M,w]=O1([x,M,w],i,p),x+=f,M+=u,w+=m,v[y*4+0]=x,v[y*4+1]=M,v[y*4+2]=w}}),ae(m1({},a),{stems:s})}},Xr={title:"Shape",type:"shape",outputs:["shape"],meta:{description:"The shape node outputs a single shape which you can plug into the leaf node."},parameters:{value:{type:"shape",internal:!0,label:!1,value:[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}},computeValue(e){return e.value}},Kr={title:"Slider",type:"slider",outputs:["number"],parameters:{value:{type:"number",label:!1,internal:!0,min:0,max:1,step:.01,value:0}},computeValue(e){return e.value}};const e0=W("nodes.stem");var n0={title:"Stem",type:"stem",outputs:["plant"],meta:{description:"The stem node is the basis of every plant, it creates a simple stem."},parameters:{origin:{type:"vec3",external:!0,value:{x:0,y:0,z:0},description:"Where the stem is placed, you can connect a vec3 node here."},height:{type:"number",min:0,max:5,step:.05,value:2},thiccness:{type:"number",min:0,max:.2,step:.01,value:.06},amount:{type:"number",min:0,max:20,value:1,description:"How many stems should be instanced"}},computeStem(e,n){e0("computeSkeleton",e);const t=e.amount(),r=n.getSetting("stemResY"),a=[];for(let s=0;s<t;s++){const{x:i,y:l,z:c}=e.origin(s),o=e.height(),v=new Float32Array(r*4);for(let h=0;h<r;h++){const f=h/r,u=e.thiccness(f)*(1-f),m=i,d=l+f*o,p=c;v[h*4+0]=m,v[h*4+1]=d,v[h*4+2]=p,v[h*4+3]=u}a.push({depth:0,skeleton:v,id:"stem-"+n.getId(),baseAlpha:0})}return{stems:a}}},t0={title:"Vec2",type:"vec2",outputs:["vec2"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0}}},r0={title:"Vec3",type:"vec3",outputs:["vec3"],meta:{description:"Outputs a Vec3, you can connect a random or parameter node here to distribute stems."},parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0},z:{label:!1,type:"number",value:0,defaultValue:0}}},a0={title:"Vec3Length",type:"vec3length",outputs:["number"],parameters:{vec:{type:"vec3",label:!1,value:{x:0,y:0,z:0}}},computeValue(e){const n=e.vec();return n?Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)+Math.pow(n.z,2)):0}},s0={title:"Split",type:"split",outputs:["plant"],meta:{description:"The split node splits the input plant at a specified height resulting in new branches."},parameters:{input:{type:"plant",label:"plant",required:!0,external:!0},height:{type:"number",min:0,max:1,step:.05,value:.7,description:"Where along the input stem do we split"},angle:{type:"number",min:0,max:2,step:.01,value:.5,description:"What angle in reference to the input stem should the split branches have."},amount:{type:"number",min:2,max:20,value:2,description:"Into how many branches should we split"}},computeStem(e){const n=e.height(),t=e.angle(),r=e.amount(),a=e.input(),s=Math.max(...a.stems.map(l=>l.depth)),i=a.stems.map(l=>l.depth===s?qr(l.skeleton,n,r,t).map((o,v)=>({skeleton:o,id:l.id,baseAlpha:n,depth:l.depth+(v===0?0:1)})):l).flat().filter(l=>!!l);return a.instances&&(a.instances=Vr(a.instances,0,n,s)),{stems:i,instances:a.instances}}},i0={title:"Number",type:"number",outputs:["number"],parameters:{value:{type:"number",internal:!0,label:!1,value:0}},computeValue({value:e=0}){return e}},l0=Object.freeze({__proto__:null,Branch:Ir,Random:Cr,Curve:Fr,Gravity:Ur,Join:Br,Leaf:Gr,Math:Hr,Noise:Yr,Output:Zr,Parameter:Wr,Rotate:Jr,Shape:Xr,Slider:Kr,Stem:n0,Vec2:t0,Vec3:r0,VecLength:a0,Split:s0,Number:i0}),c0=Object.values(l0);const a1=new Map;for(const e of c0)e.computeStem&&(e.computeStem=$1(e.computeStem)),e.computeGeometry&&(e.computeGeometry=$1(e.computeGeometry)),e.computeValue&&(e.computeValue=$1(e.computeValue)),a1.set(e.type,e);let He="",J1,X1=2;const o0=e=>{let n=0;return J.seed=0,{_id:"",getId(){return this._id},n1d(t){return J.n1d(X1++*t)},n1dn(t){return 1+J.n1d(X1++*t)/2},getSetting(t){return e[t]},get settings(){return e},get seed(){return n},refresh(){X1=2,e!=null&&e.useRandomSeed&&(n=Math.floor(Math.random()*1e5),J.seed=n)}}};var f0=e=>{const n=JSON.stringify(e);return n!==He&&(He=n,J1=o0(e)),J1.refresh(),J1};function h0({nodes:e},n){const t=f0(n),r=new Map,a=new Map,s=h=>{var f;return(f=a.get(h))!=null?f:[]},i=h=>{var f;return(f=r.get(h))!=null?f:[]};let l=[];for(const{attributes:h,state:f}of e){const u=a1.get(h.type);if(!u)return console.log("Existing node types: ",{nodeMap:a1}),{errors:["Missing NodeType "+h.type]};l.push({attributes:h,state:f,exec:u,type:h.type,id:h.id,level:-1,results:[]})}let c;if(l.forEach(h=>{r.set(h.id,h),!c&&h.type==="output"&&(c=h,c.level=0),h.attributes.refs.forEach(f=>{a.has(f.id)?a.set(f.id,[...a.get(f.id),{n:h,in:f.in,out:f.out}]):a.set(f.id,[{n:h,in:f.in,out:f.out}])})}),!c)return{errors:["Missing output node"]};function o(h){if(h!=null&&h.buckets)return h.buckets;let f=[h],u=[h];for(;f.length;){const d=f.shift(),p=s(d.id);if(p!=null&&p.length)for(const{n:y}of p)y.level=d.level+1,u.includes(y)||u.push(y),f.push(y)}const m=[];for(const d of u)m[d.level]?m[d.level].push(d):m[d.level]=[d];return h.buckets=m,m}function v(h){var m,d,p,y;if("parameters"in h)return h.parameters;let f={};const u=a1.get(h.type);for(const x of s(h.id)){const M=x.n;M.exec.outputs[0]==="plant"?f[x.in]=()=>x.n.results[0]:(m=M.exec)!=null&&m.computeValue?f[x.in]=(w=1)=>{const b=v(x.n);return M.exec.computeValue(b,t,w)}:f[x.in]=(w=1)=>{const b={},g=v(x.n);return Object.keys(g).forEach(A=>{b[A]=g[A](w)}),b}}for(const x of Object.keys(u.parameters))if((d=u.parameters[x])!=null&&d.internal)f[x]=h.state[x];else if(f[x]===void 0){if((p=u.parameters[x])!=null&&p.required&&f[x]===void 0)return{errors:["Missing Input ["+(((y=u.parameters[x])==null?void 0:y.label)||x)+"] in "+u.type]};f[x]=()=>h.state[x]}return h.parameters=f,f}return{nodes:l,outputNode:c,getNodeRef:s,getNode:i,getBucketsForNode:o,constructParametersForNode:v,ctx:t}}async function ke(e,n){var o,v;const t=h0(e,n);if(t.errors)return{errors:t.errors};const r=t.ctx,a=t.getBucketsForNode(t.outputNode);for(const h of a.reverse())for(const f of h){const u=a1.get(f.type);if(u){let m=t.constructParametersForNode(f);if(m!=null&&m.errors)return{errors:m.errors};if(u!=null&&u.computeStem){r._id=f.id;const d=u.computeStem(m,r);d.stems.find(p=>p.skeleton.includes(NaN))&&(console.warn("Node "+u.type+" produced NaN in skeleton"),console.log({result:d})),f.results=Array.isArray(d)?d:[d]}if(u!=null&&u.computeGeometry){const d=u.computeGeometry(m,f.results[0],r);f.results[0]=m1(m1({},f.results[0]),d)}}else console.warn("Missing Type",f.type),console.log(a1)}if(!((v=(o=t==null?void 0:t.outputNode)==null?void 0:o.parameters)!=null&&v.input))return{errors:["Missing input connection to output node"]};const s=t.outputNode.parameters.input();if(!s)return{errors:["DUnno?"]};const{stems:i,instances:l}=s;let c=g1(...i.map(h=>Fe(h.skeleton,r.getSetting("stemResX"))));if(l){Ce(c);const h=l==null?void 0:l.map(f=>ye(f)).flat();c=g1(c,...h),Ce(c)}return{stems:i,geometry:me(c)}}const Ye=Symbol("Comlink.proxy"),v0=Symbol("Comlink.endpoint"),p0=Symbol("Comlink.releaseProxy"),K1=Symbol("Comlink.thrown"),Ze=e=>typeof e=="object"&&e!==null||typeof e=="function",u0={canHandle:e=>Ze(e)&&e[Ye],serialize(e){const{port1:n,port2:t}=new MessageChannel;return ee(e,n),[t,[t]]},deserialize(e){return e.start(),y0(e)}},d0={canHandle:e=>Ze(e)&&K1 in e,serialize({value:e}){let n;return e instanceof Error?n={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:n={isError:!1,value:e},[n,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},We=new Map([["proxy",u0],["throw",d0]]);function ee(e,n=self){n.addEventListener("message",function t(r){if(!r||!r.data)return;const{id:a,type:s,path:i}=Object.assign({path:[]},r.data),l=(r.data.argumentList||[]).map(X);let c;try{const o=i.slice(0,-1).reduce((h,f)=>h[f],e),v=i.reduce((h,f)=>h[f],e);switch(s){case"GET":c=v;break;case"SET":o[i.slice(-1)[0]]=X(r.data.value),c=!0;break;case"APPLY":c=v.apply(o,l);break;case"CONSTRUCT":{const h=new v(...l);c=M0(h)}break;case"ENDPOINT":{const{port1:h,port2:f}=new MessageChannel;ee(e,f),c=g0(h,[h])}break;case"RELEASE":c=void 0;break;default:return}}catch(o){c={value:o,[K1]:0}}Promise.resolve(c).catch(o=>({value:o,[K1]:0})).then(o=>{const[v,h]=te(o);n.postMessage(Object.assign(Object.assign({},v),{id:a}),h),s==="RELEASE"&&(n.removeEventListener("message",t),Qe(n))})}),n.start&&n.start()}function m0(e){return e.constructor.name==="MessagePort"}function Qe(e){m0(e)&&e.close()}function y0(e,n){return ne(e,[],n)}function T1(e){if(e)throw new Error("Proxy has been released and is not useable")}function ne(e,n=[],t=function(){}){let r=!1;const a=new Proxy(t,{get(s,i){if(T1(r),i===p0)return()=>s1(e,{type:"RELEASE",path:n.map(l=>l.toString())}).then(()=>{Qe(e),r=!0});if(i==="then"){if(n.length===0)return{then:()=>a};const l=s1(e,{type:"GET",path:n.map(c=>c.toString())}).then(X);return l.then.bind(l)}return ne(e,[...n,i])},set(s,i,l){T1(r);const[c,o]=te(l);return s1(e,{type:"SET",path:[...n,i].map(v=>v.toString()),value:c},o).then(X)},apply(s,i,l){T1(r);const c=n[n.length-1];if(c===v0)return s1(e,{type:"ENDPOINT"}).then(X);if(c==="bind")return ne(e,n.slice(0,-1));const[o,v]=Je(l);return s1(e,{type:"APPLY",path:n.map(h=>h.toString()),argumentList:o},v).then(X)},construct(s,i){T1(r);const[l,c]=Je(i);return s1(e,{type:"CONSTRUCT",path:n.map(o=>o.toString()),argumentList:l},c).then(X)}});return a}function x0(e){return Array.prototype.concat.apply([],e)}function Je(e){const n=e.map(te);return[n.map(t=>t[0]),x0(n.map(t=>t[1]))]}const Xe=new WeakMap;function g0(e,n){return Xe.set(e,n),e}function M0(e){return Object.assign(e,{[Ye]:!0})}function te(e){for(const[n,t]of We)if(t.canHandle(e)){const[r,a]=t.serialize(e);return[{type:"HANDLER",name:n,value:r},a]}return[{type:"RAW",value:e},Xe.get(e)||[]]}function X(e){switch(e.type){case"HANDLER":return We.get(e.name).deserialize(e.value);case"RAW":return e.value}}function s1(e,n,t){return new Promise(r=>{const a=w0();e.addEventListener("message",function s(i){!i.data||!i.data.id||i.data.id!==a||(e.removeEventListener("message",s),r(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),t)})}function w0(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}async function b0(e,n){var r;let t=await ke(e,n);return(r=t==null?void 0:t.errors)!=null&&r.length?t:$r(t.geometry)}ee({exportToObject:b0,executeNodeSystem:ke})})();
