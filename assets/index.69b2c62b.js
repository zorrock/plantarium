var go=Object.defineProperty,wo=Object.defineProperties;var yo=Object.getOwnPropertyDescriptors;var Vn=Object.getOwnPropertySymbols;var _o=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable;var jt=(s,e,t)=>e in s?go(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,te=(s,e)=>{for(var t in e||(e={}))_o.call(e,t)&&jt(s,t,e[t]);if(Vn)for(var t of Vn(e))bo.call(e,t)&&jt(s,t,e[t]);return s},_e=(s,e)=>wo(s,yo(e));var rt=(s,e,t)=>(jt(s,typeof e!="symbol"?e+"":e,t),t);import{w as me,S as Z,i as K,s as Q,e as b,a as E,b as v,c as y,d as P,n as O,f as M,g as be,o as De,t as ko,h as ae,j as D,k as oe,l as H,m as N,p as Y,q as S,r as X,u as se,v as Dn,x as B,y as Rn,z as zn,A as Fn,B as Le,C as je,D as R,E as z,F,G as Et,H as I,I as de,J as We,K as ke,L as Bn,M as Wn,N as Gn,O as Un,P as Hn,T as Yn,Q as So,R as Re,U as Mo,V as Xn,W as xo,X as re,Y as Ce,Z as qn,_ as ve,$ as lt,a0 as $t,a1 as Po,a2 as No,a3 as Lo,a4 as jo,a5 as Eo,a6 as $o,a7 as Co,a8 as To,a9 as at,aa as Ae,ab as Ge,ac as Oo,ad as Io,ae as Ao,af as Vo,ag as Do,ah as ct,ai as Jn,aj as Zn,ak as Se,al as Ct,am as Ro,an as ut,ao as ft,ap as Kn,aq as zo,ar as Fo,as as Bo,at as Wo,au as Go,av as Qn,aw as Tt,ax as Uo,ay as es}from"./vendor.24b491bb.js";const Ho=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};Ho();const Yo="0px 0px 2px rgba(0, 0, 0, 0.7)",Xo="0px 0px 5px rgba(0, 0, 0, 0.144)";var qo={"dark_background-color":"#1a1a1a","dark_foreground-color":"#303030","dark_outline-color":"#212121","dark_text-color":"#ffffff",dark_shadow:Yo,"light_background-color":"#d0d0d0","light_foreground-color":"white","light_outline-color":"#b9b9b9","light_text-color":"#484848",light_shadow:Xo};function Jo(s){const e={};return Object.entries(s).forEach(([t,n])=>{const[i,o]=t.split("_");i in e?e[i][o]=n:e[i]={[o]:n}}),e}const Ot=Jo(qo),ht=Object.keys(Ot);let It="theme"in localStorage?localStorage.getItem("theme"):ht[0];ht.includes(It)||(It=ht[0]);const At=me(Ot[It]),ts=s=>{ht.includes(s)&&(At.set(Ot[s]),localStorage.setItem("theme",s))};function Zo(s){let e,t;return{c(){e=b("style"),t=E(),v(e,"type","text/css")},m(n,i){y(document.head,e),s[3](e),P(n,t,i)},p:O,i:O,o:O,d(n){M(e),s[3](null),n&&M(t)}}}function Ko(s,e,t){let n,i;be(s,At,c=>t(2,i=c));let o,r=!1;function a(){r||!o||(r=!0,t(0,o.innerHTML="* {transition: color 0.2s ease, background-color 0.2s ease, outline 0.2s ease !important;}",o),setTimeout(()=>{t(0,o.innerHTML=`* {transition: color 0.2s ease, background-color 0.2s ease, outline 0.2s ease !important;} :root{${n}}`,o),setTimeout(()=>{t(0,o.innerHTML=`:root{${n}}`,o),r=!1},200)},1))}De(()=>{t(0,o.innerHTML=`:root{${n}}`,o)});function l(c){ae[c?"unshift":"push"](()=>{o=c,t(0,o)})}return s.$$.update=()=>{s.$$.dirty&4&&t(1,n=ko(i)),s.$$.dirty&2&&n&&a()},[o,n,i,l]}class Qo extends Z{constructor(e){super();K(this,e,Ko,Zo,Q,{})}}function er(){return"window"in globalThis}const ns=er();var tr=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.2" baseProfile="tiny" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	 x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" xml:space="preserve">
</svg>
`,nr=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>branch</title>
  <path class="cls-1" d="M49.59,57.35,72.15,38.69"/>
  <path class="cls-1" d="M51.58,29.45,38,11.21"/>
  <path class="cls-1" d="M53.14,82.61,21.78,55.74"/>
  <path class="cls-1" d="M33.46,47.91l4,21"/>
  <polyline class="cls-1" points="56 97 50 58 51 28 56 16"/>
</svg>`,sr='<svg id="e7691b6e-31fa-49a4-aaec-be19b623d191" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><style>.b50603dd-20d5-40a2-a0ce-2fdf3b92ec21{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:5px;}</style></defs><title>checkmark</title><path class="b50603dd-20d5-40a2-a0ce-2fdf3b92ec21" d="M75.5,30,40.43,72.47a2,2,0,0,1-3.08,0L24.5,57"/></svg>',ir=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
<defs>
	<style>
		circle, path{
			fill:none;
			stroke: var(--text, white);
			stroke-width: 5px;
		}
	</style>
</defs>
	<circle class="cls-1" cx="50.37" cy="50.5" r="17.23"/>
  <path class="cls-1" d="M38.07,20.49,32.17,8.05,50.83,4.41l.61,13.8,12.13,2.28L68.73,8.05l14,10.16-9,10L81.17,38.7l12-5.47,3.34,17.3H81.93L80.57,63l12.59,6.37L82.7,83.62l-9-9.86L63.58,81.19l5.15,11.23-17.9,3.64V82.71L38.08,81.19,32.77,92.42,17.44,82.71l10.17-8.35L19.11,63,8.19,69.36,4.4,50.56H17.45l1.67-13.81L8.2,30.84l9.25-13.2,11.08,8.81Z"/>
</svg>
`,or=`<svg
  xmlns="http://www.w3.org/2000/svg"
	viewBox="0 0 100 100">
  <line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="27.836" y1="72.164" x2="72.164" y2="27.836"/>
  <line fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" x1="27.836" y1="27.988" x2="72.164" y2="72.012"/>
</svg>
`,rr=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M50.552 59.3295L39.0695 13.7056H60.2078L50.552 59.3295Z" stroke="white" stroke-width="5" stroke-linejoin="round"/>
<path d="M58.4305 77.2411C58.4305 80.8276 55.4725 83.7944 51.7497 83.7944C48.0269 83.7944 45.0688 80.8276 45.0688 77.2411C45.0688 73.6546 48.0269 70.6878 51.7497 70.6878C55.4725 70.6878 58.4305 73.6546 58.4305 77.2411Z" stroke="white" stroke-width="5"/>
</svg>
`,lr=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">

<defs>
	<style>
		path{
			stroke: white;
			stroke-width: 5px;
		}
	</style>
</defs>

<path d="M23.5167 72.9513V32.1483H82.1056L87.6855 37.0307V76.09L82.1056 78.5312H29.4453L23.5167 72.9513Z" />
<path d="M23.2747 73.6489L12.3145 30.0463L15.8885 21.4688H71.8808L75.693 32.9055" />
<path d="M25.488 43.9781H86.7394" />
</svg>
`,ar=`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
<path d="M70.5 26.5L77.5 23.5L82 32V69L77.5 82L64.5 92.5H47L32 82L18 46L21 40H27L35 57.5V15.5L39.5 11L45.5 13.5M70.5 26.5L69 15.5L58.5 14M70.5 26.5V57.5M58.5 14L55 8L45.5 13.5M58.5 14V49M45.5 13.5V49" stroke-width="5"/>
</svg>
`,cr=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>leaf</title>
  <path class="cls-1" d="M50.69,96.21,72.86,72.33,77,47,65.91,21.7,50.66,4.5"/>
  <path class="cls-1" d="M53.37,96.21,31.2,72.33,27.07,47,38.15,21.7,53.4,4.5"/>
</svg>`,ur=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M30.2312 46.4809V15.6962L33.3006 8H40.8035L44.3844 11.0785V29.7203H52.9104L55.9798 33.8249H65.0173L68.0867 38.9557L76.2717 40.1529L79 56.0583L73.7139 72.9899L66.8931 93H36.5405L30.2312 75.5553L20 60.334L21.7052 50.2435L30.2312 46.4809ZM30.2312 46.4809V58.1107M44.3844 29.3783V46.3099M56.4913 34.5091V46.3099M68.7688 39.2978V50.4145" stroke="white" stroke-width="5"/>
</svg>
`,fr=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <defs>
    <style>.cls-1{fill:none;stroke:#fff;stroke-width:5px;}</style>
  </defs>
  <title>stem</title>
  <path class="cls-1" d="M49,95.5l8.66-23.19L43.24,46.07l10.59-21L43.24,4.5"/>
</svg>`,hr=`<svg
  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" xml:space="preserve">
  <polygon fill="none" stroke="#FFFFFF" stroke-width="5" stroke-miterlimit="10" points="33.5,73.759 33.5,26.241 67.441,50 "/>
</svg>
`,dr=`<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M54.7631 15.1799L91.7944 79.3201C93.9114 82.9867 91.2652 87.5701 87.0313 87.5701H12.9687C8.73476 87.5701 6.08857 82.9867 8.20552 79.3201L45.2368 15.1799C47.3538 11.5133 52.6462 11.5133 54.7631 15.1799Z" stroke="white" stroke-width="5" stroke-linejoin="round"/>
<ellipse cx="50.0578" cy="73.7787" rx="5.98166" ry="5.89858" fill="white"/>
<path d="M52.9755 60.2707C52.5275 63.7615 47.4723 63.7615 47.0243 60.2707L43.5981 33.5748C43.3678 31.781 44.7652 30.1929 46.5736 30.1929L53.4261 30.1929C55.2346 30.1929 56.6319 31.781 56.4017 33.5748L52.9755 60.2707Z" fill="white"/>
</svg>
`,pr=`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
<path d="M32.7792 25.4477L45.6598 15.6472L61.6205 20.4075L67.2208 32.728L54.3402 46.4486L50.9801 59.3291V63.9218" stroke-width="8"/>
<path d="M47.3642 83.3434L44.983 79.0169L46.821 74.3331L51.3861 73.0881L55.5363 75.0446L56.307 80.8548L52.3347 84.3528L47.3642 83.3434Z" />
</svg>

`,ss=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",arrow:tr,branch:nr,checkmark:sr,cog:ir,cross:or,exclamation:rr,folder:lr,hand:ar,leaf:cr,pointing:ur,stem:fr,triangle:hr,warning:dr,question:pr});function mr(s){let e;return{c(){e=b("div"),v(e,"class","icon-wrapper svelte-1ho94ty"),D(e,"active",s[0]),D(e,"dark",s[1]),D(e,"circle",s[2])},m(t,n){P(t,e,n),e.innerHTML=s[3]},p(t,[n]){n&8&&(e.innerHTML=t[3]),n&1&&D(e,"active",t[0]),n&2&&D(e,"dark",t[1]),n&4&&D(e,"circle",t[2])},i:O,o:O,d(t){t&&M(e)}}}function vr(s,e,t){let n,{name:i="triangle"}=e,{active:o=!1}=e,{dark:r=!1}=e,{circle:a=!1}=e;return s.$$set=l=>{"name"in l&&t(4,i=l.name),"active"in l&&t(0,o=l.active),"dark"in l&&t(1,r=l.dark),"circle"in l&&t(2,a=l.circle)},s.$$.update=()=>{s.$$.dirty&16&&t(3,n=i in ss?ss[i]:i.toString()+" icon not found")},[o,r,a,n,i]}class Ue extends Z{constructor(e){super();K(this,e,vr,mr,Q,{name:4,active:0,dark:1,circle:2})}}function is(s){let e,t,n,i;const o=[wr,gr],r=[];function a(l,c){return l[6]?0:1}return e=a(s),t=r[e]=o[e](s),{c(){t.c(),n=oe()},m(l,c){r[e].m(l,c),P(l,n,c),i=!0},p(l,c){let u=e;e=a(l),e===u?r[e].p(l,c):(H(),N(r[u],1,1,()=>{r[u]=null}),Y(),t=r[e],t?t.p(l,c):(t=r[e]=o[e](l),t.c()),S(t,1),t.m(n.parentNode,n))},i(l){i||(S(t),i=!0)},o(l){N(t),i=!1},d(l){r[e].d(l),l&&M(n)}}}function gr(s){let e;return{c(){e=b("plant-icon"),je(e,"name",s[1]),je(e,"active",s[0]),je(e,"class","svelte-liun6t")},m(t,n){P(t,e,n)},p(t,n){n&2&&je(e,"name",t[1]),n&1&&je(e,"active",t[0])},i:O,o:O,d(t){t&&M(e)}}}function wr(s){let e,t;return e=new Ue({props:{name:s[1],active:s[0]}}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.name=n[1]),i&1&&(o.active=n[0]),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function os(s){let e,t;return{c(){e=b("p"),t=X(s[2]),v(e,"class","svelte-liun6t")},m(n,i){P(n,e,i),y(e,t)},p(n,i){i&4&&se(t,n[2])},d(n){n&&M(e)}}}function yr(s){let e,t,n,i,o,r,a,l,c=s[1]&&is(s),u=s[2]&&os(s);const f=s[9].default,h=Dn(f,s,s[8],null);return{c(){e=b("div"),t=b("button"),c&&c.c(),n=E(),u&&u.c(),i=E(),o=b("div"),h&&h.c(),v(o,"class","content svelte-liun6t"),t.disabled=s[4],v(t,"class","svelte-liun6t"),D(t,"active",s[0]),D(t,"useActive",s[3]),D(t,"only-icon",!s[2]),D(t,"has-icon",!!s[1]),v(e,"class","component-wrapper")},m(p,d){P(p,e,d),y(e,t),c&&c.m(t,null),y(t,n),u&&u.m(t,null),y(t,i),y(t,o),h&&h.m(o,null),s[10](t),r=!0,a||(l=B(t,"click",s[7]),a=!0)},p(p,[d]){p[1]?c?(c.p(p,d),d&2&&S(c,1)):(c=is(p),c.c(),S(c,1),c.m(t,n)):c&&(H(),N(c,1,1,()=>{c=null}),Y()),p[2]?u?u.p(p,d):(u=os(p),u.c(),u.m(t,i)):u&&(u.d(1),u=null),h&&h.p&&(!r||d&256)&&Rn(h,f,p,p[8],r?Fn(f,p[8],d,null):zn(p[8]),null),(!r||d&16)&&(t.disabled=p[4]),d&1&&D(t,"active",p[0]),d&8&&D(t,"useActive",p[3]),d&4&&D(t,"only-icon",!p[2]),d&2&&D(t,"has-icon",!!p[1])},i(p){r||(S(c),S(h,p),r=!0)},o(p){N(c),N(h,p),r=!1},d(p){p&&M(e),c&&c.d(),u&&u.d(),h&&h.d(p),s[10](null),a=!1,l()}}}function _r(s,e,t){let n,{$$slots:i={},$$scope:o}=e,{icon:r=void 0}=e,{name:a=""}=e,{active:l=!1}=e,{useActive:c=!1}=e,{disabled:u=!1}=e,f;const h=Le(),p=()=>{t(0,l=!l),h("click")};function d(m){ae[m?"unshift":"push"](()=>{f=m,t(5,f)})}return s.$$set=m=>{"icon"in m&&t(1,r=m.icon),"name"in m&&t(2,a=m.name),"active"in m&&t(0,l=m.active),"useActive"in m&&t(3,c=m.useActive),"disabled"in m&&t(4,u=m.disabled),"$$scope"in m&&t(8,o=m.$$scope)},s.$$.update=()=>{s.$$.dirty&32&&t(6,n=f&&!!f.parentElement)},[l,r,a,c,u,f,n,p,o,i,d]}class pe extends Z{constructor(e){super();K(this,e,_r,yr,Q,{icon:1,name:2,active:0,useActive:3,disabled:4})}}var ge;(function(s){s.INFO="info",s.WARNING="warning",s.ERROR="error",s.SUCCESS="success"})(ge||(ge={}));const br=s=>(e,t={})=>{var r;if(!e&&!t)return;const n=Array.isArray(t==null?void 0:t.values),i={id:Et(),type:ge.INFO,content:e,props:t.props,title:(r=t==null?void 0:t.title)!=null?r:t==null?void 0:t.type,values:t==null?void 0:t.values,timeout:t==null?void 0:t.timeout},o=new Promise((a,l)=>{i.resolve=a,i.reject=l});if(o.finally(()=>s.update(a=>a.filter(l=>l.id!==i.id))),t&&"type"in t){const a=t.type.toLowerCase();Object.values(ge).forEach(l=>{a===l&&(i.type=l)})}if(e instanceof Error&&(i.type=ge.ERROR),typeof i.timeout=="undefined"){let a;i.type===ge.SUCCESS&&(a=3e3),i.type===ge.INFO&&(a=2e3),i.type===ge.WARNING&&(a=7e3),a&&!n&&(i.timeout=a)}return"title"in i||(i.title=i.type.toUpperCase().slice(0,1)+i.type.slice(1)),s.update(a=>[...a,i]),i.timeout&&setTimeout(i.resolve,i.timeout),o};var rs=()=>{const s=me([]),e=br(s);return{store:s,createMessage:e,MessageType:ge}};const{store:kr,createMessage:Sr,MessageType:wf}=rs(),Mr=kr,He=Sr;function ls(s,e,t){const n=s.slice();return n[6]=e[t],n}function as(s){let e,t,n,i,o,r,a,l,c,u,f,h,p,d;i=new pe({props:{icon:"cross"}}),i.$on("click",s[4]);let m=s[0].title&&cs(s);const g=[Pr,xr],w=[];function x(k,C){return typeof k[0].content=="string"?0:1}l=x(s),c=w[l]=g[l](s);let _=s[0].values&&us(s);return{c(){e=b("div"),t=b("div"),n=b("div"),o=b("div"),R(i.$$.fragment),r=E(),m&&m.c(),a=E(),c.c(),u=E(),_&&_.c(),I(o,"display","contents"),I(o,"--bg","transparent"),v(n,"class","close-wrapper svelte-6zzrtw"),v(t,"class",f="alert-wrapper alert-"+s[0].type+" svelte-6zzrtw"),D(t,"isInverted",s[1]),v(e,"class","alert-container svelte-6zzrtw")},m(k,C){P(k,e,C),y(e,t),y(t,n),y(n,o),z(i,o,null),y(t,r),m&&m.m(t,null),y(t,a),w[l].m(t,null),y(t,u),_&&_.m(t,null),d=!0},p(k,C){k[0].title?m?m.p(k,C):(m=cs(k),m.c(),m.m(t,a)):m&&(m.d(1),m=null);let L=l;l=x(k),l===L?w[l].p(k,C):(H(),N(w[L],1,1,()=>{w[L]=null}),Y(),c=w[l],c?c.p(k,C):(c=w[l]=g[l](k),c.c()),S(c,1),c.m(t,u)),k[0].values?_?(_.p(k,C),C&1&&S(_,1)):(_=us(k),_.c(),S(_,1),_.m(t,null)):_&&(H(),N(_,1,1,()=>{_=null}),Y()),(!d||C&1&&f!==(f="alert-wrapper alert-"+k[0].type+" svelte-6zzrtw"))&&v(t,"class",f),C&3&&D(t,"isInverted",k[1])},i(k){d||(S(i.$$.fragment,k),S(c),S(_),We(()=>{h||(h=ke(t,Bn,{},!0)),h.run(1)}),We(()=>{p||(p=ke(e,Wn,{},!0)),p.run(1)}),d=!0)},o(k){N(i.$$.fragment,k),N(c),N(_),h||(h=ke(t,Bn,{},!1)),h.run(0),p||(p=ke(e,Wn,{},!1)),p.run(0),d=!1},d(k){k&&M(e),F(i),m&&m.d(),w[l].d(),_&&_.d(),k&&h&&h.end(),k&&p&&p.end()}}}function cs(s){let e,t=s[0].title+"",n;return{c(){e=b("h2"),n=X(t),v(e,"class","svelte-6zzrtw")},m(i,o){P(i,e,o),y(e,n)},p(i,o){o&1&&t!==(t=i[0].title+"")&&se(n,t)},d(i){i&&M(e)}}}function xr(s){let e,t,n;const i=[s[0].props];var o=s[0].content;function r(a){let l={};for(let c=0;c<i.length;c+=1)l=Hn(l,i[c]);return{props:l}}return o&&(e=new o(r())),{c(){e&&R(e.$$.fragment),t=oe()},m(a,l){e&&z(e,a,l),P(a,t,l),n=!0},p(a,l){const c=l&1?Gn(i,[Un(a[0].props)]):{};if(o!==(o=a[0].content)){if(e){H();const u=e;N(u.$$.fragment,1,0,()=>{F(u,1)}),Y()}o?(e=new o(r()),R(e.$$.fragment),S(e.$$.fragment,1),z(e,t.parentNode,t)):e=null}else o&&e.$set(c)},i(a){n||(e&&S(e.$$.fragment,a),n=!0)},o(a){e&&N(e.$$.fragment,a),n=!1},d(a){a&&M(t),e&&F(e,a)}}}function Pr(s){let e,t=s[0].content+"";return{c(){e=b("p")},m(n,i){P(n,e,i),e.innerHTML=t},p(n,i){i&1&&t!==(t=n[0].content+"")&&(e.innerHTML=t)},i:O,o:O,d(n){n&&M(e)}}}function us(s){let e,t,n=s[0].values,i=[];for(let r=0;r<n.length;r+=1)i[r]=fs(ls(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){e=b("div");for(let r=0;r<i.length;r+=1)i[r].c();v(e,"class","options-wrapper svelte-6zzrtw")},m(r,a){P(r,e,a);for(let l=0;l<i.length;l+=1)i[l].m(e,null);t=!0},p(r,a){if(a&1){n=r[0].values;let l;for(l=0;l<n.length;l+=1){const c=ls(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=fs(c),i[l].c(),S(i[l],1),i[l].m(e,null))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){r&&M(e),de(i,r)}}}function fs(s){let e,t,n;function i(){return s[5](s[6])}return e=new pe({props:{name:s[6]}}),e.$on("click",i),{c(){t=b("div"),R(e.$$.fragment),I(t,"display","contents"),I(t,"--bg","#303030"),I(t,"--text","white")},m(o,r){P(o,t,r),z(e,t,null),n=!0},p(o,r){s=o;const a={};r&1&&(a.name=s[6]),e.$set(a)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){N(e.$$.fragment,o),n=!1},d(o){o&&M(t),F(e,o)}}}function Nr(s){let e,t,n,i,o=s[0]&&as(s);return{c(){o&&o.c(),e=oe()},m(r,a){o&&o.m(r,a),P(r,e,a),t=!0,n||(i=B(window,"keydown",s[2]),n=!0)},p(r,[a]){r[0]?o?(o.p(r,a),a&1&&S(o,1)):(o=as(r),o.c(),S(o,1),o.m(e.parentNode,e)):o&&(H(),N(o,1,1,()=>{o=null}),Y())},i(r){t||(S(o),t=!0)},o(r){N(o),t=!1},d(r){o&&o.d(r),r&&M(e),n=!1,i()}}}function Lr(s,e,t){let n,i,o;be(s,Mr,c=>t(3,o=c));function r(c){c.key==="Escape"&&n&&n.reject()}const a=()=>{n.reject()},l=c=>n.resolve(c);return s.$$.update=()=>{s.$$.dirty&8&&t(0,n=o[0]),s.$$.dirty&1&&(n?ns&&document.body.classList.add("overlay-visible"):ns&&document.body.classList.remove("overlay-visible")),s.$$.dirty&1&&t(1,i=n&&(n.type==="success"||n.type==="warning"))},[n,i,r,o,a,l]}class jr extends Z{constructor(e){super();K(this,e,Lr,Nr,Q,{})}}const{store:Er,createMessage:$r}=rs(),Cr=Er,Ye=$r;var Tr=(s,...e)=>{const t=(i,o)=>{Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o).map(r=>r.toString())).forEach(r=>{r.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(o,r))})},n=class extends s{constructor(...o){super(...o);e.forEach(r=>t(this,new r))}};return e.forEach(i=>{t(n.prototype,i.prototype),t(n,i)}),n},hs=s=>{s[0]==="#"&&(s=s.replace("#","")),s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]);const e=s.match(/.{1,2}/g);return[parseInt(e[0],16)/255,parseInt(e[1],16)/255,parseInt(e[2],16)/255]};const Me=.4;function Or(s,e,t,n,i,o,r,a,l,c){const u=i-t,f=r-i,h=l-r,p=o-n,d=a-o,m=c-a;let g,w,x,_,k=-1e4,C=-1e4;const L=[{x:t,y:n}];for(let V=1;V<s;V++){const $=V/s;g=t+u*$,x=i+f*$;const J=r+h*$;g+=(x-g)*$,x+=(J-x)*$,w=n+p*$,_=o+d*$;const q=a+m*$;w+=(_-w)*$,_+=(q-_)*$;const ne=g+(x-g)*$,U=w+(_-w)*$,ee=ne-k,W=U-C;ee*ee+W*W>e&&(L.push({x:ne,y:U}),k=ne,C=U)}return L.push({x:l,y:c}),L}function Ir(s){const e=s.length-1;return s.map((t,n,i)=>{if(n===0)return{rx:i[n+1].x*Me*0,ry:t.y+(i[n+1].y-t.y)*Me*0};if(n===e)return{lx:i[n-1].x+(t.x-i[n-1].x)*Me*2,ly:i[n-1].y+(t.y-i[n-1].y)*Me*2};if(t.y>i[n+1].y&&t.y>i[n-1].y||t.y<i[n+1].y&&t.y<i[n-1].y)return{lx:i[n-1].x+(t.x-i[n-1].x)*Me,ly:t.y,rx:t.x+(i[n+1].x-t.x)*Me,ry:t.y};{const r={x:i[n-1].x-i[n+1].x,y:i[n-1].y-i[n+1].y},a=Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2));r.x/=a,r.y/=a;const l=i[n+1].x-t.x,c=t.x-i[n-1].x;return{lx:t.x+r.x*c*Me,ly:t.y+r.y*c*Me,rx:t.x-r.x*l*Me,ry:t.y-r.y*l*Me}}})}function Ar(s){const e=s.length-1,t={},n=Ir(s);return s.map((i,o,r)=>{if(o<e)return Or(e*20,0,i.x,i.y,n[o].rx,n[o].ry,n[o+1].lx,n[o+1].ly,r[o+1].x,r[o+1].y)}).flat().filter(i=>!i||i.x in t?!1:(t[i.x]=!0,!0))}function ds(s,e,t){let n;return(...i)=>{const o=()=>{n=null,t||s(...i)},r=t&&!n;clearTimeout(n),n=setTimeout(o,e),r&&s(...i)}}function Vr(s,e=!1){return function(t,n,i){let o;const r=i.value;return i.value=function(...a){const l=()=>{o=null,e||r.apply(this,a)},c=e&&!o;clearTimeout(o),o=setTimeout(l,s),c&&r.apply(this,a)},i}}function dt(s,e){let t,n,i,o=null,r=0;const a=s,l=()=>{r=0,o=null,i=a.apply(t,n),o||(t=n=null)};return function(){const u=Date.now();r||(r=u);const f=e-(u-r);return t=this,n=arguments,f<=0||f>e?(o&&(window.clearTimeout(o),o=null),r=u,i=a.apply(t,n),o||(t=n=null)):o||(o=window.setTimeout(l,f)),i}}const xe={amountEmitters:0,amountCallbacks:0,emitters:[]};typeof self!="undefined"&&"window"in self&&(window.debug=xe);class ye{constructor(){rt(this,"index",0);rt(this,"cbs",{});rt(this,"cbsOnce",{});this.index=xe.amountEmitters,xe.amountEmitters++}emit(e,t){e in this.cbs&&this.cbs[e].forEach(n=>n(t)),e in this.cbsOnce&&(this.cbsOnce[e].forEach(n=>n(t)),delete this.cbsOnce[e])}on(e,t,n=0){n>0&&(t=dt(t,n));const i=Object.assign(this.cbs,{[e]:[...this.cbs[e]||[],t]});return this.cbs=i,xe.emitters[this.index]={name:this.constructor.name,cbs:Object.fromEntries(Object.keys(this.cbs).map(o=>[o,this.cbs[o].length]))},xe.amountCallbacks++,()=>{var o;xe.amountCallbacks--,(o=i[e])==null||o.splice(i[e].indexOf(t),1),xe.emitters[this.index]={name:this.constructor.name,cbs:Object.fromEntries(Object.keys(this.cbs).map(r=>[r,this.cbs[r].length]))}}}once(e,t){return this.cbsOnce[e]=[...this.cbsOnce[e]||[],t],()=>{this.cbsOnce[e].splice(this.cbsOnce[e].indexOf(t),1)}}destroyEventEmitter(){xe.amountEmitters--,Object.keys(this.cbs).forEach(e=>{xe.amountCallbacks-=this.cbs[e].length,delete this.cbs[e]}),Object.keys(this.cbsOnce).forEach(e=>delete this.cbsOnce[e]),this.cbs={},this.cbsOnce={},delete xe.emitters[this.index]}}function Dr(s){if(s.length===0)return 0;let e=0;for(let t=0;t<s.length;t++)e=(e<<5)-e+s.charCodeAt(t),e=e&e;return e}var Rr=()=>{const s={};let e=0;const t=(n=0,i=0)=>{if(i>500)throw new Error("Infinite loop in id generation algo");return n in s?t(Math.max(n++,e++),i+1):(s[n]=!0,n.toString())};return t.reset=()=>{Object.keys(s).forEach(n=>delete s[+n]),e=0},t};function zr(s,e){const t=[],n=s.length/e;for(let i=0;i<n;i++){const o=[];for(let r=0;r<e;r++)o[r]=s[i*e+r];t.push(o)}return t}const Te=s=>s>1?"s":"",ps=s=>{if(typeof s!="number"||isNaN(s))return"never";if(s<1e3)return"< 1 second";const e=Math.floor(s/1e3);if(e<60)return e+" second"+Te(e);const t=Math.floor(e/60);if(t<60)return t+" minute"+Te(t);const n=Math.floor(t/60);if(n<24)return n+" hour"+Te(n);const i=Math.floor(n/24);if(i<7)return i+" day"+Te(i);const o=Math.floor(i/7);if(o<30)return o+" week"+Te(o);const r=Math.floor(o/30);if(r<12)return r+" month"+Te(r);const a=Math.floor(r/12);if(a<10)return a+" year"+Te(a);const l=Math.floor(r/10);return l+" decade"+Te(l)};function Vt(s){let e,t={length:NaN};const n=(i,o)=>i===t[o];return function(...o){return(o.length!==t.length||!o.every(n))&&(t=o,e=s.apply(this,o)),e}}const Dt={},Fr=(s,e,t={})=>{if(Dt[e])return Dt[e];const n=new Yn(s,t),i=new Image;return Dt[e]=n,i.onload=()=>{n.image=i},i.src=e,n};var Br={texture:Fr};let Rt=[],pt=2,Ve=0;const Wr={};let zt=0;const Gr=["#00ffff","#f0ffff","#f5f5dc","#000000","#0000ff","#a52a2a","#00ffff","#00008b","#008b8b","#a9a9a9","#006400","#bdb76b","#8b008b","#556b2f","#ff8c00","#9932cc","#8b0000","#e9967a","#9400d3","#ff00ff","#ffd700","#008000","#4b0082","#f0e68c","#add8e6","#e0ffff","#90ee90","#d3d3d3","#ffb6c1","#ffffe0","#00ff00","#ff00ff","#800000","#000080","#808000","#ffa500","#ffc0cb","#800080","#800080","#ff0000","#c0c0c0","#ffffff","#ffff00"];function ce(s){Ve=Math.max(Ve,s.length);const e=zt;Wr[s]=Gr[zt],zt++;const t=(...n)=>{if((!Rt.length||Rt.includes(s))&&pt===0){if(typeof n[0]=="string"&&typeof n[1]=="object"){console.groupCollapsed(`%c[${s.padEnd(Ve," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,n[0]),console.log(...n.slice(1)),console.groupEnd();return}console.log(`%c[${s.padEnd(Ve," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,...n)}};return t.group=(...n)=>{pt<1&&console.groupCollapsed(`%c[${s.padEnd(Ve," ")}]`,`color: hsl(${e*30}deg 68% 64%); font-weight: bold;`,...n)},t.warn=(...n)=>{pt<=1&&console.warn(`[${s.padEnd(Ve," ")}]`,...n)},t.error=n=>{console.error(`[${s.padEnd(Ve," ")}]`,n)},t}ce.setFilter=(...s)=>{Rt=s};ce.setLevel=(s=0)=>{pt=s};function Ur(s){const e={};return(...t)=>{const n=Dr(JSON.stringify(t));return n in e?e[n]:e[n]=s(...t)}}const Hr=/^(?:[ ]+)?(?:at )([^ ]*)?(?: )?(?:\[(.*?)\] )?(?:\(([^()]+)\))?$/gm,ms=s=>s.replace(window.location.href,"").replace(/^node_modules/,"").replace(/.+?(?=plantarium)plantarium\//,"");var Ft=s=>{const[e,...t]=s.split(`
`),[n,i]=e.split(":"),o=t.map(r=>{const a=[...r.matchAll(Hr)][0],[,l,c,u]=a;return te(te({name:ms(l)},u?{location:ms(u)}:{}),c?{alias:c.trim().replace("as ","")}:{})});return{title:i,type:n,lines:o}};function vs(s,e,t){const n=s.slice();return n[1]=e[t],n}function gs(s){let e,t,n,i=s[0].type+"",o,r,a,l=s[0].title+"",c,u,f,h,p=s[0].lines,d=[];for(let m=0;m<p.length;m+=1)d[m]=_s(vs(s,p,m));return{c(){e=b("div"),t=b("p"),n=b("b"),o=X(i),r=X(":"),a=E(),c=X(l),u=E(),f=b("pre"),h=b("code");for(let m=0;m<d.length;m+=1)d[m].c();v(f,"class","svelte-1e5rtbs"),v(e,"class","wrapper svelte-1e5rtbs")},m(m,g){P(m,e,g),y(e,t),y(t,n),y(n,o),y(n,r),y(t,a),y(t,c),y(e,u),y(e,f),y(f,h);for(let w=0;w<d.length;w+=1)d[w].m(h,null)},p(m,g){if(g&1&&i!==(i=m[0].type+"")&&se(o,i),g&1&&l!==(l=m[0].title+"")&&se(c,l),g&1){p=m[0].lines;let w;for(w=0;w<p.length;w+=1){const x=vs(m,p,w);d[w]?d[w].p(x,g):(d[w]=_s(x),d[w].c(),d[w].m(h,null))}for(;w<d.length;w+=1)d[w].d(1);d.length=p.length}},d(m){m&&M(e),de(d,m)}}}function ws(s){let e,t,n,i=s[1].alias+"",o;return{c(){e=X("as "),t=b("strong"),n=X("$"),o=X(i)},m(r,a){P(r,e,a),P(r,t,a),y(t,n),y(t,o)},p(r,a){a&1&&i!==(i=r[1].alias+"")&&se(o,i)},d(r){r&&M(e),r&&M(t)}}}function ys(s){let e,t,n=s[1].location+"",i,o;return{c(){e=X("\xA0("),t=b("i"),i=X(n),o=X(")")},m(r,a){P(r,e,a),P(r,t,a),y(t,i),P(r,o,a)},p(r,a){a&1&&n!==(n=r[1].location+"")&&se(i,n)},d(r){r&&M(e),r&&M(t),r&&M(o)}}}function _s(s){let e,t,n=s[1].name+"",i,o,r,a=s[1].alias&&ws(s),l=s[1].location&&ys(s);return{c(){e=X("at "),t=b("strong"),i=X(n),a&&a.c(),o=oe(),l&&l.c(),r=b("br")},m(c,u){P(c,e,u),P(c,t,u),y(t,i),a&&a.m(c,u),P(c,o,u),l&&l.m(c,u),P(c,r,u)},p(c,u){u&1&&n!==(n=c[1].name+"")&&se(i,n),c[1].alias?a?a.p(c,u):(a=ws(c),a.c(),a.m(o.parentNode,o)):a&&(a.d(1),a=null),c[1].location?l?l.p(c,u):(l=ys(c),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},d(c){c&&M(e),c&&M(t),a&&a.d(c),c&&M(o),l&&l.d(c),c&&M(r)}}}function Yr(s){let e,t=s[0]&&gs(s);return{c(){t&&t.c(),e=oe()},m(n,i){t&&t.m(n,i),P(n,e,i)},p(n,[i]){n[0]?t?t.p(n,i):(t=gs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:O,o:O,d(n){t&&t.d(n),n&&M(e)}}}function Xr(s,e,t){let{stacktrace:n}=e;return s.$$set=i=>{"stacktrace"in i&&t(0,n=i.stacktrace)},[n]}class qr extends Z{constructor(e){super();K(this,e,Xr,Yr,Q,{stacktrace:0})}}function bs(s,e,t){const n=s.slice();return n[13]=e[t],n}function ks(s){let e,t,n,i,o,r,a,l,c,u,f,h,p,d,m,g,w,x,_,k,C,L,V=s[6]&&Ss(s),$=s[0].title&&Ms(s);const J=[Kr,Zr,Jr],q=[];function ne(W,ie){return typeof W[0].content=="string"?0:W[0].content instanceof Error?1:W[0].content instanceof So?2:-1}~(a=ne(s))&&(l=q[a]=J[a](s));let U=s[0].content instanceof Error&&Ps(s),ee=s[0].values&&Ns(s);return d=new Ue({props:{name:"cross"}}),{c(){e=b("div"),t=b("div"),n=b("div"),V&&V.c(),i=E(),o=b("div"),$&&$.c(),r=E(),l&&l.c(),c=E(),u=b("div"),U&&U.c(),f=E(),ee&&ee.c(),h=E(),p=b("div"),m=b("div"),R(d.$$.fragment),g=E(),w=b("div"),v(u,"class","button-wrapper svelte-pmp1k"),v(o,"class","toast-text svelte-pmp1k"),I(m,"display","contents"),I(m,"--height","fit-content"),v(p,"class","toast-close svelte-pmp1k"),v(n,"class","toast-content svelte-pmp1k"),D(n,"hasIcon",!!s[6]),v(w,"style",x=`transition: width ${s[0].timeout}ms linear;`),v(w,"class","toast-progress svelte-pmp1k"),D(w,"animateProgress",s[2]),v(t,"class",_="toast toast-"+s[0].type+" svelte-pmp1k"),D(t,"isInverted",s[5]),v(e,"class","wrapper svelte-pmp1k")},m(W,ie){P(W,e,ie),y(e,t),y(t,n),V&&V.m(n,null),y(n,i),y(n,o),$&&$.m(o,null),y(o,r),~a&&q[a].m(o,null),y(o,c),y(o,u),U&&U.m(u,null),y(u,f),ee&&ee.m(u,null),y(n,h),y(n,p),y(p,m),z(d,m,null),y(t,g),y(t,w),s[11](e),k=!0,C||(L=B(p,"click",s[10]),C=!0)},p(W,ie){W[6]?V?(V.p(W,ie),ie&64&&S(V,1)):(V=Ss(W),V.c(),S(V,1),V.m(n,i)):V&&(H(),N(V,1,1,()=>{V=null}),Y()),W[0].title?$?$.p(W,ie):($=Ms(W),$.c(),$.m(o,r)):$&&($.d(1),$=null);let Ie=a;a=ne(W),a===Ie?~a&&q[a].p(W,ie):(l&&(H(),N(q[Ie],1,1,()=>{q[Ie]=null}),Y()),~a?(l=q[a],l?l.p(W,ie):(l=q[a]=J[a](W),l.c()),S(l,1),l.m(o,c)):l=null),W[0].content instanceof Error?U?(U.p(W,ie),ie&1&&S(U,1)):(U=Ps(W),U.c(),S(U,1),U.m(u,f)):U&&(H(),N(U,1,1,()=>{U=null}),Y()),W[0].values?ee?(ee.p(W,ie),ie&1&&S(ee,1)):(ee=Ns(W),ee.c(),S(ee,1),ee.m(u,null)):ee&&(H(),N(ee,1,1,()=>{ee=null}),Y()),ie&64&&D(n,"hasIcon",!!W[6]),(!k||ie&1&&x!==(x=`transition: width ${W[0].timeout}ms linear;`))&&v(w,"style",x),ie&4&&D(w,"animateProgress",W[2]),(!k||ie&1&&_!==(_="toast toast-"+W[0].type+" svelte-pmp1k"))&&v(t,"class",_),ie&33&&D(t,"isInverted",W[5])},i(W){k||(S(V),S(l),S(U),S(ee),S(d.$$.fragment,W),k=!0)},o(W){N(V),N(l),N(U),N(ee),N(d.$$.fragment,W),k=!1},d(W){W&&M(e),V&&V.d(),$&&$.d(),~a&&q[a].d(),U&&U.d(),ee&&ee.d(),F(d),s[11](null),C=!1,L()}}}function Ss(s){let e,t,n,i;return t=new Ue({props:{name:s[6],circle:!0}}),{c(){e=b("div"),n=b("div"),R(t.$$.fragment),I(n,"display","contents"),I(n,"--width","40px"),I(n,"--height","40px"),v(e,"class","toast-icon svelte-pmp1k")},m(o,r){P(o,e,r),y(e,n),z(t,n,null),i=!0},p(o,r){const a={};r&64&&(a.name=o[6]),t.$set(a)},i(o){i||(S(t.$$.fragment,o),i=!0)},o(o){N(t.$$.fragment,o),i=!1},d(o){o&&M(e),F(t)}}}function Ms(s){let e,t=s[0].title+"",n;return{c(){e=b("h3"),n=X(t),v(e,"class","svelte-pmp1k")},m(i,o){P(i,e,o),y(e,n)},p(i,o){o&1&&t!==(t=i[0].title+"")&&se(n,t)},d(i){i&&M(e)}}}function Jr(s){let e,t,n;var i=s[0].content;function o(r){return{}}return i&&(e=new i(o())),{c(){e&&R(e.$$.fragment),t=oe()},m(r,a){e&&z(e,r,a),P(r,t,a),n=!0},p(r,a){if(i!==(i=r[0].content)){if(e){H();const l=e;N(l.$$.fragment,1,0,()=>{F(l,1)}),Y()}i?(e=new i(o()),R(e.$$.fragment),S(e.$$.fragment,1),z(e,t.parentNode,t)):e=null}},i(r){n||(e&&S(e.$$.fragment,r),n=!0)},o(r){e&&N(e.$$.fragment,r),n=!1},d(r){r&&M(t),e&&F(e,r)}}}function Zr(s){let e,t=s[0].content.message+"",n,i,o,r,a=s[3]&&xs(s);return{c(){e=b("p"),n=X(t),i=E(),a&&a.c(),o=oe(),v(e,"class","svelte-pmp1k")},m(l,c){P(l,e,c),y(e,n),P(l,i,c),a&&a.m(l,c),P(l,o,c),r=!0},p(l,c){(!r||c&1)&&t!==(t=l[0].content.message+"")&&se(n,t),l[3]?a?(a.p(l,c),c&8&&S(a,1)):(a=xs(l),a.c(),S(a,1),a.m(o.parentNode,o)):a&&(H(),N(a,1,1,()=>{a=null}),Y())},i(l){r||(S(a),r=!0)},o(l){N(a),r=!1},d(l){l&&M(e),l&&M(i),a&&a.d(l),l&&M(o)}}}function Kr(s){let e,t=s[0].content+"";return{c(){e=b("p"),v(e,"class","svelte-pmp1k")},m(n,i){P(n,e,i),e.innerHTML=t},p(n,i){i&1&&t!==(t=n[0].content+"")&&(e.innerHTML=t)},i:O,o:O,d(n){n&&M(e)}}}function xs(s){let e,t,n,i;return t=new qr({props:{stacktrace:Ft(s[0].content.stack)}}),{c(){e=b("div"),R(t.$$.fragment),v(e,"class","stack-trace svelte-pmp1k")},m(o,r){P(o,e,r),z(t,e,null),i=!0},p(o,r){const a={};r&1&&(a.stacktrace=Ft(o[0].content.stack)),t.$set(a)},i(o){i||(S(t.$$.fragment,o),We(()=>{n||(n=ke(e,Re,{},!0)),n.run(1)}),i=!0)},o(o){N(t.$$.fragment,o),n||(n=ke(e,Re,{},!1)),n.run(0),i=!1},d(o){o&&M(e),F(t),o&&n&&n.end()}}}function Ps(s){let e,t,n,i;return e=new pe({props:{name:"> StackTrace"}}),e.$on("click",s[7]),{c(){t=b("div"),R(e.$$.fragment),I(t,"display","contents"),I(t,"--margin","5px 10px 5px -10px"),I(t,"--text",n=s[5]?"#1a1a1a":"white"),I(t,"--bg","transparent")},m(o,r){P(o,t,r),z(e,t,null),i=!0},p(o,r){r&32&&n!==(n=o[5]?"#1a1a1a":"white")&&I(t,"--text",n)},i(o){i||(S(e.$$.fragment,o),i=!0)},o(o){N(e.$$.fragment,o),i=!1},d(o){o&&M(t),F(e,o)}}}function Ns(s){let e,t,n=s[0].values,i=[];for(let r=0;r<n.length;r+=1)i[r]=Ls(bs(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=oe()},m(r,a){for(let l=0;l<i.length;l+=1)i[l].m(r,a);P(r,e,a),t=!0},p(r,a){if(a&49){n=r[0].values;let l;for(l=0;l<n.length;l+=1){const c=bs(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=Ls(c),i[l].c(),S(i[l],1),i[l].m(e.parentNode,e))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){de(i,r),r&&M(e)}}}function Qr(s){let e,t,n,i,o;function r(){return s[9](s[13])}return e=new pe({props:{name:s[13]}}),e.$on("click",r),{c(){t=b("div"),R(e.$$.fragment),I(t,"display","contents"),I(t,"--margin","5px 10px 5px 0"),I(t,"--text",n=s[5]?"white":"#1a1a1a"),I(t,"--bg",i=s[5]?"#1a1a1a":"white")},m(a,l){P(a,t,l),z(e,t,null),o=!0},p(a,l){s=a,l&32&&n!==(n=s[5]?"white":"#1a1a1a")&&I(t,"--text",n),l&32&&i!==(i=s[5]?"#1a1a1a":"white")&&I(t,"--bg",i);const c={};l&1&&(c.name=s[13]),e.$set(c)},i(a){o||(S(e.$$.fragment,a),o=!0)},o(a){N(e.$$.fragment,a),o=!1},d(a){a&&M(t),F(e,a)}}}function el(s){let e,t,n,i;function o(){return s[8](s[13])}return{c(){e=b("plant-button"),je(e,"name",t=s[13])},m(r,a){P(r,e,a),n||(i=B(e,"click",o),n=!0)},p(r,a){s=r,a&1&&t!==(t=s[13])&&je(e,"name",t)},i:O,o:O,d(r){r&&M(e),n=!1,i()}}}function Ls(s){let e,t,n,i,o;const r=[el,Qr],a=[];function l(c,u){return c[4]?0:1}return t=l(s),n=a[t]=r[t](s),{c(){e=b("div"),n.c(),i=E(),v(e,"class","button-spacer svelte-pmp1k")},m(c,u){P(c,e,u),a[t].m(e,null),y(e,i),o=!0},p(c,u){let f=t;t=l(c),t===f?a[t].p(c,u):(H(),N(a[f],1,1,()=>{a[f]=null}),Y(),n=a[t],n?n.p(c,u):(n=a[t]=r[t](c),n.c()),S(n,1),n.m(e,i))},i(c){o||(S(n),o=!0)},o(c){N(n),o=!1},d(c){c&&M(e),a[t].d()}}}function tl(s){let e,t,n=s[0]&&ks(s);return{c(){n&&n.c(),e=oe()},m(i,o){n&&n.m(i,o),P(i,e,o),t=!0},p(i,[o]){i[0]?n?(n.p(i,o),o&1&&S(n,1)):(n=ks(i),n.c(),S(n,1),n.m(e.parentNode,e)):n&&(H(),N(n,1,1,()=>{n=null}),Y())},i(i){t||(S(n),t=!0)},o(i){N(n),t=!1},d(i){n&&n.d(i),i&&M(e)}}}function nl(s,e,t){let n,i,{toast:o}=e,r=!1,a=!1;function l(){if(o.type===ge.ERROR)return"warning";if(o.type===ge.SUCCESS)return"checkmark";if(o.type===ge.WARNING)return"exclamation"}let c=!1,u;De(()=>{setTimeout(()=>{t(2,r=!0)},10)});const f=()=>{t(3,a=!a)},h=g=>o.resolve(g),p=g=>o.resolve(g),d=()=>o.reject();function m(g){ae[g?"unshift":"push"](()=>{u=g,t(1,u)})}return s.$$set=g=>{"toast"in g&&t(0,o=g.toast)},s.$$.update=()=>{s.$$.dirty&1&&t(6,n=o&&l()),s.$$.dirty&1&&t(5,i=o&&(o.type==="success"||o.type==="warning")),s.$$.dirty&2&&t(4,c=u&&!u.parentElement)},[o,u,r,a,c,i,n,f,h,p,d,m]}class sl extends Z{constructor(e){super();K(this,e,nl,tl,Q,{toast:0})}}function js(s,e,t){const n=s.slice();return n[4]=e[t],n}function il(s){let e,t;return e=new sl({props:{toast:s[4]}}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.toast=n[4]),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ol(s){let e,t;return{c(){e=b("plant-toast"),je(e,"toast",t=s[4])},m(n,i){P(n,e,i)},p(n,i){i&4&&t!==(t=n[4])&&je(e,"toast",t)},i:O,o:O,d(n){n&&M(e)}}}function Es(s,e){let t,n,i,o,r,a;const l=[ol,il],c=[];function u(f,h){return f[0]?0:1}return n=u(e),i=c[n]=l[n](e),{key:s,first:null,c(){t=b("div"),i.c(),o=E(),this.first=t},m(f,h){P(f,t,h),c[n].m(t,null),y(t,o),a=!0},p(f,h){e=f;let p=n;n=u(e),n===p?c[n].p(e,h):(H(),N(c[p],1,1,()=>{c[p]=null}),Y(),i=c[n],i?i.p(e,h):(i=c[n]=l[n](e),i.c()),S(i,1),i.m(t,o))},i(f){a||(S(i),We(()=>{r||(r=ke(t,Re,{easing:Xn},!0)),r.run(1)}),a=!0)},o(f){N(i),r||(r=ke(t,Re,{easing:Xn},!1)),r.run(0),a=!1},d(f){f&&M(t),c[n].d(),f&&r&&r.end()}}}function rl(s){let e,t=[],n=new Map,i,o=s[2];const r=a=>a[4].id;for(let a=0;a<o.length;a+=1){let l=js(s,o,a),c=r(l);n.set(c,t[a]=Es(c,l))}return{c(){e=b("div");for(let a=0;a<t.length;a+=1)t[a].c();v(e,"id","toast-wrapper"),v(e,"class","svelte-1ujlok7")},m(a,l){P(a,e,l);for(let c=0;c<t.length;c+=1)t[c].m(e,null);s[3](e),i=!0},p(a,[l]){l&5&&(o=a[2],H(),t=Mo(t,l,r,1,a,o,n,e,xo,Es,null,js),Y())},i(a){if(!i){for(let l=0;l<o.length;l+=1)S(t[l]);i=!0}},o(a){for(let l=0;l<t.length;l+=1)N(t[l]);i=!1},d(a){a&&M(e);for(let l=0;l<t.length;l+=1)t[l].d();s[3](null)}}}function ll(s,e,t){let n;be(s,Cr,a=>t(2,n=a));let i=!1,o;De(function(){t(0,i=!o.parentElement)});function r(a){ae[a?"unshift":"push"](()=>{o=a,t(1,o)})}return[i,o,n,r]}class al extends Z{constructor(e){super();K(this,e,ll,rl,Q,{})}}function cl(s){let e,t,n,i,o,r,a,l,c,u,f;return{c(){e=b("div"),t=b("input"),n=E(),i=b("label"),o=re("svg"),r=re("title"),a=X("cross"),l=re("line"),c=re("line"),v(t,"type","checkbox"),v(t,"id",s[1]),v(t,"class","svelte-ohv39p"),v(r,"class","svelte-ohv39p"),v(l,"vector-effect","non-scaling-stroke"),v(l,"x1","0"),v(l,"y1","100"),v(l,"x2","100"),v(l,"y2","0"),v(l,"class","svelte-ohv39p"),v(c,"vector-effect","non-scaling-stroke"),v(c,"x1","0"),v(c,"y1","0"),v(c,"x2","100"),v(c,"y2","100"),v(c,"class","svelte-ohv39p"),v(o,"xmlns","http://www.w3.org/2000/svg"),v(o,"viewBox","0 0 100 100"),v(o,"class","svelte-ohv39p"),v(i,"class","checkbox-label svelte-ohv39p"),v(i,"for",s[1]),v(e,"class","component-wrapper svelte-ohv39p")},m(h,p){P(h,e,p),y(e,t),t.checked=s[0],y(e,n),y(e,i),y(i,o),y(o,r),y(r,a),y(o,l),y(o,c),u||(f=B(t,"change",s[2]),u=!0)},p(h,[p]){p&2&&v(t,"id",h[1]),p&1&&(t.checked=h[0]),p&2&&v(i,"for",h[1])},i:O,o:O,d(h){h&&M(e),u=!1,f()}}}function ul(s,e,t){const n=Le();let{value:i=!1}=e,{id:o=Et()}=e;function r(){i=this.checked,t(0,i)}return s.$$set=a=>{"value"in a&&t(0,i=a.value),"id"in a&&t(1,o=a.id)},s.$$.update=()=>{s.$$.dirty&1&&i!==void 0&&n("change",!!i)},[i,o,r]}class mt extends Z{constructor(e){super();K(this,e,ul,cl,Q,{value:0,id:1})}}function $s(s,e,t){const n=s.slice();return n[19]=e[t],n[21]=t,n}function Cs(s,e,t){const n=s.slice();return n[19]=e[t],n}function Ts(s){let e,t,n,i,o;function r(){return s[10](s[19])}return{c(){e=re("circle"),v(e,"cx",t=s[19].x*100),v(e,"cy",n=s[19].y*100),v(e,"r","2"),v(e,"class","svelte-tsaxx5"),D(e,"pinned",s[19].pinned)},m(a,l){P(a,e,l),i||(o=B(e,"mousedown",r),i=!0)},p(a,l){s=a,l&1&&t!==(t=s[19].x*100)&&v(e,"cx",t),l&1&&n!==(n=s[19].y*100)&&v(e,"cy",n),l&1&&D(e,"pinned",s[19].pinned)},d(a){a&&M(e),i=!1,o()}}}function fl(s){let e,t,n,i,o;return{c(){e=re("line"),v(e,"x1",t=s[3][s[21]-1].x*100),v(e,"y1",n=s[3][s[21]-1].y*100),v(e,"x2",i=s[19].x*100),v(e,"y2",o=s[19].y*100),v(e,"class","svelte-tsaxx5")},m(r,a){P(r,e,a)},p:O,d(r){r&&M(e)}}}function Os(s){let e,t,n,i=s[21]>0&&s[21]%2==0&&fl(s);return{c(){i&&i.c(),e=re("circle"),v(e,"cx",t=s[19].x*100),v(e,"cy",n=s[19].y*100),v(e,"r","1"),v(e,"class","svelte-tsaxx5"),D(e,"pinned",s[19].pinned)},m(o,r){i&&i.m(o,r),P(o,e,r)},p(o,r){o[21]>0&&o[21]%2==0&&i.p(o,r)},d(o){i&&i.d(o),o&&M(e)}}}function hl(s){let e,t,n,i,o,r,a=s[0],l=[];for(let f=0;f<a.length;f+=1)l[f]=Ts(Cs(s,a,f));let c=s[3],u=[];for(let f=0;f<c.length;f+=1)u[f]=Os($s(s,c,f));return{c(){e=b("div"),t=re("svg"),n=re("path");for(let f=0;f<l.length;f+=1)l[f].c();i=re("g");for(let f=0;f<u.length;f+=1)u[f].c();v(n,"d",s[2]),v(n,"fill","none"),v(n,"stroke","grey"),v(n,"class","svelte-tsaxx5"),v(i,"id","debug"),v(i,"class","svelte-tsaxx5"),v(t,"viewBox","0 0 100 100"),v(t,"width","100"),v(t,"height","100"),v(t,"class","svelte-tsaxx5"),v(e,"class","component-wrapper svelte-tsaxx5")},m(f,h){P(f,e,h),y(e,t),y(t,n);for(let p=0;p<l.length;p+=1)l[p].m(t,null);y(t,i);for(let p=0;p<u.length;p+=1)u[p].m(i,null);o||(r=[B(t,"mousedown",s[5]),B(t,"mousemove",s[4]),B(t,"mouseover",s[7]),B(t,"mouseout",s[8]),B(t,"mouseup",s[6]),B(t,"focus",s[7]),B(t,"blur",s[8])],o=!0)},p(f,[h]){if(h&4&&v(n,"d",f[2]),h&3){a=f[0];let p;for(p=0;p<a.length;p+=1){const d=Cs(f,a,p);l[p]?l[p].p(d,h):(l[p]=Ts(d),l[p].c(),l[p].m(t,i))}for(;p<l.length;p+=1)l[p].d(1);l.length=a.length}if(h&8){c=f[3];let p;for(p=0;p<c.length;p+=1){const d=$s(f,c,p);u[p]?u[p].p(d,h):(u[p]=Os(d),u[p].c(),u[p].m(i,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=c.length}},i:O,o:O,d(f){f&&M(e),de(l,f),de(u,f),o=!1,Ce(r)}}}function dl(s,e,t){let n,i;const o=Le();let{value:r=[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}=e,a=!1,l,c,u=0,f=0,h=[];const p=()=>{requestAnimationFrame(()=>{o("change",n),t(0,n=n.sort((L,V)=>L.x>V.x?-1:1))})},d=L=>{L.pinned||(n.splice(n.indexOf(l),1),p())},m=L=>{a&&(u=L.offsetX,f=L.offsetY,l&&(c=l,t(1,l=void 0)),c&&(c.x=u/100,c.y=f/100,p()))},g=()=>{if(!l){const L={x:u/100,y:f/100,pinned:!1};t(1,l=L),n.push(l),p()}},w=()=>{l&&(d(l),t(1,l=void 0)),c=void 0},x=()=>{a=!0},_=()=>{a=!1};function k(L){const V=qn.points(L.map($=>[$.x*100,$.y*100]));return qn.svgPath(V)}const C=L=>{t(1,l=L)};return s.$$set=L=>{"value"in L&&t(9,r=L.value)},s.$$.update=()=>{s.$$.dirty&512&&t(0,n=r),s.$$.dirty&1&&t(2,i=k(n))},[n,l,i,h,m,g,w,x,_,r,C]}class pl extends Z{constructor(e){super();K(this,e,dl,hl,Q,{value:9})}}function Is(s){let e,t;return{c(){e=b("span"),v(e,"class","overlay svelte-3lnuwn"),v(e,"style",t=`width: ${(s[0]-s[1])/(s[2]-s[1])*100}%`)},m(n,i){P(n,e,i)},p(n,i){i&7&&t!==(t=`width: ${(n[0]-n[1])/(n[2]-n[1])*100}%`)&&v(e,"style",t)},d(n){n&&M(e)}}}function ml(s){let e,t,n,i,o,r,a,l,c,u,f=typeof s[1]!="undefined"&&typeof s[2]!="undefined"&&Is(s);return{c(){e=b("div"),f&&f.c(),t=E(),n=b("button"),n.textContent="-",i=E(),o=b("input"),a=E(),l=b("button"),l.textContent="+",v(n,"class","svelte-3lnuwn"),v(o,"step",s[3]),v(o,"max",s[2]),v(o,"min",s[1]),v(o,"type","number"),v(o,"style",r=`width:${s[5]};`),v(o,"class","svelte-3lnuwn"),v(l,"class","svelte-3lnuwn"),v(e,"class","component-wrapper svelte-3lnuwn")},m(h,p){P(h,e,p),f&&f.m(e,null),y(e,t),y(e,n),y(e,i),y(e,o),ve(o,s[0]),s[11](o),y(e,a),y(e,l),c||(u=[B(n,"click",s[9]),B(o,"input",s[10]),B(o,"mousedown",s[7]),B(o,"mouseup",s[8]),B(l,"click",s[12])],c=!0)},p(h,[p]){typeof h[1]!="undefined"&&typeof h[2]!="undefined"?f?f.p(h,p):(f=Is(h),f.c(),f.m(e,t)):f&&(f.d(1),f=null),p&8&&v(o,"step",h[3]),p&4&&v(o,"max",h[2]),p&2&&v(o,"min",h[1]),p&32&&r!==(r=`width:${h[5]};`)&&v(o,"style",r),p&1&&lt(o.value)!==h[0]&&ve(o,h[0])},i:O,o:O,d(h){h&&M(e),f&&f.d(),s[11](null),c=!1,Ce(u)}}}function vl(s,e,t){let n,i;const o=Le();let{min:r=-1/0}=e,{max:a=1/0}=e,{step:l=1}=e,{value:c=0}=e,u;function f(L){t(0,c=Math.max(r,Math.min(+c+L,a)))}let h=0,p=0,d;function m(L){L.preventDefault(),p=c,h=L.clientX,d=u.getBoundingClientRect(),window.removeEventListener("mousemove",w),window.addEventListener("mousemove",w),window.addEventListener("mouseup",g),document.body.style.cursor="ew-resize"}function g(){p===c?u.focus():u.blur(),document.body.style.cursor="unset",window.removeEventListener("mouseup",g),window.removeEventListener("mousemove",w)}function w(L){if(n){const V=(L.clientX-d.left)/d.width;t(0,c=Math.max(Math.min(Math.floor(r+(a-r)*V),a),r))}else{const V=L.clientX-h;t(0,c=p+Math.floor(V/10))}}const x=()=>f(-l);function _(){c=lt(this.value),t(0,c)}function k(L){ae[L?"unshift":"push"](()=>{u=L,t(4,u)})}const C=()=>f(+l);return s.$$set=L=>{"min"in L&&t(1,r=L.min),"max"in L&&t(2,a=L.max),"step"in L&&t(3,l=L.step),"value"in L&&t(0,c=L.value)},s.$$.update=()=>{var L;s.$$.dirty&6&&(n=typeof r!="undefined"&&typeof a!="undefined"&&Number.isFinite(r)&&Number.isFinite(a)),s.$$.dirty&1&&c!==void 0&&o("change",parseFloat(c+"")),s.$$.dirty&1&&t(5,i=Number.isFinite(c)?Math.max(((L=c==null?void 0:c.toString().length)!=null?L:1)*8,30)+"px":"20px")},[c,r,a,l,u,i,f,m,g,x,_,k,C]}class gl extends Z{constructor(e){super();K(this,e,vl,ml,Q,{min:1,max:2,step:3,value:0})}}function wl(s){let e,t,n,i,o,r,a,l;return{c(){e=b("div"),t=b("span"),i=E(),o=b("input"),v(t,"class","overlay svelte-2vvjq7"),v(t,"style",n=`width: ${(s[0]-s[2])/(s[3]-s[2])*100}%`),v(o,"step",s[1]),v(o,"max",s[3]),v(o,"min",s[2]),v(o,"type","number"),v(o,"style",r=`width:${s[6]};`),v(o,"class","svelte-2vvjq7"),v(e,"class","component-wrapper svelte-2vvjq7"),D(e,"is-down",s[5])},m(c,u){P(c,e,u),y(e,t),y(e,i),y(e,o),ve(o,s[0]),s[10](o),a||(l=[B(o,"input",s[9]),B(o,"mousedown",s[7]),B(o,"mouseup",s[8])],a=!0)},p(c,[u]){u&13&&n!==(n=`width: ${(c[0]-c[2])/(c[3]-c[2])*100}%`)&&v(t,"style",n),u&2&&v(o,"step",c[1]),u&8&&v(o,"max",c[3]),u&4&&v(o,"min",c[2]),u&64&&r!==(r=`width:${c[6]};`)&&v(o,"style",r),u&1&&lt(o.value)!==c[0]&&ve(o,c[0]),u&32&&D(e,"is-down",c[5])},i:O,o:O,d(c){c&&M(e),s[10](null),a=!1,Ce(l)}}}function yl(s){return parseFloat(s).toPrecision(2)}function _l(s,e,t){let n,{value:i=.5}=e,{step:o=.01}=e,{min:r=0}=e,{max:a=1}=e;const l=Le();let c,u=!1,f=0,h=0,p=0,d;function m(k){k.preventDefault(),t(5,u=!0),h=i,f=k.clientY,d=c.getBoundingClientRect(),window.removeEventListener("mousemove",w),window.addEventListener("mousemove",w),window.addEventListener("mouseup",g),document.body.style.cursor="ew-resize"}function g(){t(5,u=!1),h===i&&c.focus(),document.body.style.cursor="unset",window.removeEventListener("mouseup",g),window.removeEventListener("mousemove",w)}function w(k){p=(k.clientX-d.left)/d.width,k.clientY-f,t(0,i=Math.max(Math.min(r+(a-r)*p,a),r))}function x(){i=lt(this.value),t(0,i)}function _(k){ae[k?"unshift":"push"](()=>{c=k,t(4,c)})}return s.$$set=k=>{"value"in k&&t(0,i=k.value),"step"in k&&t(1,o=k.step),"min"in k&&t(2,r=k.min),"max"in k&&t(3,a=k.max)},s.$$.update=()=>{var k;s.$$.dirty&1&&i.toString().length>5&&t(0,i=yl(i)),s.$$.dirty&1&&i!==void 0&&l("change",parseFloat(i+"")),s.$$.dirty&1&&t(6,n=Number.isFinite(i)?Math.max(((k=i==null?void 0:i.toString().length)!=null?k:1)*8,50)+"px":"20px")},[i,o,r,a,c,u,n,m,g,x,_]}class bl extends Z{constructor(e){super();K(this,e,_l,wl,Q,{value:0,step:1,min:2,max:3})}}function As(s,e,t){const n=s.slice();return n[11]=e[t],n}function kl(s){let e,t,n;return{c(){e=b("div"),e.textContent="none",v(e,"id","selected-value"),v(e,"class","svelte-1ywe9t")},m(i,o){P(i,e,o),t||(n=B(e,"click",s[4]),t=!0)},p:O,d(i){i&&M(e),t=!1,n()}}}function Sl(s){let e,t,n,i;return{c(){e=b("div"),t=X(s[0]),v(e,"id","selected-value"),v(e,"class","svelte-1ywe9t")},m(o,r){P(o,e,r),y(e,t),n||(i=B(e,"click",s[4]),n=!0)},p(o,r){r&1&&se(t,o[0])},d(o){o&&M(e),n=!1,i()}}}function Vs(s){let e,t=s[11]+"",n,i,o,r,a;function l(){return s[8](s[11])}return{c(){e=b("p"),n=X(t),i=E(),v(e,"style",o=`opacity: ${s[11]===s[0]?.5:1}`),v(e,"class","item svelte-1ywe9t")},m(c,u){P(c,e,u),y(e,n),y(e,i),r||(a=B(e,"click",l),r=!0)},p(c,u){s=c,u&2&&t!==(t=s[11]+"")&&se(n,t),u&3&&o!==(o=`opacity: ${s[11]===s[0]?.5:1}`)&&v(e,"style",o)},d(c){c&&M(e),r=!1,a()}}}function Ds(s){let e,t=s[11]!==s[0]&&Vs(s);return{c(){t&&t.c(),e=oe()},m(n,i){t&&t.m(n,i),P(n,e,i)},p(n,i){n[11]!==n[0]?t?t.p(n,i):(t=Vs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){t&&t.d(n),n&&M(e)}}}function Ml(s){let e,t,n,i;function o(u,f){return u[0]!==void 0?Sl:kl}let r=o(s),a=r(s),l=s[1],c=[];for(let u=0;u<l.length;u+=1)c[u]=Ds(As(s,l,u));return{c(){e=b("div"),t=b("div"),a.c(),n=E(),i=b("div");for(let u=0;u<c.length;u+=1)c[u].c();v(i,"id","item-wrapper"),v(i,"class","svelte-1ywe9t"),v(t,"id","main"),v(t,"class","svelte-1ywe9t"),v(e,"class","component-wrapper svelte-1ywe9t"),D(e,"open",s[2])},m(u,f){P(u,e,f),y(e,t),a.m(t,null),y(t,n),y(t,i);for(let h=0;h<c.length;h+=1)c[h].m(i,null);s[9](t)},p(u,[f]){if(r===(r=o(u))&&a?a.p(u,f):(a.d(1),a=r(u),a&&(a.c(),a.m(t,n))),f&35){l=u[1];let h;for(h=0;h<l.length;h+=1){const p=As(u,l,h);c[h]?c[h].p(p,f):(c[h]=Ds(p),c[h].c(),c[h].m(i,null))}for(;h<c.length;h+=1)c[h].d(1);c.length=l.length}f&4&&D(e,"open",u[2])},i:O,o:O,d(u){u&&M(e),a.d(),de(c,u),s[9](null)}}}function xl(s,e,t){const n=Le();let{value:i=void 0}=e,o=!1,r;function a(){t(2,o=!0),setTimeout(()=>{document.addEventListener("click",()=>{t(2,o=!1)},{once:!0})},50)}function l(d){t(0,i=d),t(2,o=!1)}let{values:c=[]}=e;function u(d){t(1,c=d)}function f(d){t(0,i=d)}const h=d=>l(d);function p(d){ae[d?"unshift":"push"](()=>{r=d,t(3,r)})}return s.$$set=d=>{"value"in d&&t(0,i=d.value),"values"in d&&t(1,c=d.values)},s.$$.update=()=>{s.$$.dirty&1&&i&&n("change",i)},[i,c,o,r,a,l,u,f,h,p]}class Pl extends Z{constructor(e){super();K(this,e,xl,Ml,Q,{value:0,values:1,setItems:6,setValue:7})}get setItems(){return this.$$.ctx[6]}get setValue(){return this.$$.ctx[7]}}function Rs(s,e,t){const n=s.slice();return n[19]=e[t],n}function zs(s){let e,t,n,i,o;function r(){return s[9](s[19])}return{c(){e=re("circle"),v(e,"cx",t=s[19].x*100),v(e,"cy",n=s[19].y*200-50),v(e,"r","4"),v(e,"class","svelte-vrnf7c"),D(e,"pinned",s[19].pinned)},m(a,l){P(a,e,l),i||(o=B(e,"mousedown",r),i=!0)},p(a,l){s=a,l&1&&t!==(t=s[19].x*100)&&v(e,"cx",t),l&1&&n!==(n=s[19].y*200-50)&&v(e,"cy",n),l&1&&D(e,"pinned",s[19].pinned)},d(a){a&&M(e),i=!1,o()}}}function Nl(s){let e,t,n,i,o,r,a,l,c,u,f,h,p=s[0],d=[];for(let m=0;m<p.length;m+=1)d[m]=zs(Rs(s,p,m));return{c(){e=b("div"),t=re("svg"),n=re("path");for(let m=0;m<d.length;m+=1)d[m].c();i=E(),o=re("svg"),r=re("defs"),a=re("linearGradient"),l=re("stop"),c=re("stop"),u=re("path"),v(n,"d",s[2]),v(n,"fill","none"),v(n,"stroke","#65E2A0"),v(n,"class","svelte-vrnf7c"),v(t,"viewBox","0 0 100 100"),v(t,"width","50"),v(t,"height","100"),v(t,"class","svelte-vrnf7c"),v(l,"offset","0%"),I(l,"stop-color","#65E2A0"),I(l,"stop-opacity","1"),v(l,"class","svelte-vrnf7c"),v(c,"offset","100%"),I(c,"stop-color","#469C6E"),I(c,"stop-opacity","1"),v(c,"class","svelte-vrnf7c"),v(a,"id","grad1"),v(a,"x1","0%"),v(a,"y1","0%"),v(a,"x2","100%"),v(a,"y2","0%"),v(a,"class","svelte-vrnf7c"),v(r,"class","svelte-vrnf7c"),v(u,"d",s[2]),v(u,"fill","url(#grad1)"),v(u,"stroke","grey"),v(u,"class","svelte-vrnf7c"),v(o,"id","right"),v(o,"viewBox","0 0 100 100"),v(o,"width","50"),v(o,"height","100"),v(o,"class","svelte-vrnf7c"),v(e,"class","component-wrapper svelte-vrnf7c")},m(m,g){P(m,e,g),y(e,t),y(t,n);for(let w=0;w<d.length;w+=1)d[w].m(t,null);y(e,i),y(e,o),y(o,r),y(r,a),y(a,l),y(a,c),y(o,u),f||(h=[B(t,"mousedown",s[4]),B(t,"mousemove",s[3]),B(t,"mouseover",s[6]),B(t,"mouseout",s[7]),B(t,"mouseup",s[5]),B(t,"focus",s[6]),B(t,"blur",s[7])],f=!0)},p(m,[g]){if(g&4&&v(n,"d",m[2]),g&3){p=m[0];let w;for(w=0;w<p.length;w+=1){const x=Rs(m,p,w);d[w]?d[w].p(x,g):(d[w]=zs(x),d[w].c(),d[w].m(t,null))}for(;w<d.length;w+=1)d[w].d(1);d.length=p.length}g&4&&v(u,"d",m[2])},i:O,o:O,d(m){m&&M(e),de(d,m),f=!1,Ce(h)}}}function Ll(s,e,t){let n,i;const o=Le();let{value:r=[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}=e,a=!1,l,c,u=0,f=0;const h=()=>{requestAnimationFrame(()=>{o("change",n),t(0,n=n.sort((L,V)=>L.y>V.y?-1:1))})},p=L=>{L.pinned||(n.splice(n.indexOf(l),1),h())},d=L=>{a&&(u=L.offsetX,f=L.offsetY,l&&(c=l,t(1,l=void 0)),c&&(c.x=u/50,c.y=f/100,h()))},m=()=>{if(!l){const L={x:u/50,y:f/100,pinned:!1};t(1,l=L),n.push(l),h()}},g=()=>{l&&(p(l),t(1,l=void 0)),c=void 0},w=()=>{a=!0},x=()=>{a=!1},_=L=>`L ${L.x*100} ${L.y*200-50}`;function k(L){return L.reduce((V,$,J)=>J===0?`M ${$.x*100},${$.y*200-50}`:`${V} ${_($)}`,"")}const C=L=>{t(1,l=L)};return s.$$set=L=>{"value"in L&&t(8,r=L.value)},s.$$.update=()=>{s.$$.dirty&256&&t(0,n=r),s.$$.dirty&1&&t(2,i=k(n))},[n,l,i,d,m,g,w,x,r,C]}class jl extends Z{constructor(e){super();K(this,e,Ll,Nl,Q,{value:8})}}function Fs(s,e,t){const n=s.slice();return n[21]=e[t],n[23]=t,n}function Bs(s){let e,t=(s[21].title||s[21].value)+"",n,i,o,r;function a(){return s[14](s[21])}function l(){return s[15](s[21])}function c(){return s[16](s[21])}return{c(){e=b("div"),n=X(t),i=E(),v(e,"class","search-entry svelte-779fwr"),D(e,"focused",s[21].value===s[3])},m(u,f){P(u,e,f),y(e,n),y(e,i),o||(r=[B(e,"focus",a),B(e,"mouseover",l),B(e,"click",c)],o=!0)},p(u,f){s=u,f&16&&t!==(t=(s[21].title||s[21].value)+"")&&se(n,t),f&24&&D(e,"focused",s[21].value===s[3])},d(u){u&&M(e),o=!1,Ce(r)}}}function Ws(s){let e,t=s[23]<s[0]&&Bs(s);return{c(){t&&t.c(),e=oe()},m(n,i){t&&t.m(n,i),P(n,e,i)},p(n,i){n[23]<n[0]?t?t.p(n,i):(t=Bs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){t&&t.d(n),n&&M(e)}}}function El(s){let e,t,n,i,o,r=s[4],a=[];for(let l=0;l<r.length;l+=1)a[l]=Ws(Fs(s,r,l));return{c(){e=b("div"),t=b("input"),n=E();for(let l=0;l<a.length;l+=1)a[l].c();v(t,"type","text"),v(t,"placeholder","Search"),v(t,"class","svelte-779fwr"),v(e,"class","search-wrapper svelte-779fwr")},m(l,c){P(l,e,c),y(e,t),s[12](t),ve(t,s[1]),y(e,n);for(let u=0;u<a.length;u+=1)a[u].m(e,null);i||(o=[B(window,"keydown",s[6]),B(t,"input",s[13])],i=!0)},p(l,[c]){if(c&2&&t.value!==l[1]&&ve(t,l[1]),c&185){r=l[4];let u;for(u=0;u<r.length;u+=1){const f=Fs(l,r,u);a[u]?a[u].p(f,c):(a[u]=Ws(f),a[u].c(),a[u].m(e,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=r.length}},i:O,o:O,d(l){l&&M(e),s[12](null),de(a,l),i=!1,Ce(o)}}}function $l(s,e,t){let n,i;const o=Le(),r={};let{limitAmount:a=10}=e,{values:l=[]}=e,c,u="";function f($,J){if(!(J==null?void 0:J.length))return $;const q=$.filter(U=>!!(U.value.includes(J)||U.title&&U.title.toLowerCase().includes(J)));return q.length?(q.find(U=>U.value===i)||t(3,i=q[0].value),q):[{value:"Nothing Found"}]}function h(){c.focus()}function p(){t(1,u="")}function d({value:$=i}={value:i}){r[$]=r[$]+1||1,o("input",$)}function m($){if(!i.length){t(3,i=n[0].value);return}const J=n.slice(0,a).find(ee=>ee.value===i);if(!J)return;const q=n.indexOf(J),ne=Math.min(n.length,a),U=((q+$)%ne+ne)%ne;t(3,i=n[U].value)}function g({key:$}){$==="Enter"&&i.length&&d(),$==="ArrowDown"&&m(1),$==="ArrowUp"&&m(-1)}function w($){t(3,i=$.value)}const x=$=>{t(8,l=$)};function _($){ae[$?"unshift":"push"](()=>{c=$,t(2,c)})}function k(){u=this.value,t(1,u)}const C=$=>w($),L=$=>w($),V=$=>d($);return s.$$set=$=>{"limitAmount"in $&&t(0,a=$.limitAmount),"values"in $&&t(8,l=$.values)},s.$$.update=()=>{s.$$.dirty&258&&t(4,n=f(l,u.toLowerCase()))},t(3,i=""),[a,u,c,i,n,d,g,w,l,h,p,x,_,k,C,L,V]}class Cl extends Z{constructor(e){super();K(this,e,$l,El,Q,{limitAmount:0,values:8,focus:9,clear:10,setItems:11})}get focus(){return this.$$.ctx[9]}get clear(){return this.$$.ctx[10]}get setItems(){return this.$$.ctx[11]}}function Gs(s){let e,t,n;return{c(){e=b("div"),t=b("p"),n=X(s[1]),v(t,"class","svelte-1aw08v2"),v(e,"class","border svelte-1aw08v2")},m(i,o){P(i,e,o),y(e,t),y(t,n)},p(i,o){o&2&&se(n,i[1])},d(i){i&&M(e)}}}function Tl(s){let e,t,n,i,o,r,a,l,c,u,f=s[1]&&Gs(s);const h=s[4].default,p=Dn(h,s,s[3],null);return{c(){e=b("div"),t=b("div"),n=re("svg"),i=re("path"),o=E(),f&&f.c(),r=E(),a=b("div"),p&&p.c(),v(i,"d","M13.172 12l-4.95-4.95 1.414-1.414L16 12l-6.364 6.364-1.414-1.414z"),v(i,"class","svelte-1aw08v2"),v(n,"xmlns","http://www.w3.org/2000/svg"),v(n,"viewBox","0 0 24 24"),v(n,"width","24"),v(n,"height","24"),v(n,"class","svelte-1aw08v2"),v(t,"class","header svelte-1aw08v2"),v(a,"class","content svelte-1aw08v2"),v(e,"class","wrapper svelte-1aw08v2"),D(e,"open",s[0])},m(d,m){P(d,e,m),y(e,t),y(t,n),y(n,i),y(t,o),f&&f.m(t,null),y(e,r),y(e,a),p&&p.m(a,null),l=!0,c||(u=B(t,"click",s[2]),c=!0)},p(d,[m]){d[1]?f?f.p(d,m):(f=Gs(d),f.c(),f.m(t,null)):f&&(f.d(1),f=null),p&&p.p&&(!l||m&8)&&Rn(p,h,d,d[3],l?Fn(h,d[3],m,null):zn(d[3]),null),m&1&&D(e,"open",d[0])},i(d){l||(S(p,d),l=!0)},o(d){N(p,d),l=!1},d(d){d&&M(e),f&&f.d(),p&&p.d(d),c=!1,u()}}}function Ol(s,e,t){let{$$slots:n={},$$scope:i}=e;const o=Le();let{open:r=!1}=e,{name:a=""}=e;const l=()=>{t(0,r=!r),o("toggle",r)};return s.$$set=c=>{"open"in c&&t(0,r=c.open),"name"in c&&t(1,a=c.name),"$$scope"in c&&t(3,i=c.$$scope)},[r,a,l,i,n]}class Bt extends Z{constructor(e){super();K(this,e,Ol,Tl,Q,{open:0,name:1})}}function Il({target:s,template:e,value:t}){t===void 0&&"value"in e&&(t=e.value);const n=Wt(e,t),i=te({},e);return delete i.type,delete i.inputType,delete i.defaultValue,delete i.internal,i.value=t,new n({target:s,props:_e(te({},i),{"--width":"100%"})})}function Wt(s,e){return s.inputType==="select"||Array.isArray(s.values)?Pl:s.inputType==="curve"?pl:s.inputType==="shape"?jl:s.type==="number"||typeof e=="number"?s.step&&s.step%1!=0?bl:gl:mt}function Al(s){const e=2*Math.PI/s;return new Array(s).fill(null).map((n,i)=>[Math.cos(e*i),Math.sin(e*i)])}function Vl(s,e){const t=new Uint16Array(s*(e-1)*6);for(let n=0;n<e;n++){const i=n*s*6,o=n*s;for(let r=0;r<s;r++){const a=i+r*6,l=o+r;t[a+0]=l,t[a+1]=l-s+1,t[a+2]=l+1,t[a+3]=l+1,t[a+4]=l+s,t[a+5]=l,r===s-1?(t[a+0]=l,t[a+1]=l-s+1,t[a+2]=l+1,t[a+3]=l+1,t[a+4]=l+s,t[a+5]=l):(t[a+0]=l,t[a+1]=l+1,t[a+2]=l+s+1,t[a+3]=l+s+1,t[a+4]=l+s,t[a+5]=l)}}return t}function Dl(s,e){const t=[],n=[],i=[],o={position:[],index:Vl(e,s.length)},r=Al(e),a=r.length,l=s.length;for(let c=0;c<l;c++){const u=[0,0,1];c===0?$t(n,s[c],s[c+1]):c===l-1?$t(n,s[c-1],s[c]):$t(n,s[c-1],s[c+1]),Po(n,n),No(i,u,n);const f=Math.acos(Lo(u,n));jo(t),Eo(t,t,f,i);for(let h=0;h<a;h++){const p=r[h],d=[p[0],p[1],0],m=s[c][3];$o(d,d,[m,m,1]),Co(d,d,t),To(d,d,s[c]),o.position.push(d)}}return o}function Xe(s,e,t){return s*(1-t)+e*t}function Rl(s,e=0){const t=(s.length-1)*e,n=Math.floor(t),i=Math.ceil(t);return Xe(s[i],s[n],i-t)}function Us(s,e){const t=(s.length/4-1)*e,n=Math.floor(t),i=Math.ceil(t),o=i-t;return[Xe(s[i*4+0],s[n*4+0],o),Xe(s[i*4+1],s[n*4+1],o),Xe(s[i*4+2],s[n*4+2],o),Xe(s[i*4+3],s[n*4+3],o)]}function Hs(s,e){const t=(s.length/4-1)*e,n=Math.floor(t),i=Math.ceil(t);return[s[i*4+0]-s[n*4+0],s[i*4+1]-s[n*4+1],s[i*4+2]-s[n*4+2],s[i*4+3]+s[n*4+3]/2]}function Gt(...s){if(s.length===1)return s[0];const e=new Float32Array(s.reduce((u,f)=>u+f.position.length,0)),t=new Float32Array(s.reduce((u,f)=>u+f.normal.length,0)),n=new Float32Array(s.reduce((u,f)=>u+f.uv.length,0)),i=s.reduce((u,f)=>u+f.index.length,0),o=i>65536?new Uint32Array(i):new Uint16Array(i);let r=0,a=0,l=0,c=0;for(let u=0;u<s.length;u++){const f=s[u].normal,h=f.length;for(let _=0;_<h;_++)t[a+_]=f[_];a+=h;const p=s[u].uv,d=p.length;for(let _=0;_<d;_++)n[l+_]=p[_];l+=d;const m=s[u].index,g=m.length;for(let _=0;_<g;_++)o[_+c]=m[_]+r/3;c+=g;const w=s[u].position,x=w.length;for(let _=0;_<x;_++)e[r+_]=w[_];r+=x}return{position:e,normal:t,uv:n,index:o}}var zl=(s,e)=>Math.sqrt(s*s+e*e),Fl=(s,e,t)=>Math.sqrt(s*s+e*e+t*t);let ze=0,Ut=at.makeNoise2D(ze),Ys=at.makeNoise3D(ze);var Ht={n1d:s=>Ut(s,0),n2d:(s,e)=>Ut(s,e),n3d:(s,e,t)=>Ys(s,e,t),get seed(){return ze},set seed(s){ze=s,Ut=at.makeNoise2D(ze),Ys=at.makeNoise3D(ze)}},Xs=([s,e])=>{const t=zl(s,e);return t===0?[1,0]:[s/t,e/t]},Bl=(s,e,t)=>{const n=Fl(s,e,t);return[s/n,e/n,t/n]},qs=(s,e,t)=>[s*Math.cos(t)-e*Math.sin(t),s*Math.sin(t)+e*Math.cos(t)];function Yt(s,e,t){const[n,i,o]=s,[r,a,l]=Bl(e[0],e[1],e[2]),c=Math.cos(t),u=Math.sin(t);return new Ae((c+(1-c)*r*r)*n+((1-c)*r*a-l*u)*i+((1-c)*r*l+a*u)*o,((1-c)*r*a+l*u)*n+(c+(1-c)*a*a)*i+((1-c)*a*l-r*u)*o,((1-c)*r*l-a*u)*n+((1-c)*a*l+r*u)*i+(c+(1-c)*l*l)*o)}function Xt(s,e){return new Ge(s,{position:{size:3,data:e.position},normal:{size:3,data:e.normal},uv:{size:2,data:e.uv},index:{data:e.index}})}const Wl=100,qt=2,Js=1;function Gl(s=1,e=12,t=12){const n=360*(Math.PI/180)/t,i=e*t+1,o=(e-1)*t*2+t,r=new Float32Array(i*3),a=new Float32Array(i*3),l=new Float32Array(i*2),c=new Uint16Array(o*3);r[0]=0,r[1]=1-Js,r[2]=0,a[0]=0,a[1]=1,a[2]=0,l[0]=.5,l[1]=.5;const u=new Array(e-1).fill(null).map((h,p,d)=>s+p/(d.length-1)*qt);u.push(Wl);const f=u.map(h=>{const p=(Math.max(Math.min(h,s+qt),s)-s)/qt;return Math.sin((p+.5)*Math.PI)/2+.5-Js});for(let h=0;h<e;h++){const p=u[h],d=f[h];for(let m=0;m<t;m++){const g=n*m,w=Math.cos(g)*p,x=d,_=Math.sin(g)*p,C=h*t+m+1;if(r[C*3+0]=w,r[C*3+1]=x,r[C*3+2]=_,a[C*3+0]=0,a[C*3+1]=1,a[C*3+2]=0,l[C*2+0]=w,l[C*2+1]=_,h===0){const L=(C-1)*3;c[L+0]=0,c[L+1]=(m+1)%t+1,c[L+2]=m+1}else if(m===t-1){const L=h*t*6+m*6-t*3;c[L+0]=C,c[L+1]=C+1-t-t,c[L+2]=C+1-t,c[L+3]=C,c[L+4]=C-t,c[L+5]=C+1-t*2}else{const L=h*t*6+m*6-t*3;c[L+0]=C,c[L+1]=C+1-t,c[L+2]=C+1,c[L+3]=C,c[L+4]=C-t,c[L+5]=C+1-t}}}return{position:r,normal:a,uv:l,index:c}}function Ul(s,{res:e=1,xCurvature:t=.5,yCurvature:n=.2}={}){const i=s.length,o=3+e*2,r=o*i,a=(o-1)*(i-1)*2,l=new Float32Array(r*3),c=new Float32Array(r*2),u=new Float32Array(r*2),f=new Uint16Array(a*3);return s.forEach((h,p)=>{const d=p*o;for(let m=0;m<o;m++){const g=2-m/(o-1)*2-1;l[d*3+m*3+0]=(h.x-1)*g*.5;const w=-(1-h.y)*(1-h.y)*.5,x=Math.sin(Math.abs(g)*Math.PI)*.01;if(l[d*3+m*3+1]=x*t+w*n,l[d*3+m*3+2]=h.y-1,u[d*2+m*2+0]=l[d*3+m*3+0]+1/2,u[d*2+m*2+1]=l[d*3+m*3+2],p<s.length-1){const _=p*(o-1);f[_*6+m*6+0]=d+m+0,f[_*6+m*6+1]=d+m+1,f[_*6+m*6+2]=d+m+o,f[_*6+m*6+3]=d+m+1,f[_*6+m*6+4]=d+m+o,f[_*6+m*6+5]=d+m+o+1}}}),{position:l,normal:c,index:f,uv:u}}function Zs(s,e=8){const t=zr(s,4),n=Dl(t,e);return{position:Float32Array.from(n.position.map(o=>o.splice(0,3)).flat()),index:n.index,normal:new Float32Array,uv:new Float32Array}}const Hl={title:"Branches",type:"branches",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},length:{type:["number","parameter","curve"],min:0,max:3,step:.05,value:.8},thiccness:{type:"number",min:0,max:1,step:.01,value:.8},offsetSingle:{type:"number",min:0,max:1,step:.01,value:.5},lowestBranch:{type:"number",min:0,max:1,step:.01,value:.2},amount:{type:"number",min:0,max:64,value:10}},computeSkeleton(s,e){const{skeletons:t}=s.input.result,n=e.getSetting("stemResY"),i=t.map(o=>{const r=[],a=e.handleParameter(s.amount),l=e.handleParameter(s.lowestBranch);for(let c=0;c<a;c++){const u=c/a,f=e.handleParameter(s.length,u)*(1-u),h=e.handleParameter(s.thiccness,u),p=e.handleParameter(s.offsetSingle,u),d=c%2==0;let m=l+(1-l)*u;m-=1/a*p*(d?-1:1);const[g,,w]=Hs(o,m),x=Xs([g,w]),[_,k]=qs(x[0],x[1],d?-Math.PI/2:Math.PI/2),[C,L,V,$]=Us(o,m),J=Math.max(Math.floor(n*f*10),4),q=new Float32Array(J*4);for(let ne=0;ne<J*4;ne++){const U=ne/J;q[ne*4+0]=C+_*U*f,q[ne*4+1]=L,q[ne*4+2]=V+k*U*f,q[ne*4+3]=$*h*(1-U)}r.push(q)}return r}).flat();return{skeletons:i,allSkeletons:[...i,...t]}},computeGeometry(s,e,t){const n=t.getSetting("stemResX"),{geometry:i}=s.input.result,{skeletons:o}=e;return{geometry:Gt(i,...o.map(r=>Zs(r,n)))}}},Yl={title:"Curve",type:"curve",outputs:["number"],parameters:{value:{type:"curve",inputType:"curve",internal:!0,label:!1,value:[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}},computeValue(s,e,t){const n=Ar(s.value).map(i=>i.y);return Rl(n,1-t)}},Xl={title:"Gravity",type:"gravity",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,type:"select",values:["simple","verlet","test"]},strength:{type:"number",inputType:"slider",min:0,max:2,step:.05}},computeSkeleton(s,e){const{input:t,type:n,strength:i}=s,{skeletons:o}=t.result;return n==="simple"&&o.forEach(r=>{const a=r.length/4;for(let l=1;l<a;l++){const c=l/a,u=r[l*4+1],f=e.handleParameter(i,c);r[l*4+1]=u-u*c*c*c*f}return r}),n==="test"&&o.forEach(r=>{const a=r.length/4;for(let l=1;l<a;l++){const c=l/a,u=e.handleParameter(i,c),f=r[l*4+0],h=r[l*4+1],p=r[l*4+2],d=r[(l-1)*4+0],m=r[(l-1)*4+1],g=r[(l-1)*4+2],w=d-f,x=m-h,_=m-p,[k,C]=qs(w,_,90);for(let L=l;L<a;L++){const V=r[L*4+0],$=r[L*4+1],J=r[L*4+2],q=V-d,ne=$-m,U=J-g;let[ee,W,ie]=Yt([q,ne,U],[k,x,C],u*c);const Ie=ee+d,Mt=W+m,xt=ie+g;r[L*4+0]=Ie,r[L*4+1]=Mt,r[L*4+2]=xt}}return r}),n==="verlet"&&o.forEach(r=>{const a=r.length/4;for(let l=1;l<a;l++){const c=r[l*4+0],u=r[l*4+1],f=r[l*4+2],h=new Ae(5,0,0).cross(new Ae(c,u,f),new Ae(0,1,0)),p=l/a,d=e.handleParameter(i,p);for(let m=l;m<a;m++){const g=Yt([c,u,f],h,p*d);r[m*4+0]=g[0],r[m*4+1]=g[1],r[m*4+2]=g[2]}}return r}),{skeletons:o}},computeGeometry(s){return s.input.result}},Jt=ce("nodes.join"),ql={title:"Join",type:"join",outputs:["plant"],parameters:{inputA:{type:"plant",label:"plant",external:!0},inputB:{type:"plant",label:"plant",external:!0}},computeSkeleton(s,e){Jt("compute skeleton",s,e);const{inputA:t,inputB:n}=s;if(!t||!n)return t?t.result:n.result;const{skeletons:i,allSkeletons:o}=t.result,{skeletons:r,allSkeletons:a}=n.result;Jt(i,r);const l=[...i,...r],c=[];return o&&c.push(...o),a&&c.push(...a),{allSkeletons:c,skeletons:l}},computeGeometry(s){const{inputA:e,inputB:t}=s;if(!e||!t)return e?e.result:t.result;const{geometry:n,instances:i}=e.result,{geometry:o,instances:r}=t.result,a=Gt(n,o),l=[];return i&&l.push(...i),r&&l.push(...r),Jt("compute geometry",{geometryA:n,geometryB:o,result:a}),{geometry:a,instances:l}}},Jl=[{x:1,y:1,pinned:!0},{x:.62,y:.84,pinned:!1},{x:.54,y:.63,pinned:!1},{x:.38,y:.41,pinned:!0},{x:.44,y:.23,pinned:!1},{x:.64,y:.12,pinned:!1},{x:.98,y:.02,pinned:!0}],Zl={title:"Leaf",type:"leaf",outputs:["plant","leaf"],parameters:{input:{type:"plant",external:!0},size:{type:["number","parameter","curve","vec2"],inputType:"slider",min:0,max:3,step:.05,value:.2},shape:{type:"leaf",external:!0,defaultValue:Jl},lowestLeaf:{type:"number",inputType:"slider",min:0,max:1,step:.01,value:.5},curvature:{external:!0,type:"vec2",defaultValue:{x:.5,y:.2}},amount:{type:"number",min:0,max:20,value:10}},computeSkeleton(s,e){const{input:t}=s,{skeletons:n}=t.result,i=n.map((o,r)=>{const a=r/n.length,l=e.handleParameter(s.amount,a),c=new Float32Array(l*3),u=new Float32Array(l*3),f=new Float32Array(l*3);for(let h=0;h<l;h++){const p=h/(l-1),d=e.handleParameter(s.size,1-p),m=e.handleParameter(s.lowestLeaf,p),g=m+(1-m)*p-.001,[w,x,_]=Us(o,g),[k,,C]=Hs(o,g),L=Xs([k,C]),V=Math.atan2(-L[0],L[1]);c[h*3+0]=w,c[h*3+1]=x,c[h*3+2]=_,u[h*3+0]=d,u[h*3+1]=1,u[h*3+2]=d,f[h*3+0]=0,f[h*3+1]=V-Math.PI/2*(h%2==0?-1:1),f[h*3+2]=0}return{offset:c,scale:u,rotation:f}});return{allSkeletons:t.result.allSkeletons,skeletons:n,instances:i}},computeGeometry(s,e,t){const{shape:n,input:i,curvature:o}=s,{instances:r}=e,a=t.handleParameter(o),l=Ul(t.handleParameter(n),{res:t.getSetting("leafRes",2),xCurvature:a.x,yCurvature:a.y});return{geometry:i.result.geometry,instances:r.map(c=>te(te({},c),l))}}},Kl={title:"Math",type:"math",outputs:["number"],parameters:{mode:{type:"whatever",internal:!0,inputType:"selection",label:!1,defaultValue:"add",values:["add","multiply","subtract"]},a:{type:"number",defaultValue:0,label:!1},b:{type:"number",defaultValue:0,label:!1}},computeValue(s,e,t){const{mode:n}=s,i=e.handleParameter(s.a,t),o=e.handleParameter(s.b,t);switch(n){case"multiply":return i*o;case"subtract":return i-o;default:return i+o}}},Ql=ce("nodes.noise"),ea={title:"Noise",type:"noise",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},size:{type:"number",inputType:"slider",min:0,max:20,step:.05,value:1},strength:{type:"number",inputType:"slider",min:0,max:2,step:.01,value:.5}},computeSkeleton(s,e){Ql(s);const{input:t}=s,n=e.handleParameter(s.size),i=e.handleParameter(s.strength),{skeletons:o}=t.result;return o.forEach((r,a)=>{const l=r.length/4,c=[r[0],r[1],r[2]];let u=0;for(let f=0;f<l;f++){const h=f/l;u+=(Math.abs(c[0]-r[f*4+0])+Math.abs(c[1]-r[f*4+1])+Math.abs(c[2]-r[f*4+2]))/3,c[0]=r[f*4+0],c[1]=r[f*4+1],c[2]=r[f*4+2],r[f*4+0]=r[f*4+0]+Ht.n1d(u*n+0+a*500)*i*h,r[f*4+1]=r[f*4+1]+Ht.n1d(u*n+1e3+a*500)*i*h,r[f*4+2]=r[f*4+2]+Ht.n1d(u*n+2e3+a*500)*i*h}}),{skeletons:o,allSkeletons:t.result.allSkeletons}},computeGeometry(s){return s.input.result}},ta={title:"Output",type:"output",outputs:[],parameters:{main:{type:"plant",label:"plant",external:!0}},computeNode(s={}){return s.main}},na={title:"Parameter",type:"parameter",outputs:["number"],parameters:{value:{type:"number",value:0},variation:{type:"number",inputType:"slider",value:0,min:0,max:1,step:.05}},computeValue(s,e){const{value:t=0,variation:n=0}=s;return n?t+e.n1d(200)*n*Math.max(t,1):t}},sa=s=>s==="X"?[1,0,0]:s==="Z"?[0,0,1]:[0,1,0],ia={title:"Rotate",type:"rotate",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,label:!1,type:"select",values:["Y","X","Z"]},spread:{internal:!0,type:"boolean",value:!0},angle:{type:"number",inputType:"slider",min:0,max:Math.PI*2,step:.05,value:0}},computeSkeleton(s,e){const{input:t,type:n,spread:i}=s,{result:{skeletons:o,allSkeletons:r}}=t,a=sa(n);return o.forEach((l,c)=>{const u=l.length/4,f=l[0],h=l[1],p=l[2],d=c/o.length,m=e.handleParameter(s.angle,d)*(i?d:1);for(let g=1;g<u;g++){let w=l[g*4+0],x=l[g*4+1],_=l[g*4+2];w-=f,x-=h,_-=p,[w,x,_]=Yt([w,x,_],a,m),w+=f,x+=h,_+=p,l[g*4+0]=w,l[g*4+1]=x,l[g*4+2]=_}}),{skeletons:o,allSkeletons:r}},computeGeometry(s){return s.input.result}},oa={title:"Shape",type:"shape",outputs:["leaf"],parameters:{value:{type:"leaf",inputType:"shape",internal:!0,label:!1,value:[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}},computeValue(s){return s.value}},ra={title:"Slider",type:"slider",outputs:["number"],parameters:{value:{type:"number",label:!1,inputType:"slider",internal:!0,min:0,max:1,step:.01,value:0}},computeValue(s){return s.value}},Ks=ce("nodes.stem"),la={title:"Stem",type:"stem",outputs:["plant"],parameters:{origin:{type:"vec3",external:!0,defaultValue:{x:0,y:0,z:0}},height:{type:"number",inputType:"slider",min:0,max:5,step:.05,value:2},thiccness:{type:"number",inputType:"slider",min:0,max:.2,step:.01,value:.06},amount:{type:"number",min:0,max:20,value:1}},computeSkeleton(s,e){Ks("computeSkeleton",s);const t=e.handleParameter(s.amount),n=e.getSetting("stemResY"),i=[];for(let o=0;o<t;o++){const{x:r,y:a,z:l}=e.handleParameter(s.origin),c=e.handleParameter(s.height),u=new Float32Array(n*4);for(let f=0;f<n;f++){const h=f/n,p=e.handleParameter(s.thiccness,h)*(1-h),d=r,m=a+h*c,g=l;u[f*4+0]=d,u[f*4+1]=m,u[f*4+2]=g,u[f*4+3]=p}i.push(u)}return{skeletons:i,allSkeletons:i}},computeGeometry(s,e,t){Ks("computeNode",s,e);const n=t.getSetting("stemResX");return{geometry:Gt(...e.skeletons.map(i=>Zs(i,n)))}}},aa={title:"Vec2",type:"vec2",outputs:["vec2"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0}}},ca={title:"Vec3",type:"vec3",outputs:["vec3"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0},z:{label:!1,type:"number",value:0,defaultValue:0}}};var ua=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Branch:Hl,Curve:Yl,Gravity:Xl,Join:ql,Leaf:Zl,Math:Kl,Noise:ea,Output:ta,Parameter:na,Rotate:ia,Shape:oa,Slider:ra,Stem:la,Vec2:aa,Vec3:ca});const Zt=Object.values(ua).map(s=>("computeNode"in s?s.compute=s.computeNode:s.compute=e=>({type:s.type,parameters:e}),s));const fa=(s,e)=>t=>Math.min(Math.max(t,s),e),ha=s=>{const e=10**s;return t=>Math.floor(t*e)/e},da=fa(-1e5,1e5),pa=ha(1),vt=s=>da(pa(s));class Qs{constructor({x1:e=0,y1:t=0,x2:n=0,y2:i=0},o){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x1=e,this.y1=t,this.x2=n,this.y2=i,this.system=o.node.system,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("viewbox","0 0 100 100"),this.svg.setAttribute("width","100"),this.svg.setAttribute("height","100"),this.svg.style.overflow="visible",this.svg.style.position="absolute",this.svg.style.top="3.5px",this.svg.style.pointerEvents="none",this.svg.style.zIndex="-1",o.view.wrapper.append(this.svg),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("node-connection-path"),this.path.setAttribute("vector-effect","non-scaling-stroke"),this.path.setAttribute("d",`
      M 0 0
      C 50 0 
        50 100
				100  100
      `),this.svg.appendChild(this.path),this.setPosition()}setPosition({x1:e=this.x1,y1:t=this.y1,x2:n=this.x2,y2:i=this.y2}={}){var a;this.x1=vt(e),this.y1=vt(t),this.x2=vt(n),this.y2=vt(i);const o=this.x2-this.x1+3.5,r=this.y2-this.y1;(a=this==null?void 0:this.hoverPath)==null||a.setAttribute("d",`
      M 0 0
      C ${o/2} 0 
        ${o/2} ${r}
				${o}  ${r}
      `),this.path.setAttribute("d",`
      M 0 0
      C ${o/2} 0 
        ${o/2} ${r}
				${o}  ${r}
      `)}remove(){var e;this.path.remove(),(e=this==null?void 0:this.hoverPath)==null||e.remove(),this.system.save()}}class ma extends Qs{constructor(e){super({},e.output);this.connection=e,this.input=e.input.view,this.output=e.output.view,this.hoverPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.hoverPath.classList.add("node-connection-hover"),this.hoverPath.setAttribute("vector-effect","non-scaling-stroke"),this.svg.append(this.hoverPath),this.hoverPath.addEventListener("mouseover",()=>{const{activeNode:t}=this.system.view;t&&t.view.active&&t.view.hoveredConnection!==this&&this.handleNodeOver(t)}),this.hoverPath.addEventListener("mouseout",()=>{const{activeNode:t}=this.system.view;this.handleNodeOut(t)}),e.input.node.system.view.colorStore.on(e.input.type[0],t=>{this.path.style.stroke=t})}handleNodeOver(e){this.connection.isNodeJoinable(e)&&(e.view.hoveredConnection=this,this.path.classList.add("hover-active"))}handleNodeOut(e){e&&e.view.hoveredConnection===this&&delete e.view.hoveredConnection,this.path.classList.remove("hover-active")}remove(){super.remove()}}function va(s){if(!ga(s))throw new Error("panzoom requires DOM element to be attached to the DOM tree");const t=s.parentElement;return s.scrollTop=0,{getBBox:o,getOwner:i,applyTransform:r};function i(){return t}function o(){return{left:0,top:0,width:s.clientWidth,height:s.clientHeight}}function r(a){s.style.transformOrigin="0 0 0",s.style.transform="matrix("+a.scale+", 0, 0, "+a.scale+", "+a.x+", "+a.y+")"}}function ga(s){return s&&s.parentElement&&s.style}function wa(s,e,t){typeof t!="object"&&(t={});const n=typeof t.minVelocity=="number"?t.minVelocity:5,i=typeof t.amplitude=="number"?t.amplitude:.25,o=typeof t.cancelAnimationFrame=="function"?t.cancelAnimationFrame:ya(),r=typeof t.requestAnimationFrame=="function"?t.requestAnimationFrame:_a();let a,l;const c=342;let u,f,h,p,d,m,g,w;return{start:_,stop:C,cancel:x};function x(){o(u),o(w)}function _(){a=s(),p=g=f=d=0,l=new Date,o(u),o(w),u=r(k)}function k(){const V=Date.now(),$=V-l;l=V;const J=s(),q=J.x-a.x,ne=J.y-a.y;a=J;const U=1e3/(1+$);f=.8*q*U+.2*f,d=.8*ne*U+.2*d,u=r(k)}function C(){o(u),o(w);const V=s();h=V.x,m=V.y,l=Date.now(),(f<-n||f>n)&&(p=i*f,h+=p),(d<-n||d>n)&&(g=i*d,m+=g),w=r(L)}function L(){const V=Date.now()-l;let $=!1,J=0,q=0;p&&(J=-p*Math.exp(-V/c),J>.5||J<-.5?$=!0:J=p=0),g&&(q=-g*Math.exp(-V/c),q>.5||q<-.5?$=!0:q=g=0),$&&(e(h+J,m+q),w=r(L))}}function ya(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function _a(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(s){return setTimeout(s,16)}}const ba=.2;function ka(s,e){const t=va(s),n=t.getOwner(),i={x:0,y:0};let o=!1;const r={x:0,y:0,scale:1},a=typeof e.pinchSpeed=="number"?e.pinchSpeed:1,l=e.bounds,c=typeof e.maxZoom=="number"?e.maxZoom:Number.POSITIVE_INFINITY,u=typeof e.minZoom=="number"?e.minZoom:0,f=typeof e.boundsPadding=="number"?e.boundsPadding:.05,h=typeof e.zoomSpeed=="number"?e.zoomSpeed:ba;let p=ei(e.transformOrigin);Sa(l);let d,m=!1,g=!1,w,x,_;const k=wa(to,lo,e.smoothScroll);let C,L=!1;bn();const V={dispose:ao,moveBy:wn,moveTo:Pt,smoothMoveTo:ro,centerOn:oo,zoomTo:st,zoomAbs:_n,pause:ne,resume:U,isPaused:ee,getTransform:Ie,setTransform:ie,getTransformOrigin:Mt,setTransformOrigin:xt},$=typeof e.initialX=="number"?e.initialX:r.x,J=typeof e.initialY=="number"?e.initialY:r.y,q=typeof e.initialZoom=="number"?e.initialZoom:r.scale;return($!=r.x||J!=r.y||q!=r.scale)&&_n($,J,q),V;function ne(){kn(),L=!0}function U(){L&&(bn(),L=!1)}function ee(){return L}function W(j,T){return i.x=j,i.y=T,i}function ie(j,T,A){r.x=j,r.y=T,r.scale=A,et()}function Ie(){return r}function Mt(){return p}function xt(j){p=ei(j)}function to(){return{x:r.x,y:r.y}}function Pt(j,T){r.x=j,r.y=T,Nt(),et()}function wn(j,T){Pt(r.x+j,r.y+T)}function Nt(){const j=no();if(!j)return;let T=!1;const A=so();let G=j.left-A.right;return G>0&&(r.x+=G,T=!0),G=j.right-A.left,G<0&&(r.x+=G,T=!0),G=j.top-A.bottom,G>0&&(r.y+=G,T=!0),G=j.bottom-A.top,G<0&&(r.y+=G,T=!0),T}function no(){if(!!l){if(typeof l=="boolean"){const j=n.getBoundingClientRect(),T=j.width,A=j.height;return{left:T*f,top:A*f,right:T*(1-f),bottom:A*(1-f)}}return l}}function so(){const j=t.getBBox(),T=io(j.left,j.top);return{left:T.x,top:T.y,right:j.width*r.scale+T.x,bottom:j.height*r.scale+T.y}}function io(j,T){return{x:j*r.scale+r.x,y:T*r.scale+r.y}}function et(){o=!0,d=window.requestAnimationFrame(co)}function yn(j,T,A){if(Kt(j)||Kt(T)||Kt(A))throw new Error("zoom requires valid numbers");const G=r.scale*A;if(G<u){if(r.scale===u)return;A=u/r.scale}if(G>c){if(r.scale===c)return;A=c/r.scale}const he=W(j,T);r.x=he.x-A*(he.x-r.x),r.y=he.y-A*(he.y-r.y),l&&f===1&&u===1?(r.scale*=A,Nt()):Nt()||(r.scale*=A),et()}function _n(j,T,A){const G=A/r.scale;yn(j,T,G)}function oo(j){const T=j.ownerSVGElement;if(!T)throw new Error("ui element is required to be within the scene");const A=j.getBoundingClientRect(),G=A.left+A.width/2,he=A.top+A.height/2,Ne=T.getBoundingClientRect(),it=Ne.width/2-G,ot=Ne.height/2-he;tt(it,ot)}function ro(j,T){tt(j-r.x,T-r.y)}function tt(j,T){return wn(j,T)}function lo(j,T){Pt(j,T)}function ao(){kn()}function bn(){n.addEventListener("mousedown",jn,{passive:!0}),n.addEventListener("dblclick",Ln,{passive:!1}),n.addEventListener("touchstart",Mn,{passive:!0}),n.addEventListener("keydown",Sn),n.addEventListener("wheel",Tn,{passive:!0}),et()}function kn(){n.removeEventListener("wheel",Tn),n.removeEventListener("mousedown",jn),n.removeEventListener("keydown",Sn),n.removeEventListener("dblclick",Ln),n.removeEventListener("touchstart",Mn),d&&(window.cancelAnimationFrame(d),d=0),k.cancel(),Cn(),vo(),An()}function co(){o&&uo()}function uo(){o=!1,t.applyTransform(r),d=0,e.onTransform&&e.onTransform(r)}function Sn(j){let T=0;if(j.keyCode===38||j.keyCode===40||j.keyCode===37||j.keyCode===39||(j.keyCode===189||j.keyCode===109?T=1:(j.keyCode===187||j.keyCode===107)&&(T=-1)),T){const A=On(T*100),G=p?Lt():fo();st(G.x,G.y,A)}}function fo(){const j=n.getBoundingClientRect();return{x:j.width/2,y:j.height/2}}function Mn(j){if(ho(j),j.touches.length===1)return mo(j);j.touches.length===2&&(_=Nn(j.touches[0],j.touches[1]),C=!0,xn())}function ho(j){j.stopPropagation(),j.preventDefault()}function po(j){j.preventDefault(),j.stopPropagation()}function mo(j){const T=j.touches[0],A=$e(T),G=W(A.x,A.y);w=G.x,x=G.y,k.cancel(),xn()}function xn(){m||(m=!0,document.addEventListener("touchmove",Pn),document.addEventListener("touchend",nt),document.addEventListener("touchcancel",nt))}function Pn(j){if(j.touches.length===1){j.stopPropagation();const T=j.touches[0],A=$e(T),G=W(A.x,A.y),he=G.x-w,Ne=G.y-x;he!==0&&Ne!==0&&In(),w=G.x,x=G.y,tt(he,Ne)}else if(j.touches.length===2){C=!0;const T=j.touches[0],A=j.touches[1],G=Nn(T,A),he=1+(G/_-1)*a,Ne=$e(T),it=$e(A);if(w=(Ne.x+it.x)/2,x=(Ne.y+it.y)/2,p){const ot=Lt();w=ot.x,x=ot.y}st(w,x,he),_=G,j.stopPropagation(),j.preventDefault()}}function nt(j){if(j.touches.length>0){const T=$e(j.touches[0]),A=W(T.x,T.y);w=A.x,x=A.y}}function Nn(j,T){const A=j.clientX-T.clientX,G=j.clientY-T.clientY;return Math.sqrt(A*A+G*G)}function Ln(j){po(j)}function jn(j){if(m)return j.stopPropagation(),!1;if(j.target!==n&&j.target!==s||!(j.button===1&&window.event!==null||j.button===0))return;k.cancel();const A=$e(j),G=W(A.x,A.y);return w=G.x,x=G.y,document.addEventListener("mousemove",En),document.addEventListener("mouseup",$n),!1}function En(j){if(m||j.ctrlKey)return;In();const T=$e(j),A=W(T.x,T.y),G=A.x-w,he=A.y-x;w=A.x,x=A.y,tt(G,he)}function $n(){An(),Cn()}function Cn(){document.removeEventListener("mousemove",En),document.removeEventListener("mouseup",$n),g=!1}function vo(){document.removeEventListener("touchmove",Pn),document.removeEventListener("touchend",nt),document.removeEventListener("touchcancel",nt),g=!1,C=!1,m=!1}function Tn(j){k.cancel();let T=j.deltaY;j.deltaMode>0&&(T*=100);const A=On(T);if(A!==1){const G=p?Lt():$e(j);st(G.x,G.y,A)}}function $e(j){const T=n.getBoundingClientRect(),A=j.clientX-T.left,G=j.clientY-T.top;return{x:A,y:G}}function Lt(){const j=n.getBoundingClientRect();return{x:j.width*p.x,y:j.height*p.y}}function st(j,T,A){return k.cancel(),yn(j,T,A)}function On(j){const T=Math.sign(j),A=Math.min(.25,Math.abs(h*j/128));return 1-T*A}function In(){g||(g=!0,k.start())}function An(){g&&(C||k.stop())}}function ei(s){if(!!s){if(typeof s=="object")return(!Fe(s.x)||!Fe(s.y))&&ti(),s;ti()}}function ti(s){throw new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function Sa(s){const e=typeof s;if(e==="undefined"||e==="boolean")return;if(!(Fe(s.left)&&Fe(s.top)&&Fe(s.bottom)&&Fe(s.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}function Fe(s){return Number.isFinite(s)}function Kt(s){return Number.isNaN?Number.isNaN(s):s!==s}function Ma(s,e){const t=s.x2<e.x1,n=s.x1>e.x2,i=s.y1>e.y2,o=s.y2<e.y1;return!(t||n||i||o)}var xa=(s,e)=>e.type.includes(s.type)||e.type.includes("*");function gt(s,e){if(s===void 0&&e===void 0)return;const t=Array.isArray(s)?"array":typeof s;if(t==="string"||t==="boolean"||t==="number")return s===e?void 0:e;if(Array.isArray(s)){const r=s.map((a,l)=>typeof e=="object"&&l in e?gt(a,e[l]):e[l]);return!r.length||r.length===1&&!r[0]?void 0:r}if(!s)return e;const n=Object.keys(s),i={};let o=!1;if(n.forEach(r=>{const a=gt(s[r],e[r]);a!==void 0&&(o=!0,i[r]=a)}),!!o)return i}function Pa(s,e){return[gt(s,e),gt(e,s)]}function wt(s,e){const t=typeof s;if(t==="string"||t==="boolean"||t==="number")return e;if(Array.isArray(s))return s.map((n,i)=>e[i]?wt(n,e[i]):n);if(typeof s=="object"){const n=Object.keys(e),i=te({},s);return n.forEach(o=>{i[o]=wt(s[o],e[o])}),i}}class Na{constructor(e,{input:t,output:n}){if(!n||!t)return;if(this.system=e,t.node.getChildren().includes(n.node))throw new Error("Circular reference");if(!xa(n,t))throw new Error("Can't connect type "+t.type+" to "+n.type);this.output=n,this.input=t,e.options.view&&(this.view=new ma(this)),this.output.setConnection(this),this.input.setConnection(this),this.output.node.system.save()}joinNode(e){if(!this.isNodeJoinable(e))return;this.remove(),this.output.node.connectTo(e,0,e.getInputs()[0].key);const t=this.input.node.getInputs(),n=t.indexOf(this.input),i=t[n].key;e.connectTo(this.input.node,0,i)}isNodeJoinable(e){const t=this.input.type,n=this.output.type;if(this.input.node===e||this.output.node===e)return!1;const i=e.getInputs();if(!i.length||!i.find(r=>r.type.includes(n)))return!1;const o=e.outputs;return!(!o.length||!o.find(r=>t.includes(r.type)||t.includes("*")))}remove(){this.view&&this.view.remove(),this.input.removeConnection(),this.output.removeConnection(this)}deserialize(){return{id:this.input.node.attributes.id,out:this.indexOut,in:this.indexIn}}get indexOut(){return this.output.node.outputs.indexOf(this.output)}get indexIn(){return this.input.key}}class Qt extends ye{constructor(e,t){super();this.outputs=[],this._state={},this.states={},this.inputData=[],this.enableUpdates=!0,this.refs=[],this.system=e;const{attributes:n,state:i={}}=t;this._state=i,this.attributes=n,this.id=n.id,this._compute=Ur((o=this._state)=>this.compute(o))}get state(){return this._state}bindView(e){this.view=e,this.outputs.forEach(t=>t.bindView()),Object.values(this.states).forEach(t=>t.bindView())}setAttributes(e){this.enableUpdates&&this.system.history.addAction(),this.attributes=te(te({},this.attributes),e),this==null||this.view.updateViewPosition(),this.save()}compute(e){return e}getChildren(){return this.outputs.map(n=>n.connections).flat().map(n=>n.input.node)}getSockets(){return[...this.getInputs(),...this.outputs]}getInputs(){return Object.values(this.states).map(e=>e.getInput()).filter(e=>!!e)}setStateValue(e,t){this.states[e].setValue(t)}getStateValue(e){return this.state[e]}update(){!this.enableUpdates||(this.computedData=this._compute(this.state),this.emit("computedData",this.computedData),this.refs.forEach(e=>{e.node.enableUpdates=!1,e.keyIn.forEach(t=>{e.node.setStateValue(t,this.computedData)}),e.node.enableUpdates=!0,e.node.update()}),this.save())}remove(){this.system.removeNode(this),this.destroyEventEmitter()}connectTo(e,t=0,n=e.getInputs()[0].key){var l,c,u;const i=this.outputs[t],o=(l=e.states[n])==null?void 0:l.getInput();if(!o)return;const r=new Na(this.system,{output:i,input:o});(c=i==null?void 0:i.view)==null||c.updatePosition(),(u=o==null?void 0:o.view)==null||u.updatePosition();const a=this.refs.find(f=>f.node.id===e.id&&f.indexOut===t);return a?a.keyIn=[...a.keyIn,n]:this.refs.push({node:e,keyIn:[n],indexOut:t}),this.update(),r}disconnectFrom(e,t,n){this.refs=this.refs.filter(i=>!(i.indexOut!==n||(i.keyIn.splice(i.keyIn.indexOf(t),1),i.keyIn.length===0))),this.update()}deserialize(){const e=Object.assign({},this.attributes);e.refs=this.outputs.map(n=>n.connections).flat().map(n=>n.deserialize());const t={};return Object.values(this.states).forEach(n=>{t[n.key]=n.getValue()}),Object.assign({},{attributes:e,state:t})}save(){this.system.save()}}var La={title:"Boolean",type:"boolean",outputs:["boolean"],parameters:{value:{type:"boolean",defaultValue:!1}},compute({value:s=!1}){return s}};const ja={title:"Math",type:"math",outputs:["number","number"],parameters:{mode:{type:"whatever",internal:!0,inputType:"selection",label:!1,defaultValue:"add",values:["add","multiply","subtract"]},a:{type:"number",defaultValue:0,label:!1},b:{type:"number",defaultValue:0,label:!1}},compute({mode:s,a:e,b:t}){switch(s){case"multiply":return e*t;case"subtract":return e-t;default:return e+t}}};var Ea={title:"Number",type:"number",outputs:["number"],parameters:{value:{type:"number",internal:!0,label:!1,defaultValue:0}},compute({value:s=0}){return s}};class $a{constructor(e){this.nodeState=e,this.wrapper=document.createElement("div"),this.input=document.createElement("div"),this.isPaused=!1,this.wrapper.classList.add("node-state-single-wrapper"),this.input.classList.add("node-state-input");const t=e.template,n=t.label||e.key;if(typeof n=="string"){const i=document.createElement("p");i.className="state-label",i.innerHTML=n,this.wrapper.appendChild(i)}(t==null?void 0:t.label)===!1&&this.wrapper.classList.add("hide-label"),t.external||(this.element=Il({target:this.input,template:t,value:e.getValue()}),this.element&&this.element.$on("change",({detail:i})=>{this.isPaused||(this.isPaused=!0,typeof i!="undefined"&&!Number.isNaN(i)&&this.nodeState.setValue(i),this.isPaused=!1)})),e.node.view.stateWrapper.appendChild(this.wrapper),this.wrapper.appendChild(this.input)}updateValue(){this.isPaused||(this.isPaused=!0,setTimeout(()=>{this.element&&(this.element.value=this.nodeState.getValue())},50),this.isPaused=!1)}updatePosition(){var e,t;this.rect=this.wrapper.getBoundingClientRect(),(t=(e=this.nodeState.getInput())==null?void 0:e.view)==null||t.updatePosition()}get y(){return this.rect.y-this.nodeState.node.view.y}get height(){return this.rect.height}setActive(e){this.wrapper.classList[e?"remove":"add"]("disabled")}}class Ca{constructor(e){if(!e||!e.node)throw new Error("Somethings missing");this.input=e,this.node=e.node,this.wrapper=document.createElement("div"),this.wrapper.classList.add("node-input-wrapper"),e.type.forEach(t=>{this.wrapper.classList.add(`socket-type-${t==="*"?"all":t}`)}),e.state.view.wrapper.appendChild(this.wrapper),this.wrapper.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault();const n=this.input.connection;n?(n.remove(),this.node.system.view.createFloatingConnection(n.output)):this.node.system.view.createFloatingConnection(this.input)},!1),this.node.system.view.colorStore.on(e.type[0],t=>{const n=window.getComputedStyle(this.wrapper,null).getPropertyValue("background-color");this.wrapper.style.backgroundColor=n!=="rgba(0, 0, 0, 0)"?n:t})}updatePosition(){var e;this.rect=this.wrapper.getBoundingClientRect(),(e=this==null?void 0:this.connection)==null||e.setPosition({x2:this.x,y2:this.y})}remove(){this.wrapper.remove(),this.connection&&this.connection.remove()}set state(e){this.wrapper.classList.forEach(t=>{t.includes("socket-state-")&&this.wrapper.classList.remove(t)}),e&&e.length&&this.wrapper.classList.add("socket-state-"+e)}get x(){return this.node.view.x-3}get y(){const e=this.node.system.view;return(this.rect.y+this.rect.height/2-e.y-e.top)/e.s-e.height/2}}class qe{constructor(e,t,n){this.state=e,this.key=n,this.node=e.node,this.type=Array.isArray(t)?t:[t]}bindView(){this.view=new Ca(this)}removeConnection(){const e=this.connection;delete this.connection,e&&e.remove(),this.node.setStateValue(this.key,void 0),this.state.setIsExternal(!1)}setConnection(e){this.connection&&this.connection.remove(),this.connection=e,this.view&&(this.view.connection=e.view),this.state.setIsExternal(!0)}remove(){this.view&&this.view.remove(),this.removeConnection()}}class en extends ye{constructor(e,t,n){super();var i,o;this.node=e,this.key=t,this.template=n,this.isExternal=!1,this.value=(o=(i=e.state[t])!=null?i:n.defaultValue)!=null?o:n.value,this.node._state[t]=this.value,this.template.internal||(this.input=new qe(this,n.type,t))}setIsExternal(e=!1){var t;this.isExternal=e,(t=this==null?void 0:this.view)==null||t.setActive(!e)}getValue(){return this.value}setValue(e){this.isExternal||(this.node.enableUpdates&&this.node.system.history.addAction(),this.value=e),this.node._state[this.key]=e,this.node.enableUpdates&&(this==null||this.view.updateValue(),this.node.update())}remove(){}getInput(){return this.input}bindView(){this.view=new $a(this),this.input&&this.input.bindView()}}class tn{constructor(e){this.inputs=[],this.outputs=[],this.active=!1,this.x=0,this.y=0,this.downX=0,this.downY=0,this.mDownX=0,this.mDownY=0,this.height=50,this.width=91,this.node=e,this.system=e.system,this.wrapper=document.createElement("div"),this.wrapper.style.minHeight=this.height+"px",this.wrapper.style.minWidth=this.width+"px",this.wrapper.classList.add("node-wrapper","node-type-"+e.attributes.type.toLowerCase()),this.wrapper.setAttribute("id","node-view-"+this.system.id+"-"+this.node.id),this.outputWrapper=document.createElement("div"),this.outputWrapper.classList.add("node-outputs-wrapper"),this.wrapper.append(this.outputWrapper);const t=document.createElement("p");t.innerHTML=e.attributes.name||e.attributes.type,t.classList.add("node-title"),this.wrapper.appendChild(t),this.stateWrapper=document.createElement("div"),this.stateWrapper.classList.add("node-state-wrapper"),this.wrapper.append(this.stateWrapper),e.system.view.nodeContainer.append(this.wrapper);const{pos:{x:n=0,y:i=0}={}}=e.attributes;this.x=n,this.y=i,this.bindEventListeners(),this.wrapper.style.left=n+"px",this.wrapper.style.top=i+"px",setTimeout(()=>{const{width:o,height:r}=this.wrapper.getBoundingClientRect();this.width=o/this.system.view.s,this.height=r/this.system.view.s,this.updateViewPosition(n,i)},10)}bindEventListeners(){this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e)),this._unsubscribeMouseMove=this.system.view.on("mousemove",e=>this.handleMouseMove(e)),this._unsubscribeMouseUp=this.system.view.on("mouseup",()=>this.handleMouseUp())}removeEventListeners(){this._unsubscribeMouseMove(),this._unsubscribeMouseUp(),this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e))}set state(e){this.wrapper.classList.remove("node-active","node-selected","node-dragging"),this.wrapper.classList.add("node-"+e),this._state=e}get state(){return this._state}handleMouseDown(e){var i,o,r,a;if(this.system.view.keyMap.space||e.button===2||e.target!==e.currentTarget)return;e.stopImmediatePropagation(),e.stopPropagation(),this.node.system.view.setActive(this.node,e);const{rmx:t,rmy:n}=this.system.view;this.mDownX=t,this.mDownY=n,this.downX=((o=(i=this.node.attributes)==null?void 0:i.pos)==null?void 0:o.x)||0,this.downY=((a=(r=this.node.attributes)==null?void 0:r.pos)==null?void 0:a.y)||0,this.active=!0,this.system.view.selectedNodes.length&&this.system.view.selectedNodes.forEach(l=>{l.view.active=!0,l.view.mDownX=t,l.view.mDownY=n,l.view.downX=l.view.x,l.view.downY=l.view.y})}handleMouseUp(){this.active=!1,this.hoveredConnection&&(this.hoveredConnection.connection.joinNode(this.node),delete this.hoveredConnection)}handleMouseMove({mx:e,my:t,keys:n}){if(this.active){this.state="dragging";const i=n.ctrlKey?.02:1;let o=this.mDownX-e,r=this.mDownY-t;n.shiftKey&&(Math.abs(o)>Math.abs(r)?r=0:o=0);const a=Math.round((this.downX-o/this.system.view.s)*i)/i,l=Math.round((this.downY-r/this.system.view.s)*i)/i;this.setPosition(a,l)}}updateViewPosition(e=(o=>(o=(i=>(i=(n=>(n=this.node.attributes)==null?void 0:n.pos)())==null?void 0:i.x)())!=null?o:this.x)(),t=(l=>(l=(a=>(a=(r=>(r=this.node.attributes)==null?void 0:r.pos)())==null?void 0:a.y)())!=null?l:this.y)()){this.wrapper.style.left=e+"px",this.wrapper.style.top=t+"px",Object.values(this.node.states).forEach(c=>{var u;return(u=c==null?void 0:c.view)==null?void 0:u.updatePosition()}),this.node.outputs.forEach(c=>c.view.updatePosition())}setPosition(e,t){this.x=e,this.y=t,this.node.setAttributes({pos:{x:e,y:t}}),this.updateViewPosition()}remove(){this.removeEventListeners(),this.wrapper.remove()}}class Ta extends Qt{constructor(e,t){super(e,t);this.states={input:new en(this,"input",{type:"*"})},this.outputs=[]}compute({input:e}){return e}}class Oa extends tn{constructor(e){super(e);const t=document.createElement("div");e.on("computedData",n=>{t.innerHTML="";const i=document.createElement("p");i.innerHTML=JSON.stringify(n,null," "),t.append(i)}),this.wrapper.appendChild(t)}}var Ia={title:"Debug",meta:{description:"Outputs any inputs for debug purposes"},node:Ta,view:Oa};class Aa extends Qt{constructor(e,t){super(e,t);this.states={input:new en(this,"input",{type:"*",external:!0,label:!1})},this.outputs=[]}compute({input:e}){return e}}class Va extends tn{constructor(e){super(e);const t=document.createElement("p");t.style.margin="0px",t.style.padding="4px",t.style.color="white",t.style.fontWeight="bold",e.on("computedData",n=>{t.innerHTML=JSON.stringify(n,null,2)}),this.wrapper.appendChild(t)}}var Da={title:"Output",meta:{description:"Outputs the final value"},node:Aa,view:Va};const nn={BooleanNode:La,MathNode:ja,NumberNode:Ea,DebugNode:Ia,OutputNode:Da};let sn=0;class yt{constructor(e,t="system"in e?e.system.log.level:2){this.isGrouped=!1,this.output=ce("logger"),this.module=e,this.name=e.constructor.name,this.length=this.name.length,sn=Math.max(sn,this.length),this.level=t,this.output=ce(this.getModuleName())}getModuleName(){return this.isGrouped?"":`${this.name.padEnd(sn," ")}`}handle(e,t,n){n&&n.length?(console.groupCollapsed(`${this.getModuleName()} ${t}`),e(...n),console.groupEnd()):e(`${this.getModuleName()} ${t}`)}info(e,...t){this.level>=3&&this.output(e,...t)}log(e,...t){this.level>=2&&this.output(e,...t)}warn(e,...t){this.level>=1&&this.output.warn(e,...t)}error(e,...t){this.level>=0&&(this.output.error(e),this.output(...t))}group(e){this.output.group(e),this.isGrouped=!0}groupEnd(){console.groupEnd(),this.isGrouped=!1}}class Ra{constructor(e){this.x=0,this.y=0,this.view=e,this.system=e.system,this.log=new yt(this),this.wrapper=document.createElement("div"),this.wrapper.classList.add("context-wrapper"),this.search=new Cl({target:this.wrapper}),this.search.$on("input",({detail:t})=>{this.resolve(t)}),this.view.wrapper.append(this.wrapper),this.view.system.store.on("types",t=>this.updateTypes(t),20),this.view.on("keydown",({key:t})=>t==="Escape"&&this.hide())}updateTypes(e){this.search.setItems(e.map(t=>({value:t.type||t.title,title:t.title})))}handleWindowClick(e){e.composedPath().includes(this.wrapper)||this.reject()}reject(){this.rej&&this.rej(),this.hide()}resolve(e){const t=this.system.store.getByName(e),{x:n,y:i}=this.view.projectWindowToLocal(this.x,this.y),o=n-this.view.width/2,r=i-this.view.height/2;t?this.res({attributes:{pos:{x:o,y:r},id:"",name:t.title,type:t.title,refs:[]},state:{value:void 0}}):this.reject(),this.hide()}hide(){this.search.clear(),this.wrapper.classList.remove("context-visible"),this.wrapper.blur(),this.res=e=>e,this.reject=()=>{}}show({x:e,y:t,socket:n}){return this.x=e,this.y=t,this.socket=n,this.wrapper.style.left=e/this.system.view.width*100+"%",this.wrapper.style.top=t/this.system.view.height*100+"%",setTimeout(()=>{this.wrapper.classList.add("context-visible"),this.search.focus()},10),new Promise((i,o)=>{this.res=i,this.rej=o})}}class za extends ye{constructor(e){super();this.mDownX=0,this.mDownY=0,this.downX=0,this.downY=0,this.isShiftKey=!1,this.view=e,this.wrapper=document.createElement("div"),this.wrapper.classList.add("box-selection-wrapper"),this.view.wrapper.append(this.wrapper),this.view.on("mousedown",({target:t,mx:n,x:i,my:o,y:r,keys:a})=>{var l;a.space||a.shiftKey||a.button===2||!a.ctrlKey||t&&!((l=t==null?void 0:t.className)==null?void 0:l.includes("nodesystem"))||(this.mDownX=n,this.mDownY=o,this.downX=i,this.downY=r,this.wrapper.style.left=n+"px",this.wrapper.style.top=o+"px",this.wrapper.style.width="0px",this.wrapper.style.height="0px",this.isShiftKey=a.shift,this.show())})}show(){this.wrapper.classList.add("box-selection-visible");const e=this.view.system.nodes.map(i=>{const{width:o,height:r}=i.view,{x:a,y:l}=i.view,c=a+this.view.width/2,u=l+this.view.height/2,f=c+o,h=u+r;return{n:i,state:i.view.state,x1:c,y1:u,x2:f,y2:h}});let t=[];const n=this.view.on("mousemove",({mx:i,my:o,x:r,y:a})=>{const{mDownX:l,mDownY:c,downX:u,downY:f,isShiftKey:h}=this,p={x1:Math.min(i,l),x2:Math.max(i,l),y1:Math.min(o,c),y2:Math.max(o,c)};this.wrapper.style.left=p.x1+"px",this.wrapper.style.top=p.y1+"px",this.wrapper.style.width=Math.abs(l-i)+"px",this.wrapper.style.height=Math.abs(c-o)+"px";const d={x1:Math.min(r,u),x2:Math.max(r,u),y1:Math.min(a,f),y2:Math.max(a,f)};t=e.filter(m=>Ma(d,m)?!0:(h||(m.state="normal",m.n.view.state="normal"),!1)).map(({n:m,state:g})=>(g!=="active"&&(g="selected",m.view.state="selected"),m))},5);this.view.once("mouseup",()=>{n(),this.hide(),this.emit("selection",t)})}projectBox(e){const{x:t,y:n}=this.view.projectWindowToLocal(e.x1,e.y1),{x:i,y:o}=this.view.projectWindowToLocal(e.x2,e.y2);return{x1:t,y1:n,x2:i,y2:o}}hide(){this.wrapper.classList.remove("box-selection-visible")}}class Fa{constructor(e){this.connections=[],this.output=e,this.node=e.node,this.wrapper=document.createElement("div"),this.wrapper.classList.add("node-output-wrapper"),this.wrapper.classList.add(`socket-type-${e.type}`),e.node.view.outputWrapper.appendChild(this.wrapper),this.wrapper.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault(),this.node.system.view.createFloatingConnection(this.output)},!1),this.node.system.view.colorStore.on(e.type,t=>{const n=window.getComputedStyle(this.wrapper,null).getPropertyValue("background-color");this.wrapper.style.backgroundColor=n!=="rgba(0, 0, 0, 0)"&&n!=="rgb(0,0,0)"?n:t})}remove(){this.wrapper.remove(),this.connections.forEach(e=>e.remove())}set state(e){this.wrapper.classList.forEach(t=>{t.includes("socket-state-")&&this.wrapper.classList.remove(t)}),e&&e.length&&this.wrapper.classList.add("socket-state-"+e)}updatePosition(){this.rect=this.wrapper.getBoundingClientRect(),this.output.connections.forEach(e=>e.view.setPosition({x1:this.x,y1:this.y}))}get x(){return this.node.view.x+this.node.view.width+3}get y(){const e=this.node.system.view;return(this.rect.y+this.rect.height/2-e.y-e.top)/e.s-e.height/2}}class _t{constructor(e,t){if(this.connections=[],this.node=e,this.type=t,Array.isArray(t))throw new Error("Output can only output one type, not "+t)}bindView(){this.view=new Fa(this)}connectTo(e){const t=this.node.outputs.indexOf(this);return this.node.connectTo(e.node,t,e.key)}removeConnection(e){const t=this.connections.indexOf(e);this.connections.splice(t,1),this.node.disconnectFrom(e.input.node,e.indexIn,e.indexOut),this.view&&this.view.connections.splice(t,1)}setConnection(e){this.connections.push(e),this.view&&this.view.connections.push(e.view)}remove(){this.connections.forEach(e=>e.remove())}}class Ba extends Tr(Qs,ye){constructor(e,t={}){const{system:n}=e.node;super({},e);this.view=n.view,this.path.style.zIndex="999";const i=Array.isArray(e.type)?e.type[0]:e.type;n.view.colorStore.on(i,f=>{this.path.style.stroke=f}),e.view.updatePosition();const o=e.view.x,r=e.view.y;let a=o,l=r;t&&(a=t.x-n.view.width/2,l=t.y-n.view.height/2),this.setPosition({x1:o,y1:r,x2:a,y2:l}),this.dx2=this.x2,this.dy2=this.y2,this.isInput=e instanceof qe,this.allSockets=e instanceof qe?n.getOutputs(e.type):n.getInputs(e.type),this.allSockets.forEach(f=>f.view.state="potential");let c=this.allSockets.filter(f=>f.node.attributes.id!==e.node.attributes.id);c.forEach(f=>f.view.state="middle");const u="connection"in e?[e.connection]:e.connections;if(u&&!!u.length){const f=u.map(h=>[h.input,h.output]).flat();c=c.filter(h=>!f.includes(h))}this.potentialSockets=c,this.potentialSockets.forEach(f=>f.view.updatePosition()),this.potentialSockets.forEach(f=>f.view.state="highlight"),this._unsubMouseUp=this.view.on("mouseup",this.handleMouseUp.bind(this)),this._unsubMouseMove=this.view.on("mousemove",this.handleMouseMove.bind(this)),this.mdx=this.view.mx,this.mdy=this.view.my,this.socket=e}handleMouseUp(e){const{x:t,y:n,keys:i}=e;this._unsubMouseUp(),this._unsubMouseMove(),this.allSockets.forEach(a=>a.view.state="");let o,r=0;this.socket instanceof qe&&this.hoveredSocket instanceof _t?(o=this.socket.key,r=this.hoveredSocket.node.outputs.indexOf(this.hoveredSocket)):this.socket instanceof _t&&this.hoveredSocket instanceof qe&&(o=this.hoveredSocket.key,r=this.socket.node.outputs.indexOf(this.socket)),this.hoveredSocket?(this.emit("connection",{keyIn:o,indexOut:r,inputNode:this.isInput?this.socket.node:this.hoveredSocket.node,outputNode:this.isInput?this.hoveredSocket.node:this.socket.node}),this.remove()):i.ctrlKey?this.view.addMenu.show({x:t,y:n,socket:this.socket}).then(a=>this.view.system.createNode(a)).then(a=>{this.socket instanceof _t?this.socket.node.connectTo(a,r,o):a.connectTo(this.socket.node,r,o)}).catch(()=>{}).finally(()=>{this.remove()}):this.remove()}handleMouseMove(e){const{x:t,y:n}=e;this.mdx||(this.mdx=t,this.mdy=n);const i=this.dx2+(t-this.mdx),o=this.dy2+(n-this.mdy),r=20,a=this.potentialSockets.map(l=>{const{x:c,y:u}=l.view;return{socket:l,distance:Math.abs(i-c)+Math.abs(o-u)}}).filter(l=>l.distance<r).sort((l,c)=>l.distance>c.distance?-1:1).map(l=>l.socket);if(a.length){const{x:l,y:c}=a[0].view;this.hoveredSocket=a[0],this.setPosition({x2:l,y2:c})}else this.hoveredSocket=void 0,this.setPosition({x2:i,y2:o})}remove(){super.remove()}}const Wa=[{color:"#a52a2a",name:"brown"},{color:"#008000",name:"green"},{color:"#4b0082",name:"indigo"},{color:"#f0e68c",name:"khaki"},{color:"#add8e6",name:"lightblue"},{color:"#e0ffff",name:"lightcyan"},{color:"#90ee90",name:"lightgreen"},{color:"#d3d3d3",name:"lightgrey"},{color:"#ffb6c1",name:"lightpink"},{color:"#ffffe0",name:"lightyellow"},{color:"#00ff00",name:"lime"},{color:"#ff00ff",name:"magenta"},{color:"#800000",name:"maroon"},{color:"#000080",name:"navy"},{color:"#808000",name:"olive"},{color:"#ffa500",name:"orange"},{color:"#ffc0cb",name:"pink"},{color:"#800080",name:"purple"},{color:"#800080",name:"violet"},{color:"#ff0000",name:"red"},{color:"#c0c0c0",name:"silver"},{color:"#ffffff",name:"white"}];class Ga extends ye{constructor(){super();this.colors={boolean:"#f00",number:"#fff",plant:"#65e2a0",vec3:"#6363C7"},this.index=0}setType(e){e in this.colors||(this.colors[e]=Wa[this.index].color,this.index++),this.emit(e,this.colors[e])}on(e,t){return this.setType(e),t(this.colors[e]),super.on(e,t)}}class Ua extends ye{constructor(e){super();var t,n,i,o;this.colorStore=new Ga,this.width=0,this.height=0,this.top=0,this.left=0,this.x=window.innerWidth/2,this.y=window.innerHeight/2,this.s=1,this.mx=0,this.my=0,this.mdx=0,this.mdy=0,this.rmx=0,this.rmy=0,this.mouseDown=!1,this.keyMap={},this.selectedNodes=[],this.selectedNodesDown=[],this.clipboard=[],this.system=e,this.wrapper=(n=(t=e.options)==null?void 0:t.wrapper)!=null?n:document.createElement("div"),this.wrapper.classList.add("nodesystem-wrapper"),e.options.parent&&e.options.parent.appendChild(this.wrapper),this.transformWrapper=document.createElement("div"),this.transformWrapper.classList.add("nodesystem-transform"),this.wrapper.appendChild(this.transformWrapper),this.nodeContainer=document.createElement("div"),this.nodeContainer.classList.add("nodes-container"),this.transformWrapper.append(this.nodeContainer),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("viewBox","0 0 1 1"),this.svg.setAttribute("height","1"),this.svg.setAttribute("width","1"),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.style.transform=`scale(${(i=window.devicePixelRatio)!=null?i:1})`,this.transformWrapper.appendChild(this.svg),this.addMenu=new Ra(this),this.boxSelection=new za(this),this.boxSelection.on("selection",r=>{this.selectedNodes=r}),this.dpr=(o=window.devicePixelRatio)!=null?o:1,this.bindEventListeners(),this.handleResize()}createFloatingConnection(e){new Ba(e,{x:this.mx,y:this.my}).once("connection",({inputNode:n,outputNode:i,keyIn:o,indexOut:r})=>{i.connectTo(n,r,o)})}setActive(e,{shiftKey:t=!1,ctrlKey:n=!1}={}){if(!e)this.activeNode&&(this.activeNode.view.state="normal",this.activeNode=void 0),this.selectedNodes.forEach(i=>i.view.state="normal"),this.selectedNodes=[];else if(t&&n){if(this.activeNode&&(this.activeNode.view.state="normal",this.activeNode=void 0),this.activeNode=e,this.activeNode.view.state="active",this.activeNode.outputs.length){const i=this.system.createNode({state:{},attributes:{type:"debug",id:"0",name:"debug",refs:[],pos:{x:this.activeNode.view.x+this.activeNode.view.width+10,y:this.activeNode.view.y}}});i.enableUpdates=!0,this.activeNode.connectTo(i,0,"input")}}else t?this.activeNode?(this.selectedNodes.push(this.activeNode),this.activeNode.view.state="selected",this.activeNode=e,this.activeNode.view.state="active"):(this.activeNode=e,this.activeNode.view.state="active"):this.activeNode?(this.selectedNodes.forEach(i=>i.view.state="normal"),this.selectedNodes=[],this.activeNode!==e&&(this.activeNode.view.state="normal",this.activeNode=e,this.activeNode.view.state="active")):(this.activeNode=e,this.activeNode.view.state="active")}getSelectedNodes(){return this.activeNode&&this.selectedNodes.includes(this.activeNode)?this.selectedNodes:this.activeNode?[...this.selectedNodes,this.activeNode]:[...this.selectedNodes]}projectLocalToWindow(e,t){const n=e+this.x,i=t+this.y,o=n*this.s,r=i*this.s;return{x:o,y:r}}projectWindowToLocal(e,t){const n=e-this.x,i=t-this.y,o=n/this.s,r=i/this.s;return{x:o,y:r}}setTransform({x:e=this.x,y:t=this.y,s:n=this.s}={}){this.x=e,this.y=t,this.s=n/this.dpr,this.panzoom.setTransform(e,t,n/this.dpr)}showAddMenu(){this.addMenu.show({x:this.rmx,y:this.rmy}).then(e=>{const t=this.system.createNode(e);this.setActive(t)}).catch()}bindEventListeners(){window.addEventListener("keydown",e=>this.handleKeyDown(e)),window.addEventListener("keyup",e=>this.handleKeyUp(e)),this.wrapper.addEventListener("mousemove",e=>this.handleMouseMove(e)),this.wrapper.addEventListener("contextmenu",e=>{e.preventDefault(),this.showAddMenu()}),this.wrapper.addEventListener("mousedown",e=>this.handleMouseDown(e)),this.wrapper.addEventListener("touchdown",e=>this.handleMouseDown(e)),this.wrapper.addEventListener("mouseup",e=>this.handleMouseUp(e)),window.addEventListener("resize",dt(()=>this.handleResize(),10)),this.panzoom=ka(this.transformWrapper,{minZoom:.2,maxZoom:5,onTransform:({x:e,y:t,scale:n})=>{this.x=e,this.y=t,this.s=n;const i=(n-.2)/5/2,o=n*this.height*.02,r=n*this.width*.02;this.wrapper.style.setProperty("--scale",Math.abs(i)+""),this.wrapper.style.setProperty("--scale-x",o+"%"),this.wrapper.style.setProperty("--scale-y",r+"%"),this.wrapper.style.setProperty("--pos-x",`${e}px`),this.wrapper.style.setProperty("--pos-y",`${t}px`),this.system.setMetaData({transform:{x:e,y:t,s:n}})}})}handleResize(){const{width:e,height:t,top:n,left:i}=this.wrapper.getBoundingClientRect();this.width=e,this.height=t,this.top=n,this.left=i,this.emit("resize",{width:e,height:t})}handleMouseMove(e){this.ev=e;const{clientX:t,clientY:n,shiftKey:i,ctrlKey:o}=e;this.rmx=t-this.left,this.rmy=n-this.top;const{x:r,y:a}=this.projectWindowToLocal(this.rmx,this.rmy);this.mx=r,this.my=a,this.emit("mousemove",{x:r,y:a,mx:this.rmx,my:this.rmy,keys:_e(te({},this.keyMap),{shiftKey:i,ctrlKey:o})})}handleMouseDown(e){const{shiftKey:t,ctrlKey:n,clientX:i,clientY:o,button:r,target:a}=e;t||this.setActive(),[...e.path].includes(this.addMenu.wrapper)||(this.addMenu.hide(),e.preventDefault()),this.mouseDown=!0,this.rmx=i-this.left,this.rmy=o-this.top;const{x:l,y:c}=this.projectWindowToLocal(this.rmx,this.rmy);this.mx=l,this.my=c,this.selectedNodesDown=this.selectedNodes.map(u=>[u.view.x,u.view.y]),this.emit("mousedown",{x:l,y:c,mx:this.rmx,my:this.rmy,target:a,keys:_e(te({},this.keyMap),{shiftKey:t,ctrlKey:n,button:r})})}handleMouseUp({clientX:e,clientY:t,shiftKey:n,ctrlKey:i}){this.mouseDown=!1;const o=e-this.left,r=t-this.top;this.emit("mouseup",{x:o,y:r,keys:_e(te({},this.keyMap),{shiftKey:n,ctrlKey:i})})}handleKeyUp({key:e}){e===" "&&(e="space"),delete this.keyMap[e&&e.toLowerCase()],this.emit("keyup",{key:e,keys:this.keyMap})}handleKeyDown({key:e,ctrlKey:t,shiftKey:n}){switch(e=e===" "?"space":e.toLowerCase(),this.keyMap[e&&e.toLowerCase()]=!0,e==="space"&&this.ev&&this.handleMouseDown(this.ev),e){case"escape":this.addMenu.hide();break;case"a":n&&this.showAddMenu();break;case"c":if(n&&t)localStorage.clear(),window.location.reload();else if(t){const i=this.selectedNodes.splice(0);this.activeNode&&!i.includes(this.activeNode)&&i.push(this.activeNode),this.clipboard=i.map(o=>o.deserialize())}else this.selectedNodes.length&&this.activeNode&&this.selectedNodes[0].connectTo(this.activeNode);break;case"f":this.setTransform({x:0,y:0,s:1});break;case"g":this.keyMap.g||(this.mdx=this.mx,this.mdy=this.my,this.selectedNodesDown=this.selectedNodes.map(i=>[i.view.x,i.view.y]));break;case"x":this.activeNode&&(t?this.system.spliceNode(this.activeNode):this.system.removeNode(this.activeNode)),this.selectedNodes.forEach(i=>i.remove());break;case"z":this.system.history&&t&&(n?this.system.history.redo():this.system.history.undo());break;case"l":this.activeNode&&(console.log(this.activeNode),console.log(this.activeNode.deserialize()));break;case"v":if(t){const i=this.clipboard.sort((c,u)=>{const{pos:{x:f=0,y:h=0}={}}=c.attributes,{pos:{x:p=0,y:d=0}={}}=u.attributes;return f+h<p+d?-1:1});let{pos:{x:o=0,y:r=0}={}}=i[0].attributes;const{x:a,y:l}=this.projectWindowToLocal(this.mx,this.my);o-=a,r-=l,this.clipboard.map(c=>{const{pos:{x:u=0,y:f=0}={}}=c.attributes;return c.attributes.pos={x:u-o,y:f-r},c}).forEach(c=>this.system.createNode(c))}break}this.emit("keydown",{key:e,keys:_e(te({},this.keyMap),{ctrlKey:t})})}}class Ha{constructor(e){this.id=Rr(),this.system=e,this.log=new yt(this),this.log.info("Initialized")}reset(){this.id.reset(),this.log.info("Reset id generator")}create(e){const{attributes:t}=e,n=t.type.toLowerCase(),i=this.system.store.getByName(n);t.id=this.id(+t.id);const o=new i.node(this.system,e);if(this.system.options.view&&i.view){const r=new i.view(o);o.bindView(r)}return n==="output"&&this.system.setOutputNode(o),this.log.info(`Created node with type ${t.type}`,e),o}}class Ya{constructor(e){this.system=e,this.history=[],this.historyIndex=-1,this.isApplyingChanges=!1,this.log=new yt(this),this.log.info("Instantiated"),this.addAction=(()=>{let t;return()=>{!this.system.isLoaded||this.isApplyingChanges||(t?clearTimeout(t):this.prevState=this.system.serialize().nodes,t=setTimeout(()=>{this._addAction(),t=!1},200))}})().bind(this)}_addAction(){if(this.log.info("Register History Step"),this.isApplyingChanges)return;this.historyIndex!==this.history.length-1&&(this.history.length=this.historyIndex+1);const e=this.system.serialize().nodes,[t,n]=Pa(this.prevState,e);!n||!t||(this.history.push({previous:n,next:t}),this.history.length>60&&(this.history=this.history.reverse().slice(0,60).reverse()),this.historyIndex=this.history.length-1)}serialize(){return{steps:this.history,index:this.historyIndex}}deserialize(e){this.historyIndex=e.index,this.history=e.steps}undo(){if(this.isApplyingChanges)return;if(this.isApplyingChanges=!0,this.historyIndex<0){this.log.info("Reached beginning of Stack"),this.isApplyingChanges=!1;return}const{previous:e}=this.history[this.historyIndex],t=this.system.serialize(),n=wt(t.nodes,e);t.nodes=n,this.system.load(t),this.historyIndex--,this.isApplyingChanges=!1}redo(){if(this.isApplyingChanges)return;if(this.isApplyingChanges=!0,this.historyIndex>=this.history.length-1){this.log.info("Reached end of Stack"),this.isApplyingChanges=!1;return}const{next:e}=this.history[this.historyIndex+1],t=this.system.serialize(),n=wt(t.nodes,e);t.nodes=n,this.system.load(t),this.historyIndex++,this.isApplyingChanges=!1}}class Xa{constructor(e){this.system=e}parseSystem(e){const{nodes:t}=e,n=new Map,i=t.map(o=>{const r=this.system.factory.create(o);return r.enableUpdates=!1,n.set(r.id,r),r});return i.forEach(o=>{o.attributes.refs&&o.attributes.refs.forEach(r=>{const a=n.get(r.id);if(!a)throw new Error(`Failed ref: from ${o.attributes.name||o.attributes.id} to ${r.id} `);o.connectTo(a,r.out,r.in)})}),i.forEach(o=>{o.enableUpdates=!0,o.update()}),i}parseType(e){const{compute:t,meta:n,outputs:i,title:o,parameters:r}=e,a=class extends Qt{constructor(c,u){super(c,u);if(t&&(this.compute=t),i){const f=Array.isArray(i)?i:[i];this.outputs=f.map(h=>new _t(this,h))}Object.entries(r).forEach(([f,h])=>{this.states[f]=new en(this,f,h)})}},l=Object.values(r).filter(c=>c.internal!==!0).map(c=>c.type);if(this.system.options.view){const c=class extends tn{constructor(f){super(f)}};return _e(te({},e),{inputs:l,title:o,meta:n,node:a,view:c})}return _e(te({inputs:l},e),{title:o,meta:n,node:a})}getData(){return{meta:this.system.meta,nodes:this.system.nodes.map(e=>e.deserialize())}}}const qa=ce("NodeTypeStore");class Ja extends ye{constructor(){super();this.types=[],this.typeMap={}}add(e){qa("register new type "+e.title,e),this.types=[...this.types.filter(t=>t.title.toLowerCase()!==e.title.toLowerCase()),e],this.typeMap[e.title.toLowerCase()]=e,this.emit("types",this.types),this.emit("type",e)}getByName(e){if(e.toLowerCase()in this.typeMap)return this.typeMap[e.toLowerCase()];if(e in this.typeMap)return this.typeMap[e];throw new Error("NodeTypeStore: type "+e+" does not exist")}}var Za=Object.defineProperty,Ka=Object.getOwnPropertyDescriptor,Qa=(s,e,t,n)=>{for(var i=n>1?void 0:n?Ka(e,t):e,o=s.length-1,r;o>=0;o--)(r=s[o])&&(i=(n?r(e,t,i):r(i))||i);return n&&i&&Za(e,t,i),i};let ec=0;class on extends ye{constructor(e={}){super();this.parser=new Xa(this),this.meta={lastSaved:Date.now()},this.isLoaded=!1,this.isPaused=!1,this.nodes=[],this.states=[],this.id=ec++;const{view:t=!1,wrapper:n,defaultNodes:i=!1,registerNodes:o=!1,logLevel:r=5}=e;this.options={view:t,wrapper:n};try{if(this.log=new yt(this,r),this.log.group(`Instantiated id:${this.id}`),this.store=new Ja,this.factory=new Ha(this),this.history=new Ya(this),t&&(this.view=new Ua(this)),i){const a=[];i===!0?a.push(...Object.entries(nn).map(l=>l[1])):Array.isArray(i)&&i.length&&i.forEach(l=>{typeof l=="string"&&l in nn&&a.push(nn[l])}),a.forEach(l=>this.registerNodeType(l))}o&&o.length&&o.forEach(this.registerNodeType.bind(this)),this.log.groupEnd()}catch(a){this.emit("error",{type:"init",error:a})}}get result(){return this._result}set result(e){this._result=e,this.isLoaded&&this.emit("result",e)}setMetaData(e){this.meta=te(te({},this.meta),e),this.save()}load(e){var t;try{this.isLoaded=!1,this.isPaused=!0,this.nodes.forEach(i=>i.enableUpdates=!1),this.nodes.forEach(i=>i.remove()),this.factory.reset();const n=this.parser.parseSystem(e);return this.addNodes(n),this.meta=e.meta||{lastSaved:0},this.meta.lastSaved=Date.now(),(t=this==null?void 0:this.view)==null||t.setTransform(this.meta.transform),this.log.info(`Loaded NodeSystemData with ${n.length} Nodes`,e),"history"in e&&this.history.deserialize(e.history),this.isPaused=!1,this.isLoaded=!0,this.result=this._result,this}catch(n){this.emit("error",{type:"loading",error:n})}}serialize(){return _e(te({},this.parser.getData()),{history:this.history.serialize(),meta:this.meta})}save(){this.isLoaded&&(this.meta.lastSaved=Date.now(),this.log.info("save system",this.serialize()),this.emit("save",this.serialize()))}setOutputNode(e){this.outputNode&&this.outputNode.remove(),this.outputNode=e,e.on("computedData",t=>this.result=t)}addNodes(e){e.forEach(t=>this.addNode(t))}addNode(e){this.history.addAction(),this.nodes.push(e),this.save()}removeNode(e){this.history.addAction(),e.enableUpdates=!1,e.view.remove(),Object.values(e.states).forEach(t=>t.remove()),e.outputs.forEach(t=>t.remove()),e.getInputs().forEach(t=>t.remove()),this.nodes=this.nodes.filter(t=>t!==e),this.save(),this.log.info(`Removed Node id:${e.id} type:${e.attributes.type}`,e.deserialize())}spliceNode(e){const t=e.getInputs().map(i=>{var o;return(o=i==null?void 0:i.connection)==null?void 0:o.output}),n=e.outputs.map(i=>i.connections).flat().map(i=>i.input);for(let i=0;i<t.length;i++){const o=t[i],r=n[i];!r||!o||o.connectTo(r)}return this.removeNode(e)}getSockets(e){const t=this.nodes.map(n=>[...n.getSockets()]).flat();return e?t.filter(n=>n.type===e):t}getInputs(e){const t=this.nodes.map(n=>n.getInputs()).flat();return!e||e==="*"?t:t.filter(n=>n.type.includes("*")||n.type.includes(e))}getOutputs(e){const t=this.nodes.map(n=>n.outputs).flat();return!e||e.includes("*")?t:t.filter(n=>n.type==="*"||e.includes(n.type))}createNode(e){const t=this.factory.create(e);return this.addNode(t),this.save(),this.log.info(`Created new node id:${e.attributes.id} type:${e.attributes.type}`,e),t}getNodes(){return this.nodes}findNodeById(e){return this.nodes.filter(t=>t.id===e)[0]}getNodeTypes(){return this.store.types}registerNodeType(e){if("node"in e)this.store.add(e);else{const t=this.parser.parseType(e);this.store.add(t)}this.log.info(`Registered new nodeType type:${e.title}`,e)}}Qa([Vr(1e3)],on.prototype,"save",1);const tc=JSON.parse(localStorage.getItem("pt_local_state")),Je=te({},tc),nc=ds((s,e)=>{Je[s]=e,localStorage.setItem("pt_local_state",JSON.stringify(Je))},100,!1);var we={get(s,e){var t;return Je[s]=(t=Je[s])!=null?t:e,Je[s]},set:nc};var bf=(()=>{let s=Math.random();return()=>(s=s>0?s-Math.random():s+Math.random(),s.toString().split(".")[1])})();const sc={};Zt.forEach(s=>{sc[s.type]=s,"computeSkeleton"in s&&(s.computeSkeleton=Vt(s.computeSkeleton)),"computeGeometry"in s&&(s.computeGeometry=Vt(s.computeGeometry)),"computeValue"in s&&(s.computeValue=Vt(s.computeValue))});const kf=ce("gen.plant");function ic(){return new Worker("assets/webWorker.5d7c92aa.js",{type:"module"})}var ni=()=>{const s=ic(),e=Oo(s);let t=!1;async function n(i,o){if(t)return;t=!0;const r=await e.plant(i,o);return t=!1,r}return{plant:n}};let si=0;class ii extends ye{constructor({canvas:e,width:t,height:n,clearColor:i="ffffff",alpha:o=!1,camPos:r=[0,2,4]}={}){super();if(this.scene=new Io,this.lastCamPos=new Ae(0,0,0),this.canvas=e,(!t||!n)&&e){const a=e.getBoundingClientRect();t=a.width,n=a.height}this.renderer=new Ao({canvas:e,width:t,premultipliedAlpha:!0,height:n,alpha:o,antialias:!0,dpr:1}),this.gl=this.renderer.gl,this.gl.clearColor(...hs(i),0),this.renderer.gl.canvas&&(this.canvas=this.renderer.gl.canvas),this.camera=new Vo(this.gl,{fov:70,aspect:t/n}),this.lastCamPos.set(r),this.camera.position.set(r),this.camera.lookAt(new Ae(0,0,0)),e&&(this.controls=new Do(this.camera,{element:e,target:new Ae(0,.2,0),maxPolarAngle:1.6,minDistance:.2,maxDistance:15,ease:.7,rotateSpeed:.5,inertia:.5})),this.bindEventlisteners(),e&&this.render()}setControlTarget(e){Number.isNaN(e.x)||(this.controlTarget||(this.controls.target=e),this.controlTarget=e)}setClearColor(e){this.gl.clearColor(...hs(e),1)}renderScene(e){this.renderer.render({scene:e,camera:this.camera})}render(){requestAnimationFrame(this.render.bind(this)),this.lastCamPos.equals(this.camera.position)||(this.lastCamPos.set(this.camera.position),this.emit("camPos",this.camera.position.toArray())),this.controlTarget&&(this.controlTarget.squaredDistance(this.controls.target)<5e-5?this.controls.target=this.controlTarget:this.controls.target.lerp(this.controlTarget,.05)),window.target=this.controls.target,this.controls.update(),this.renderer.render({scene:this.scene,camera:this.camera}),this.emit("perf",performance.now()-si),si=performance.now()}bindEventlisteners(){const e=dt(()=>this.handleResize(),500);window.addEventListener("resize",()=>{this.canvas.classList.add("resizing"),e()})}handleResize(){let e=this.canvas.parentElement;e||(e=this.canvas);const{width:t,height:n}=e.getBoundingClientRect();this.renderer.setSize(t,n),this.camera.perspective({aspect:this.gl.canvas.width/this.gl.canvas.height}),this.canvas.classList.remove("resizing")}}var oc=`precision highp float;precision highp int;
#define GLSLIFY 1
uniform float uTime;uniform sampler2D tMap;uniform vec3 uFogColor;uniform float uFogNear;uniform float uFogFar;uniform float texScale;varying vec2 vUv;varying vec4 vMVPos;varying vec3 vPos;void main(){vec3 tex=texture2D(tMap,vUv*texScale).rgb;float dist=length(vMVPos);float fog=smoothstep(uFogNear,uFogFar,dist);tex=mix(tex,uFogColor,fog);tex=mix(tex,uFogColor,smoothstep(0.0,-1.0,vPos.y));gl_FragColor.rgb=tex;}`,rc=`precision highp float;precision highp int;
#define GLSLIFY 1
attribute vec2 uv;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform float uTime;varying vec2 vUv;varying vec4 vMVPos;varying vec3 vPos;void main(){vUv=uv;vec3 pos=position;vPos=pos;vMVPos=modelViewMatrix*vec4(pos,1.0);gl_Position=projectionMatrix*vMVPos;}`,lc=`#version 300 es
precision highp float;
#define varying in
#define texture2D texture
#define gl_FragColor FragColor
out vec4 FragColor;precision highp float;
#define GLSLIFY 1
uniform sampler2D tMap;varying vec4 vMVPos;vec3 normals(vec3 pos){vec3 fdx=dFdx(pos);vec3 fdy=dFdy(pos);return normalize(cross(fdx,fdy));}vec2 matcap(vec3 eye,vec3 normal){vec3 reflected=reflect(eye,normal);float m=2.8284271247461903*sqrt(reflected.z+1.0);return reflected.xy/m+0.5;}void main(){vec3 normal=normals(vMVPos.xyz);vec3 mat=texture2D(tMap,matcap(normalize(vMVPos.xyz),normal)).rgb;gl_FragColor.rgb=mat;gl_FragColor.a=1.0;}`,ac=`#version 300 es
#define GLSLIFY 1
#define attribute in
#define varying out
attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;varying vec4 vMVPos;void main(){vMVPos=modelViewMatrix*vec4(position,1.0);gl_Position=projectionMatrix*vMVPos;}`,cc=`precision highp float;
#define GLSLIFY 1
float pointSize=0.02;varying float distToCamera;void main(){vec2 uv=gl_PointCoord.xy;float dist=2.0-distToCamera;float circle=pointSize*dist>length(uv-0.5)?0.8:0.0;float xMask=min(abs(uv.x-0.5),abs(uv.y-0.5));circle=xMask>0.003?0.0:circle;gl_FragColor.rgb=vec3(0.0,0.0,0.0);gl_FragColor.a=circle;}`,uc=`#define GLSLIFY 1
attribute vec3 position;uniform mat4 modelMatrix;uniform mat4 viewMatrix;uniform mat4 projectionMatrix;varying float distToCamera;void main(){vec4 mPos=modelMatrix*vec4(position,1.0);vec4 mvPos=viewMatrix*mPos;gl_PointSize=300.0/length(mvPos.xyz);distToCamera=-mvPos.z/10.0+1.0;gl_Position=projectionMatrix*mvPos;}`,fc=`precision highp float;precision highp int;
#define GLSLIFY 1
void main(){gl_FragColor=vec4(1.,.9,.4,.7);}`,hc=`precision highp float;precision highp int;
#define GLSLIFY 1
attribute vec2 uv;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat3 normalMatrix;void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}`;const oi={fragment:oc,vertex:rc},ri={fragment:fc,vertex:hc},li={fragment:cc,vertex:uc},ai=s=>{const e=new Yn(s),t=new Image;return t.onload=()=>e.image=t,t.src="assets/matcap_green.jpg",new ct(s,{vertex:ac,fragment:lc,uniforms:{tMap:{value:e}},cullFace:null})},dc=ni(),ue=new ii({width:100,height:100,alpha:!0,clearColor:"000"}),ci=new on({view:!1,defaultNodes:!1,registerNodes:Zt}),Oe=new Jn(ue.gl,{geometry:new Zn(ue.gl,{width:0,height:0,depth:0}),program:ai(ue.gl)}),Ze=document.createElement("canvas");Ze.width=Ze.height=100;const Be=Ze.getContext("2d");Oe.setParent(ue.scene);async function pc({pd:s,geo:e}){ci.load(s);const t=ci.result;let n;if(e&&(n=e),s&&!n&&(n=(await(await dc).plant(t,{stemResX:12,stemResY:12})).geometry),!n)return;Oe.geometry=Xt(ue.gl,n),Oe.geometry.computeBoundingBox(),ue.camera.position.x=Oe.geometry.bounds.center.x,ue.camera.position.y=Oe.geometry.bounds.center.y;const o=(Oe.geometry.bounds.max.y-Oe.geometry.bounds.center.y)*2/2/Math.tan(Math.PI*ue.camera.fov/360);ue.camera.position.z=o,ue.camera.lookAt(Oe.geometry.bounds.center),ue.renderScene(ue.scene),Be.clearRect(0,0,100,100);for(let r=0;r<1;r++)Be.drawImage(Ze,0,0),Be.drawImage(ue.canvas,0,0),Be.filter="blur(7px) opacity(0.6) brightness(0.95)";return Be.filter="blur(0px) drop-shadow(0px 0px 10px rgba(0, 0, 0, 0.8))",Be.drawImage(ue.canvas,0,0),Ze.toDataURL("image/webp",1)}class mc{constructor(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}}class vc{constructor(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}}class gc{constructor(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}}class wc{constructor(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}class yc{constructor(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}const _c=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,bc=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ui=3,kc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",_c]],fi=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function hi(s){return s?di(s):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new yc:typeof navigator!="undefined"?di(navigator.userAgent):xc()}function Sc(s){return s!==""&&kc.reduce((e,[t,n])=>{if(e)return e;const i=n.exec(s);return!!i&&[t,i]},!1)}function di(s){const e=Sc(s);if(!e)return null;const[t,n]=e;if(t==="searchbot")return new wc;let i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<ui&&(i=[...i,...Pc(ui-i.length)]):i=[];const o=i.join("."),r=Mc(s),a=bc.exec(s);return a&&a[1]?new gc(t,o,r,a[1]):new mc(t,o,r)}function Mc(s){for(let e=0,t=fi.length;e<t;e++){const[n,i]=fi[e];if(i.exec(s))return n}return null}function xc(){return typeof process!="undefined"&&process.version?new vc(process.version.slice(1)):null}function Pc(s){const e=[];for(let t=0;t<s;t++)e.push("0");return e}function Nc(){return"window"in globalThis}let pi={};(()=>{"sessionStorage"in globalThis||(globalThis.sessionStorage={getItem:s=>{},setItem:(s,e)=>{}})})();if("user"in sessionStorage)try{pi=JSON.parse(sessionStorage.getItem("user"))}catch{}const mi=me(pi);mi.subscribe(s=>{sessionStorage.setItem("user",JSON.stringify(s))});const bt=mi,{VITE_API_URL:Lc="http://localhost:3000"}={VITE_API_URL:"https://plant-api.jim-fx.com",BASE_URL:"",MODE:"production",DEV:!1,PROD:!0};function jc(s){const t=s.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}const vi=Nc(),kt=(()=>{let s=vi&&localStorage.getItem("token");function e(){if(!s||s.length<10){bt.set({});return}const t=jc(s);bt.set({username:t.username,id:t.sub})}return e(),{set token(t){s=t,vi&&localStorage.setItem("token",t),e()},get token(){return s}}})();async function Ee({method:s,path:e,data:t,isJSON:n=!0}){const i={method:s,headers:{}};t&&(i.headers["Content-Type"]="application/json",i.body=JSON.stringify(t)),kt.token&&(i.headers["access-token"]=`Bearer ${kt.token}`);const o=await fetch(`${Lc}/${e}`,i);if(o.ok){if(n)try{return await o.json()}catch(a){console.error("Response from "+e+" failed to parse"),console.error(a)}return o.text()}const r=await o.json();return console.error(r),r}function gi(s,e={}){return Ee(te({method:"GET",path:s},e))}function Ec(s){return Ee({method:"DELETE",path:s})}function $c(s,e){return Ee({method:"POST",path:s,data:e})}function Cc(s){return Ee({method:"GET",path:`api/report/${s}`})}function Tc(s){return Ee({method:"PUT",path:`api/report/${s}/publish`})}function Oc(s){return Ee({method:"PUT",path:`api/report/${s}/unpublish`})}function Ic(){return Ee({method:"GET",path:"api/report/labels"})}function Ac(s,e){return Ee({method:"PUT",path:`api/report/${s}`,data:{labels:e}})}var Vc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getReport:Cc,publishReport:Tc,unpublishReport:Oc,getAvailableLabels:Ic,setReportLabels:Ac});async function Dc(s,e){const t=await $c("api/auth/login",{username:s,password:e});kt.token=t.access_token}function Rc(){kt.token=""}function wi(s){return Ee({method:"POST",path:"api/report",data:s})}function zc(s){return Ec(`api/report/${s}`)}async function Fc(){const s=await gi("api/user/role",{isJSON:!1});return bt.update(e=>(e.role=s,e)),s}async function Bc(){const s=await gi("api/user/permission");return bt.update(e=>(e.permissions=s,e)),s}var Wc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",login:Dc,logout:Rc,submitReport:wi,deleteReport:zc,getRole:Fc,getPermission:Bc});te(te({},Vc),Wc);const Pe=ce("ProjectManager"),rn="pt_project_";class Gc extends ye{constructor(){super();this.activeProject=me(),this.projects={},this.store=me([]),this.loadProjects()}createNewProject(){const e=Object.values(this.projects).filter(n=>/^DefaultProject((\d)+)?/.test(n.meta.name)).length,t={meta:{name:"DefaultProject"+(e||""),id:Et(),transform:{x:0,y:0,s:1}},nodes:[{attributes:{pos:{x:-100,y:0},type:"stem",id:"1",refs:[{id:"0",in:"main",out:0}]}},{attributes:{pos:{x:0,y:0},type:"output",id:"0",refs:[]}}]};return Pe("created new plant",t),t}createNew(){const e=this.createNewProject();this.emit("new",e),this.saveProject(e)}async updateProjectMeta(e,t){const n=await this.getProject(e);n.meta=te(te({},n.meta),t),Pe("update meta",e),this.emit("update",n),this.saveProject(n)}async saveProject(e){var n;const t=JSON.parse(JSON.stringify(e));this.projects[t.meta.id]=t,this.emit("save",t),((n=t==null?void 0:t.meta)==null?void 0:n.thumbnail)||this.renderThumbnail({project:t}),await Se.setItem("pt_project_ids",Object.keys(this.projects)),await Se.setItem(rn+t.meta.id,t),Pe("saved plant id: ",t.meta.id),this.store.set(Object.values(this.projects))}async getProject(e){if(e in this.projects)return this.projects[e];const t=await Se.getItem(rn+e);return this.projects[e]=t,t}async deleteProject(e){e in this.projects?(delete this.projects[e],await Se.removeItem(rn+e),await Se.setItem("pt_project_ids",Object.keys(this.projects)),this.store.set(Object.values(this.projects)),this.emit("delete",e),Pe("deleted project with id: "+e)):Pe.warn("cant delete project with id: "+e)}async setActiveProject(e){if(this.loadingActiveProject&&await this.loadingActiveProject,e===this.activeProjectId)return;this.activeProjectId=e,this.loadingActiveProject=this.getProject(e);const t=await this.loadingActiveProject;this.loadingActiveProject?(this.activeProjectId=e,this.saveProject(t),this.activeProject.set(t),await Se.setItem("pt_active_id",e),Pe("set active project to id: "+e),this.emit("load",t),delete this.loadingActiveProject):Pe.warn("cant find plant with id: "+e)}async renderThumbnail({project:e,geo:t}){var a;const n=((a=e==null?void 0:e.meta)==null?void 0:a.id)||this.activeProjectId;if(!(n in this.projects))return;const i=performance.now(),o=await pc(t?{geo:t}:{pd:e}),r=performance.now()-i;this.projects[n].meta.thumbnail=o,Pe("generated thumbnail for "+n+" in "+Math.floor(r)+"ms"),this.saveProject(this.projects[n]),this.store.set(Object.values(this.projects))}async loadProjects(){const e=await Se.getItem("pt_project_ids")||[];Pe("loaded project ids",e);const t=await Se.getItem("pt_active_id");if(!e.length){const n=this.createNewProject();e.push(n.meta.id),await this.saveProject(n)}await Promise.all(e.map(async n=>{const i=await this.getProject(n);Pe("loaded ",n),this.projects[n]=i})),t&&e.includes(t)?this.setActiveProject(t):this.setActiveProject(e[0]),this.store.set(Object.values(this.projects))}setProject(e){this.plant=e,this.emit("plant",e)}getActiveProject(){return this.plant}setSettings(e){this.emit("settings",e)}}function Uc(s){let e,t,n,i,o,r,a,l,c,u=ps(Date.now()-s[0].meta.lastSaved)+"",f,h,p,d,m,g,w,x,_;return{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),o=b("div"),r=b("input"),l=E(),c=b("p"),f=X(u),h=X(" ago"),p=E(),d=b("div"),m=E(),g=b("div"),w=b("button"),w.textContent="delete",v(t,"class","project-image svelte-cu2aw0"),I(t,"background-image","url("+s[0].meta.thumbnail+")"),v(r,"contenteditable",""),r.value=a=s[0].meta.name,v(r,"class","svelte-cu2aw0"),v(c,"class","svelte-cu2aw0"),v(o,"class","project-content-header svelte-cu2aw0"),v(d,"class","project-content-main svelte-cu2aw0"),v(w,"class","delete svelte-cu2aw0"),v(g,"class","project-content-footer svelte-cu2aw0"),v(i,"class","project-content svelte-cu2aw0"),v(e,"class","project-wrapper svelte-cu2aw0"),D(e,"active",s[0].meta.id===le.activeProjectId||s[1])},m(k,C){P(k,e,C),y(e,t),y(e,n),y(e,i),y(i,o),y(o,r),y(o,l),y(o,c),y(c,f),y(c,h),y(i,p),y(i,d),y(i,m),y(i,g),y(g,w),x||(_=[B(r,"blur",s[3]),B(r,"keydown",s[4]),B(w,"click",Ct(s[5])),B(e,"resize",alert),B(e,"click",s[6])],x=!0)},p(k,[C]){C&1&&I(t,"background-image","url("+k[0].meta.thumbnail+")"),C&1&&a!==(a=k[0].meta.name)&&r.value!==a&&(r.value=a),C&1&&u!==(u=ps(Date.now()-k[0].meta.lastSaved)+"")&&se(f,u),C&3&&D(e,"active",k[0].meta.id===le.activeProjectId||k[1])},i:O,o:O,d(k){k&&M(e),x=!1,Ce(_)}}}function Hc(s,e,t){let{project:n}=e,i=!1;function o(){return t(1,i=!0),setTimeout(()=>{t(1,i=!1)},100),!0}const r=function(){const u=this.value.split(`
`).join("").trim();le.updateProjectMeta(n.meta.id,{name:u})},a=function(u){if(u.key==="Enter"){const f=this.value.split(`
`).join("").trim();this.blur(),u.preventDefault(),le.updateProjectMeta(n.meta.id,{name:f})}},l=()=>le.deleteProject(n.meta.id),c=()=>o()&&le.setActiveProject(n.meta.id);return s.$$set=u=>{"project"in u&&t(0,n=u.project)},[n,i,o,r,a,l,c]}class Yc extends Z{constructor(e){super();K(this,e,Hc,Uc,Q,{project:0})}}function yi(s,e,t){const n=s.slice();return n[9]=e[t],n}function Xc(s){let e;return{c(){e=b("div"),v(e,"class","svelte-7wgw1o")},m(t,n){P(t,e,n)},p:O,d(t){t&&M(e)}}}function qc(s){let e,t,n;return{c(){e=b("input"),v(e,"type","text"),v(e,"class","search svelte-7wgw1o"),v(e,"placeholder","Search")},m(i,o){P(i,e,o),ve(e,s[1]),t||(n=B(e,"input",s[8]),t=!0)},p(i,o){o&2&&e.value!==i[1]&&ve(e,i[1])},d(i){i&&M(e),t=!1,n()}}}function _i(s){let e,t,n=s[2],i=[];for(let r=0;r<n.length;r+=1)i[r]=ki(yi(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){e=b("div");for(let r=0;r<i.length;r+=1)i[r].c();v(e,"class","project-list svelte-7wgw1o")},m(r,a){P(r,e,a);for(let l=0;l<i.length;l+=1)i[l].m(e,null);t=!0},p(r,a){if(a&6){n=r[2];let l;for(l=0;l<n.length;l+=1){const c=yi(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=ki(c),i[l].c(),S(i[l],1),i[l].m(e,null))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){r&&M(e),de(i,r)}}}function bi(s){let e,t;return e=new Yc({props:{project:s[9]}}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.project=n[9]),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ki(s){let e=Si(s[1],s[9]),t,n,i=e&&bi(s);return{c(){i&&i.c(),t=oe()},m(o,r){i&&i.m(o,r),P(o,t,r),n=!0},p(o,r){r&6&&(e=Si(o[1],o[9])),e?i?(i.p(o,r),r&6&&S(i,1)):(i=bi(o),i.c(),S(i,1),i.m(t.parentNode,t)):i&&(H(),N(i,1,1,()=>{i=null}),Y())},i(o){n||(S(i),n=!0)},o(o){N(i),n=!1},d(o){i&&i.d(o),o&&M(t)}}}function Jc(s){let e,t,n,i,o,r,a,l,c,u;t=new Ro({}),t.$on("resize",s[6]);function f(m,g){return m[2].length>3?qc:Xc}let h=f(s),p=h(s),d=s[0]&&_i(s);return{c(){e=b("div"),R(t.$$.fragment),n=E(),i=b("div"),o=b("button"),o.innerHTML='<p class="svelte-7wgw1o">new</p>',r=E(),p.c(),a=E(),d&&d.c(),v(o,"class","add-new svelte-7wgw1o"),v(i,"class","header svelte-7wgw1o"),v(e,"class","project-manager-wrapper svelte-7wgw1o"),v(e,"style",`width: ${s[4]}px; height: ${s[5]}px;`)},m(m,g){P(m,e,g),z(t,e,null),y(e,n),y(e,i),y(i,o),y(i,r),p.m(i,null),y(e,a),d&&d.m(e,null),l=!0,c||(u=B(o,"click",s[7]),c=!0)},p(m,[g]){h===(h=f(m))&&p?p.p(m,g):(p.d(1),p=h(m),p&&(p.c(),p.m(i,null))),m[0]?d?(d.p(m,g),g&1&&S(d,1)):(d=_i(m),d.c(),S(d,1),d.m(e,null)):d&&(H(),N(d,1,1,()=>{d=null}),Y())},i(m){l||(S(t.$$.fragment,m),S(d),l=!0)},o(m){N(t.$$.fragment,m),N(d),l=!1},d(m){m&&M(e),F(t),p.d(),d&&d.d(),c=!1,u()}}}function Si(s,e){if(!s||s.length<1)return!0;const t=e.meta.name.toLowerCase();return s=s.toLowerCase(),!!(t.includes(s)||s.includes(t))}function Zc(s,e,t){let n;const{store:i}=le;be(s,i,h=>t(2,n=h));let{visible:o}=e,r;const{width:a,height:l}=we.get("projectManagerSize",{width:300,height:window.innerHeight/2}),c=h=>{o&&we.set("projectManagerSize",{width:h.detail.clientWidth,height:h.detail.clientHeight})},u=()=>le.createNew();function f(){r=this.value,t(1,r)}return s.$$set=h=>{"visible"in h&&t(0,o=h.visible)},[o,r,n,i,a,l,c,u,f]}class Kc extends Z{constructor(e){super();K(this,e,Zc,Jc,Q,{visible:0})}}const ln={enableSync:{type:"boolean",defaultValue:!1},useRandomSeed:{type:"boolean",defaultValue:!1},theme:{type:"select",values:["dark","light"],defaultValue:"dark"},debug:{onlyDev:!0,options:{renderPerf:{type:"boolean",defaultValue:!1},generatePerf:{type:"boolean",defaultValue:!1},pd:{type:"boolean",defaultValue:!1},skeleton:{type:"boolean",defaultValue:!1},wireframe:{type:"boolean",defaultValue:!1},logLevel:{type:"number",min:0,max:2,defaultValue:1}}},background:{options:{grid:{label:"Show Grid",type:"boolean",defaultValue:!1},ground:{label:"Show Ground",type:"boolean",defaultValue:!0},resX:{onlyDev:!0,type:"number",min:8,max:64,step:1,defaultValue:8},resY:{onlyDev:!0,type:"number",min:8,max:64,step:1,defaultValue:16},scale:{type:"number",min:0,max:5,step:.1,defaultValue:1}}},leafRes:{onlyDev:!0,type:"number",min:3,max:12,step:1,defaultValue:2},stemResX:{onlyDev:!0,type:"number",min:3,max:32,step:1,defaultValue:3},stemResY:{onlyDev:!0,type:"number",min:3,max:64,step:1,defaultValue:32},isDev:{label:"Advanced",type:"boolean",defaultValue:!1}},an=ce("SettingsManager"),Mi=(s,e)=>{const t={};return Object.entries(s).forEach(([n,i])=>{var r;const o=e&&n in e?e[n]:void 0;"options"in i?t[n]=Mi(i.options,o):t[n]=(r=o!=null?o:i.defaultValue)!=null?r:i.value}),t},cn=(s,e)=>{const t=e.shift();if(t&&t in s)return e.length?cn(s[t],e):s[t]},xi=s=>s.includes(".")?s.split("."):[s];class Qc extends ye{constructor(){super();this.settings={},this.store=me(this.settings),this._save=ds(()=>{Se.setItem("pt_settings",this.settings)},500,!1)}save(){var e,t,n;this.emit("settings",this.settings),ce.setLevel((n=(t=(e=this.settings)==null?void 0:e.debug)==null?void 0:t.logLevel)!=null?n:2),this.store.set(this.settings),an("save settings",this.settings),this._save()}async loadFromLocal(){var t,n,i;const e=await Se.getItem("pt_settings")||{};this.settings=Mi(ln,e),ce.setLevel((i=(n=(t=this.settings)==null?void 0:t.debug)==null?void 0:n.logLevel)!=null?i:2),this.store.set(this.settings),an("loaded settings from local",this.settings),this.emit("settings",this.settings)}set(e,t){const n=xi(e);if(n.length>1){const i=n.pop(),o=cn(this.settings,n);o&&(o[i]=t)}else this.settings[n[0]]=t;an(`Set ${n}`,t),this.emit(n+".update",t),this.save()}get(e){return cn(this.settings,xi(e))}getSettings(){return JSON.parse(JSON.stringify(this.settings))}}let eu=0;const un=we.get("sections")||[];var tu=()=>{const s=eu++;return{get(){return un[s]||!1},set(e){un[s]=e,we.set("sections",un)}}};function Pi(s,e,t){const n=s.slice();return n[11]=e[t][0],n[12]=e[t][1],n}function Ni(s){let e,t,n,i,o;const r=[su,nu],a=[];function l(c,u){return c[3].options?0:1}return t=l(s),n=a[t]=r[t](s),{c(){e=b("div"),n.c(),v(e,"class","wrapper svelte-1glihwf")},m(c,u){P(c,e,u),a[t].m(e,null),o=!0},p(c,u){let f=t;t=l(c),t===f?a[t].p(c,u):(H(),N(a[f],1,1,()=>{a[f]=null}),Y(),n=a[t],n?n.p(c,u):(n=a[t]=r[t](c),n.c()),S(n,1),n.m(e,null))},i(c){o||(S(n),We(()=>{i||(i=ke(e,Re,{},!0)),i.run(1)}),o=!0)},o(c){N(n),i||(i=ke(e,Re,{},!1)),i.run(0),o=!1},d(c){c&&M(e),a[t].d(),c&&i&&i.end()}}}function nu(s){let e,t=(s[3].label||s[2])+"",n,i,o,r,a;const l=[{value:s[1]},s[8](s[6])];var c=Wt(s[6],s[1]);function u(f){let h={};for(let p=0;p<l.length;p+=1)h=Hn(h,l[p]);return{props:h}}return c&&(o=new c(u()),o.$on("change",s[10])),{c(){e=b("p"),n=X(t),i=E(),o&&R(o.$$.fragment),r=oe()},m(f,h){P(f,e,h),y(e,n),P(f,i,h),o&&z(o,f,h),P(f,r,h),a=!0},p(f,h){(!a||h&12)&&t!==(t=(f[3].label||f[2])+"")&&se(n,t);const p=h&322?Gn(l,[h&2&&{value:f[1]},h&320&&Un(f[8](f[6]))]):{};if(c!==(c=Wt(f[6],f[1]))){if(o){H();const d=o;N(d.$$.fragment,1,0,()=>{F(d,1)}),Y()}c?(o=new c(u()),o.$on("change",f[10]),R(o.$$.fragment),S(o.$$.fragment,1),z(o,r.parentNode,r)):o=null}else c&&o.$set(p)},i(f){a||(o&&S(o.$$.fragment,f),a=!0)},o(f){o&&N(o.$$.fragment,f),a=!1},d(f){f&&M(e),f&&M(i),f&&M(r),o&&F(o,f)}}}function su(s){let e,t;return e=new Bt({props:{name:s[2],open:s[7].get(),$$slots:{default:[ru]},$$scope:{ctx:s}}}),e.$on("toggle",s[9]),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.name=n[2]),i&32779&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function iu(s){let e;return{c(){e=b("p"),e.textContent="error"},m(t,n){P(t,e,n)},p:O,i:O,o:O,d(t){t&&M(e)}}}function ou(s){let e,t;return e=new ji({props:{path:s[0],value:s[12],key:s[11],template:s[3].options[s[11]]}}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&1&&(o.path=n[0]),i&2&&(o.value=n[12]),i&2&&(o.key=n[11]),i&10&&(o.template=n[3].options[n[11]]),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Li(s){let e,t,n,i;const o=[ou,iu],r=[];function a(l,c){return l[11]in l[3].options?0:1}return e=a(s),t=r[e]=o[e](s),{c(){t.c(),n=oe()},m(l,c){r[e].m(l,c),P(l,n,c),i=!0},p(l,c){let u=e;e=a(l),e===u?r[e].p(l,c):(H(),N(r[u],1,1,()=>{r[u]=null}),Y(),t=r[e],t?t.p(l,c):(t=r[e]=o[e](l),t.c()),S(t,1),t.m(n.parentNode,n))},i(l){i||(S(t),i=!0)},o(l){N(t),i=!1},d(l){r[e].d(l),l&&M(n)}}}function ru(s){let e,t,n=Object.entries(s[1]),i=[];for(let r=0;r<n.length;r+=1)i[r]=Li(Pi(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=oe()},m(r,a){for(let l=0;l<i.length;l+=1)i[l].m(r,a);P(r,e,a),t=!0},p(r,a){if(a&11){n=Object.entries(r[1]);let l;for(l=0;l<n.length;l+=1){const c=Pi(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=Li(c),i[l].c(),S(i[l],1),i[l].m(e.parentNode,e))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){de(i,r),r&&M(e)}}}function lu(s){let e,t,n=(s[4].isDev||!s[3].onlyDev)&&Ni(s);return{c(){n&&n.c(),e=oe()},m(i,o){n&&n.m(i,o),P(i,e,o),t=!0},p(i,[o]){i[4].isDev||!i[3].onlyDev?n?(n.p(i,o),o&24&&S(n,1)):(n=Ni(i),n.c(),S(n,1),n.m(e.parentNode,e)):n&&(H(),N(n,1,1,()=>{n=null}),Y())},i(i){t||(S(n),t=!0)},o(i){N(n),t=!1},d(i){n&&n.d(i),i&&M(e)}}}function au(s,e,t){let n;const i=fe.store;be(s,i,d=>t(4,n=d));let{value:o}=e,{key:r}=e,{path:a=""}=e;a=a+(a.length?".":"")+r;let{template:l}=e,c=l;const u=tu(),f=d=>{const m=te({},d);return delete m.defaultValue,delete m.type,m},h=({detail:d})=>u.set(d),p=d=>fe.set(a,d.detail);return s.$$set=d=>{"value"in d&&t(1,o=d.value),"key"in d&&t(2,r=d.key),"path"in d&&t(0,a=d.path),"template"in d&&t(3,l=d.template)},[a,o,r,l,n,i,c,u,f,h,p]}class ji extends Z{constructor(e){super();K(this,e,au,lu,Q,{value:1,key:2,path:0,template:3})}}function Ei(s,e,t){const n=s.slice();return n[2]=e[t][0],n[3]=e[t][1],n}function $i(s){let e,t;return e=new ji({props:{key:s[2],value:s[3],template:ln[s[2]]}}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,i){const o={};i&1&&(o.key=n[2]),i&1&&(o.value=n[3]),i&1&&(o.template=ln[n[2]]),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function cu(s){let e,t,n=Object.entries(s[0]),i=[];for(let r=0;r<n.length;r+=1)i[r]=$i(Ei(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=oe()},m(r,a){for(let l=0;l<i.length;l+=1)i[l].m(r,a);P(r,e,a),t=!0},p(r,[a]){if(a&1){n=Object.entries(r[0]);let l;for(l=0;l<n.length;l+=1){const c=Ei(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=$i(c),i[l].c(),S(i[l],1),i[l].m(e.parentNode,e))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){de(i,r),r&&M(e)}}}function uu(s,e,t){let n;const i=fe.store;return be(s,i,o=>t(0,n=o)),[n,i]}class fu extends Z{constructor(e){super();K(this,e,uu,cu,Q,{})}}function hu(s){let e;return{c(){e=b("p"),e.textContent=`\u{1F389} Now you have all the knowledge to use the Plantarium. Have some fun with
  it.`,v(e,"class","svelte-1h3eb6p")},m(t,n){P(t,e,n)},p:O,i:O,o:O,d(t){t&&M(e)}}}class du extends Z{constructor(e){super();K(this,e,null,hu,Q,{})}}function pu(s){let e,t,n,i,o,r,a,l;return i=new Ue({props:{name:"hand"}}),{c(){e=b("p"),t=X("Hey there "),n=b("span"),o=b("div"),R(i.$$.fragment),r=E(),a=b("p"),a.innerHTML=`Welcome to <b>Plantarium</b>, a tool for creating parametrized, procedural 3D
  plants.`,I(o,"display","contents"),I(o,"--stroke","#1a1a1a"),v(n,"class","svelte-1tutruj"),v(e,"class","svelte-1tutruj"),v(a,"class","svelte-1tutruj")},m(c,u){P(c,e,u),y(e,t),y(e,n),y(n,o),z(i,o,null),P(c,r,u),P(c,a,u),l=!0},p:O,i(c){l||(S(i.$$.fragment,c),l=!0)},o(c){N(i.$$.fragment,c),l=!1},d(c){c&&M(e),F(i),c&&M(r),c&&M(a)}}}class mu extends Z{constructor(e){super();K(this,e,null,pu,Q,{})}}const fn=[{title:"Tutorial",description:mu,options:{"lets go":()=>{}},type:"alert"},{description:`This is the <b>Plant View</b>, here you can explore the generated 3D model of your plant. 
      Try to change the view by:`,selector:".scene-wrapper",checks:[{description:"Clicking and dragging",setup:function(s,{c:e}){const t=document.querySelector(e.selector);t.getAttribute("setup")!=="true"&&(t.setAttribute("setup","true"),t.addEventListener("click",s,{once:!0}))}},{description:"Scrolling / Zooming",setup:(s,{c:e})=>{const t=document.querySelector(e.selector+"> canvas");t.getAttribute("setup")!=="true"&&(t.setAttribute("setup","true"),t.addEventListener("wheel",s,{once:!0,passive:!0}))}}]},{selector:"#nodesystem-view",description:"This is the <b>Node View</b>, here you define the way your plant looks. Try playing with some of the settings. If you are not so sure how this works, maybe visit the NodeTutorial"},{description:"This Button opens the project view",clickSelector:"header > div.left > div > div"},{description:"This is the ProjectView, here you can create/rename/delete projects.",selector:".project-manager-wrapper",checks:[{description:"create a new project",setup:(s,{pm:e})=>{e.once("new",s)}},{description:"rename the project",setup:(s,{pm:e})=>{e.once("update",s)}},{description:"delete the project",setup:(s,{pm:e})=>{e.once("delete",s)}}]},{description:"This Button opens the <b>Settings View</b>",clickSelector:"header > div.right > div:nth-child(2) .icon-wrapper"},{description:"This is the <b>SettingView</b>, here you can change some general settings.",selector:"header > div.right > div:nth-child(2) > div > div > div.wrapper.right.visible"},{description:"When you encounter something which doesnt work or you have an Idea for a new feature, use this button to report it.",clickSelector:"header > div.right > div:nth-child(1) > div"},{title:"Tutorial",description:du,options:{"lets go":()=>{}},type:"alert"}];var Ke=me(void 0);function Ci(s,e,t){const n=s.slice();return n[14]=e[t],n[15]=e,n[16]=t,n}function Ti(s){let e,t,n,i,o,r,a,l,c=s[6].description+"",u,f,h,p,d,m=s[3]&&Oi(s);o=new pe({props:{icon:"cross"}}),o.$on("click",s[11]);let g=s[1]&&Ii(s),w=!s[4]&&Vi(s),x=s[0]&&s[5]&&Di(s);return{c(){e=b("span"),m&&m.c(),t=E(),n=b("div"),i=b("div"),r=b("div"),R(o.$$.fragment),a=E(),l=b("p"),u=E(),g&&g.c(),f=E(),w&&w.c(),p=E(),x&&x.c(),I(r,"display","contents"),I(r,"--bg","transparent"),v(i,"class","close-wrapper svelte-zb5b7g"),v(l,"class","svelte-zb5b7g"),v(n,"class","wrapper svelte-zb5b7g"),v(n,"style",h=`left: ${s[8]}px; top: ${s[0].top+20}px;`),v(e,"class","svelte-zb5b7g"),D(e,"isLeft",s[2]),D(e,"hasElement",!!s[5]),D(e,"hasClick",!!s[3])},m(_,k){P(_,e,k),m&&m.m(e,null),y(e,t),y(e,n),y(n,i),y(i,r),z(o,r,null),y(n,a),y(n,l),l.innerHTML=c,y(n,u),g&&g.m(n,null),y(n,f),w&&w.m(n,null),y(e,p),x&&x.m(e,null),d=!0},p(_,k){_[3]?m?(m.p(_,k),k&8&&S(m,1)):(m=Oi(_),m.c(),S(m,1),m.m(e,t)):m&&(H(),N(m,1,1,()=>{m=null}),Y()),(!d||k&64)&&c!==(c=_[6].description+"")&&(l.innerHTML=c),_[1]?g?(g.p(_,k),k&2&&S(g,1)):(g=Ii(_),g.c(),S(g,1),g.m(n,f)):g&&(H(),N(g,1,1,()=>{g=null}),Y()),_[4]?w&&(H(),N(w,1,1,()=>{w=null}),Y()):w?(w.p(_,k),k&16&&S(w,1)):(w=Vi(_),w.c(),S(w,1),w.m(n,null)),(!d||k&257&&h!==(h=`left: ${_[8]}px; top: ${_[0].top+20}px;`))&&v(n,"style",h),_[0]&&_[5]?x?x.p(_,k):(x=Di(_),x.c(),x.m(e,null)):x&&(x.d(1),x=null),k&4&&D(e,"isLeft",_[2]),k&32&&D(e,"hasElement",!!_[5]),k&8&&D(e,"hasClick",!!_[3])},i(_){d||(S(m),S(o.$$.fragment,_),S(g),S(w),d=!0)},o(_){N(m),N(o.$$.fragment,_),N(g),N(w),d=!1},d(_){_&&M(e),m&&m.d(),F(o),g&&g.d(),w&&w.d(),x&&x.d()}}}function Oi(s){let e,t,n,i,o;return t=new Ue({props:{name:"pointing"}}),{c(){e=b("div"),n=b("div"),R(t.$$.fragment),I(n,"display","contents"),I(n,"--fill","#303030"),v(e,"class","click-wrapper svelte-zb5b7g"),v(e,"style",i=`top: ${s[0].top+20}px; left: ${s[8]-(s[2]?20:-0)}px;`)},m(r,a){P(r,e,a),y(e,n),z(t,n,null),o=!0},p(r,a){(!o||a&261&&i!==(i=`top: ${r[0].top+20}px; left: ${r[8]-(r[2]?20:-0)}px;`))&&v(e,"style",i)},i(r){o||(S(t.$$.fragment,r),o=!0)},o(r){N(t.$$.fragment,r),o=!1},d(r){r&&M(e),F(t)}}}function Ii(s){let e,t,n=s[1],i=[];for(let r=0;r<n.length;r+=1)i[r]=Ai(Ci(s,n,r));const o=r=>N(i[r],1,1,()=>{i[r]=null});return{c(){e=b("div");for(let r=0;r<i.length;r+=1)i[r].c();v(e,"class","checks-wrapper svelte-zb5b7g")},m(r,a){P(r,e,a);for(let l=0;l<i.length;l+=1)i[l].m(e,null);t=!0},p(r,a){if(a&2){n=r[1];let l;for(l=0;l<n.length;l+=1){const c=Ci(r,n,l);i[l]?(i[l].p(c,a),S(i[l],1)):(i[l]=Ai(c),i[l].c(),S(i[l],1),i[l].m(e,null))}for(H(),l=n.length;l<i.length;l+=1)o(l);Y()}},i(r){if(!t){for(let a=0;a<n.length;a+=1)S(i[a]);t=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(r){r&&M(e),de(i,r)}}}function Ai(s){let e,t,n,i,o,r=s[14].description+"",a,l,c;function u(h){s[12](h,s[14])}let f={};return s[14]._isCompleted!==void 0&&(f.value=s[14]._isCompleted),t=new mt({props:f}),ae.push(()=>ft(t,"value",u)),{c(){e=b("div"),R(t.$$.fragment),i=E(),o=b("p"),a=X(r),l=E(),v(o,"class","svelte-zb5b7g"),v(e,"class","check-wrapper svelte-zb5b7g"),D(e,"is-completed",s[14]._isCompleted)},m(h,p){P(h,e,p),z(t,e,null),y(e,i),y(e,o),y(o,a),y(e,l),c=!0},p(h,p){s=h;const d={};!n&&p&2&&(n=!0,d.value=s[14]._isCompleted,ut(()=>n=!1)),t.$set(d),(!c||p&2)&&r!==(r=s[14].description+"")&&se(a,r),p&2&&D(e,"is-completed",s[14]._isCompleted)},i(h){c||(S(t.$$.fragment,h),c=!0)},o(h){N(t.$$.fragment,h),c=!1},d(h){h&&M(e),F(t)}}}function Vi(s){let e,t,n,i;return t=new pe({props:{name:"next"}}),t.$on("click",s[13]),{c(){e=b("div"),n=b("div"),R(t.$$.fragment),I(n,"display","contents"),I(n,"--text","white"),I(n,"--bg","#303030"),v(e,"class","next-wrapper svelte-zb5b7g")},m(o,r){P(o,e,r),y(e,n),z(t,n,null),i=!0},p:O,i(o){i||(S(t.$$.fragment,o),i=!0)},o(o){N(t.$$.fragment,o),i=!1},d(o){o&&M(e),F(t)}}}function Di(s){let e,t;return{c(){e=b("span"),v(e,"class","highlighter  svelte-zb5b7g"),v(e,"style",t=`width: ${s[0].width}px; height: ${s[0].height}px; left: ${s[0].left}px; top: ${s[0].top}px;`)},m(n,i){P(n,e,i)},p(n,i){i&1&&t!==(t=`width: ${n[0].width}px; height: ${n[0].height}px; left: ${n[0].left}px; top: ${n[0].top}px;`)&&v(e,"style",t)},d(n){n&&M(e)}}}function vu(s){let e,t,n=s[7]&&Ti(s);return{c(){n&&n.c(),e=oe()},m(i,o){n&&n.m(i,o),P(i,e,o),t=!0},p(i,[o]){i[7]?n?(n.p(i,o),o&128&&S(n,1)):(n=Ti(i),n.c(),S(n,1),n.m(e.parentNode,e)):n&&(H(),N(n,1,1,()=>{n=null}),Y())},i(i){t||(S(n),t=!0)},o(i){N(n),t=!1},d(i){n&&n.d(i),i&&M(e)}}}function gu(s,e,t){let n,i,o,r,a,l,c,u,f,h,p;be(s,Ke,w=>t(6,p=w));const d=()=>{t(7,h=!1)};function m(w,x){s.$$.not_equal(x._isCompleted,w)&&(x._isCompleted=w,t(1,f),t(6,p))}const g=()=>Kn(Ke,p._isCompleted=!0,p);return s.$$.update=()=>{if(s.$$.dirty&64&&p&&p.clickSelector){const w=document.querySelector(p.clickSelector);w&&w.getAttribute("setup")!=="true"&&(w.setAttribute("setup","true"),w.addEventListener("click",()=>{setTimeout(()=>{Kn(Ke,p._isCompleted=!0,p)},20)},{once:!0}))}s.$$.dirty&64&&t(10,n=p&&p.selector),s.$$.dirty&1024&&t(5,i=n&&document.querySelector(n)),s.$$.dirty&32&&t(9,o=i&&i.getBoundingClientRect()),s.$$.dirty&64&&t(4,r=p&&p.clickSelector&&document.querySelector(p.clickSelector)),s.$$.dirty&16&&t(3,a=r&&r.getBoundingClientRect()),s.$$.dirty&520&&t(0,l=o||a),s.$$.dirty&1&&t(2,c=l&&l.left+l.width>window.innerWidth-100),s.$$.dirty&5&&t(8,u=l&&(c?l.left-10:l.left+l.width+10)),s.$$.dirty&64&&t(1,f=p&&p.checks),s.$$.dirty&66&&f&&f.forEach((w,x)=>(w._isSetup||(w._isSetup=!0,w.setup(()=>{t(1,f[x]._isCompleted=!0,f),t(1,f),t(6,p)},{pm:le,c:p})),w)),s.$$.dirty&1&&t(7,h=!!l)},[l,f,c,a,r,i,p,h,u,o,n,d,m,g]}class wu extends Z{constructor(e){super();K(this,e,gu,vu,Q,{})}}const Ri=["yes","next","lets go","okay"];let zi;const Fi={handleReject:()=>{we.set("hasViewedTutorial",!0),Ye("The tutorial is accessable under...")},currentIndex:0,previous:async function(){},next:async function(){var t;const s=fn[this.currentIndex];if(this.currentIndex===fn.length)return;if(s.setup&&await s.setup({pm:zi}),Ke.set(s),this.currentIndex++,this.currentIndex>2&&we.set("hasViewedTutorial",!0),s.title=(t=s.title)!=null?t:`Tutorial (${this.currentIndex}/${fn.length})`,s.type==="alert"){const n=await He(s.description,{title:s.title,type:"success",values:s.options?Object.keys(s.options):void 0,timeout:0});if(Ri.includes(n.toString()))return this.next()}if(s.type==="toast"){const n=await Ye(s.description,{values:s.options?Object.keys(s.options):void 0,timeout:0});if(Ri.includes(n.toString()))return this.next()}const e=Ke.subscribe(n=>{n._isCompleted&&(e(),this.next())})},init:function({projectManager:s}){if(we.get("hasViewedTutorial"))return;zi=s;const e=`It looks like this is your first time here...
    Want to take a little tour? `;setTimeout(async()=>{await Ye(e,{title:"",timeout:8e3,values:["nah","yes"]})==="yes"?this.next():this.handleReject()},1e4)},restart:function(){we.set("hasViewedTutorial",!1),this.currentIndex=0,this.next()}},yu=me([]),_u=me([]),Bi={},hn={render:!1,generate:!1},dn={render:yu,generate:_u};function bu(s){Bi[s]=performance.now()}function Wi(s){var e,t;hn.render=!!((e=s==null?void 0:s.debug)==null?void 0:e.renderPerf),hn.generate=!!((t=s==null?void 0:s.debug)==null?void 0:t.generatePerf)}function Gi(s,e){(s in dn?dn[s]:me([])).update(n=>(n.push(e),n.length>200&&n.shift(),n)),s in pn&&pn[s]()}function ku(s){var t;if(!hn[s])return;const e=performance.now()-((t=Bi[s])!=null?t:0);Gi(s,e)}const Ui={},pn={};function Hi(s,e){e=e||Ui[s]||document.createElement("canvas"),Ui[s]=e;const t=200,n=100;e.width=t,e.height=n;const i=e.getContext("2d");pn[s]=()=>{const o=[...zo(dn[s])],r=Math.max(...o);let a=0;const l=t/200;i.clearRect(0,0,t,n),i.fillStyle="rgba(255, 255, 255, 0.5)",i.fillRect(0,0,t,n);for(let c=0;c<o.length;c++){a+=o[c];const u=o[c]*(n/r);i.fillStyle="rgba(0, 0, 0, 0.5)",i.fillRect(c*l,n-u,l,u)}i.fillStyle="black",i.textAlign="left",i.fillText(s+"",10,10),i.textAlign="right",i.fillText(`avg: ${Math.floor(a/o.length*10)/10}ms max: ${Math.floor(r*10)/10}ms`,180,10)}}const fe=new Qc,le=new Gc;ts(fe.get("theme"));Wi(fe.getSettings());fe.on("enableSync.update",s=>{Ye(`${s?"Enabled":"Disabled"} sync`,{type:"success"})});fe.on("theme.update",s=>{ts(s)});const Qe=new on({view:!0,defaultNodes:!1,registerNodes:Zt});le.on("load",s=>Qe.load(s));Qe.on("result",s=>le.setProject(s),50);Qe.on("save",s=>le.saveProject(s));fe.on("settings",s=>{le.setSettings(s),Wi(s)},50);Fi.init({projectManager:le});const Su=(s,e)=>{const{background:{scale:t=1,resX:n=16,resY:i=16}={}}=e||{},o=t!=null?t:0,r=n!=null?n:8,a=i!=null?i:8,l=Gl(o,r,a);return Xt(s,l)};class Mu{constructor(e,t){this.scene=e,this.gl=e.renderer.gl,this.initMeshes(),t.on("settings",this.setSettings.bind(this)),this.setSettings(fe.getSettings())}initMeshes(){const e=new Fo(this.gl),t=Br.texture(this.gl,"assets/rocky_dirt1-albedo.jpg",{wrapS:this.gl.REPEAT,wrapT:this.gl.REPEAT}),n=new ct(this.gl,{vertex:oi.vertex,fragment:oi.fragment,uniforms:{uTime:{value:0},tMap:{value:t},uFogColor:{value:new Bo("#ffffff")},uFogNear:{value:10},uFogFar:{value:30},texScale:{value:1}}});this.ground=this.scene.addMesh({geometry:e,program:n});const i=(o=0)=>{requestAnimationFrame(i),n.uniforms.uTime.value=o};i()}setSettings(e){var t,n;this.settings=e,((t=e==null?void 0:e.background)==null?void 0:t.ground)&&(this.ground.geometry=Su(this.gl,e)),this.ground.visible=!!((n=e==null?void 0:e.background)==null?void 0:n.ground)}}function xu(s){let e,t,n=(s[1]?"<b>[NEW]</b>":"")+"",i,o=s[0].subject+"",r;return{c(){e=b("p"),t=new Wo,i=E(),r=X(o),t.a=i},m(a,l){P(a,e,l),t.m(n,e),y(e,i),y(e,r)},p(a,[l]){l&2&&n!==(n=(a[1]?"<b>[NEW]</b>":"")+"")&&t.p(n),l&1&&o!==(o=a[0].subject+"")&&se(r,o)},i:O,o:O,d(a){a&&M(e)}}}function Pu(s,e,t){let{commit:n}=e,{isNew:i=!1}=e;return s.$$set=o=>{"commit"in o&&t(0,n=o.commit),"isNew"in o&&t(1,i=o.isNew)},[n,i]}class Nu extends Z{constructor(e){super();K(this,e,Pu,xu,Q,{commit:0,isNew:1})}}const Yi=me([]);let mn=we.get("lastUpdated",Date.now());function Lu(s){const e=Date.parse(s.date);return _e(te({},s),{date:e,new:mn<e})}let St;async function ju(){const e=await(await fetch("commits.json")).json();return mn=Date.now(),we.set("lastUpdated",mn),e.map(t=>Lu(t))}const Eu=async()=>{if(St)return St;St=ju();const s=await St;Yi.set(s)};function Xi(s,e,t){const n=s.slice();return n[4]=e[t],n}function qi(s){let e,t=s[2](s[4].date)+"",n;return{c(){e=b("h3"),n=X(t),v(e,"class","svelte-13vbnbr")},m(i,o){P(i,e,o),y(e,n)},p(i,o){o&1&&t!==(t=i[2](i[4].date)+"")&&se(n,t)},d(i){i&&M(e)}}}function Ji(s){let e=s[1](s[4]),t,n,i,o=e&&qi(s);return n=new Nu({props:{commit:s[4]}}),{c(){o&&o.c(),t=E(),R(n.$$.fragment)},m(r,a){o&&o.m(r,a),P(r,t,a),z(n,r,a),i=!0},p(r,a){a&1&&(e=r[1](r[4])),e?o?o.p(r,a):(o=qi(r),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);const l={};a&1&&(l.commit=r[4]),n.$set(l)},i(r){i||(S(n.$$.fragment,r),i=!0)},o(r){N(n.$$.fragment,r),i=!1},d(r){o&&o.d(r),r&&M(t),F(n,r)}}}function $u(s){let e,t,n,i,o=s[0],r=[];for(let l=0;l<o.length;l+=1)r[l]=Ji(Xi(s,o,l));const a=l=>N(r[l],1,1,()=>{r[l]=null});return{c(){e=b("h1"),e.textContent="Changelog",t=E(),n=b("div");for(let l=0;l<r.length;l+=1)r[l].c();v(n,"class","svelte-13vbnbr")},m(l,c){P(l,e,c),P(l,t,c),P(l,n,c);for(let u=0;u<r.length;u+=1)r[u].m(n,null);i=!0},p(l,[c]){if(c&7){o=l[0];let u;for(u=0;u<o.length;u+=1){const f=Xi(l,o,u);r[u]?(r[u].p(f,c),S(r[u],1)):(r[u]=Ji(f),r[u].c(),S(r[u],1),r[u].m(n,null))}for(H(),u=o.length;u<r.length;u+=1)a(u);Y()}},i(l){if(!i){for(let c=0;c<o.length;c+=1)S(r[c]);i=!0}},o(l){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)N(r[c]);i=!1},d(l){l&&M(e),l&&M(t),l&&M(n),de(r,l)}}}function Cu(s,e,t){let n;be(s,Yi,a=>t(0,n=a)),Eu();let i=n.length&&new Date(n[0].date).getDay();return[n,a=>{const l=new Date(a.date);return l.getDay()!=i?(i=l.getDay(),!0):!1},a=>new Date(a).toLocaleDateString()]}class Tu extends Z{constructor(e){super();K(this,e,Cu,$u,Q,{})}}function Ou(s){let e,t,n,i,o,r,a,l,c;function u(d){s[6](d)}let f={useActive:!0,icon:s[3],name:s[1]};s[0]!==void 0&&(f.active=s[0]),t=new pe({props:f}),ae.push(()=>ft(t,"active",u));var h=s[4];function p(d){return{props:{visible:d[0]}}}return h&&(l=new h(p(s))),{c(){e=b("div"),n=b("div"),R(t.$$.fragment),r=E(),a=b("div"),l&&R(l.$$.fragment),I(n,"display","contents"),I(n,"--bg","transparent"),I(n,"--text",o=s[5]["text-color"]),v(a,"class","wrapper svelte-1e2gb7"),D(a,"visible",s[0]),D(a,"right",s[2]),v(e,"class","icon-wrapper svelte-1e2gb7"),D(e,"active",s[0])},m(d,m){P(d,e,m),y(e,n),z(t,n,null),y(e,r),y(e,a),l&&z(l,a,null),c=!0},p(d,m){m&32&&o!==(o=d[5]["text-color"])&&I(n,"--text",o);const g={};m&8&&(g.icon=d[3]),m&2&&(g.name=d[1]),!i&&m&1&&(i=!0,g.active=d[0],ut(()=>i=!1)),t.$set(g);const w={};if(m&1&&(w.visible=d[0]),h!==(h=d[4])){if(l){H();const x=l;N(x.$$.fragment,1,0,()=>{F(x,1)}),Y()}h?(l=new h(p(d)),R(l.$$.fragment),S(l.$$.fragment,1),z(l,a,null)):l=null}else h&&l.$set(w);m&1&&D(a,"visible",d[0]),m&4&&D(a,"right",d[2]),m&1&&D(e,"active",d[0])},i(d){c||(S(t.$$.fragment,d),l&&S(l.$$.fragment,d),c=!0)},o(d){N(t.$$.fragment,d),l&&N(l.$$.fragment,d),c=!1},d(d){d&&M(e),F(t),l&&F(l)}}}function Iu(s){let e,t;return e=new Go({props:{$$slots:{default:[Ou]},$$scope:{ctx:s}}}),e.$on("clickoutside",s[7]),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},p(n,[i]){const o={};i&319&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Au(s,e,t){let n;be(s,At,f=>t(5,n=f));let{name:i}=e,{right:o=!1}=e,{icon:r}=e,{component:a}=e,{visible:l=!1}=e;function c(f){l=f,t(0,l)}const u=()=>t(0,l=!1);return s.$$set=f=>{"name"in f&&t(1,i=f.name),"right"in f&&t(2,o=f.right),"icon"in f&&t(3,r=f.icon),"component"in f&&t(4,a=f.component),"visible"in f&&t(0,l=f.visible)},[l,i,o,r,a,n,c,u]}class vn extends Z{constructor(e){super();K(this,e,Au,Iu,Q,{name:1,right:2,icon:3,component:4,visible:0})}}function Vu(s){let e,t,n,i,o,r,a,l,c,u,f,h,p,d,m,g,w,x=s[0]==="bug"&&Zi(s);return p=new pe({props:{name:"Submit"}}),p.$on("click",s[9]),{c(){e=b("section"),t=b("label"),t.textContent="Title",n=E(),i=b("input"),o=E(),r=b("section"),a=b("label"),a.textContent="Description",l=E(),c=b("textarea"),f=E(),x&&x.c(),h=E(),d=b("div"),R(p.$$.fragment),v(t,"for","title"),v(t,"class","svelte-1725buf"),v(i,"type","text"),v(i,"id","title"),v(i,"placeholder","Simple Title"),v(i,"class","svelte-1725buf"),v(e,"class","svelte-1725buf"),v(a,"for","description"),v(a,"class","svelte-1725buf"),v(c,"type","text"),v(c,"id","description"),v(c,"rowspan","5"),v(c,"placeholder",u=s[0]==="bug"?"Please provide a detailed description of what happened.":"Please describe the feature."),v(c,"class","svelte-1725buf"),v(r,"class","svelte-1725buf"),I(d,"display","contents"),I(d,"--bg","white"),I(d,"--text-color","#303030")},m(_,k){P(_,e,k),y(e,t),y(e,n),y(e,i),ve(i,s[2]),P(_,o,k),P(_,r,k),y(r,a),y(r,l),y(r,c),ve(c,s[3]),P(_,f,k),x&&x.m(_,k),P(_,h,k),P(_,d,k),z(p,d,null),m=!0,g||(w=[B(i,"keydown",Ct(s[11])),B(i,"input",s[12]),B(c,"keydown",Ct(s[10])),B(c,"input",s[13])],g=!0)},p(_,k){k&4&&i.value!==_[2]&&ve(i,_[2]),(!m||k&1&&u!==(u=_[0]==="bug"?"Please provide a detailed description of what happened.":"Please describe the feature."))&&v(c,"placeholder",u),k&8&&ve(c,_[3]),_[0]==="bug"?x?(x.p(_,k),k&1&&S(x,1)):(x=Zi(_),x.c(),S(x,1),x.m(h.parentNode,h)):x&&(H(),N(x,1,1,()=>{x=null}),Y())},i(_){m||(S(x),S(p.$$.fragment,_),m=!0)},o(_){N(x),N(p.$$.fragment,_),m=!1},d(_){_&&M(e),_&&M(o),_&&M(r),_&&M(f),x&&x.d(_),_&&M(h),_&&M(d),F(p,_),g=!1,Ce(w)}}}function Du(s){let e,t,n,i={ctx:s,current:null,token:null,hasCatch:!0,pending:Wu,then:Bu,catch:Fu,value:16,error:17,blocks:[,,,]};return Tt(t=s[6],i),{c(){e=oe(),i.block.c()},m(o,r){P(o,e,r),i.block.m(o,i.anchor=r),i.mount=()=>e.parentNode,i.anchor=e,n=!0},p(o,r){s=o,i.ctx=s,r&64&&t!==(t=s[6])&&Tt(t,i)||Uo(i,s,r)},i(o){n||(S(i.block),n=!0)},o(o){for(let r=0;r<3;r+=1){const a=i.blocks[r];N(a)}n=!1},d(o){o&&M(e),i.block.d(o),i.token=null,i=null}}}function Zi(s){let e,t,n,i,o,r,a,l,c,u,f,h=s[7]&&Ki(s);function p(m){s[15](m)}let d={};return s[4]!==void 0&&(d.value=s[4]),i=new mt({props:d}),ae.push(()=>ft(i,"value",p)),u=new Bt({props:{name:"What is that?",$$slots:{default:[zu]},$$scope:{ctx:s}}}),{c(){h&&h.c(),e=E(),t=b("section"),n=b("div"),R(i.$$.fragment),r=E(),a=b("p"),a.textContent="Include Browser Info",l=E(),c=b("div"),R(u.$$.fragment),I(a,"margin-left","5px"),I(n,"display","flex"),I(n,"align-items","center"),v(c,"class","info svelte-1725buf"),v(t,"class","svelte-1725buf")},m(m,g){h&&h.m(m,g),P(m,e,g),P(m,t,g),y(t,n),z(i,n,null),y(n,r),y(n,a),y(t,l),y(t,c),z(u,c,null),f=!0},p(m,g){m[7]?h?(h.p(m,g),g&128&&S(h,1)):(h=Ki(m),h.c(),S(h,1),h.m(e.parentNode,e)):h&&(H(),N(h,1,1,()=>{h=null}),Y());const w={};!o&&g&16&&(o=!0,w.value=m[4],ut(()=>o=!1)),i.$set(w);const x={};g&262144&&(x.$$scope={dirty:g,ctx:m}),u.$set(x)},i(m){f||(S(h),S(i.$$.fragment,m),S(u.$$.fragment,m),f=!0)},o(m){N(h),N(i.$$.fragment,m),N(u.$$.fragment,m),f=!1},d(m){h&&h.d(m),m&&M(e),m&&M(t),F(i),F(u)}}}function Ki(s){let e,t,n,i,o,r,a,l,c,u;function f(p){s[14](p)}let h={};return s[5]!==void 0&&(h.value=s[5]),n=new mt({props:h}),ae.push(()=>ft(n,"value",f)),c=new Bt({props:{name:"What is that?",$$slots:{default:[Ru]},$$scope:{ctx:s}}}),{c(){e=b("section"),t=b("div"),R(n.$$.fragment),o=E(),r=b("p"),r.textContent="Include StackTrace",a=E(),l=b("div"),R(c.$$.fragment),I(r,"margin-left","5px"),I(t,"display","flex"),I(t,"align-items","center"),v(l,"class","info svelte-1725buf"),v(e,"class","svelte-1725buf")},m(p,d){P(p,e,d),y(e,t),z(n,t,null),y(t,o),y(t,r),y(e,a),y(e,l),z(c,l,null),u=!0},p(p,d){const m={};!i&&d&32&&(i=!0,m.value=p[5],ut(()=>i=!1)),n.$set(m);const g={};d&262146&&(g.$$scope={dirty:d,ctx:p}),c.$set(g)},i(p){u||(S(n.$$.fragment,p),S(c.$$.fragment,p),u=!0)},o(p){N(n.$$.fragment,p),N(c.$$.fragment,p),u=!1},d(p){p&&M(e),F(n),F(c)}}}function Ru(s){let e,t,n=s[1].stack+"",i;return{c(){e=b("pre"),t=b("code"),i=X(n)},m(o,r){P(o,e,r),y(e,t),y(t,i)},p(o,r){r&2&&n!==(n=o[1].stack+"")&&se(i,n)},d(o){o&&M(e)}}}function zu(s){let e,t,n,i,o,r,a,l,c,u,f,h,p,d,m,g,w,x;return{c(){e=b("p"),e.textContent=`This information makes it easier for a developer to track down what
            might have caused the bug.`,t=E(),n=b("ul"),i=b("li"),o=X("OS "),r=b("i"),r.textContent=`(${s[8].os})`,a=E(),l=b("li"),c=X("Browser "),u=b("i"),u.textContent=`(${s[8].name} / ${s[8].version})`,f=E(),h=b("li"),p=X("Screen Resolution "),d=b("i"),d.textContent=`(${window.innerWidth}x${window.innerHeight})`,m=E(),g=b("li"),w=X("Screen DPI "),x=b("i"),x.textContent=`(${window.devicePixelRatio})`},m(_,k){P(_,e,k),P(_,t,k),P(_,n,k),y(n,i),y(i,o),y(i,r),y(n,a),y(n,l),y(l,c),y(l,u),y(n,f),y(n,h),y(h,p),y(h,d),y(n,m),y(n,g),y(g,w),y(g,x)},p:O,d(_){_&&M(e),_&&M(t),_&&M(n)}}}function Fu(s){let e,t,n,i=JSON.stringify(s[17],null,2)+"",o;return{c(){e=b("p"),e.textContent="Errror",t=E(),n=b("code"),o=X(i)},m(r,a){P(r,e,a),P(r,t,a),P(r,n,a),y(n,o)},p(r,a){a&64&&i!==(i=JSON.stringify(r[17],null,2)+"")&&se(o,i)},i:O,o:O,d(r){r&&M(e),r&&M(t),r&&M(n)}}}function Bu(s){let e,t,n,i=JSON.stringify(s[16],null,2)+"",o,r;return e=new pe({props:{name:"Done",icon:"checkmark"}}),{c(){R(e.$$.fragment),t=E(),n=b("code"),o=X(i)},m(a,l){z(e,a,l),P(a,t,l),P(a,n,l),y(n,o),r=!0},p(a,l){(!r||l&64)&&i!==(i=JSON.stringify(a[16],null,2)+"")&&se(o,i)},i(a){r||(S(e.$$.fragment,a),r=!0)},o(a){N(e.$$.fragment,a),r=!1},d(a){F(e,a),a&&M(t),a&&M(n)}}}function Wu(s){let e;return{c(){e=X("Submitting Reprot")},m(t,n){P(t,e,n)},p:O,i:O,o:O,d(t){t&&M(e)}}}function Gu(s){let e,t,n,i;const o=[Du,Vu],r=[];function a(l,c){return l[6]?0:1}return e=a(s),t=r[e]=o[e](s),{c(){t.c(),n=oe()},m(l,c){r[e].m(l,c),P(l,n,c),i=!0},p(l,[c]){let u=e;e=a(l),e===u?r[e].p(l,c):(H(),N(r[u],1,1,()=>{r[u]=null}),Y(),t=r[e],t?t.p(l,c):(t=r[e]=o[e](l),t.c()),S(t,1),t.m(n.parentNode,n))},i(l){i||(S(t),i=!0)},o(l){N(t),i=!1},d(l){r[e].d(l),l&&M(n)}}}function Uu(s,e,t){let n,{mode:i="bug"}=e,o=hi(),r,a,l=!1,{error:c}=e,u=!0,f;function h(){const _={type:i,title:r,description:a};u&&(_.stacktrace=n),l&&(_.browser=hi(),_.browser.screen={width:window.innerWidth,height:window.innerHeight,dpi:window.devicePixelRatio}),t(6,f=wi(_))}De(async()=>{n&&t(2,r=n.type+": "+n.title)});function p(_){Qn.call(this,s,_)}function d(_){Qn.call(this,s,_)}function m(){r=this.value,t(2,r)}function g(){a=this.value,t(3,a)}function w(_){u=_,t(5,u)}function x(_){l=_,t(4,l)}return s.$$set=_=>{"mode"in _&&t(0,i=_.mode),"error"in _&&t(1,c=_.error)},s.$$.update=()=>{s.$$.dirty&2&&t(7,n=c&&Ft(c.stack))},[i,c,r,a,l,u,f,n,o,h,p,d,m,g,w,x]}class gn extends Z{constructor(e){super();K(this,e,Uu,Gu,Q,{mode:0,error:1})}}class Hu{constructor(e,t){this.scene=e,this.pm=t,this.m={},this.gl=e.renderer.gl,this.initGeometry(),this.setSettings(fe.getSettings()),t.on("settings",this.setSettings.bind(this))}initGeometry(){this.m.skeleton=this.scene.addMesh({geometry:new Ge(this.gl,{position:{size:3,data:new Float32Array([0,0,0])},uv:{size:2,data:new Float32Array([0,0])},index:{size:1,data:new Uint16Array([0])}}),program:new ct(this.gl,{vertex:ri.vertex,fragment:ri.fragment,depthTest:!1}),mode:this.gl.LINES}),this.m.vertices=this.scene.addMesh({mode:this.gl.POINTS,geometry:new Ge(this.gl,{position:{size:3,data:new Float32Array(3)}}),program:new ct(this.gl,{vertex:li.vertex,fragment:li.fragment,depthTest:!1,transparent:!0})})}setSettings(e){var t,n;this.settings=JSON.parse(JSON.stringify(e)),this.m.skeleton.visible=!!((t=this.settings.debug)==null?void 0:t.skeleton),this.m.vertices.visible=!!((n=this.settings.debug)==null?void 0:n.skeleton),this.update()}setPlant(e){this.plant=e,this.update()}update(e=this.plant,t=this.settings){var n,i;if(!(!e||!t)&&(e.allSkeletons||e.skeletons)&&((n=t.debug)==null?void 0:n.skeleton)){const o=(i=e.allSkeletons)!=null?i:e.skeletons;let r=0;for(const u of o)r+=u.length/4*3;const a=new Float32Array(r),l=new Uint32Array((r/3-1)*2);let c=0;o.forEach(u=>{const f=u.length/4;for(let h=0;h<f;h++)a[c*3+h*3+0]=u[h*4+0],a[c*3+h*3+1]=u[h*4+1],a[c*3+h*3+2]=u[h*4+2];for(let h=0;h<f-1;h++)l[c*2+h*2]=c+h,l[c*2+h*2+1]=c+h+1;c+=f}),this.m.skeleton.geometry=new Ge(this.gl,{position:{size:3,data:a},index:{size:1,data:l}}),this.m.vertices.geometry=new Ge(this.gl,{position:{size:3,data:a}})}}}const Yu=dt(s=>{le.renderThumbnail({geo:s})},5e3),Xu=ce("scene.foreground");class qu{constructor(e,t){this.scene=e,this.pm=t,this.worker=ni(),this.gl=e.renderer.gl,this.initGeometry(),this.dbg=new Hu(e,t),this.setSettings(fe.getSettings()),this.setPlant(t.getActiveProject()),this.pm.on("settings",this.setSettings.bind(this)),this.pm.on("plant",this.setPlant.bind(this))}initGeometry(){const e=new Zn(this.scene.gl,{width:0,height:0,depth:0});this.mesh=this.scene.addMesh({geometry:e,program:ai(this.gl)})}setSettings(e){this.settings=JSON.parse(JSON.stringify(e)),this.update()}setPlant(e){!e||(this.plant=JSON.parse(JSON.stringify(e)),this.update())}async update(e=this.plant,t=this.settings){var n;if(!(!e||!t)){this.scene.isLoading.set(!0);try{bu("generate");const i=await this.worker.plant(e,t);if(ku("generate"),!i)return;Yu(i.geometry),this.scene.isLoading.set(!1),this.mesh.mode=((n=t==null?void 0:t.debug)==null?void 0:n.wireframe)?this.gl.LINES:this.gl.TRIANGLES,this.dbg.setPlant(i),this.mesh.geometry=Xt(this.gl,i.geometry),this.mesh.geometry.computeBoundingBox(),this.scene.renderer.setControlTarget(this.mesh.geometry.bounds.center)}catch(i){Xu.error(i),await Ye(i,{title:"Error [Generator]",values:["report"]})==="report"&&He(gn,{timeout:0,title:"Report Bug",type:"error",props:{mode:"bug",error:i}})}}}}class Ju{constructor(e,t){this.isLoading=me(!1),this.renderer=new ii({canvas:t,camPos:we.get("camPos")}),this.renderer.on("camPos",n=>we.set("camPos",n)),this.renderer.on("perf",n=>Gi("render",n),40),this.renderer.handleResize(),this.scene=this.renderer.scene,this.gl=this.renderer.gl,this.wrapper=t.parentElement,this.bg=new Mu(this,e),this.fg=new qu(this,e)}addMesh(e){const t=new Jn(this.gl,e);return t.setParent(this.scene),t}}function Qi(s){let e,t,n=JSON.stringify(s[1],null,2)+"",i;return{c(){e=b("pre"),t=b("code"),i=X(n),v(t,"class","svelte-jamjfg"),v(e,"class","svelte-jamjfg")},m(o,r){P(o,e,r),y(e,t),y(t,i)},p(o,r){r&2&&n!==(n=JSON.stringify(o[1],null,2)+"")&&se(i,n)},d(o){o&&M(e)}}}function eo(s){let e;return{c(){e=b("div"),e.innerHTML='<p class="svelte-jamjfg">Is Loading</p>',v(e,"class","is-loading svelte-jamjfg")},m(t,n){P(t,e,n)},d(t){t&&M(e)}}}function Zu(s){var d,m;let e,t,n,i,o,r,a,l,c,u,f,h=((m=(d=s[6])==null?void 0:d.debug)==null?void 0:m.pd)&&s[1]&&Qi(s),p=s[7]&&eo();return{c(){var g,w,x,_;e=b("div"),h&&h.c(),t=E(),n=b("div"),i=b("canvas"),r=E(),a=b("canvas"),c=E(),u=b("canvas"),f=E(),p&&p.c(),v(i,"style",o=`display: ${((w=(g=s[6])==null?void 0:g.debug)==null?void 0:w.generatePerf)?"visible":"none"}`),v(i,"class","svelte-jamjfg"),v(a,"style",l=`display: ${((_=(x=s[6])==null?void 0:x.debug)==null?void 0:_.renderPerf)?"visible":"none"}`),v(a,"class","svelte-jamjfg"),v(n,"class","performance-wrapper svelte-jamjfg"),v(u,"class","svelte-jamjfg"),v(e,"class","scene-wrapper svelte-jamjfg")},m(g,w){P(g,e,w),h&&h.m(e,null),y(e,t),y(e,n),y(n,i),s[10](i),y(n,r),y(n,a),s[11](a),y(e,c),y(e,u),s[12](u),y(e,f),p&&p.m(e,null)},p(g,[w]){var x,_,k,C,L,V;((_=(x=g[6])==null?void 0:x.debug)==null?void 0:_.pd)&&g[1]?h?h.p(g,w):(h=Qi(g),h.c(),h.m(e,t)):h&&(h.d(1),h=null),w&64&&o!==(o=`display: ${((C=(k=g[6])==null?void 0:k.debug)==null?void 0:C.generatePerf)?"visible":"none"}`)&&v(i,"style",o),w&64&&l!==(l=`display: ${((V=(L=g[6])==null?void 0:L.debug)==null?void 0:V.renderPerf)?"visible":"none"}`)&&v(a,"style",l),g[7]?p||(p=eo(),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i:O,o:O,d(g){g&&M(e),h&&h.d(),s[10](null),s[11](null),s[12](null),p&&p.d()}}}function Ku(s,e,t){let n,i,o=O,r=()=>(o(),o=es(d,k=>t(6,i=k)),d),a,l=O,c=()=>(l(),l=es(n,k=>t(7,a=k)),n);s.$$.on_destroy.push(()=>o()),s.$$.on_destroy.push(()=>l());let u,f,h,p,d,m,g;De(()=>{Hi("render",g),Hi("generate",m)});function w(k){ae[k?"unshift":"push"](()=>{m=k,t(3,m)})}function x(k){ae[k?"unshift":"push"](()=>{g=k,t(4,g)})}function _(k){ae[k?"unshift":"push"](()=>{u=k,t(0,u)})}return s.$$.update=()=>{s.$$.dirty&257&&u&&le&&!f&&t(8,f=new Ju(le,u)),s.$$.dirty&256&&c(t(5,n=f&&f.isLoading)),s.$$.dirty&512&&le&&(p&&p(),t(9,p=le.on("save",k=>t(1,h=k))))},fe&&r(t(2,d=fe.store)),[u,h,d,m,g,n,i,a,f,p,w,x,_]}class Qu extends Z{constructor(e){super();K(this,e,Ku,Zu,Q,{})}}function ef(s){let e,t,n,i,o,r,a,l,c,u,f,h,p;return t=new pe({props:{name:"Tutorial",icon:"hand"}}),t.$on("click",s[0]),o=new pe({props:{name:"Report Bug",icon:"exclamation"}}),o.$on("click",s[1]),l=new pe({props:{name:"Request Feature"}}),l.$on("click",s[2]),f=new pe({props:{name:"Changelog"}}),f.$on("click",s[3]),{c(){e=b("div"),n=b("div"),R(t.$$.fragment),i=E(),r=b("div"),R(o.$$.fragment),a=E(),c=b("div"),R(l.$$.fragment),u=E(),h=b("div"),R(f.$$.fragment),I(n,"display","contents"),I(n,"--bg","#303030"),I(n,"--text","white"),I(r,"display","contents"),I(r,"--bg","#303030"),I(r,"--text","white"),I(c,"display","contents"),I(c,"--bg","#303030"),I(c,"--text","white"),I(h,"display","contents"),I(h,"--bg","#303030"),I(h,"--text","white"),v(e,"class","svelte-4ypi13")},m(d,m){P(d,e,m),y(e,n),z(t,n,null),y(e,i),y(e,r),z(o,r,null),y(e,a),y(e,c),z(l,c,null),y(e,u),y(e,h),z(f,h,null),p=!0},p:O,i(d){p||(S(t.$$.fragment,d),S(o.$$.fragment,d),S(l.$$.fragment,d),S(f.$$.fragment,d),p=!0)},o(d){N(t.$$.fragment,d),N(o.$$.fragment,d),N(l.$$.fragment,d),N(f.$$.fragment,d),p=!1},d(d){d&&M(e),F(t),F(o),F(l),F(f)}}}function tf(s){return[()=>Fi.restart(),()=>He(gn,{timeout:0,title:"Report Bug",type:"error",props:{mode:"bug"}}),()=>He(gn,{timeout:0,title:"Request Feature",props:{mode:"feat"}}),()=>He(Tu,{timeout:0})]}class nf extends Z{constructor(e){super();K(this,e,tf,ef,Q,{})}}function sf(s){var m,g;let e,t,n,i,o,r=((g=(m=s[0])==null?void 0:m.meta.name)!=null?g:"")+"",a,l,c,u,f,h,p,d;return n=new vn({props:{icon:"folder",name:"Projects",component:Kc}}),u=new vn({props:{icon:"question",component:nf,right:!0}}),h=new vn({props:{icon:"cog",component:fu,right:!0}}),{c(){e=b("header"),t=b("div"),R(n.$$.fragment),i=E(),o=b("h3"),a=X(r),l=E(),c=b("div"),R(u.$$.fragment),f=E(),p=b("div"),R(h.$$.fragment),v(t,"class","left svelte-1dyrwb1"),v(o,"class","svelte-1dyrwb1"),I(p,"display","contents"),I(p,"--min-width","250px"),v(c,"class","right svelte-1dyrwb1"),v(e,"class","svelte-1dyrwb1")},m(w,x){P(w,e,x),y(e,t),z(n,t,null),y(e,i),y(e,o),y(o,a),y(e,l),y(e,c),z(u,c,null),y(c,f),y(c,p),z(h,p,null),d=!0},p(w,[x]){var _,k;(!d||x&1)&&r!==(r=((k=(_=w[0])==null?void 0:_.meta.name)!=null?k:"")+"")&&se(a,r)},i(w){d||(S(n.$$.fragment,w),S(u.$$.fragment,w),S(h.$$.fragment,w),d=!0)},o(w){N(n.$$.fragment,w),N(u.$$.fragment,w),N(h.$$.fragment,w),d=!1},d(w){w&&M(e),F(n),F(u),F(h)}}}function of(s,e,t){let n;const i=le.activeProject;return be(s,i,o=>t(0,n=o)),[n,i]}class rf extends Z{constructor(e){super();K(this,e,of,sf,Q,{})}}function lf(s){let e,t,n,i,o,r,a,l,c,u,f,h,p,d,m;return e=new Qo({}),n=new jr({}),o=new al({}),a=new wu({}),c=new rf({}),h=new Qu({}),{c(){R(e.$$.fragment),t=E(),R(n.$$.fragment),i=E(),R(o.$$.fragment),r=E(),R(a.$$.fragment),l=E(),R(c.$$.fragment),u=E(),f=b("main"),R(h.$$.fragment),p=E(),d=b("div"),v(d,"id","nodesystem-view"),v(d,"class","svelte-1hr3zx4"),v(f,"class","svelte-1hr3zx4")},m(g,w){z(e,g,w),P(g,t,w),z(n,g,w),P(g,i,w),z(o,g,w),P(g,r,w),z(a,g,w),P(g,l,w),z(c,g,w),P(g,u,w),P(g,f,w),z(h,f,null),y(f,p),y(f,d),s[1](d),m=!0},p:O,i(g){m||(S(e.$$.fragment,g),S(n.$$.fragment,g),S(o.$$.fragment,g),S(a.$$.fragment,g),S(c.$$.fragment,g),S(h.$$.fragment,g),m=!0)},o(g){N(e.$$.fragment,g),N(n.$$.fragment,g),N(o.$$.fragment,g),N(a.$$.fragment,g),N(c.$$.fragment,g),N(h.$$.fragment,g),m=!1},d(g){F(e,g),g&&M(t),F(n,g),g&&M(i),F(o,g),g&&M(r),F(a,g),g&&M(l),F(c,g),g&&M(u),g&&M(f),F(h),s[1](null)}}}function af(s,e,t){let n;De(async()=>{n.append(Qe.view.wrapper),Qe.view.handleResize()});function i(o){ae[o?"unshift":"push"](()=>{n=o,t(0,n)})}return[n,i]}class cf extends Z{constructor(e){super();K(this,e,af,lf,Q,{})}}function uf(s){return{c:O,m:O,i:O,o:O,d:O}}function ff(s){let e,t;return e=new cf({}),{c(){R(e.$$.fragment)},m(n,i){z(e,n,i),t=!0},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function hf(s){let e;return{c(){e=b("p"),e.textContent="Loading"},m(t,n){P(t,e,n)},i:O,o:O,d(t){t&&M(e)}}}function df(s){let e,t,n={ctx:s,current:null,token:null,hasCatch:!1,pending:hf,then:ff,catch:uf,value:0,blocks:[,,,]};return Tt(fe.loadFromLocal(),n),{c(){e=oe(),n.block.c()},m(i,o){P(i,e,o),n.block.m(i,n.anchor=o),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(i,[o]){s=i},i(i){t||(S(n.block),t=!0)},o(i){for(let o=0;o<3;o+=1){const r=n.blocks[o];N(r)}t=!1},d(i){i&&M(e),n.block.d(i),n.token=null,n=null}}}class pf extends Z{constructor(e){super();K(this,e,null,df,Q,{})}}let mf;try{mf=new pf({target:document.body})}catch(s){console.log(s)}
//# sourceMappingURL=index.69b2c62b.js.map
