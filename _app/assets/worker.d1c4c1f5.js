var d0=Object.defineProperty;var Be=Object.getOwnPropertySymbols;var x0=Object.prototype.hasOwnProperty,M0=Object.prototype.propertyIsEnumerable;var Ge=(U,F,L)=>F in U?d0(U,F,{enumerable:!0,configurable:!0,writable:!0,value:L}):U[F]=L,m1=(U,F)=>{for(var L in F||(F={}))x0.call(F,L)&&Ge(U,L,F[L]);if(Be)for(var L of Be(F))M0.call(F,L)&&Ge(U,L,F[L]);return U};(function(){"use strict";const U=class extends Error{constructor(e,n={}){super(e),this.detail=e,this.meta=n}static fromParent(e,n,t,r){return new U(t,Object.assign({cause:e},r))}getCause(){return this.meta.cause||void 0}unwrapChain(e=this){return U.unwrapChain(e)}};let F=U;F.unwrapChain=e=>{const n=[e];let t=e.getCause();for(;t;)n.push(t),t=t.getCause();return n};const L=.4;function He(e,n,t,r,a,s,i,c,l,o){const f=a-t,v=i-a,h=l-i,u=s-r,y=c-s,m=o-c;let p,d,w,x,M=-1e4,b=-1e4;const g=[{x:t,y:r}];for(let _=1;_<e;_++){const z=_/e;p=t+f*z,w=a+v*z;const E=i+h*z;p+=(w-p)*z,w+=(E-w)*z,d=r+u*z,x=s+y*z;const O=c+m*z;d+=(x-d)*z,x+=(O-x)*z;const D=p+(w-p)*z,S=d+(x-d)*z,R=D-M,A=S-b;R*R+A*A>n&&(g.push({x:D,y:S}),M=D,b=S)}return g.push({x:l,y:o}),g}function Ye(e){const n=e.length-1;return e.map((t,r,a)=>{if(r===0)return{rx:a[r+1].x*L*0,ry:t.y+(a[r+1].y-t.y)*L*0};if(r===n)return{lx:a[r-1].x+(t.x-a[r-1].x)*L*2,ly:a[r-1].y+(t.y-a[r-1].y)*L*2};if(t.y>a[r+1].y&&t.y>a[r-1].y||t.y<a[r+1].y&&t.y<a[r-1].y)return{lx:a[r-1].x+(t.x-a[r-1].x)*L,ly:t.y,rx:t.x+(a[r+1].x-t.x)*L,ry:t.y};{const i={x:a[r-1].x-a[r+1].x,y:a[r-1].y-a[r+1].y},c=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));i.x/=c,i.y/=c;const l=a[r+1].x-t.x,o=t.x-a[r-1].x;return{lx:t.x+i.x*o*L,ly:t.y+i.y*o*L,rx:t.x-i.x*l*L,ry:t.y-i.y*l*L}}})}function Ze(e){const n=e.length-1,t={},r=Ye(e);return e.map((a,s,i)=>{if(s<n)return He(n*20,0,a.x,a.y,r[s].rx,r[s].ry,r[s+1].lx,r[s+1].ly,i[s+1].x,i[s+1].y)}).flat().filter(a=>!a||a.x in t?!1:(t[a.x]=!0,!0))}var t1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Qe={exports:{}};(function(e,n){(function(t,r){r()})(t1,function(){function t(o,f){return typeof f=="undefined"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function r(o,f,v){var h=new XMLHttpRequest;h.open("GET",o),h.responseType="blob",h.onload=function(){l(h.response,f,v)},h.onerror=function(){console.error("could not download file")},h.send()}function a(o){var f=new XMLHttpRequest;f.open("HEAD",o,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function s(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(f)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof t1=="object"&&t1.global===t1?t1:void 0,c=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(o,f,v){var h=i.URL||i.webkitURL,u=document.createElement("a");f=f||o.name||"download",u.download=f,u.rel="noopener",typeof o=="string"?(u.href=o,u.origin===location.origin?s(u):a(u.href)?r(o,f,v):s(u,u.target="_blank")):(u.href=h.createObjectURL(o),setTimeout(function(){h.revokeObjectURL(u.href)},4e4),setTimeout(function(){s(u)},0))}:"msSaveOrOpenBlob"in navigator?function(o,f,v){if(f=f||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(t(o,v),f);else if(a(o))r(o,f,v);else{var h=document.createElement("a");h.href=o,h.target="_blank",setTimeout(function(){s(h)})}}:function(o,f,v,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof o=="string")return r(o,f,v);var u=o.type==="application/octet-stream",y=/constructor/i.test(i.HTMLElement)||i.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||u&&y||c)&&typeof FileReader!="undefined"){var p=new FileReader;p.onloadend=function(){var x=p.result;x=m?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=x:location=x,h=null},p.readAsDataURL(o)}else{var d=i.URL||i.webkitURL,w=d.createObjectURL(o);h?h.location=w:location.href=w,h=null,setTimeout(function(){d.revokeObjectURL(w)},4e4)}});i.saveAs=l.saveAs=l,e.exports=l})})(Qe);const We={amountEmitters:0,amountCallbacks:0,emitters:[]};typeof self!="undefined"&&"window"in self&&(globalThis.debug=We);function Xe(e,n){const t=[],r=e.length/n;for(let a=0;a<r;a++){const s=[];for(let i=0;i<n;i++)s[i]=e[a*n+i];t.push(s)}return t}function R1(e){let n,t={length:NaN};const r=(a,s)=>a===t[s];return function(...s){return(s.length!==t.length||!s.every(r))&&(t=s,n=e.apply(this,s)),n}}function ne(e){let n=e[0],t=e[1],r=e[2];return Math.sqrt(n*n+t*t+r*r)}function N1(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ke(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e}function te(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function re(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function Je(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function Ke(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function $1(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function en(e,n){let t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return Math.sqrt(t*t+r*r+a*a)}function nn(e,n){let t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return t*t+r*r+a*a}function ae(e){let n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function tn(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function rn(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function T1(e,n){let t=n[0],r=n[1],a=n[2],s=t*t+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function se(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function ie(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[0],c=t[1],l=t[2];return e[0]=a*l-s*c,e[1]=s*i-r*l,e[2]=r*c-a*i,e}function an(e,n,t,r){let a=n[0],s=n[1],i=n[2];return e[0]=a+r*(t[0]-a),e[1]=s+r*(t[1]-s),e[2]=i+r*(t[2]-i),e}function sn(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s+t[12])/i,e[1]=(t[1]*r+t[5]*a+t[9]*s+t[13])/i,e[2]=(t[2]*r+t[6]*a+t[10]*s+t[14])/i,e}function cn(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s)/i,e[1]=(t[1]*r+t[5]*a+t[9]*s)/i,e[2]=(t[2]*r+t[6]*a+t[10]*s)/i,e}function ln(e,n,t){let r=n[0],a=n[1],s=n[2],i=t[0],c=t[1],l=t[2],o=t[3],f=c*s-l*a,v=l*r-i*s,h=i*a-c*r,u=c*h-l*v,y=l*f-i*h,m=i*v-c*f,p=o*2;return f*=p,v*=p,h*=p,u*=2,y*=2,m*=2,e[0]=r+f+u,e[1]=a+v+y,e[2]=s+h+m,e}const on=function(){const e=[0,0,0],n=[0,0,0];return function(t,r){N1(e,t),N1(n,r),T1(e,e),T1(n,n);let a=se(e,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}}();function fn(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}const vn=e=>!!e.length;class I extends Array{constructor(n=0,t=n,r=n){return super(n,t,r),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(n){this[0]=n}set y(n){this[1]=n}set z(n){this[2]=n}set(n,t=n,r=n){return vn(n)?this.copy(n):(ke(this,n,t,r),this)}copy(n){return N1(this,n),this}add(n,t){return t?te(this,n,t):te(this,this,n),this}sub(n,t){return t?re(this,n,t):re(this,this,n),this}multiply(n){return n.length?Je(this,this,n):$1(this,this,n),this}divide(n){return n.length?Ke(this,this,n):$1(this,this,1/n),this}inverse(n=this){return rn(this,n),this}len(){return ne(this)}distance(n){return n?en(this,n):ne(this)}squaredLen(){return ae(this)}squaredDistance(n){return n?nn(this,n):ae(this)}negate(n=this){return tn(this,n),this}cross(n,t){return t?ie(this,n,t):ie(this,this,n),this}scale(n){return $1(this,this,n),this}normalize(){return T1(this,this),this}dot(n){return se(this,n)}equals(n){return fn(this,n)}applyMatrix4(n){return sn(this,this,n),this}scaleRotateMatrix4(n){return cn(this,this,n),this}applyQuaternion(n){return ln(this,this,n),this}angle(n){return on(this,n)}lerp(n,t){return an(this,this,n,t),this}clone(){return new I(this[0],this[1],this[2])}fromArray(n,t=0){return this[0]=n[t],this[1]=n[t+1],this[2]=n[t+2],this}toArray(n=[],t=0){return n[t]=this[0],n[t+1]=this[1],n[t+2]=this[2],n}transformDirection(n){const t=this[0],r=this[1],a=this[2];return this[0]=n[0]*t+n[4]*r+n[8]*a,this[1]=n[1]*t+n[5]*r+n[9]*a,this[2]=n[2]*t+n[6]*r+n[10]*a,this.normalize()}}function L1(){}function hn(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}Promise.resolve();const k=[];function pn(e,n=L1){let t;const r=new Set;function a(c){if(hn(e,c)&&(e=c,t)){const l=!k.length;for(const o of r)o[1](),k.push(o,e);if(l){for(let o=0;o<k.length;o+=2)k[o][0](k[o+1]);k.length=0}}}function s(c){a(c(e))}function i(c,l=L1){const o=[c,l];return r.add(o),r.size===1&&(t=n(a)||L1),c(e),()=>{r.delete(o),r.size===0&&(t(),t=null)}}return{set:a,update:s,subscribe:i}}const mn=typeof globalThis.WorkerGlobalScope!="undefined"&&self instanceof globalThis.WorkerGlobalScope;let u1=[],y1=2,J=0,ce=0;const P1="plant.log.history",j1="localStorage"in globalThis,r1=j1?P1 in localStorage?JSON.parse(localStorage.getItem(P1)):[]:[];j1&&(y1=parseInt(localStorage.getItem("pt-log-level"))||2);function un(){j1&&localStorage.setItem(P1,JSON.stringify(r1))}let K;function e1(e){J=Math.max(J,e.length);const n=ce;ce++;const t=(a,s)=>{if(!mn&&(r1.push({scope:e,args:a,level:y1}),r1.length=Math.min(100,r1.length),K&&K.set(r1),un(),(!u1.length||u1.includes(e))&&s<=y1)){if(a instanceof Error){console.error(`[${e.padEnd(J," ")}]`,a);return}if(Array.isArray(a)&&typeof a[0]=="string"&&typeof a[1]=="object"){console.groupCollapsed(`%c[${e.padEnd(J," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,a[0]),console.log(...a.slice(1)),console.groupEnd();return}s===0&&console.log(`%c[${e.padEnd(J," ")}]`,`color: hsl(${n*30}deg 68% 64%); font-weight: bold;`,...a),s===1&&console.warn(`[${e.padEnd(J," ")}]`,...a)}},r=(...a)=>t(a,2);return r.warn=(...a)=>t(a,1),r.error=a=>t(a,0),r}e1.getStore=function(){return K||(K=pn([]),K)},e1.setFilter=(...e)=>{u1=e,console.log("[log] set filter",{filters:u1})},e1.setLevel=(e=0)=>{y1=e,localStorage.setItem("pt-log-level",""+e)};let le;function yn(e){const n=e.position,t=e.index,r=e.normal;for(let a=0;a<t.length/3;a++){const s=new I(n[t[a*3+0]*3+0],n[t[a*3+0]*3+1],n[t[a*3+0]*3+2]),i=new I(n[t[a*3+1]*3+0]-s.x,n[t[a*3+1]*3+1]-s.y,n[t[a*3+1]*3+2]-s.z),c=new I(n[t[a*3+2]*3+0]-s.x,n[t[a*3+2]*3+1]-s.y,n[t[a*3+2]*3+2]-s.z);let l=new I().cross(i,c).normalize();l[0]===0&&l[1]===0&&l[3]===0&&(l=le);for(let o=0;o<3;o++)r[t[a*3+o]*3+0]=l.x,r[t[a*3+o]*3+1]=l.y,r[t[a*3+o]*3+2]=l.z;le=l}return e}function dn(e,n=[0,0,0],t=[0,0,0],r=[1,1,1]){const a=new Float32Array(e.position.length),s=e.position.length,i=e.position;for(let c=0;c<s;c+=3){const l=i[c+0]*r[0],o=i[c+1]*r[1],f=i[c+2]*r[2],v=l,h=Math.cos(t[0])*o-Math.sin(t[0])*f,u=Math.sin(t[0])*o+Math.cos(t[0])*f,y=Math.cos(t[1])*v-Math.sin(t[1])*u,m=h,p=Math.sin(t[1])*v+Math.cos(t[1])*u;a[c+0]=y+n[0],a[c+1]=m+n[1],a[c+2]=p+n[2]}return{position:a,uv:e.uv,normal:e.normal,index:e.index}}function xn(e){const n=[],t={position:e.position,normal:e.position,uv:e.uv,index:e.index},r=e.offset,a=e.rotation,s=e.scale,i=e.offset.length;for(let c=0;c<i;c+=3)n.push(dn(t,[r[c+0],r[c+1],r[c+2]],[a[c+0],a[c+1],a[c+2]],[s[c+0],s[c+1],s[c+2]]));return n}var T=1e-6,B=typeof Float32Array!="undefined"?Float32Array:Array,oe=Math.random;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function Mn(){var e=new B(16);return B!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function gn(e){var n=new B(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function wn(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function bn(e,n,t,r,a,s,i,c,l,o,f,v,h,u,y,m){var p=new B(16);return p[0]=e,p[1]=n,p[2]=t,p[3]=r,p[4]=a,p[5]=s,p[6]=i,p[7]=c,p[8]=l,p[9]=o,p[10]=f,p[11]=v,p[12]=h,p[13]=u,p[14]=y,p[15]=m,p}function zn(e,n,t,r,a,s,i,c,l,o,f,v,h,u,y,m,p){return e[0]=n,e[1]=t,e[2]=r,e[3]=a,e[4]=s,e[5]=i,e[6]=c,e[7]=l,e[8]=o,e[9]=f,e[10]=v,e[11]=h,e[12]=u,e[13]=y,e[14]=m,e[15]=p,e}function fe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Sn(e,n){if(e===n){var t=n[1],r=n[2],a=n[3],s=n[6],i=n[7],c=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=r,e[9]=s,e[11]=n[14],e[12]=a,e[13]=i,e[14]=c}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}function An(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=n[4],c=n[5],l=n[6],o=n[7],f=n[8],v=n[9],h=n[10],u=n[11],y=n[12],m=n[13],p=n[14],d=n[15],w=t*c-r*i,x=t*l-a*i,M=t*o-s*i,b=r*l-a*c,g=r*o-s*c,_=a*o-s*l,z=f*m-v*y,E=f*p-h*y,O=f*d-u*y,D=v*p-h*m,S=v*d-u*m,R=h*d-u*p,A=w*R-x*S+M*D+b*O-g*E+_*z;return A?(A=1/A,e[0]=(c*R-l*S+o*D)*A,e[1]=(a*S-r*R-s*D)*A,e[2]=(m*_-p*g+d*b)*A,e[3]=(h*g-v*_-u*b)*A,e[4]=(l*O-i*R-o*E)*A,e[5]=(t*R-a*O+s*E)*A,e[6]=(p*M-y*_-d*x)*A,e[7]=(f*_-h*M+u*x)*A,e[8]=(i*S-c*O+o*z)*A,e[9]=(r*O-t*S-s*z)*A,e[10]=(y*g-m*M+d*w)*A,e[11]=(v*M-f*g-u*w)*A,e[12]=(c*E-i*D-l*z)*A,e[13]=(t*D-r*E+a*z)*A,e[14]=(m*x-y*b-p*w)*A,e[15]=(f*b-v*x+h*w)*A,e):null}function _n(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=n[4],c=n[5],l=n[6],o=n[7],f=n[8],v=n[9],h=n[10],u=n[11],y=n[12],m=n[13],p=n[14],d=n[15];return e[0]=c*(h*d-u*p)-v*(l*d-o*p)+m*(l*u-o*h),e[1]=-(r*(h*d-u*p)-v*(a*d-s*p)+m*(a*u-s*h)),e[2]=r*(l*d-o*p)-c*(a*d-s*p)+m*(a*o-s*l),e[3]=-(r*(l*u-o*h)-c*(a*u-s*h)+v*(a*o-s*l)),e[4]=-(i*(h*d-u*p)-f*(l*d-o*p)+y*(l*u-o*h)),e[5]=t*(h*d-u*p)-f*(a*d-s*p)+y*(a*u-s*h),e[6]=-(t*(l*d-o*p)-i*(a*d-s*p)+y*(a*o-s*l)),e[7]=t*(l*u-o*h)-i*(a*u-s*h)+f*(a*o-s*l),e[8]=i*(v*d-u*m)-f*(c*d-o*m)+y*(c*u-o*v),e[9]=-(t*(v*d-u*m)-f*(r*d-s*m)+y*(r*u-s*v)),e[10]=t*(c*d-o*m)-i*(r*d-s*m)+y*(r*o-s*c),e[11]=-(t*(c*u-o*v)-i*(r*u-s*v)+f*(r*o-s*c)),e[12]=-(i*(v*p-h*m)-f*(c*p-l*m)+y*(c*h-l*v)),e[13]=t*(v*p-h*m)-f*(r*p-a*m)+y*(r*h-a*v),e[14]=-(t*(c*p-l*m)-i*(r*p-a*m)+y*(r*l-a*c)),e[15]=t*(c*h-l*v)-i*(r*h-a*v)+f*(r*l-a*c),e}function Dn(e){var n=e[0],t=e[1],r=e[2],a=e[3],s=e[4],i=e[5],c=e[6],l=e[7],o=e[8],f=e[9],v=e[10],h=e[11],u=e[12],y=e[13],m=e[14],p=e[15],d=n*i-t*s,w=n*c-r*s,x=n*l-a*s,M=t*c-r*i,b=t*l-a*i,g=r*l-a*c,_=o*y-f*u,z=o*m-v*u,E=o*p-h*u,O=f*m-v*y,D=f*p-h*y,S=v*p-h*m;return d*S-w*D+x*O+M*E-b*z+g*_}function ve(e,n,t){var r=n[0],a=n[1],s=n[2],i=n[3],c=n[4],l=n[5],o=n[6],f=n[7],v=n[8],h=n[9],u=n[10],y=n[11],m=n[12],p=n[13],d=n[14],w=n[15],x=t[0],M=t[1],b=t[2],g=t[3];return e[0]=x*r+M*c+b*v+g*m,e[1]=x*a+M*l+b*h+g*p,e[2]=x*s+M*o+b*u+g*d,e[3]=x*i+M*f+b*y+g*w,x=t[4],M=t[5],b=t[6],g=t[7],e[4]=x*r+M*c+b*v+g*m,e[5]=x*a+M*l+b*h+g*p,e[6]=x*s+M*o+b*u+g*d,e[7]=x*i+M*f+b*y+g*w,x=t[8],M=t[9],b=t[10],g=t[11],e[8]=x*r+M*c+b*v+g*m,e[9]=x*a+M*l+b*h+g*p,e[10]=x*s+M*o+b*u+g*d,e[11]=x*i+M*f+b*y+g*w,x=t[12],M=t[13],b=t[14],g=t[15],e[12]=x*r+M*c+b*v+g*m,e[13]=x*a+M*l+b*h+g*p,e[14]=x*s+M*o+b*u+g*d,e[15]=x*i+M*f+b*y+g*w,e}function En(e,n,t){var r=t[0],a=t[1],s=t[2],i,c,l,o,f,v,h,u,y,m,p,d;return n===e?(e[12]=n[0]*r+n[4]*a+n[8]*s+n[12],e[13]=n[1]*r+n[5]*a+n[9]*s+n[13],e[14]=n[2]*r+n[6]*a+n[10]*s+n[14],e[15]=n[3]*r+n[7]*a+n[11]*s+n[15]):(i=n[0],c=n[1],l=n[2],o=n[3],f=n[4],v=n[5],h=n[6],u=n[7],y=n[8],m=n[9],p=n[10],d=n[11],e[0]=i,e[1]=c,e[2]=l,e[3]=o,e[4]=f,e[5]=v,e[6]=h,e[7]=u,e[8]=y,e[9]=m,e[10]=p,e[11]=d,e[12]=i*r+f*a+y*s+n[12],e[13]=c*r+v*a+m*s+n[13],e[14]=l*r+h*a+p*s+n[14],e[15]=o*r+u*a+d*s+n[15]),e}function On(e,n,t){var r=t[0],a=t[1],s=t[2];return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=n[3]*r,e[4]=n[4]*a,e[5]=n[5]*a,e[6]=n[6]*a,e[7]=n[7]*a,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=n[11]*s,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function Rn(e,n,t,r){var a=r[0],s=r[1],i=r[2],c=Math.hypot(a,s,i),l,o,f,v,h,u,y,m,p,d,w,x,M,b,g,_,z,E,O,D,S,R,A,N;return c<T?null:(c=1/c,a*=c,s*=c,i*=c,l=Math.sin(t),o=Math.cos(t),f=1-o,v=n[0],h=n[1],u=n[2],y=n[3],m=n[4],p=n[5],d=n[6],w=n[7],x=n[8],M=n[9],b=n[10],g=n[11],_=a*a*f+o,z=s*a*f+i*l,E=i*a*f-s*l,O=a*s*f-i*l,D=s*s*f+o,S=i*s*f+a*l,R=a*i*f+s*l,A=s*i*f-a*l,N=i*i*f+o,e[0]=v*_+m*z+x*E,e[1]=h*_+p*z+M*E,e[2]=u*_+d*z+b*E,e[3]=y*_+w*z+g*E,e[4]=v*O+m*D+x*S,e[5]=h*O+p*D+M*S,e[6]=u*O+d*D+b*S,e[7]=y*O+w*D+g*S,e[8]=v*R+m*A+x*N,e[9]=h*R+p*A+M*N,e[10]=u*R+d*A+b*N,e[11]=y*R+w*A+g*N,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}function Nn(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[4],i=n[5],c=n[6],l=n[7],o=n[8],f=n[9],v=n[10],h=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=s*a+o*r,e[5]=i*a+f*r,e[6]=c*a+v*r,e[7]=l*a+h*r,e[8]=o*a-s*r,e[9]=f*a-i*r,e[10]=v*a-c*r,e[11]=h*a-l*r,e}function $n(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[0],i=n[1],c=n[2],l=n[3],o=n[8],f=n[9],v=n[10],h=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*a-o*r,e[1]=i*a-f*r,e[2]=c*a-v*r,e[3]=l*a-h*r,e[8]=s*r+o*a,e[9]=i*r+f*a,e[10]=c*r+v*a,e[11]=l*r+h*a,e}function Tn(e,n,t){var r=Math.sin(t),a=Math.cos(t),s=n[0],i=n[1],c=n[2],l=n[3],o=n[4],f=n[5],v=n[6],h=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*a+o*r,e[1]=i*a+f*r,e[2]=c*a+v*r,e[3]=l*a+h*r,e[4]=o*a-s*r,e[5]=f*a-i*r,e[6]=v*a-c*r,e[7]=h*a-l*r,e}function Ln(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Pn(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jn(e,n,t){var r=t[0],a=t[1],s=t[2],i=Math.hypot(r,a,s),c,l,o;return i<T?null:(i=1/i,r*=i,a*=i,s*=i,c=Math.sin(n),l=Math.cos(n),o=1-l,e[0]=r*r*o+l,e[1]=a*r*o+s*c,e[2]=s*r*o-a*c,e[3]=0,e[4]=r*a*o-s*c,e[5]=a*a*o+l,e[6]=s*a*o+r*c,e[7]=0,e[8]=r*s*o+a*c,e[9]=a*s*o-r*c,e[10]=s*s*o+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function qn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cn(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function he(e,n,t){var r=n[0],a=n[1],s=n[2],i=n[3],c=r+r,l=a+a,o=s+s,f=r*c,v=r*l,h=r*o,u=a*l,y=a*o,m=s*o,p=i*c,d=i*l,w=i*o;return e[0]=1-(u+m),e[1]=v+w,e[2]=h-d,e[3]=0,e[4]=v-w,e[5]=1-(f+m),e[6]=y+p,e[7]=0,e[8]=h+d,e[9]=y-p,e[10]=1-(f+u),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Fn(e,n){var t=new B(3),r=-n[0],a=-n[1],s=-n[2],i=n[3],c=n[4],l=n[5],o=n[6],f=n[7],v=r*r+a*a+s*s+i*i;return v>0?(t[0]=(c*i+f*r+l*s-o*a)*2/v,t[1]=(l*i+f*a+o*r-c*s)*2/v,t[2]=(o*i+f*s+c*a-l*r)*2/v):(t[0]=(c*i+f*r+l*s-o*a)*2,t[1]=(l*i+f*a+o*r-c*s)*2,t[2]=(o*i+f*s+c*a-l*r)*2),he(e,n,t),e}function Un(e,n){return e[0]=n[12],e[1]=n[13],e[2]=n[14],e}function pe(e,n){var t=n[0],r=n[1],a=n[2],s=n[4],i=n[5],c=n[6],l=n[8],o=n[9],f=n[10];return e[0]=Math.hypot(t,r,a),e[1]=Math.hypot(s,i,c),e[2]=Math.hypot(l,o,f),e}function In(e,n){var t=new B(3);pe(t,n);var r=1/t[0],a=1/t[1],s=1/t[2],i=n[0]*r,c=n[1]*a,l=n[2]*s,o=n[4]*r,f=n[5]*a,v=n[6]*s,h=n[8]*r,u=n[9]*a,y=n[10]*s,m=i+f+y,p=0;return m>0?(p=Math.sqrt(m+1)*2,e[3]=.25*p,e[0]=(v-u)/p,e[1]=(h-l)/p,e[2]=(c-o)/p):i>f&&i>y?(p=Math.sqrt(1+i-f-y)*2,e[3]=(v-u)/p,e[0]=.25*p,e[1]=(c+o)/p,e[2]=(h+l)/p):f>y?(p=Math.sqrt(1+f-i-y)*2,e[3]=(h-l)/p,e[0]=(c+o)/p,e[1]=.25*p,e[2]=(v+u)/p):(p=Math.sqrt(1+y-i-f)*2,e[3]=(c-o)/p,e[0]=(h+l)/p,e[1]=(v+u)/p,e[2]=.25*p),e}function Bn(e,n,t,r){var a=n[0],s=n[1],i=n[2],c=n[3],l=a+a,o=s+s,f=i+i,v=a*l,h=a*o,u=a*f,y=s*o,m=s*f,p=i*f,d=c*l,w=c*o,x=c*f,M=r[0],b=r[1],g=r[2];return e[0]=(1-(y+p))*M,e[1]=(h+x)*M,e[2]=(u-w)*M,e[3]=0,e[4]=(h-x)*b,e[5]=(1-(v+p))*b,e[6]=(m+d)*b,e[7]=0,e[8]=(u+w)*g,e[9]=(m-d)*g,e[10]=(1-(v+y))*g,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Gn(e,n,t,r,a){var s=n[0],i=n[1],c=n[2],l=n[3],o=s+s,f=i+i,v=c+c,h=s*o,u=s*f,y=s*v,m=i*f,p=i*v,d=c*v,w=l*o,x=l*f,M=l*v,b=r[0],g=r[1],_=r[2],z=a[0],E=a[1],O=a[2],D=(1-(m+d))*b,S=(u+M)*b,R=(y-x)*b,A=(u-M)*g,N=(1-(h+d))*g,P=(p+w)*g,$=(y+x)*_,q=(p-w)*_,V=(1-(h+m))*_;return e[0]=D,e[1]=S,e[2]=R,e[3]=0,e[4]=A,e[5]=N,e[6]=P,e[7]=0,e[8]=$,e[9]=q,e[10]=V,e[11]=0,e[12]=t[0]+z-(D*z+A*E+$*O),e[13]=t[1]+E-(S*z+N*E+q*O),e[14]=t[2]+O-(R*z+P*E+V*O),e[15]=1,e}function Hn(e,n){var t=n[0],r=n[1],a=n[2],s=n[3],i=t+t,c=r+r,l=a+a,o=t*i,f=r*i,v=r*c,h=a*i,u=a*c,y=a*l,m=s*i,p=s*c,d=s*l;return e[0]=1-v-y,e[1]=f+d,e[2]=h-p,e[3]=0,e[4]=f-d,e[5]=1-o-y,e[6]=u+m,e[7]=0,e[8]=h+p,e[9]=u-m,e[10]=1-o-v,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Yn(e,n,t,r,a,s,i){var c=1/(t-n),l=1/(a-r),o=1/(s-i);return e[0]=s*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(t+n)*c,e[9]=(a+r)*l,e[10]=(i+s)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*s*2*o,e[15]=0,e}function me(e,n,t,r,a){var s=1/Math.tan(n/2),i;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(i=1/(r-a),e[10]=(a+r)*i,e[14]=2*a*r*i):(e[10]=-1,e[14]=-2*r),e}var Zn=me;function Qn(e,n,t,r,a){var s=1/Math.tan(n/2),i;return e[0]=s/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(i=1/(r-a),e[10]=a*i,e[14]=a*r*i):(e[10]=-1,e[14]=-r),e}function Wn(e,n,t,r){var a=Math.tan(n.upDegrees*Math.PI/180),s=Math.tan(n.downDegrees*Math.PI/180),i=Math.tan(n.leftDegrees*Math.PI/180),c=Math.tan(n.rightDegrees*Math.PI/180),l=2/(i+c),o=2/(a+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=-((i-c)*l*.5),e[9]=(a-s)*o*.5,e[10]=r/(t-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*t/(t-r),e[15]=0,e}function ue(e,n,t,r,a,s,i){var c=1/(n-t),l=1/(r-a),o=1/(s-i);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*o,e[11]=0,e[12]=(n+t)*c,e[13]=(a+r)*l,e[14]=(i+s)*o,e[15]=1,e}var Xn=ue;function kn(e,n,t,r,a,s,i){var c=1/(n-t),l=1/(r-a),o=1/(s-i);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=o,e[11]=0,e[12]=(n+t)*c,e[13]=(a+r)*l,e[14]=s*o,e[15]=1,e}function Jn(e,n,t,r){var a,s,i,c,l,o,f,v,h,u,y=n[0],m=n[1],p=n[2],d=r[0],w=r[1],x=r[2],M=t[0],b=t[1],g=t[2];return Math.abs(y-M)<T&&Math.abs(m-b)<T&&Math.abs(p-g)<T?fe(e):(f=y-M,v=m-b,h=p-g,u=1/Math.hypot(f,v,h),f*=u,v*=u,h*=u,a=w*h-x*v,s=x*f-d*h,i=d*v-w*f,u=Math.hypot(a,s,i),u?(u=1/u,a*=u,s*=u,i*=u):(a=0,s=0,i=0),c=v*i-h*s,l=h*a-f*i,o=f*s-v*a,u=Math.hypot(c,l,o),u?(u=1/u,c*=u,l*=u,o*=u):(c=0,l=0,o=0),e[0]=a,e[1]=c,e[2]=f,e[3]=0,e[4]=s,e[5]=l,e[6]=v,e[7]=0,e[8]=i,e[9]=o,e[10]=h,e[11]=0,e[12]=-(a*y+s*m+i*p),e[13]=-(c*y+l*m+o*p),e[14]=-(f*y+v*m+h*p),e[15]=1,e)}function Kn(e,n,t,r){var a=n[0],s=n[1],i=n[2],c=r[0],l=r[1],o=r[2],f=a-t[0],v=s-t[1],h=i-t[2],u=f*f+v*v+h*h;u>0&&(u=1/Math.sqrt(u),f*=u,v*=u,h*=u);var y=l*h-o*v,m=o*f-c*h,p=c*v-l*f;return u=y*y+m*m+p*p,u>0&&(u=1/Math.sqrt(u),y*=u,m*=u,p*=u),e[0]=y,e[1]=m,e[2]=p,e[3]=0,e[4]=v*p-h*m,e[5]=h*y-f*p,e[6]=f*m-v*y,e[7]=0,e[8]=f,e[9]=v,e[10]=h,e[11]=0,e[12]=a,e[13]=s,e[14]=i,e[15]=1,e}function et(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function nt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function tt(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e[8]=n[8]+t[8],e[9]=n[9]+t[9],e[10]=n[10]+t[10],e[11]=n[11]+t[11],e[12]=n[12]+t[12],e[13]=n[13]+t[13],e[14]=n[14]+t[14],e[15]=n[15]+t[15],e}function ye(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e[6]=n[6]-t[6],e[7]=n[7]-t[7],e[8]=n[8]-t[8],e[9]=n[9]-t[9],e[10]=n[10]-t[10],e[11]=n[11]-t[11],e[12]=n[12]-t[12],e[13]=n[13]-t[13],e[14]=n[14]-t[14],e[15]=n[15]-t[15],e}function rt(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=n[11]*t,e[12]=n[12]*t,e[13]=n[13]*t,e[14]=n[14]*t,e[15]=n[15]*t,e}function at(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e[4]=n[4]+t[4]*r,e[5]=n[5]+t[5]*r,e[6]=n[6]+t[6]*r,e[7]=n[7]+t[7]*r,e[8]=n[8]+t[8]*r,e[9]=n[9]+t[9]*r,e[10]=n[10]+t[10]*r,e[11]=n[11]+t[11]*r,e[12]=n[12]+t[12]*r,e[13]=n[13]+t[13]*r,e[14]=n[14]+t[14]*r,e[15]=n[15]+t[15]*r,e}function st(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}function it(e,n){var t=e[0],r=e[1],a=e[2],s=e[3],i=e[4],c=e[5],l=e[6],o=e[7],f=e[8],v=e[9],h=e[10],u=e[11],y=e[12],m=e[13],p=e[14],d=e[15],w=n[0],x=n[1],M=n[2],b=n[3],g=n[4],_=n[5],z=n[6],E=n[7],O=n[8],D=n[9],S=n[10],R=n[11],A=n[12],N=n[13],P=n[14],$=n[15];return Math.abs(t-w)<=T*Math.max(1,Math.abs(t),Math.abs(w))&&Math.abs(r-x)<=T*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-M)<=T*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-b)<=T*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(i-g)<=T*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(c-_)<=T*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(l-z)<=T*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(o-E)<=T*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(f-O)<=T*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(v-D)<=T*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(h-S)<=T*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(u-R)<=T*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(y-A)<=T*Math.max(1,Math.abs(y),Math.abs(A))&&Math.abs(m-N)<=T*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(p-P)<=T*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-$)<=T*Math.max(1,Math.abs(d),Math.abs($))}var ct=ve,lt=ye,ot=Object.freeze({__proto__:null,create:Mn,clone:gn,copy:wn,fromValues:bn,set:zn,identity:fe,transpose:Sn,invert:An,adjoint:_n,determinant:Dn,multiply:ve,translate:En,scale:On,rotate:Rn,rotateX:Nn,rotateY:$n,rotateZ:Tn,fromTranslation:Ln,fromScaling:Pn,fromRotation:jn,fromXRotation:qn,fromYRotation:Vn,fromZRotation:Cn,fromRotationTranslation:he,fromQuat2:Fn,getTranslation:Un,getScaling:pe,getRotation:In,fromRotationTranslationScale:Bn,fromRotationTranslationScaleOrigin:Gn,fromQuat:Hn,frustum:Yn,perspectiveNO:me,perspective:Zn,perspectiveZO:Qn,perspectiveFromFieldOfView:Wn,orthoNO:ue,ortho:Xn,orthoZO:kn,lookAt:Jn,targetTo:Kn,str:et,frob:nt,add:tt,subtract:ye,multiplyScalar:rt,multiplyScalarAndAdd:at,exactEquals:st,equals:it,mul:ct,sub:lt});function de(){var e=new B(3);return B!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ft(e){var n=new B(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function xe(e){var n=e[0],t=e[1],r=e[2];return Math.hypot(n,t,r)}function vt(e,n,t){var r=new B(3);return r[0]=e,r[1]=n,r[2]=t,r}function ht(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function pt(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e}function mt(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function Me(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function ge(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function we(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function ut(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}function yt(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}function dt(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e}function xt(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e}function Mt(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e}function gt(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function wt(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e}function be(e,n){var t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return Math.hypot(t,r,a)}function ze(e,n){var t=n[0]-e[0],r=n[1]-e[1],a=n[2]-e[2];return t*t+r*r+a*a}function Se(e){var n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function bt(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function zt(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function St(e,n){var t=n[0],r=n[1],a=n[2],s=t*t+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e}function Ae(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function At(e,n,t){var r=n[0],a=n[1],s=n[2],i=t[0],c=t[1],l=t[2];return e[0]=a*l-s*c,e[1]=s*i-r*l,e[2]=r*c-a*i,e}function _t(e,n,t,r){var a=n[0],s=n[1],i=n[2];return e[0]=a+r*(t[0]-a),e[1]=s+r*(t[1]-s),e[2]=i+r*(t[2]-i),e}function Dt(e,n,t,r,a,s){var i=s*s,c=i*(2*s-3)+1,l=i*(s-2)+s,o=i*(s-1),f=i*(3-2*s);return e[0]=n[0]*c+t[0]*l+r[0]*o+a[0]*f,e[1]=n[1]*c+t[1]*l+r[1]*o+a[1]*f,e[2]=n[2]*c+t[2]*l+r[2]*o+a[2]*f,e}function Et(e,n,t,r,a,s){var i=1-s,c=i*i,l=s*s,o=c*i,f=3*s*c,v=3*l*i,h=l*s;return e[0]=n[0]*o+t[0]*f+r[0]*v+a[0]*h,e[1]=n[1]*o+t[1]*f+r[1]*v+a[1]*h,e[2]=n[2]*o+t[2]*f+r[2]*v+a[2]*h,e}function Ot(e,n){n=n||1;var t=oe()*2*Math.PI,r=oe()*2-1,a=Math.sqrt(1-r*r)*n;return e[0]=Math.cos(t)*a,e[1]=Math.sin(t)*a,e[2]=r*n,e}function Rt(e,n,t){var r=n[0],a=n[1],s=n[2],i=t[3]*r+t[7]*a+t[11]*s+t[15];return i=i||1,e[0]=(t[0]*r+t[4]*a+t[8]*s+t[12])/i,e[1]=(t[1]*r+t[5]*a+t[9]*s+t[13])/i,e[2]=(t[2]*r+t[6]*a+t[10]*s+t[14])/i,e}function Nt(e,n,t){var r=n[0],a=n[1],s=n[2];return e[0]=r*t[0]+a*t[3]+s*t[6],e[1]=r*t[1]+a*t[4]+s*t[7],e[2]=r*t[2]+a*t[5]+s*t[8],e}function $t(e,n,t){var r=t[0],a=t[1],s=t[2],i=t[3],c=n[0],l=n[1],o=n[2],f=a*o-s*l,v=s*c-r*o,h=r*l-a*c,u=a*h-s*v,y=s*f-r*h,m=r*v-a*f,p=i*2;return f*=p,v*=p,h*=p,u*=2,y*=2,m*=2,e[0]=c+f+u,e[1]=l+v+y,e[2]=o+h+m,e}function Tt(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[0],s[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),s[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Lt(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),s[1]=a[1],s[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function Pt(e,n,t,r){var a=[],s=[];return a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2],s[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),s[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),s[2]=a[2],e[0]=s[0]+t[0],e[1]=s[1]+t[1],e[2]=s[2]+t[2],e}function jt(e,n){var t=e[0],r=e[1],a=e[2],s=n[0],i=n[1],c=n[2],l=Math.sqrt(t*t+r*r+a*a),o=Math.sqrt(s*s+i*i+c*c),f=l*o,v=f&&Ae(e,n)/f;return Math.acos(Math.min(Math.max(v,-1),1))}function qt(e){return e[0]=0,e[1]=0,e[2]=0,e}function Vt(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ct(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Ft(e,n){var t=e[0],r=e[1],a=e[2],s=n[0],i=n[1],c=n[2];return Math.abs(t-s)<=T*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(r-i)<=T*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-c)<=T*Math.max(1,Math.abs(a),Math.abs(c))}var Ut=Me,It=ge,Bt=we,Gt=be,Ht=ze,Yt=xe,Zt=Se,Qt=function(){var e=de();return function(n,t,r,a,s,i){var c,l;for(t||(t=3),r||(r=0),a?l=Math.min(a*t+r,n.length):l=n.length,c=r;c<l;c+=t)e[0]=n[c],e[1]=n[c+1],e[2]=n[c+2],s(e,e,i),n[c]=e[0],n[c+1]=e[1],n[c+2]=e[2];return n}}(),Wt=Object.freeze({__proto__:null,create:de,clone:ft,length:xe,fromValues:vt,copy:ht,set:pt,add:mt,subtract:Me,multiply:ge,divide:we,ceil:ut,floor:yt,min:dt,max:xt,round:Mt,scale:gt,scaleAndAdd:wt,distance:be,squaredDistance:ze,squaredLength:Se,negate:bt,inverse:zt,normalize:St,dot:Ae,cross:At,lerp:_t,hermite:Dt,bezier:Et,random:Ot,transformMat4:Rt,transformMat3:Nt,transformQuat:$t,rotateX:Tt,rotateY:Lt,rotateZ:Pt,angle:jt,zero:qt,str:Vt,exactEquals:Ct,equals:Ft,sub:Ut,mul:It,div:Bt,dist:Gt,sqrDist:Ht,len:Yt,sqrLen:Zt,forEach:Qt});const{identity:Xt,rotate:kt}=ot,{add:Jt,cross:Kt,dot:er,mul:nr,normalize:_e,subtract:q1,scale:g0,transformMat4:tr}=Wt;function rr(e){const n=2*Math.PI/e;return new Array(e).fill(null).map((t,r)=>[Math.cos(n*r),Math.sin(n*r)])}function ar(e,n=1){const t=new Uint16Array(e*(Math.max(n,1)-1)*6);for(let r=0;r<n;r++){const a=r*e*6,s=r*e;for(let i=0;i<e;i++){const c=a+i*6,l=s+i;t[c+0]=l,t[c+1]=l-e+1,t[c+2]=l+1,t[c+3]=l+1,t[c+4]=l+e,t[c+5]=l,i===e-1?(t[c+0]=l,t[c+1]=l-e+1,t[c+2]=l+1,t[c+3]=l+1,t[c+4]=l+e,t[c+5]=l):(t[c+0]=l,t[c+1]=l+1,t[c+2]=l+e+1,t[c+3]=l+e+1,t[c+4]=l+e,t[c+5]=l)}}return t}function sr(e,n=3){const t=e,r=[],a=[],s=[],i={position:[],normals:[],index:ar(n,t.length)},c=rr(n),l=c.length,o=t.length;for(let f=0;f<o;f++){const v=[0,0,1];f===0?q1(a,t[f],t[f+1]):f===o-1?q1(a,t[f-1],t[f]):q1(a,t[f-1],t[f+1]),_e(a,a),Kt(s,v,a);const h=Math.acos(er(v,a));Xt(r),kt(r,r,h,s);for(let u=0;u<l;u++){const y=c[u],m=[y[0],y[1],0],p=t[f][3];nr(m,m,[p,p,1]),tr(m,m,r);const d=[];_e(d,m),i.normals.push(d),Jt(m,m,t[f]),i.position.push(m)}}return i}function a1(e,n,t){return e*(1-t)+n*t}function ir(e,n=0){const t=(e.length-1)*n,r=Math.floor(t),a=Math.ceil(t);return a1(e[a],e[r],a-t)}function De(e,n){const t=(e.length/4-1)*n,r=Math.floor(t),a=Math.ceil(t),s=a-t;return[a1(e[a*4+0],e[r*4+0],s),a1(e[a*4+1],e[r*4+1],s),a1(e[a*4+2],e[r*4+2],s),a1(e[a*4+3],e[r*4+3],s)]}function V1(e,n){const t=(e.length/4-1)*n,r=Math.floor(t),a=Math.ceil(t);return[e[a*4+0]-e[r*4+0],e[a*4+1]-e[r*4+1],e[a*4+2]-e[r*4+2],e[a*4+3]+e[r*4+3]/2]}function d1(...e){const n=e.filter(v=>!!v);if(n.length===1)return n[0];const t=new Float32Array(n.reduce((v,h)=>v+h.position.length,0)),r=new Float32Array(n.reduce((v,h)=>v+h.normal.length,0)),a=new Float32Array(n.reduce((v,h)=>v+h.uv.length,0)),s=n.reduce((v,h)=>v+h.index.length,0),i=s>65536?new Uint32Array(s):new Uint16Array(s);let c=0,l=0,o=0,f=0;for(let v=0;v<n.length;v++){const h=n[v].normal,u=h.length;for(let M=0;M<u;M++)r[l+M]=h[M];l+=u;const y=n[v].uv,m=y.length;for(let M=0;M<m;M++)a[o+M]=y[M];o+=m;const p=n[v].index,d=p.length;for(let M=0;M<d;M++)i[M+f]=p[M]+c/3;f+=d;const w=n[v].position,x=w.length;for(let M=0;M<x;M++)t[c+M]=w[M];c+=x}return{position:t,normal:r,uv:a,index:i}}var cr=(e,n)=>Math.sqrt(e*e+n*n),lr=(e,n,t)=>Math.sqrt(e*e+n*n+t*t),s1={},x1={},i1={};Object.defineProperty(i1,"__esModule",{value:!0});function or(e){var n=new Uint32Array(1);return n[0]=e[0]*1664525+1013904223,n}i1.default=or,Object.defineProperty(x1,"__esModule",{value:!0}),x1.makeNoise2D=void 0;var M1=i1,fr=1/47,C1=(Math.sqrt(2+1)-1)/2,vr=(1/Math.sqrt(2+1)-1)/2;function Ee(e,n,t){return{dx:-n-e*C1,dy:-t-e*C1,xsb:n,ysb:t}}function hr(e){for(var n=[],t=0;t<c1.length;t+=4){for(var r=pr[c1[t]],a=null,s=null,i=0;i<r.length;i+=3)s=Ee(r[i],r[i+1],r[i+2]),a===null?n[t/4]=s:a.next=s,a=s;s.next=Ee(c1[t+1],c1[t+2],c1[t+3])}for(var c=[],t=0;t<F1.length;t+=2)c[F1[t]]=n[F1[t+1]];for(var l=new Uint8Array(256),o=new Uint8Array(256),f=new Uint8Array(256),t=0;t<256;t++)f[t]=t;var v=new Uint32Array(1);v[0]=e,v=M1.default(M1.default(M1.default(v)));for(var t=255;t>=0;t--){v=M1.default(v);var h=new Uint32Array(1);h[0]=(v[0]+31)%(t+1),h[0]<0&&(h[0]+=t+1),l[t]=f[h[0]],o[t]=l[t]&14,f[h[0]]=f[t]}return function(u,y){for(var m=(u+y)*vr,p=u+m,d=y+m,w=Math.floor(p),x=Math.floor(d),M=(w+x)*C1,b=u-(w+M),g=y-(x+M),_=p-w,z=d-x,E=_+z,O=_-z+1|E<<1|E+z<<2|E+_<<4,D=0,S=c[O];S!==void 0;S=S.next){var R=b+S.dx,A=g+S.dy,N=2-R*R-A*A;if(N>0){var P=w+S.xsb,$=x+S.ysb,q=l[P&255],V=o[q+$&255],X=Oe[V]*R+Oe[V+1]*A;D+=N*N*N*N*X}}return D*fr}}x1.makeNoise2D=hr;var pr=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],Oe=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],F1=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],c1=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],g1={};Object.defineProperty(g1,"__esModule",{value:!0}),g1.makeNoise3D=void 0;var w1=i1,mr=1/103,b1=(Math.sqrt(3+1)-1)/3,ur=(1/Math.sqrt(3+1)-1)/3;function U1(e,n,t,r){return{dx:-n-e*b1,dy:-t-e*b1,dz:-r-e*b1,xsb:n,ysb:t,zsb:r}}function yr(e){for(var n=[],t=0;t<G.length;t+=9){for(var r=dr[G[t]],a=null,s=null,i=0;i<r.length;i+=4)s=U1(r[i],r[i+1],r[i+2],r[i+3]),a===null?n[t/9]=s:a.next=s,a=s;s.next=U1(G[t+1],G[t+2],G[t+3],G[t+4]),s.next.next=U1(G[t+5],G[t+6],G[t+7],G[t+8])}for(var c=[],t=0;t<B1.length;t+=2)c[B1[t]]=n[B1[t+1]];for(var l=new Uint8Array(256),o=new Uint8Array(256),f=new Uint8Array(256),t=0;t<256;t++)f[t]=t;var v=new Uint32Array(1);v[0]=e,v=w1.default(w1.default(w1.default(v)));for(var t=255;t>=0;t--){v=w1.default(v);var h=new Uint32Array(1);h[0]=(v[0]+31)%(t+1),h[0]<0&&(h[0]+=t+1),l[t]=f[h[0]],o[t]=l[t]%24*3,f[h[0]]=f[t]}return function(u,y,m){for(var p=(u+y+m)*ur,d=u+p,w=y+p,x=m+p,M=Math.floor(d),b=Math.floor(w),g=Math.floor(x),_=(M+b+g)*b1,z=u-(M+_),E=y-(b+_),O=m-(g+_),D=d-M,S=w-b,R=x-g,A=D+S+R,N=S-R+1|D-S+1<<1|D-R+1<<2|A<<3|A+R<<5|A+S<<7|A+D<<9,P=0,$=c[N];$!==void 0;$=$.next){var q=z+$.dx,V=E+$.dy,X=O+$.dz,Y=2-q*q-V*V-X*X;if(Y>0){var C=M+$.xsb,f1=b+$.ysb,v1=g+$.zsb,h1=l[C&255],p1=l[h1+f1&255],H=o[p1+v1&255],ee=I1[H]*q+I1[H+1]*V+I1[H+2]*X;P+=Y*Y*Y*Y*ee}}return P*mr}}g1.makeNoise3D=yr;var dr=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],I1=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],B1=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],G=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],z1={};Object.defineProperty(z1,"__esModule",{value:!0}),z1.makeNoise4D=void 0;var S1=i1,xr=1/30,l1=(Math.sqrt(4+1)-1)/4,Mr=(1/Math.sqrt(4+1)-1)/4;function A1(e,n,t,r,a){return{dx:-n-e*l1,dy:-t-e*l1,dz:-r-e*l1,dw:-a-e*l1,xsb:n,ysb:t,zsb:r,wsb:a}}function gr(e){for(var n=[],t=0;t<j.length;t+=16){for(var r=wr[j[t]],a=null,s=null,i=0;i<r.length;i+=5)s=A1(r[i],r[i+1],r[i+2],r[i+3],r[i+4]),a===null?n[t/16]=s:a.next=s,a=s;s.next=A1(j[t+1],j[t+2],j[t+3],j[t+4],j[t+5]),s.next.next=A1(j[t+6],j[t+7],j[t+8],j[t+9],j[t+10]),s.next.next.next=A1(j[t+11],j[t+12],j[t+13],j[t+14],j[t+15])}for(var c=[],t=0;t<G1.length;t+=2)c[G1[t]]=n[G1[t+1]];for(var l=new Uint8Array(256),o=new Uint8Array(256),f=new Uint8Array(256),t=0;t<256;t++)f[t]=t;var v=new Uint32Array(1);v[0]=e,v=S1.default(S1.default(S1.default(v)));for(var t=255;t>=0;t--){v=S1.default(v);var h=new Uint32Array(1);h[0]=(v[0]+31)%(t+1),h[0]<0&&(h[0]+=t+1),l[t]=f[h[0]],o[t]=l[t]&252,f[h[0]]=f[t]}return function(u,y,m,p){for(var d=(u+y+m+p)*Mr,w=u+d,x=y+d,M=m+d,b=p+d,g=Math.floor(w),_=Math.floor(x),z=Math.floor(M),E=Math.floor(b),O=(g+_+z+E)*l1,D=u-(g+O),S=y-(_+O),R=m-(z+O),A=p-(E+O),N=w-g,P=x-_,$=M-z,q=b-E,V=N+P+$+q,X=$-q+1|P-$+1<<1|P-q+1<<2|N-P+1<<3|N-$+1<<4|N-q+1<<5|V<<6|V+q<<8|V+$<<11|V+P<<14|V+N<<17,Y=0,C=c[X];C!==void 0;C=C.next){var f1=D+C.dx,v1=S+C.dy,h1=R+C.dz,p1=A+C.dw,H=2-f1*f1-v1*v1-h1*h1-p1*p1;if(H>0){var ee=g+C.xsb,f0=_+C.ysb,v0=z+C.zsb,h0=E+C.wsb,p0=l[ee&255],m0=l[p0+f0&255],u0=l[m0+v0&255],O1=o[u0+h0&255],y0=_1[O1]*f1+_1[O1+1]*v1+_1[O1+2]*h1+_1[O1+3]*p1;Y+=H*H*H*H*y0}}return Y*xr}}z1.makeNoise4D=gr;var wr=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],_1=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],G1=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],j=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.makeNoise4D=e.makeNoise3D=e.makeNoise2D=void 0;var n=x1;Object.defineProperty(e,"makeNoise2D",{enumerable:!0,get:function(){return n.makeNoise2D}});var t=g1;Object.defineProperty(e,"makeNoise3D",{enumerable:!0,get:function(){return t.makeNoise3D}});var r=z1;Object.defineProperty(e,"makeNoise4D",{enumerable:!0,get:function(){return r.makeNoise4D}})})(s1);let Z=0,H1=s1.makeNoise2D(Z),Re=s1.makeNoise3D(Z);var Q={n1d:e=>H1(e,0),n2d:(e,n)=>H1(e,n),n3d:(e,n,t)=>Re(e,n,t),get seed(){return Z},set seed(e){e!==Z&&(Z=e,H1=s1.makeNoise2D(Z),Re=s1.makeNoise3D(Z))}},Ne=([e,n])=>{const t=cr(e,n);return t===0?[1,0]:[e/t,n/t]},Y1=([e,n,t])=>{const r=lr(e,n,t);return[e/r,n/r,t/r]},$e=(e,n,t)=>[e*Math.cos(t)-n*Math.sin(t),e*Math.sin(t)+n*Math.cos(t)];function D1(e,n,t){const[r,a,s]=e,[i,c,l]=Y1(n),o=Math.cos(t),f=Math.sin(t);return new I((o+(1-o)*i*i)*r+((1-o)*i*c-l*f)*a+((1-o)*i*l+c*f)*s,((1-o)*i*c+l*f)*r+(o+(1-o)*c*c)*a+((1-o)*c*l-i*f)*s,((1-o)*i*l-c*f)*r+((1-o)*c*l+i*f)*a+(o+(1-o)*l*l)*s)}function br([e,n,t]){return e===0&&t===0?[1,0,0]:[1,1,-((e+n)/t)]}function zr(e,{res:n=1,xCurvature:t=.5,yCurvature:r=.2}={}){const a=e.length,s=3+n*2,i=s*a,c=(s-1)*(a-1)*2,l=new Float32Array(i*3),o=new Float32Array(i*2),f=new Float32Array(i*2),v=new Uint16Array(c*3);return e.forEach((h,u)=>{const y=u*s;for(let m=0;m<s;m++){const p=2-m/(s-1)*2-1;l[y*3+m*3+0]=(h.x-1)*p*.5;const d=-(1-h.y)*(1-h.y)*.5,w=Math.sin(Math.abs(p)*Math.PI)*.01;if(l[y*3+m*3+1]=w*t+d*r,l[y*3+m*3+2]=h.y-1,f[y*2+m*2+0]=l[y*3+m*3+0]+1/2,f[y*2+m*2+1]=l[y*3+m*3+2],u<e.length-1){const x=u*(s-1);v[x*6+m*6+0]=y+m+0,v[x*6+m*6+1]=y+m+1,v[x*6+m*6+2]=y+m+s,v[x*6+m*6+3]=y+m+1,v[x*6+m*6+4]=y+m+s,v[x*6+m*6+5]=y+m+s+1}}}),{position:l,normal:o,index:v,uv:f}}function Te(e,n=8){const t=Xe(e,4),r=sr(t,n),a=Float32Array.from(r.position.flat()),s=Float32Array.from(r.normals.flat());return{position:a,index:r.index,normal:s,uv:new Float32Array}}function Sr(e,n=1,t=1,r=0,a=!0){var p,d,w,x,M,b;const s=Array.isArray(t)?1:t,i=((p=t[0])!=null?p:s)*10,c=((d=t[1])!=null?d:s)*10,l=((w=t[2])!=null?w:s)*10,o=Array.isArray(r)?0:r,f=(x=r[0])!=null?x:o,v=(M=r[1])!=null?M:o,h=(b=r[2])!=null?b:o,u=e.length/4,y=[e[0],e[1],e[2]];let m=0;for(let g=0;g<u;g++){const _=g/u;m+=(Math.abs(y[0]-e[g*4+0])+Math.abs(y[1]-e[g*4+1])+Math.abs(y[2]-e[g*4+2]))/3,y[0]=e[g*4+0],y[1]=e[g*4+1],y[2]=e[g*4+2];const z=a?n*_:n,[E,O,D]=e.slice(g*4,g*4+3);e[g*4+0]=E+Q.n1d(1e3+f+m*i)*z,e[g*4+1]=O+Q.n1d(2e3+v+m*c)*z,e[g*4+2]=D+Q.n1d(3e3+h+m*l)*z}return e}function Le(e,[n,t,r]){let a=e.length/4,s=-1;for(;s++<a-1;)e[s*4+0]=e[s*4+0]+n,e[s*4+1]=e[s*4+1]+t,e[s*4+2]=e[s*4+2]+r;return e}function Pe(e,n,t=1,r,a=!1){const[s=0,i=0,c=0]=r||e;s&&i&&c&&Le(e,[-s,-i,-c]);const l=e.length/4;let o=-1;for(;o++<l-1;){const f=e.slice(o*4,o*4+3),v=o/l,h=D1([...f],n,a?t*v:t);e[o*4+0]=h[0],e[o*4+1]=h[1],e[o*4+2]=h[2]}return s&&i&&c&&Le(e,[s,i,c]),e}function Ar(e,n=.5,t=2,r=1){const a=Math.max(Math.min(n,1),0),s=Math.floor(Math.max(0,t));if(s<2)return[e];const i=e.length/4,c=Math.floor(i*a),l=Y1(V1(e,a)),o=Y1(br(l));return[...c<0?[]:[e.slice(0,c*4)],...new Array(s).fill(null).map((f,v)=>{const h=e.slice((c-2)*4),u=v/t;return Pe(h,o,r,void 0,!0),Pe(h,l,u*6),h})].filter(f=>f.length>4)}function w0(e){return e}var _r={title:"Branches",type:"branches",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},length:{type:"number",min:0,max:3,step:.05,value:.8},thiccness:{type:"number",min:0,max:1,step:.01,value:.8},offsetSingle:{type:"number",min:0,max:1,step:.01,value:.5},lowestBranch:{type:"number",min:0,max:1,step:.01,value:.2},amount:{type:"number",min:0,max:64,value:10}},computeStem(e,n){if(!e.input)return{stems:[]};const{stems:t}=e.input(),r=n.getSetting("stemResY"),a=Math.max(...t.map(i=>i.depth)),s=t.map(i=>{const c=[];if(a!==i.depth)return[];const l=e.amount(),o=e.lowestBranch();for(let f=0;f<l;f++){const v=f/l,h=e.length(v)*(1-v),u=e.thiccness(v),y=e.offsetSingle(v),m=f%2===0;let p=o+(1-o)*v;p-=1/l*y*(m?-1:1);const[d,,w]=V1(i.skeleton,p),x=Ne([d,w]),[M,b]=$e(x[0],x[1],m?-Math.PI/2:Math.PI/2),[g,_,z,E]=De(i.skeleton,p),O=Math.max(Math.floor(r*h*10),4),D=new Float32Array(O*4);for(let S=0;S<O*4;S++){const R=S/O;D[S*4+0]=g+M*R*h,D[S*4+1]=_,D[S*4+2]=z+b*R*h,D[S*4+3]=E*u*(1-R)}c.push(D)}return c.map(f=>({skeleton:f,id:i.id,depth:i.depth+1}))}).flat();return{stems:[...t,...s]}}},Dr={title:"Random",type:"random",outputs:["number"],parameters:{min:{type:"number",value:0,min:0,max:1,step:.05},max:{type:"number",value:1,min:0,max:1,step:.05}},computeValue(e,n,t){const r=e.max(),a=e.min();return r?a+n.n1dn(200+t*1e3)*Math.abs(r-a):0}},Er={title:"Curve",type:"curve",outputs:["number"],parameters:{value:{type:"curve",internal:!0,label:!1,value:[{x:0,y:1,pinned:!0},{x:1,y:0,pinned:!0}]}},computeValue(e,n,t){const r=Ze(e.value).map(a=>a.y);return ir(r,1-t)}},Or={title:"Gravity",type:"gravity",outputs:["plant"],parameters:{input:{type:"plant",external:!0},type:{internal:!0,type:"select",values:["simple","verlet","test"],value:"simple"},strength:{type:"number",min:0,max:2,step:.05,value:1}},computeStem(e){const{input:n,type:t,strength:r}=e,{stems:a}=n(),s=Math.max(...a.map(i=>i.depth));return t==="simple"&&a.forEach(({skeleton:i,depth:c})=>{if(c!==s)return;const l=i.length/4;for(let o=1;o<l;o++){const f=o/l,v=i[o*4+1],h=r(f);i[o*4+1]=v-v*f*f*f*h}return i}),t==="test"&&a.forEach(({skeleton:i})=>{const c=i.length/4;for(let l=1;l<c;l++){const o=l/c,f=r(o),v=i[l*4+0],h=i[l*4+1],u=i[l*4+2],y=i[(l-1)*4+0],m=i[(l-1)*4+1],p=i[(l-1)*4+2],d=y-v,w=m-h,x=m-u,[M,b]=$e(d,x,90);for(let g=l;g<c;g++){const _=i[g*4+0],z=i[g*4+1],E=i[g*4+2],O=_-y,D=z-m,S=E-p;let[R,A,N]=D1([O,D,S],[M,w,b],f*o);const P=R+y,$=A+m,q=N+p;i[g*4+0]=P,i[g*4+1]=$,i[g*4+2]=q}}return i}),t==="verlet"&&a.forEach(({skeleton:i})=>{const c=i.length/4;for(let l=1;l<c;l++){const o=i[l*4+0],f=i[l*4+1],v=i[l*4+2],h=new I(5,0,0).cross(new I(o,f,v),new I(0,1,0)),u=l/c,y=r(u);for(let m=l;m<c;m++){const p=D1([o,f,v],h,u*y);i[m*4+0]=p[0],i[m*4+1]=p[1],i[m*4+2]=p[2]}}return i}),{stems:a}},computeGeometry(e){return e.input()}};const Z1=e1("nodes.join");var Rr={title:"Join",type:"join",outputs:["plant"],parameters:{inputA:{type:"plant",label:"plant",external:!0},inputB:{type:"plant",label:"plant",external:!0}},computeStem(e,n){Z1("compute skeleton",e,n);const{inputA:t,inputB:r}=e;if(!t||!r)return t?t():r();const{stems:a}=t(),{stems:s}=r();return Z1(a,s),{stems:[...a,...s]}},computeGeometry(e){const{inputA:n,inputB:t}=e;if(!n||!t)return n?n():t();const{geometry:r,instances:a}=n(),{geometry:s,instances:i}=t(),c=d1(r,s),l=[];return a&&l.push(a),i&&l.push(i),Z1("compute geometry",{geometryA:r,geometryB:s,result:c}),{geometry:c,instances:l}}},Nr={title:"Leaf",type:"leaf",outputs:["plant"],parameters:{input:{type:"plant",external:!0},size:{type:"number",min:0,max:3,step:.05,value:.2},shape:{type:"shape",external:!0,value:[{x:1,y:1,pinned:!0},{x:.62,y:.84,pinned:!1},{x:.54,y:.63,pinned:!1},{x:.38,y:.41,pinned:!0},{x:.44,y:.23,pinned:!1},{x:.64,y:.12,pinned:!1},{x:.98,y:.02,pinned:!0}]},lowestLeaf:{type:"number",min:0,max:1,step:.01,value:.5},curvature:{external:!0,type:"vec2",value:{x:.5,y:.2}},amount:{type:"number",min:0,max:20,value:10}},computeStem(e){const{stems:n}=e.input(),t=Math.max(...n.map(a=>a.depth)),r=n.map((a,s)=>{const i=s/n.length;if(a.depth!==t)return;const c=e.amount(i),l=new Float32Array(c*3),o=new Float32Array(c*3),f=new Float32Array(c*3);for(let v=0;v<c;v++){const h=v/(c-1),u=e.size(1-h),y=e.lowestLeaf(h),m=y+(1-y)*h-.001,[p,d,w]=De(a.skeleton,m),[x,,M]=V1(a.skeleton,m),b=Ne([x,M]),g=Math.atan2(-b[0],b[1]);l[v*3+0]=p,l[v*3+1]=d,l[v*3+2]=w,o[v*3+0]=u,o[v*3+1]=1,o[v*3+2]=u,f[v*3+0]=0,f[v*3+1]=g-Math.PI/2*(v%2===0?-1:1),f[v*3+2]=0}return{offset:l,scale:o,rotation:f}}).filter(a=>!!a);return{stems:n,instances:r}},computeGeometry(e,n,t){const{shape:r,input:a,curvature:s}=e,{instances:i}=n,c=s(),l=zr(r(),{res:t.getSetting("leafRes",2),xCurvature:c.x,yCurvature:c.y});return{geometry:a().geometry,instances:i.map(o=>m1(m1({},o),l))}}},$r={title:"Math",type:"math",outputs:["number"],parameters:{mode:{type:"select",internal:!0,label:!1,value:"add",values:["add","multiply","subtract"]},a:{type:"number",value:0,label:!1},b:{type:"number",value:0,label:!1}},computeValue(e,n,t){const{mode:r}=e,a=e.a(t),s=e.b(t);switch(r){case"multiply":return a*s;case"subtract":return a-s;default:return a+s}}};const Tr=e1("nodes.noise");var Lr={title:"Noise",type:"noise",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},size:{type:"number",min:0,max:2,step:.05,value:1},strength:{type:"number",min:0,max:2,step:.01,value:.5}},computeStem(e){Tr("computeSkeleton",e);const{stems:n}=e.input(),t=e.size(),r=e.strength(),a=Math.max(...n.map(s=>s.depth));return n.forEach((s,i)=>{s.depth===a&&Sr(s.skeleton,r,t,i*200)}),{stems:n}},computeGeometry(e,n,t){var i;const r=t.getSetting("stemResX"),a=(i=e==null?void 0:e.input)==null?void 0:i.call(e),{stems:s}=n;return{geometry:d1(a?a.geometry:null,...s.map(({skeleton:c})=>Te(c,r)))}}},Pr={title:"Output",type:"output",outputs:[],parameters:{input:{type:"plant",label:"plant",external:!0}}},jr={title:"Parameter",type:"parameter",outputs:["number"],parameters:{value:{type:"number",inputType:"float",value:0},variation:{type:"number",value:0,min:0,max:1,step:.05}},computeValue(e,n,t=1){const r=e.value(),a=e.variation();return a?r+n.n1d(200*t)*a*Math.max(r,1):r}};const qr=e=>e==="X"?[1,0,0]:e==="Z"?[0,0,1]:[0,1,0];var Vr={title:"Rotate",type:"rotate",outputs:["plant"],parameters:{input:{type:"plant",external:!0},axis:{type:"select",internal:!0,label:!1,inputType:"tab",values:["Y","X","Z"],value:"X"},spread:{internal:!0,type:"boolean",value:!0},angle:{type:"number",min:0,max:Math.PI*2,step:.05,value:0}},computeStem(e,n){const{input:t,axis:r,spread:a}=e,{stems:s}=t(),i=qr(r),{depth:c}=s[s.length-1];return s.forEach((l,o)=>{if(l.depth!==c)return;const f=l.skeleton,v=l.skeleton.length/4,h=f[0],u=f[1],y=f[2],m=o/s.length,p=e.angle(m)*(a?m:1);for(let d=1;d<v;d++){let w=f[d*4+0],x=f[d*4+1],M=f[d*4+2];w-=h,x-=u,M-=y,[w,x,M]=D1([w,x,M],i,p),w+=h,x+=u,M+=y,f[d*4+0]=w,f[d*4+1]=x,f[d*4+2]=M}}),{stems:s}}},Cr={title:"Shape",type:"shape",outputs:["shape"],parameters:{value:{type:"shape",internal:!0,label:!1,value:[{x:1,y:0,pinned:!0},{x:.5,y:.5,pinned:!0},{x:1,y:1,pinned:!0}]}},computeValue(e){return e.value}},Fr={title:"Slider",type:"slider",outputs:["number"],parameters:{value:{type:"number",label:!1,internal:!0,min:0,max:1,step:.01,value:0}},computeValue(e){return e.value}};const Ur=e1("nodes.stem");var Ir={title:"Stem",type:"stem",outputs:["plant"],parameters:{origin:{type:"vec3",external:!0,value:{x:0,y:0,z:0}},height:{type:"number",min:0,max:5,step:.05,value:2},thiccness:{type:"number",min:0,max:.2,step:.01,value:.06},amount:{type:"number",min:0,max:20,value:1}},computeStem(e,n){Ur("computeSkeleton",e);const t=e.amount(),r=n.getSetting("stemResY"),a=[];for(let s=0;s<t;s++){const{x:i,y:c,z:l}=e.origin(s),o=e.height(),f=new Float32Array(r*4);for(let v=0;v<r;v++){const h=v/r,u=e.thiccness(h)*(1-h),y=i,m=c+h*o,p=l;f[v*4+0]=y,f[v*4+1]=m,f[v*4+2]=p,f[v*4+3]=u}a.push({depth:0,skeleton:f,id:"stem"+n.getId()})}return{stems:a}}},Br={title:"Vec2",type:"vec2",outputs:["vec2"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0}}},Gr={title:"Vec3",type:"vec3",outputs:["vec3"],parameters:{x:{label:!1,type:"number",value:0,defaultValue:0},y:{label:!1,type:"number",value:0,defaultValue:0},z:{label:!1,type:"number",value:0,defaultValue:0}}},Hr={title:"Vec3Length",type:"vec3length",outputs:["number"],parameters:{vec:{type:"vec3",label:!1,value:{x:0,y:0,z:0}}},computeValue(e){const n=e.vec();return n?Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)+Math.pow(n.z,2)):0}},Yr={title:"Split",type:"split",outputs:["plant"],parameters:{input:{type:"plant",label:"plant",external:!0},height:{type:"number",min:0,max:1,step:.05,value:.7},angle:{type:"number",min:0,max:2,step:.01,value:.5},amount:{type:"number",min:2,max:20,value:2}},computeStem(e){const n=e.height(),t=e.angle(),r=e.amount(),{stems:a}=e.input(),s=Math.max(...a.map(c=>c.depth));return{stems:a.map(c=>c.depth===s?Ar(c.skeleton,n,r,t).map((o,f)=>({skeleton:o,id:c.id,depth:c.depth+(f===0?0:1)})):c).flat().filter(c=>!!c)}}},Zr={title:"Number",type:"number",outputs:["number"],parameters:{value:{type:"number",internal:!0,label:!1,value:0}},computeValue({value:e=0}){return e}},Qr=Object.freeze({__proto__:null,Branch:_r,Random:Dr,Curve:Er,Gravity:Or,Join:Rr,Leaf:Nr,Math:$r,Noise:Lr,Output:Pr,Parameter:jr,Rotate:Vr,Shape:Cr,Slider:Fr,Stem:Ir,Vec2:Br,Vec3:Gr,VecLength:Hr,Split:Yr,Number:Zr}),Wr=Object.values(Qr);const o1=new Map;for(const e of Wr)e.computeStem&&(e.computeStem=R1(e.computeStem)),e.computeGeometry&&(e.computeGeometry=R1(e.computeGeometry)),e.computeValue&&(e.computeValue=R1(e.computeValue)),o1.set(e.type,e);let je="",Q1,W1=2;const Xr=e=>{let n=0;return Q.seed=0,{_id:"",getId(){return this._id},n1d(t){return Q.n1d(W1++*t)},n1dn(t){return 1+Q.n1d(W1++*t)/2},getSetting(t){return e[t]},get settings(){return e},get seed(){return n},refresh(){W1=2,e!=null&&e.useRandomSeed&&(n=Math.floor(Math.random()*1e5),Q.seed=n)}}};var kr=e=>{const n=JSON.stringify(e);return n!==je&&(je=n,Q1=Xr(e)),Q1.refresh(),Q1};function Jr({nodes:e},n){const t=kr(n),r=new Map,a=new Map,s=v=>{var h;return(h=a.get(v))!=null?h:[]},i=v=>{var h;return(h=r.get(v))!=null?h:[]},c=e.map(({attributes:v,state:h})=>({attributes:v,state:h,type:v.type.toLowerCase(),id:v.id,level:-1,results:[]}));let l;c.forEach(v=>{r.set(v.id,v),!l&&v.type==="output"&&(l=v,l.level=0),v.attributes.refs.forEach(h=>{a.has(h.id)?a.set(h.id,[...a.get(h.id),{n:v,in:h.in,out:h.out}]):a.set(h.id,[{n:v,in:h.in,out:h.out}])})});function o(v){if(v!=null&&v.buckets)return v.buckets;let h=[v],u=[v];for(;h.length;){const m=h.shift(),p=s(m.id);if(p!=null&&p.length)for(const{n:d}of p)d.level=m.level+1,u.includes(d)||u.push(d),h.push(d)}const y=[];for(const m of u)y[m.level]?y[m.level].push(m):y[m.level]=[m];return v.buckets=y,y}function f(v){var y;if(v.paramaters)return v.paramaters;let h={};const u=o1.get(v.type);for(const[m,p]of Object.entries(v.state))(y=u.parameters[m])!=null&&y.internal?h[m]=p:h[m]=()=>p;for(const m of s(v.id)){const p=o1.get(m.n.type);p.outputs[0]==="plant"?h[m.in]=()=>m.n.results[0]:p!=null&&p.computeValue?h[m.in]=(d=1)=>{const w=f(m.n);return p.computeValue(w,t,d)}:h[m.in]=(d=1)=>{const w={},x=f(m.n);return Object.keys(x).forEach(b=>{w[b]=x[b](d)}),w}}return v.paramaters=h,h}return{nodes:c,outputNode:l,getNodeRef:s,getNode:i,getBucketsForNode:o,constructParametersForNode:f,ctx:t}}async function Kr(e,n){const t=Jr(e,n),r=t.ctx,a=t.getBucketsForNode(t.outputNode);for(const l of a.reverse())for(const o of l){const f=o1.get(o.type);if(f){let v=t.constructParametersForNode(o);if(f!=null&&f.computeStem){r._id=o.id;const h=f.computeStem(v,r);o.results=Array.isArray(h)?h:[h]}if(f!=null&&f.computeGeometry){const h=f.computeGeometry(v,o.results[0],r);o.results[0]=m1(m1({},o.results[0]),h)}}else console.warn("Missing Type",o.type),console.log(o1)}const{stems:s,instances:i}=t.outputNode.paramaters.input();let c=d1(...s.map(l=>Te(l.skeleton,r.getSetting("stemResX"))));if(i){const l=i==null?void 0:i.map(o=>xn(o)).flat();c=d1(c,...l)}return{stems:s,geometry:yn(c)}}const qe=Symbol("Comlink.proxy"),e0=Symbol("Comlink.endpoint"),n0=Symbol("Comlink.releaseProxy"),X1=Symbol("Comlink.thrown"),Ve=e=>typeof e=="object"&&e!==null||typeof e=="function",t0={canHandle:e=>Ve(e)&&e[qe],serialize(e){const{port1:n,port2:t}=new MessageChannel;return k1(e,n),[t,[t]]},deserialize(e){return e.start(),s0(e)}},r0={canHandle:e=>Ve(e)&&X1 in e,serialize({value:e}){let n;return e instanceof Error?n={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:n={isError:!1,value:e},[n,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},Ce=new Map([["proxy",t0],["throw",r0]]);function k1(e,n=self){n.addEventListener("message",function t(r){if(!r||!r.data)return;const{id:a,type:s,path:i}=Object.assign({path:[]},r.data),c=(r.data.argumentList||[]).map(W);let l;try{const o=i.slice(0,-1).reduce((v,h)=>v[h],e),f=i.reduce((v,h)=>v[h],e);switch(s){case"GET":l=f;break;case"SET":o[i.slice(-1)[0]]=W(r.data.value),l=!0;break;case"APPLY":l=f.apply(o,c);break;case"CONSTRUCT":{const v=new f(...c);l=l0(v)}break;case"ENDPOINT":{const{port1:v,port2:h}=new MessageChannel;k1(e,h),l=c0(v,[v])}break;case"RELEASE":l=void 0;break;default:return}}catch(o){l={value:o,[X1]:0}}Promise.resolve(l).catch(o=>({value:o,[X1]:0})).then(o=>{const[f,v]=K1(o);n.postMessage(Object.assign(Object.assign({},f),{id:a}),v),s==="RELEASE"&&(n.removeEventListener("message",t),Fe(n))})}),n.start&&n.start()}function a0(e){return e.constructor.name==="MessagePort"}function Fe(e){a0(e)&&e.close()}function s0(e,n){return J1(e,[],n)}function E1(e){if(e)throw new Error("Proxy has been released and is not useable")}function J1(e,n=[],t=function(){}){let r=!1;const a=new Proxy(t,{get(s,i){if(E1(r),i===n0)return()=>n1(e,{type:"RELEASE",path:n.map(c=>c.toString())}).then(()=>{Fe(e),r=!0});if(i==="then"){if(n.length===0)return{then:()=>a};const c=n1(e,{type:"GET",path:n.map(l=>l.toString())}).then(W);return c.then.bind(c)}return J1(e,[...n,i])},set(s,i,c){E1(r);const[l,o]=K1(c);return n1(e,{type:"SET",path:[...n,i].map(f=>f.toString()),value:l},o).then(W)},apply(s,i,c){E1(r);const l=n[n.length-1];if(l===e0)return n1(e,{type:"ENDPOINT"}).then(W);if(l==="bind")return J1(e,n.slice(0,-1));const[o,f]=Ue(c);return n1(e,{type:"APPLY",path:n.map(v=>v.toString()),argumentList:o},f).then(W)},construct(s,i){E1(r);const[c,l]=Ue(i);return n1(e,{type:"CONSTRUCT",path:n.map(o=>o.toString()),argumentList:c},l).then(W)}});return a}function i0(e){return Array.prototype.concat.apply([],e)}function Ue(e){const n=e.map(K1);return[n.map(t=>t[0]),i0(n.map(t=>t[1]))]}const Ie=new WeakMap;function c0(e,n){return Ie.set(e,n),e}function l0(e){return Object.assign(e,{[qe]:!0})}function K1(e){for(const[n,t]of Ce)if(t.canHandle(e)){const[r,a]=t.serialize(e);return[{type:"HANDLER",name:n,value:r},a]}return[{type:"RAW",value:e},Ie.get(e)||[]]}function W(e){switch(e.type){case"HANDLER":return Ce.get(e.name).deserialize(e.value);case"RAW":return e.value}}function n1(e,n,t){return new Promise(r=>{const a=o0();e.addEventListener("message",function s(i){!i.data||!i.data.id||i.data.id!==a||(e.removeEventListener("message",s),r(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),t)})}function o0(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}k1({executeNodeSystem:Kr})})();
